<!DOCTYPE html>
<html manifest="app.manifest">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="format-detection" content="telephone=yes">
	<meta name="viewport" content="width=device-width, maximum-scale=1.0, initial-scale=1.0, user-scalable=no"/>

	<title></title>

	<style type="text/css">ï»¿ html,body{-webkit-touch-callout:none;-webkit-user-select:none;user-select:none;background-color:#000;overflow:hidden}*{margin:0;padding:0;border:0;-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-tap-highlight-color:transparent;-webkit-border-style:none;border-style:none;-webkit-text-size-adjust:none;text-size-adjust:none;-webkit-font-smoothing:always;font-smoothing:always;-webkit-user-select:none;user-select:none;font-family:"Helvetica Neue",Helvetica,sans-serif}@-webkit-keyframes move_bg_progressmeter{0%{background-position:50px 50px}100%{background-position:0 0}}@-moz-keyframes move_bg_progressmeter{0%{background-position:50px 50px}100%{background-position:0 0}}@-o-keyframes move_bg_progressmeter{0%{background-position:50px 50px}100%{background-position:0 0}}.TW3ProgressBar{border:2px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden;-webkit-touch-callout:none;-webkit-border-radius:25px;border-radius:25px}.TW3ProgressMeter{overflow:hidden;margin:0;padding:0;background-color:rgba(144,156,179,1);-webkit-touch-callout:none;-webkit-animation:move_bg_progressmeter 3s linear infinite;animation:move_bg_progressmeter 3s linear infinite;-webkit-background-size:50px 50px;background-size:50px 50px;-webkit-border-radius:25px;border-radius:25px;background-image:-webkit-gradient(linear,0 0,100% 100%,color-stop(.25,rgba(255,255,255,.2)),color-stop(.25,transparent),color-stop(.5,transparent),color-stop(.5,rgba(255,255,255,.2)),color-stop(.75,rgba(255,255,255,.2)),color-stop(.75,transparent),to(transparent) );background-image:linear-gradient(-45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent )}.TW3ScrollbarUpBtn{border-top:1px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden;border-bottom-left-radius:24px;border-bottom-right-radius:24px;box-shadow:0 4px 0 -2px #F1F1F1 inset,0 2em 2em -2em #AAA inset,0 0 2px rgba(0,0,0,.5)}.TW3ScrollbarDownBtn{border-bottom:1px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden;border-top-left-radius:24px;border-top-right-radius:24px;box-shadow:0 4px 0 -2px #F1F1F1 inset,0 2em 2em -2em #AAA inset,0 0 2px rgba(0,0,0,.5)}.TW3ScrollbarUpBtn:active,.TW3ScrollbarDownBtn:active{background-color:#E5E5E5}.TW3ScrollbarDownBtn:hover,.TW3ScrollbarUpBtn:hover{cursor:pointer}.TW3ScrollbarLeftBtn{border-right:1px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden;border-top-left-radius:24px;border-bottom-left-radius:24px;box-shadow:0 4px 0 -2px #F1F1F1 inset,0 2em 2em -2em #AAA inset,0 0 2px rgba(0,0,0,.5)}.TW3ScrollbarRightBtn{border-left:1px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden;border-top-right-radius:24px;border-bottom-right-radius:24px;box-shadow:0 4px 0 -2px #F1F1F1 inset,0 2em 2em -2em #AAA inset,0 0 2px rgba(0,0,0,.5)}.TW3ScrollbarLeftBtn:active,.TW3ScrollbarRightBtn:active{background-color:#E5E5E5}.TW3ScrollbarLeftBtn:hover,.TW3ScrollbarRightBtn:hover{cursor:pointer}.TW3ScrollbarHandle{border-radius:25px;border:1px solid rgba(0,0,0,.3);background-color:#FFF;overflow:hidden}.TW3ScrollbarHandle:active{background-color:#E5E5E5}.TW3ScrollbarHandle:Hover{cursor:pointer}.TW3VerticalScrollbar{border:1px solid rgba(0,0,0,.4);overflow:hidden;border-radius:24px;background-color:rgba(250,250,250,.3);-webkit-touch-callout:none}.TW3VerticalScrollbar:disabled{opacity:.5;cursor:wait}.TW3HorizontalScrollbar{border:1px solid rgba(0,0,0,.4);overflow:hidden;border-radius:24px;background-color:rgba(250,250,250,.3);-webkit-touch-callout:none}.TW3HorizontalScrollbar:disabled{opacity:.5;cursor:wait}.TW3BlockBox{overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;margin:0;padding:0;background-color:rgba(0,0,0,.50)}.TW3CheckMark{margin:0;padding:0}.TW3ScrollContentIndicator{margin:0;padding:0;background-color:#222;border:solid 1px #9A9A9A}@-webkit-keyframes BACKSCROLL{0%{-webkit-transform:translateZ(0);background-position:0 0}100%{background-position:-557px 0;-webkit-transform:translateZ(0)}}@keyframes BACKSCROLL{0%{transform:translateZ(0);background-position:0 0}100%{background-position:-557px 0;transform:translateZ(0)}}@-webkit-keyframes MOVE-LEFT{0%{-webkit-transform:translateX(100%)}100%{-webkit-transform:translateX(0)}}@-webkit-keyframes MOVE-OUT-LEFT{0%{-webkit-transform:translateX(0)}100%{-webkit-transform:translateX(-100%)}}@keyframes MOVE-LEFT{0%{transform:translateX(100%)}100%{transform:translateX(0)}}@keyframes MOVE-OUT-LEFT{0%{transform:translateX(0)}100%{transform:translateX(-100%)}}@-webkit-keyframes MOVE-RIGHT{0%{-webkit-transform:translateX(-100%)}100%{-webkit-transform:translateX(0);visibility:hidden}}@-webkit-keyframes MOVE-OUT-RIGHT{0%{-webkit-transform:translateX(0)}100%{-webkit-transform:translateX(100%);visibility:hidden}}@keyframes MOVE-RIGHT{0%{transform:translateX(-100%)}100%{transform:translateX(0);visibility:hidden}}@keyframes MOVE-OUT-RIGHT{0%{transform:translateX(0)}100%{transform:translateX(100%);visibility:hidden}}@-webkit-keyframes ROTATE-FOREVER{from{-webkit-transform:none}to{-webkit-transform:rotate(360deg)}}@keyframes ROTATE-FOREVER{from{transform:none}to{transform:rotate(360deg)}}.TW3ToolButton{-webkit-box-shadow:0 1px 1px #9aa5bb,0 -1px 1px #8e96a5;box-shadow:0 1px 1px #9aa5bb,0 -1px 1px #8e96a5;-webkit-border-radius:5px;border-radius:5px;cursor:default;color:#fff;font-family:"Helvetica Neue",Helvetica,sans-serif;font-size:12px;border:solid 1px #54617d;border-color:#484e59 #54617d #4c5c7a #54617d;background:rgb(146,161,191);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,rgba(146,161,191,1)),color-stop(25%,rgba(121,138,173,1)),color-stop(50%,rgba(98,118,160,1)),color-stop(53%,rgba(85,106,151,1)),color-stop(75%,rgba(86,108,152,1)),color-stop(95%,rgba(84,105,147,1)));background:-webkit-linear-gradient(top,rgba(146,161,191,1) 0%,rgba(121,138,173,1) 25%,rgba(98,118,160,1) 50%,rgba(85,106,151,1) 53%,rgba(86,108,152,1) 75%,rgba(84,105,147,1) 95%);background:linear-gradient(to top,rgba(146,161,191,1) 0%,rgba(121,138,173,1) 25%,rgba(98,118,160,1) 50%,rgba(85,106,151,1) 53%,rgba(86,108,152,1) 75%,rgba(84,105,147,1) 95%)}.TW3ToolButton:active:enabled{background:rgb(84,105,147);background:-webkit-gradient(linear,left top,left bottom,color-stop(5%,rgba(84,105,147,1)),color-stop(25%,rgba(86,108,152,1)),color-stop(47%,rgba(85,106,151,1)),color-stop(50%,rgba(98,118,160,1)),color-stop(75%,rgba(121,138,173,1)),color-stop(100%,rgba(146,161,191,1)));background:-webkit-linear-gradient(top,rgba(84,105,147,1) 5%,rgba(86,108,152,1) 25%,rgba(85,106,151,1) 47%,rgba(98,118,160,1) 50%,rgba(121,138,173,1) 75%,rgba(146,161,191,1) 100%);background:linear-gradient(to top,rgba(84,105,147,1) 5%,rgba(86,108,152,1) 25%,rgba(85,106,151,1) 47%,rgba(98,118,160,1) 50%,rgba(121,138,173,1) 75%,rgba(146,161,191,1) 100%)}.TW3ToolButton:disabled{Opacity:.5;cursor:wait}.TW3Panel{cursor:inherited;border:2px solid #7c7a77;resize:none;font-size:12px;border-radius:6px;background-color:#FFF}.TW3CustomControl{cursor:default;background-color:#CECECE}.TW3AlertButton{font-family:"Helvetica Neue",Helvetica,sans-serif;font-size:18px;font-weight:bold;text-align:center;text-decoration:none;color:#fff;border:1px solid rgba(19,30,58,.9);background-color:#5f6981;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#b0b5c0),color-stop(50%,#6a748b),color-stop(51%,#505a75),color-stop(100%,#5f6981));-webkit-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.8);box-shadow:0 1px 0 rgba(0,0,0,.8);-webkit-text-shadow:0 -1px 0 rgba(0,0,0,.8);text-shadow:0 -1px 0 rgba(0,0,0,.8)}.TW3AlertButton:active{background-image:-webkit-gradient(linear,left top,left bottom,color-stop(0%,#5f6981),color-stop(50%,#505a75),color-stop(51%,#6a748b),color-stop(100%,#b0b5c0) )}.TW3AlertDialog{z-index:1000;padding:6px 5px;border:2px solid rgba(178,183,194,.8);border-top-color:rgba(226,227,228,.8);background:rgba(11,27,68,.8) url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARQAAAAfCAYAAAAmwDIOAAAGyklEQVR42u2da3NURRCGD1HIhktQEiEXbhFCDBcBQQRchBgiEMArKkQ+4P//EfjGaqpP5a1TT50drGRxPjw7PWf6Nt1zpli2Cpq3b98mzqS4JDbFlvh7j/KmXL88fsqsV563P69A3fam/zdj0L/X4mncBQPRdNG1MCGuilfidaVSqQSv4m6YwAslmBKPxV+C2GIdtwG7UjjHcrst0tlj+2O98WeL19kH65fn+YHU+ImYogvloHgmXv2HvCy1/cB4OQY+3a/k8a5J+f5Yj2MU5Ehr5bmy/XNxuOtC+Vg8Fn8Cf8A66JJ9eUyzsTnapyzYvhyLCc93G8gRe7/7+XK/QddsfeR44B/sOT88Q+Xv7qbYL+xCuS1+b/EC5ITXXiSggzFzzv5yJL+ck/ujOkBciMm5sG/uCdWrf214b1Qn0KW9Bv1rx3ET0Ot5JrhmfXR71dPhfJ07Oy+UOfGb+HXHmLKN7XXWMczW4pke6EBOnK9hOgb6ppxJl/N2HdiP+euRN/cuKInDZ4brAecP8vBnZXmlzH3mvEmf13iPkK8w5t5dKPvEuvgl+FmkLFJ2wMYJHZp3Phfkg+OyPufDOWOdYuSYqUP+3I73xrLvh+rP8VmfbNlfwn3i+nHPuI8Qz/B1zjVltgU/uc6xNsS+Rh8nxI/ip0RzkfOQGfcRMukUknFE9xrnaz6gBlwnzoNjcT7sL+G8fU49hDnkBfs0oP/FteO9lve8PF/QQxs4D3wm3c9CE78pPxXPguc7ZJGyP+u2cVzHfXfrWSx4DmvPwQ73yTVjzA5ice5cr4Tj+DzhOOwL6g3061/KHp/3VX4GTeZ8+f0TFBfOV3ktkxuNPh6IJ2Kzgjyt+3u/8WoPfF9jWpMnYr2Jn4ofbY+VSqUyIo/EZqOPH8TG9lipVCojsvHuQlkPHlYqlcqIrIvHjT6+F2vbY6VSqYzImth495ey9wPJMfdnjPuKMWWYJ7HOo8O6nivA9jEyXA+WGbApqEnZ+YC+FOuBbjHkvyxP9g92YMPzAt/fiYdNCENxL2SNQT4TKXc9czsf0Y/buCzQhvU9t6D33gLO2+1K8qN6gz/RN48EbKFWbJOwXRd0/ki/IBa+QxAHcjVfWEvKD/Q9ltsOxVqjj2/F3RiFFkzuzbDn2pDWaQ5xh0FXPB+Z8hoJl30NbAKK5TLEMygnrjfHKn/G9eC8uE/sk3OBtd65Q2zqwRD8Uw53xf0mhNsx3kls7s+Yu2ADtt3Py/2yHtQE6uX6rFNeG5gX9C7lkhpQTFhL0I5jgR6uwbzo7MH+rUcFlL/zeYfca0K4Jb6pVCqVEbklho0+psWsWBRnxUVxRXxd6c3NUvsx39fNcepVPYegx1wSq3FvzIsT9I9UHxAHxYw4Lk6L8+HkmvgquNEmn+O6ZF9zudveRrIVHbYmd83BR2Ixec5rXMP+deBe+Zz7gn55374uQBfzo7pwjlzT/vD5YDveP87z2XWxGu/7mXj/Z+I+2A//SPXITESA6Qh2Mi6dC+KyuBZcNzkgnZwn+cx9mU6Hb/Jh8w7fbOcx2LevQ0z0BT64flxrzk0UywH3188L+MEYsDc+N4J9O+X5e9x4P1fisjgZ7+/ReJ8nRr0TWKmcyfafciL5c3HpXO3gy5RJJ2WbawSbjjhs5zqchwG6YFdYK4ZrxXbks6AnAffAGDFf0gVbGwHoIeqsiPPxvs2JY+Iw/DcYxYSwq3wkpuJ2PBabXxBLcfFcEpeDK0nOu9Zcx+dmi/4S1/EYlCvrckyTDcopwTgB1DdH8hlgHMFxuX6eG+dvcs+ecg7ckx2cCxbFQrw3n4qp/DqyO4QwFkxGwT6J4s1HMT/Pi0ckF32+DeuZfsfcxsDWOtcd9uu65Ldo3wL2YvVJmfcMa7hPf8Z50PkAHZA77DmXL+IsL8XZnotzflQMgkYg9UJ5vwyC6bh8ZsVc61espWjeaoyGrTGraZNjG/ftMQp9rEIenboG2nPeUB+BsXj/gnKjfDy+jyDTs5U4d6fjojge53I6zumBOLdIvVD2PvujqYfE0Wj0iWAxDsEZsSwutFgRia+5rmTQNX2ydzgnh/0UsMJ7ckAXY4IfW4e5P48LIpiP8zIbZ+iIGPT56lEvlP8v+8RkcFBMxyGaEceDk+JUsCzOC2FyzkXBmukCYO85F/gnnWXY43KBb/J7KlHfkukWg+y3el/Pf71Q9hAT4kCLQ+JIi1kxE+NnYqHFolgSZ3eMjtaA1HObkF0XQFuIaZiu2yy26jPfqt+xVk0PR60n/x3rGawXSgV/IRsY8RXOya91u8hM5pE5BQNHXx1qn8eGfwCSQnWTJ3EExgAAAABJRU5ErkJggg==) no-repeat 50% 0;color:#fff;font-family:Helvetica,Arial,sans-serif;text-align:center;-webkit-border-radius:15px;border-radius:15px;-webkit-box-shadow:0 8px 19px rgba(0,0,0,.9);box-shadow:0 8px 19px rgba(0,0,0,.9);-webkit-text-shadow:0 -1px 0 rgba(0,0,0,.8);text-shadow:0 -1px 0 rgba(0,0,0,.8)}.TW3ToolbarButton{margin:0;padding:0;border:0;border-right:2px solid #FFF;font-family:"Helvetica Neue",Helvetica,sans-serif;font-size:12px;text-align:center;color:#FFF;background-color:rgba(255,255,255,.20);text-shadow:0 -1px -1px rgba(0,0,0,.30);-webkit-tap-highlight-color:transparent}.TW3ToolbarButton:active{background-color:rgba(0,0,0,.20)}.TW3ToolbarButton:disabled{background-color:transparent}.TW3Toolbar{cursor:default;background-image:-webkit-gradient(linear,left top,left bottom,from(#b2bbca),color-stop(.25,#a7b0c3),color-stop(.5,#909cb3),color-stop(.5,#8593ac),color-stop(.75,#7c8ba5),to(#73839f));border-top:1px solid #dde5ef;border-bottom:1px solid #2d3642;-webkit-box-shadow:rgba(33,33,33,.2) 0 1px 1px;box-shadow:rgba(33,33,33,.2) 0 1px 1px}.TW3Memo,.TW3EditBox,.TW3ComboBox{border:1px solid #acacac;border-radius:5px;resize:none;-webkit-user-select:text;user-select:text}.TW3HeaderControl{cursor:default;border-bottom:1px solid #2d3642;border-top:1px solid #cdd5df;box-shadow:0 1px 1px rgba(33,33,33,.2);background:rgb(178,187,202);background:-webkit-gradient(linear,left top,left bottom,color-stop(1%,rgba(178,187,202,1)),color-stop(25%,rgba(167,176,195,1)),color-stop(47%,rgba(144,156,179,1)),color-stop(50%,rgba(133,147,172,1)),color-stop(75%,rgba(124,139,165,1)),color-stop(100%,rgba(115,131,159,1)));background:-webkit-linear-gradient(top,rgba(178,187,202,1) 1%,rgba(167,176,195,1) 25%,rgba(144,156,179,1) 47%,rgba(133,147,172,1) 50%,rgba(124,139,165,1) 75%,rgba(115,131,159,1) 100%);background:linear-gradient(to top,rgba(178,187,202,1) 1%,rgba(167,176,195,1) 25%,rgba(144,156,179,1) 47%,rgba(133,147,172,1) 50%,rgba(124,139,165,1) 75%,rgba(115,131,159,1) 100%)}.TW3HeaderControl:disabled{cursor:wait;opacity:.5}.TW3CustomForm,.TW3Form{-webkit-transform:translateZ(0);transform:translateZ(0);-webkit-user-select:none;user-select:none;background-color:#D5DCE1;background-size:5px 100%;background-image:-webkit-gradient(linear,left top,right top,from(#c5ccd4),color-stop(.75,#c5ccd4),color-stop(.75,transparent),to(transparent));background-image:linear-gradient(to left,#c5ccd4 0%,#c5ccd4 75%,transparent 75%,transparent 100%)}.TW3Label,TW3LabelText{opacity:1.0;cursor:default;font-family:"Helvetica Neue",Helvetica,sans-serif}.TW3Label:disabled,TW3LabelText:disabled{text-shadow:0 1px 0 #fff;opacity:.5}.TW3Button{border:solid 2px rgba(32,32,33,.4);-webkit-border-radius:8px;border-radius:8px;background:rgb(226,226,226);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,rgba(226,226,226,1)),color-stop(50%,rgba(219,219,219,1)),color-stop(52%,rgba(209,209,209,1)),color-stop(100%,rgba(254,254,254,1)));background:-webkit-linear-gradient(top,rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 52%,rgba(254,254,254,1) 100%);background:linear-gradient(to top,rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 52%,rgba(254,254,254,1) 100%);font-family:"Helvetica Neue",Verdana,sans-serif;font-size:18px;font-weight:normal;text-shadow:1px 1px -1px #cecece;color:#000;-webkit-text-size-adjust:auto;-o-text-size-adjust:auto;-webkit-tap-highlight-color:transparent}.TW3Button:active:enabled{color:#FFF;background:rgb(207,231,250);background:-webkit-gradient(linear,left top,left bottom,color-stop(0%,rgba(207,231,250,1)),color-stop(52%,rgba(99,147,193,1)),color-stop(66%,rgba(78,136,191,1)),color-stop(96%,rgba(192,224,249,1)));background:-webkit-linear-gradient(top,rgba(207,231,250,1) 0%,rgba(99,147,193,1) 52%,rgba(78,136,191,1) 66%,rgba(192,224,249,1) 96%);background:linear-gradient(to top,rgba(207,231,250,1) 0%,rgba(99,147,193,1) 52%,rgba(78,136,191,1) 66%,rgba(192,224,249,1) 96%);text-shadow:none;-webkit-tap-highlight-color:transparent}.TW3Button:disabled{Opacity:.50}ul{cursor:default;list-style:none;margin:0;padding:0}ul li{-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;background-color:#FFF;border:1px solid #999;color:#222;cursor:hand;font-family:"Helvetica Neue",Helvetica,sans-serif;font-size:17px;font-weight:bold;margin-bottom:-1px;padding:12px 12px;text-decoration:none}ul li:first-child{border-top-left-radius:8px;border-top-right-radius:8px}ul li:last-child{border-bottom-left-radius:8px;border-bottom-right-radius:8px}ul li:active{color:#FFF;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAeCAIAAABi9+OQAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAEFJREFUeNpUjLENwDAMwwhN2fL/A/0vU9DBVofaQDKJAghqPlvrRRiRCPtnI7I4arGIwwsL6reb7XfHd8toDr4BAJzOJ7d0A6msAAAAAElFTkSuQmCC);background-size:auto 100%;background-repeat:repeat-x}.TW3ToggleSwitch{background-color:#FFF;border:1px solid #AAA;border-radius:6px;color:#FFF;font-weight:700;overflow:hidden;box-shadow:0 1px 0 #FFF;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}.TW3ToggleOnLabel{border-radius:6px;text-align:center;background:#007FEA;text-shadow:0 -1px 0 #093B5C;box-shadow:0 4px 5px -2px rgba(0,0,0,.3) inset}.TW3ToggleOffLabel{border-radius:6px;text-align:center;box-shadow:0 4px 5px -2px rgba(0,0,0,.3) inset}.TW3ToggleKnob{cursor:pointer;background-color:#FFF;border:1px solid #AAA;border-radius:4px;color:#FFF;font-weight:700;overflow:hidden;box-shadow:0 4px 0 -2px #F1F1F1 inset,0 2em 2em -2em #AAA inset,0 0 2px rgba(0,0,0,.5)}.TW3ToggleKnob:hover{background:#E5E5E5;</style>
	

	<script type="text/javascript">
	/* This prevents the window being moved by touches,
		to give the impression of a native app */
	document.ontouchmove = function(e) { e.preventDefault(); }

	/* Note: If you build with the CSS as an external file,
	the app may execute before the CSS has been properly loaded.
	You may want to use a different bootstrap mechanism. jQuery
	provides a good preloading mechanism for instance. */

	function bootstrap() { var $R = [
	"Invalid component registration"];
function Trunc(v) { return (v>=0)?Math.floor(v):Math.ceil(v) };
function Trim$_String_Integer_Integer_(s,a,b) { if (a<0) a=0; if (b<0) b=0; return s.substr(a,s.length-a-b) };
function Trim$_String_(s) { return s.replace(/^\s\s*/, "").replace(/\s\s*$/, "") };
var TObject={
	$ClassName: "TObject",
	$Parent: null,
	ClassName: function (s) { return s.$ClassName },
	ClassType: function (s) { return s },
	ClassParent: function (s) { return s.$Parent },
	$Init: function () {},
	Create: function (s) { return s },
	Destroy: function (s) { for (var prop in s) if (s.hasOwnProperty(prop)) delete s.prop },
	Destroy$: function(s) { return s.ClassType.Destroy(s) },
	Free: function (s) { if (s!==null) s.ClassType.Destroy(s) }
};
function StrReplace(s,o,n) { return o?s.replace(new RegExp(StrRegExp(o), "g"), n):s };
function StrRegExp(s) { return s.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&") };
function SameText(a,b) { return a.toUpperCase()==b.toUpperCase() };
/*

Copyright (C) 2010 by Johannes Baagï¿½e <baagoe@baagoe.org>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

From http://baagoe.com/en/RandomMusings/javascript/
*/
function $alea() {
  return (function(args) {
    // Johannes BaagÃ¸e <baagoe@baagoe.com>, 2010
    var s0 = 0;
    var s1 = 0;
    var s2 = 0;
    var c = 1;

    if (args.length == 0) {
      args = [+new Date];
    }
    var mash = function() {
       var n = 0xefc8249d;
    
       var mash = function(data) {
         data = data.toString();
         for (var i = 0; i < data.length; i++) {
           n += data.charCodeAt(i);
           var h = 0.02519603282416938 * n;
           n = h >>> 0;
           h -= n;
           h *= n;
           n = h >>> 0;
           h -= n;
           n += h * 0x100000000; // 2^32
         }
         return (n >>> 0) * 2.3283064365386963e-10; // 2^-32
       };
    
       //mash.version = 'Mash 0.9';
       return mash;
    }();
    s0 = mash(' ');
    s1 = mash(' ');
    s2 = mash(' ');

    for (var i = 0; i < args.length; i++) {
      s0 -= mash(args[i]);
      if (s0 < 0) {
        s0 += 1;
      }
      s1 -= mash(args[i]);
      if (s1 < 0) {
        s1 += 1;
      }
      s2 -= mash(args[i]);
      if (s2 < 0) {
        s2 += 1;
      }
    }
    mash = null;

    var random = function() {
      var t = 2091639 * s0 + c * 2.3283064365386963e-10; // 2^-32
      s0 = s1;
      s1 = s2;
      return s2 = t - (c = t | 0);
    };
    /*random.uint32 = function() {
      return random() * 0x100000000; // 2^32
    };
    random.fract53 = function() {
      return random() +
        (random() * 0x200000 | 0) * 1.1102230246251565e-16; // 2^-53
    };*/
    //random.version = 'Alea 0.9';
    random.args = args;
    return random;

  } (Array.prototype.slice.call(arguments)));
};var Random = $alea();
function IntToHex2(v) { var r=v.toString(16); return (r.length==1)?"0"+r:r };
function IntToHex(v,d) { var r=v.toString(16); return "00000000".substr(0, d-r.length)+r };
function Frac(v) { return v-((v>0)?Math.floor(v):Math.ceil(v)) };
/**
sprintf() for JavaScript 0.7-beta1
http://www.diveintojavascript.com/projects/javascript-sprintf

Copyright (c) Alexandru Marasteanu <alexaholic [at) gmail (dot] com>
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:
    * Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.
    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.
    * Neither the name of sprintf() for JavaScript nor the
      names of its contributors may be used to endorse or promote products
      derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL Alexandru Marasteanu BE LIABLE FOR ANY
DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
**/

var sprintf = (function() {
	function get_type(variable) {
		return Object.prototype.toString.call(variable).slice(8, -1).toLowerCase();
	}
	function str_repeat(input, multiplier) {
		for (var output = []; multiplier > 0; output[--multiplier] = input) {/* do nothing */}
		return output.join('');
	}

	var str_format = function() {
		if (!str_format.cache.hasOwnProperty(arguments[0])) {
			str_format.cache[arguments[0]] = str_format.parse(arguments[0]);
		}
		return str_format.format.call(null, str_format.cache[arguments[0]], arguments);
	};

	str_format.format = function(parse_tree, argv) {
		var cursor = 1, tree_length = parse_tree.length, node_type = '', arg, output = [], i, k, match, pad, pad_character, pad_length;
		for (i = 0; i < tree_length; i++) {
			node_type = get_type(parse_tree[i]);
			if (node_type === 'string') {
				output.push(parse_tree[i]);
			}
			else if (node_type === 'array') {
				match = parse_tree[i]; // convenience purposes only
				if (match[2]) { // keyword argument
					arg = argv[cursor];
					for (k = 0; k < match[2].length; k++) {
						if (!arg.hasOwnProperty(match[2][k])) {
							throw(sprintf('[sprintf] property "%s" does not exist', match[2][k]));
						}
						arg = arg[match[2][k]];
					}
				}
				else if (match[1]) { // positional argument (explicit)
					arg = argv[match[1]];
				}
				else { // positional argument (implicit)
					arg = argv[cursor++];
				}

				if (/[^s]/.test(match[8]) && (get_type(arg) != 'number')) {
					throw(sprintf('[sprintf] expecting number but found %s', get_type(arg)));
				}
				switch (match[8]) {
					case 'b': arg = arg.toString(2); break;
					case 'c': arg = String.fromCharCode(arg); break;
					case 'd': arg = String(parseInt(arg, 10)); if (match[7]) { arg = str_repeat('0', match[7]-arg.length)+arg } break;
					case 'e': arg = match[7] ? arg.toExponential(match[7]) : arg.toExponential(); break;
					case 'f': arg = match[7] ? parseFloat(arg).toFixed(match[7]) : parseFloat(arg); break;
					case 'o': arg = arg.toString(8); break;
					case 's': arg = ((arg = String(arg)) && match[7] ? arg.substring(0, match[7]) : arg); break;
					case 'u': arg = Math.abs(arg); break;
					case 'x': arg = arg.toString(16); break;
					case 'X': arg = arg.toString(16).toUpperCase(); break;
				}
				arg = (/[def]/.test(match[8]) && match[3] && arg >= 0 ? '+'+ arg : arg);
				pad_character = match[4] ? match[4] == '0' ? '0' : match[4].charAt(1) : ' ';
				pad_length = match[6] - String(arg).length;
				pad = match[6] ? str_repeat(pad_character, pad_length) : '';
				output.push(match[5] ? arg + pad : pad + arg);
			}
		}
		return output.join('');
	};

	str_format.cache = {};

	str_format.parse = function(fmt) {
		var _fmt = fmt, match = [], parse_tree = [], arg_names = 0;
		while (_fmt) {
			if ((match = /^[^\x25]+/.exec(_fmt)) !== null) {
				parse_tree.push(match[0]);
			}
			else if ((match = /^\x25{2}/.exec(_fmt)) !== null) {
				parse_tree.push('%');
			}
			else if ((match = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(_fmt)) !== null) {
				if (match[2]) {
					arg_names |= 1;
					var field_list = [], replacement_field = match[2], field_match = [];
					if ((field_match = /^([a-z_][a-z_\d]*)/i.exec(replacement_field)) !== null) {
						field_list.push(field_match[1]);
						while ((replacement_field = replacement_field.substring(field_match[0].length)) !== '') {
							if ((field_match = /^\.([a-z_][a-z_\d]*)/i.exec(replacement_field)) !== null) {
								field_list.push(field_match[1]);
							}
							else if ((field_match = /^\[(\d+)\]/.exec(replacement_field)) !== null) {
								field_list.push(field_match[1]);
							}
							else {
								throw('[sprintf] huh?');
							}
						}
					}
					else {
						throw('[sprintf] huh?');
					}
					match[2] = field_list;
				}
				else {
					arg_names |= 2;
				}
				if (arg_names === 3) {
					throw('[sprintf] mixing positional and named placeholders is not (yet) supported');
				}
				parse_tree.push(match);
			}
			else {
				throw('[sprintf] huh?');
			}
			_fmt = _fmt.substring(match[0].length);
		}
		return parse_tree;
	};

	return str_format;
})();
function Format(f,a) { a.unshift(f); return sprintf.apply(null,a) };
;
;
function FloatToStr$_Float_(i) { return i.toString() }
function FloatToStr$_Float_Integer_(i,p) { return (p==99)?i.toString():i.toFixed(p) };
var Exception={
	$ClassName: "Exception",
	$Parent: TObject,
	$Init: function () { FMessage="" },
	Create: function (s,Msg) { s.FMessage=Msg; return s }
};
var EAssertionFailed={
	$ClassName: "EAssertionFailed",
	$Parent: Exception,
	$Init: Exception.$Init
};
function Delete(s,i,n) { var v=s.v; if ((i<=0)||(i>v.length)||(n<=0)) return; s.v=v.substr(0,i-1)+v.substr(i+n-1); };
function DegToRad(v) { return v*(Math.PI/180) };
function Cotan(v) { return 1/Math.tan(v) };
function ClampInt(v,mi,ma) { return v<mi ? mi : v>ma ? ma : v };
function $W(e) { return e.ClassType?e:Exception.Create($New(Exception),e.constructor.name+", "+e.message) };
function $Sign(v) { return v<0?-1:v>0?1:0 };
function $SIdx(s,i,z) {
	if (i<1) throw Exception.Create($New(Exception),"Lower bound exceeded! Index "+i.toString()+z);
	if (i>s.length) throw Exception.Create($New(Exception),"Upper bound exceeded! Index "+i.toString()+z);
	return s.charAt(i-1);
};
function $SCodeIdx(s,i,z) {
	if (i<1) throw Exception.Create($New(Exception),"Lower bound exceeded! Index "+i.toString()+z);
	if (i>s.length) throw Exception.Create($New(Exception),"Upper bound exceeded! Index "+i.toString()+z);
	return s.charCodeAt(i-1);
};
function $Pop(a,z) {
	if (a.length>0) return a.pop();
	throw Exception.Create($New(Exception),"Upper bound exceeded! Index 0"+z);
};
function $Peek(a,z) {
	var n=a.length;
	if (n>0) return a[n-1];
	throw Exception.Create($New(Exception),"Upper bound exceeded! Index 0"+z);
};
function $NewDyn(c,z) {
	if (c==null) throw Exception.Create($New(Exception),"ClassType is nil"+z);
	var i={ClassType:c};
	c.$Init(i);
	return i
};
function $New(c) { var i={ClassType:c}; c.$Init(i); return i };
function $Is(o,c) {
	if (o===null) return false;
	return $Inh(o.ClassType,c);
}
;
function $Inh(s,c) {
	if (s===null) return false;
	while ((s)&&(s!==c)) s=s.$Parent;
	return (s)?true:false;
}
;
function $Idx(i,l,h,z) {
	if (i<l) throw Exception.Create($New(Exception),"Lower bound exceeded! Index "+i.toString()+z);
	if (i>h) throw Exception.Create($New(Exception),"Upper bound exceeded! Index "+i.toString()+z);
	return i-l;
};
function $Event3(i,f) {
	var li=i,lf=f;
	return function(a,b,c) {
		return lf.call(li,li,a,b,c)
	}
};
function $Event2(i,f) {
	var li=i,lf=f;
	return function(a,b) {
		return lf.call(li,li,a,b)
	}
};
function $Event1(i,f) {
	var li=i,lf=f;
	return function(a) {
		return lf.call(li,li,a)
	}
};
function $Event0(i,f) {
	var li=i,lf=f;
	return function() {
		return lf.call(li,li)
	}
};
function $Div(a,b) { var r=a/b; return (r>=0)?Math.floor(r):Math.ceil(r) };
function $DIdxW(a,i,v,z) {
	if (i<0) throw Exception.Create($New(Exception),"Lower bound exceeded! Index "+i.toString()+z);
	if (i>a.length) throw Exception.Create($New(Exception),"Upper bound exceeded! Index "+i.toString()+z);
	a[i]=v;
};
function $DIdxR(a,i,z) {
	if (i<0) throw Exception.Create($New(Exception),"Lower bound exceeded! Index "+i.toString()+z);
	if (i>a.length) throw Exception.Create($New(Exception),"Upper bound exceeded! Index "+i.toString()+z);
	return a[i];
};
function $CmpNum(a,b) { return a-b };
function $CheckIntf(i,z) { if (i) return i; throw Exception.Create($New(Exception),"Interface is nil"+z); };
function $CheckFunc(i,z) { if (i) return i; throw Exception.Create($New(Exception),"Function pointer is nil"+z); };
function $Check(i,z) { if (i) return i; throw Exception.Create($New(Exception),"Object not instantiated"+z); };
function $Assert(b,m,z) { if (!b) throw Exception.Create($New(EAssertionFailed),"Assertion failed"+z+((m=="")?"":" : ")+m); };
function $AsIntf(o,i) {
	if (o===null) return null;
	var r = o.ClassType.$Intf[i].map(function (e) {
		return function () {
			var arg=Array.prototype.slice.call(arguments);
			arg.splice(0,0,o);
			return e.apply(o, arg);
		}
	});
	r.O = o;
	return r;
}
;
function $As(o,c) {
	if ((o===null)||$Is(o,c)) return o;
	throw Exception.Create($New(Exception),"Cannot cast instance of type \""+o.ClassType.$ClassName+"\" to class \""+c.$ClassName+"\"");
};
function $ArraySwapChk(a,i1,i2,z) {
	var n=a.length-1, t=a[$Idx(i1,0,n,z)];
	a[i1]=a[$Idx(i2,0,n,z)]
	a[i2]=t;
};
function $ArraySetLenC(a,n,d) {
	var o=a.length;
	if (o==n) return;
	if (o>n) a.length=n; else for (;o<n;o++) a.push(d());
};
function $ArraySetLen(a,n,v) {
	var o=a.length;
	if (o==n) return;
	if (o>n) a.length=n; else for (;o<n;o++) a.push(v);
};
function $ArrayInsert(a,i,v,z) {
	if (i==a.length) a.push(v); else a.splice($Idx(i,0,a.length-1,z),0,v)
};
/// TG2Resource = class (TObject)
var TG2Resource = {
   $ClassName:"TG2Resource",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $._Parent = null;
      $.Resources = {_ItemCount$5:0,_Items$5:[]};
   }
   /// procedure TG2Resource.SetParent(const Value: TG2Resource)
   ,SetParent:function(Self, Value) {
      if (Value===$Check(Self,"")._Parent) {
         return;
      }
      if ($Check(Self,"")._Parent!==null) {
         TG2QuickList$Remove$8($Check($Check(Self,"")._Parent,"").Resources,Self);
      }
      $Check(Self,"")._Parent = Value;
      if ($Check(Self,"")._Parent!==null) {
         TG2QuickList$Add$11($Check($Check(Self,"")._Parent,"").Resources,Self);
      }
   }
   /// constructor TG2Resource.Create()
   ,Create$48:function(Self) {
      TObject.Create(Self);
      $Check(Self,"")._Parent = null;
      return Self
   }
   /// destructor TG2Resource.Destroy()
   ,Destroy:function(Self) {
      while ($Check(Self,"").Resources._ItemCount$5>0) {
         TObject.Free(TG2QuickList$Pop$5($Check(Self,"").Resources))      }
      TG2Resource.SetParent(Self,null);
      TObject.Destroy(Self);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2VertexBuffer = class (TG2Resource)
var TG2VertexBuffer = {
   $ClassName:"TG2VertexBuffer",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._BoundAttribs = {_ItemCount$4:0,_Items$4:[]};
      $._Data = $._DataBuffer = $._gl = $._VB = null;
      $._Decl = [];
      $._Locked = false;
      $._LockMode = 0;
      $._Position = $._VertexCount = $._VertexSize = 0;
      $._TexCoordIndex = function () {
         for (var r=[],i=0; i<32; i++) r.push(0);
         return r
      }();
   }
   /// procedure TG2VertexBuffer.Bind()
   ,Bind:function(Self) {
      var i$9 = 0;
      var VBPos = 0;
      var IndPosition = 0;
      var IndColor = 0;
      var IndTexCoord = 0;
      var IndNormal = 0;
      var IndBinormal = 0;
      var IndTangent = 0;
      var IndBlendWeight = 0;
      var IndBlendIndex = 0;
      var ai = 0;
      $Check(Self,"")._gl.bindBuffer(34962,$Check(Self,"")._VB);
      VBPos = 0;
      IndPosition = 0;
      IndColor = 0;
      IndTexCoord = 0;
      IndNormal = 0;
      IndBinormal = 0;
      IndTangent = 0;
      IndBlendWeight = 0;
      IndBlendIndex = 0;
      var $temp1;
      for(i$9 = 0,$temp1 = $Check(Self,"")._Decl.length;i$9<$temp1;i$9++) {
         switch ($DIdxR($Check(Self,"")._Decl,i$9,"").Element) {
            case 1 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_Position"+IndPosition.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndPosition;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 2 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_Color"+IndColor.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndPosition;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 6 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_TexCoord"+IndTexCoord.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndTexCoord;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 3 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_Normal"+IndNormal.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndNormal;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 5 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_Binormal"+IndBinormal.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndBinormal;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 4 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_Tangent"+IndTangent.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndTangent;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 7 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_BlendWeight"+IndBlendWeight.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndBlendWeight;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            case 8 :
               ai = TG2ShaderProgram.GetShaderAttribute($Check($Check(g2,"")._Gfx,"")._Shader$4,("a_BlendIndex"+IndBlendIndex.toString()));
               if (ai>(-1)) {
                  TG2QuickListInt$Add$10($Check(Self,"")._BoundAttribs,ai);
                  $Check(Self,"")._gl.enableVertexAttribArray(ai);
                  $Check(Self,"")._gl.vertexAttribPointer(ai,$DIdxR($Check(Self,"")._Decl,i$9,"").Count$4,5126,false,$Check(Self,"")._VertexSize,VBPos);
               }
               ++IndBlendIndex;
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
               break;
            default :
               (VBPos+= ($DIdxR($Check(Self,"")._Decl,i$9,"").Count$4*4));
         }
      }
   }
   /// constructor TG2VertexBuffer.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._gl = $Check($Check(g2,"")._Gfx,"").gl$1;
      $Check(Self,"")._VB = $Check(Self,"")._gl.createBuffer();
      return Self
   }
   /// destructor TG2VertexBuffer.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"")._gl.deleteBuffer($Check(Self,"")._VB);
      TG2Resource.Destroy(Self);
   }
   /// function TG2VertexBuffer.GetTexCoordIndex(const Index: Integer) : Integer
   ,GetTexCoordIndex:function(Self, Index) {
      return $Check(Self,"")._TexCoordIndex[$Idx(Index,0,31,"")];
   }
   /// procedure TG2VertexBuffer.Initialize(const Decl: TG2VBDecl; const Count: Integer)
   ,Initialize$1:function(Self, Decl$1, Count$11) {
      var i$10 = 0;
      var ti = 0;
      $Check(Self,"")._Decl = Decl$1;
      $Check(Self,"")._VertexCount = Count$11;
      $Check(Self,"")._VertexSize = 0;
      ti = 0;
      var $temp2;
      for(i$10 = 0,$temp2 = $Check(Self,"")._Decl.length;i$10<$temp2;i$10++) {
         if ($DIdxR($Check(Self,"")._Decl,i$10,"").Element) {
            if ($DIdxR($Check(Self,"")._Decl,i$10,"").Element==6) {
               $Check(Self,"")._TexCoordIndex[$Idx(ti,0,31,"")] = $Check(Self,"")._VertexSize;
               ++ti;
            }
            $Check(Self,"")._VertexSize+=$DIdxR($Check(Self,"")._Decl,i$10,"").Count$4*4;
         }
      }
      for(i$10 = ti;i$10<=31;i$10++) {
         $Check(Self,"")._TexCoordIndex[$Idx(i$10,0,31,"")] = 0;
      }
      $Check(Self,"")._gl.bindBuffer(34962,$Check(Self,"")._VB);
      $Check(Self,"")._gl.bufferData(34962,$Check(Self,"")._VertexCount*$Check(Self,"")._VertexSize,35044);
       Self._DataBuffer = new ArrayBuffer(Self._VertexCount * Self._VertexSize);  Self._Data = new DataView(Self._DataBuffer); $Check(Self,"")._Locked = false;
   }
   /// procedure TG2VertexBuffer.Lock(LockMode: TG2BufferLockMode = 2)
   ,Lock:function(Self, LockMode) {
      if ($Check(Self,"")._Locked) {
         TG2VertexBuffer.UnLock(Self);
      }
      $Check(Self,"")._LockMode = LockMode;
      $Check(Self,"")._Locked = true;
      $Check(Self,"")._Position = 0;
   }
   /// procedure TG2VertexBuffer.Unbind()
   ,Unbind:function(Self) {
      var i$11 = 0;
      var $temp3;
      for(i$11 = 0,$temp3 = $Check(Self,"")._BoundAttribs._ItemCount$4;i$11<$temp3;i$11++) {
         $Check(Self,"")._gl.disableVertexAttribArray(TG2QuickListInt$GetItem$10($Check(Self,"")._BoundAttribs,i$11));
      }
      TG2QuickListInt$Clear$9($Check(Self,"")._BoundAttribs);
   }
   /// procedure TG2VertexBuffer.UnLock()
   ,UnLock:function(Self) {
      if (!$Check(Self,"")._Locked) {
         return;
      }
      switch ($Check(Self,"")._LockMode) {
         case 2 :
            TG2VertexBuffer.WriteBufferData(Self);
            break;
      }
      $Check(Self,"")._Locked = false;
   }
   /// procedure TG2VertexBuffer.WriteBufferData()
   ,WriteBufferData:function(Self) {
      $Check(Self,"")._gl.bindBuffer(34962,$Check(Self,"")._VB);
      $Check(Self,"")._gl.bufferSubData(34962,0,$Check(Self,"")._DataBuffer);
      $Check(Self,"")._gl.bindBuffer(34962,null);
   }
   /// procedure TG2VertexBuffer.WriteFloat32(const f: TG2Float)
   ,WriteFloat32:function(Self, f) {
      $Check(Self,"")._Data.setFloat32($Check(Self,"")._Position,f,true);
      $Check(Self,"")._Position+=4;
   }
   /// procedure TG2VertexBuffer.WriteVec2(const v: TG2Vec2)
   ,WriteVec2:function(Self, v$3) {
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec2$GetX$2(v$3));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec2$GetY$2(v$3));
   }
   /// procedure TG2VertexBuffer.WriteVec3(const v: TG2Vec3)
   ,WriteVec3:function(Self, v$4) {
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec3$GetX$1(v$4));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec3$GetY$1(v$4));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec3$GetZ$1(v$4));
   }
   /// procedure TG2VertexBuffer.WriteVec4(const v: TG2Vec4)
   ,WriteVec4:function(Self, v$5) {
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec4$GetX(v$5));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec4$GetY(v$5));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec4$GetZ(v$5));
      TG2VertexBuffer.WriteFloat32(Self,TG2Vec4$GetW(v$5));
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2VBVertex = record
function Copy$TG2VBVertex(s,d) {
   d.Element=s.Element;
   d.Count$4=s.Count$4;
   return d;
}
function Clone$TG2VBVertex($) {
   return {
      Element:$.Element,
      Count$4:$.Count$4
   }
}
/// TG2VBElement enumeration
var TG2VBElement = [ "vbNone", "vbPosition", "vbDiffuse", "vbNormal", "vbTangent", "vbBinormal", "vbTexCoord", "vbVertexWeight", "vbVertexIndex" ];
/// TG2TextureUsage enumeration
var TG2TextureUsage = [ "tuDefault", "tuUsage2D", "tuUsage3D" ];
/// TG2ResourceAsync = class (TG2Resource)
var TG2ResourceAsync = {
   $ClassName:"TG2ResourceAsync",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._State = 0;
   }
   /// constructor TG2ResourceAsync.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      $Check(Self,"")._State = 0;
      return Self
   }
   ,Destroy:TG2Resource.Destroy
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2TextureBase = class (TG2ResourceAsync)
var TG2TextureBase = {
   $ClassName:"TG2TextureBase",
   $Parent:TG2ResourceAsync
   ,$Init:function ($) {
      TG2ResourceAsync.$Init($);
      $._gl$1 = $._Texture = null;
      $._Usage = 0;
   }
   /// constructor TG2TextureBase.Create()
   ,Create$48:function(Self) {
      TG2ResourceAsync.Create$48(Self);
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._gl$1 = $Check($Check(g2,"")._Gfx,"").gl$1;
      $Check(Self,"")._Texture = $Check(Self,"")._gl$1.createTexture();
      return Self
   }
   /// destructor TG2TextureBase.Destroy()
   ,Destroy:function(Self) {
      TG2TextureBase.Release$1$($Check(Self,""));
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2TextureBase.Release()
   ,Release$1:function(Self) {
      if ($Check(Self,"")._Texture!==null) {
         $Check(Self,"")._gl$1.deleteTexture($Check(Self,"")._Texture);
         $Check(Self,"")._Texture = null;
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,Release$1$:function($){return $.ClassType.Release$1($)}
};
/// TG2TextureCubeBase = class (TG2TextureBase)
var TG2TextureCubeBase = {
   $ClassName:"TG2TextureCubeBase",
   $Parent:TG2TextureBase
   ,$Init:function ($) {
      TG2TextureBase.$Init($);
      $._Size = 0;
   }
   /// procedure TG2TextureCubeBase.Bind(const Stage: Integer)
   ,Bind$1:function(Self, Stage) {
      $Check(Self,"")._gl$1.activeTexture(33984+Stage);
      $Check(Self,"")._gl$1.bindTexture(34067,$Check(Self,"")._Texture);
   }
   ,Destroy:TG2TextureBase.Destroy
   ,Create$48:TG2TextureBase.Create$48
   ,Release$1:TG2TextureBase.Release$1
};
/// TG2TextureCube = class (TG2TextureCubeBase)
var TG2TextureCube = {
   $ClassName:"TG2TextureCube",
   $Parent:TG2TextureCubeBase
   ,$Init:function ($) {
      TG2TextureCubeBase.$Init($);
      $._Image = [undefined,undefined,undefined,undefined,undefined,undefined];
      $._ImagesLoaded = 0;
      $._OnLoadProc = null;
   }
   /// constructor TG2TextureCube.Create()
   ,Create$48:function(Self) {
      TG2TextureBase.Create$48(Self);
      $Check(Self,"")._OnLoadProc = null;
      return Self
   }
   /// procedure TG2TextureCube.Load(const FileNamePosX: String; const FileNameNegX: String; const FileNamePosY: String; const FileNameNegY: String; const FileNamePosZ: String; const FileNameNegZ: String; TextureUsage: TG2TextureUsage = 0)
   ,Load:function(Self, FileNamePosX, FileNameNegX, FileNamePosY, FileNameNegY, FileNamePosZ, FileNameNegZ, TextureUsage) {
      var i$12 = 0;
      var t$1 = 0;
      $Check(Self,"")._Usage = $Check(Self,"")._Usage;
      $Check(Self,"")._State = 1;
      $Check(Self,"")._ImagesLoaded = 0;
      for(i$12 = 0;i$12<=5;i$12++) {
         
      Self._Image[i$12] = new Image();
    $Check(Self,"")._Image[$Idx(i$12,0,5,"")].onload = $Event0(Self,TG2TextureCube.OnLoad);
         $Check(Self,"")._Image[$Idx(i$12,0,5,"")].onerror = $Event0(Self,TG2TextureCube.OnError);
      }
      if (PreventCaching) {
         t$1 = G2Time();
         $Check(Self,"")._Image[0].src = (FileNamePosX+"?c="+t$1.toString());
         $Check(Self,"")._Image[1].src = (FileNameNegX+"?c="+t$1.toString());
         $Check(Self,"")._Image[2].src = (FileNamePosY+"?c="+t$1.toString());
         $Check(Self,"")._Image[3].src = (FileNameNegY+"?c="+t$1.toString());
         $Check(Self,"")._Image[4].src = (FileNamePosZ+"?c="+t$1.toString());
         $Check(Self,"")._Image[5].src = (FileNameNegZ+"?c="+t$1.toString());
      } else {
         $Check(Self,"")._Image[0].src = FileNamePosX;
         $Check(Self,"")._Image[1].src = FileNameNegX;
         $Check(Self,"")._Image[2].src = FileNamePosY;
         $Check(Self,"")._Image[3].src = FileNameNegY;
         $Check(Self,"")._Image[4].src = FileNamePosZ;
         $Check(Self,"")._Image[5].src = FileNameNegZ;
      }
      $Check(g2,"")._LoadingItems+=1;
   }
   /// procedure TG2TextureCube.OnError()
   ,OnError:function(Self) {
      $Check(Self,"")._State = 3;
      $Check(g2,"")._LoadingItems-=1;
   }
   /// procedure TG2TextureCube.OnLoad()
   ,OnLoad:function(Self) {
      var i$13 = 0;
      var glvar = undefined;
      ++$Check(Self,"")._ImagesLoaded;
      if ($Check(Self,"")._State==1) {
         if ($Check(Self,"")._ImagesLoaded>=6) {
             glvar = Self._gl$1; $Check(Self,"")._gl$1.bindTexture(34067,$Check(Self,"")._Texture);
            $Check(Self,"")._gl$1.texParameteri(34067,10242,33071);
            $Check(Self,"")._gl$1.texParameteri(34067,10243,33071);
            $Check(Self,"")._gl$1.texParameteri(34067,10241,9987);
            $Check(Self,"")._gl$1.texParameteri(34067,10240,9729);
            $Check(Self,"")._gl$1.pixelStorei(37440,0);
            for(i$13 = 0;i$13<=5;i$13++) {
               glvar.texImage2D(G2TextureCubeFaceGL[$Idx(i$13,0,5,"")],0,6408,6408,5121,$Check(Self,"")._Image[$Idx(i$13,0,5,"")]);
            }
            $Check(Self,"")._gl$1.generateMipmap(34067);
            $Check(Self,"")._gl$1.bindTexture(34067,null);
            $Check(Self,"")._Size = Number($Check(Self,"")._Image[0].width);
            $Check(Self,"")._State = 2;
            $Check(g2,"")._LoadingItems-=1;
            if ($Check(Self,"")._OnLoadProc) {
               $CheckFunc($Check(Self,"")._OnLoadProc,"")();
            }
         }
      }
   }
   ,Destroy:TG2TextureBase.Destroy
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,Release$1:TG2TextureBase.Release$1
};
/// TG2Texture2DBase = class (TG2TextureBase)
var TG2Texture2DBase = {
   $ClassName:"TG2Texture2DBase",
   $Parent:TG2TextureBase
   ,$Init:function ($) {
      TG2TextureBase.$Init($);
      $._Height = $._RealHeight = $._RealWidth = $._Width = 0;
      $._SizeTU = 0;
      $._SizeTV = 0;
   }
   /// procedure TG2Texture2DBase.Bind(const Stage: Integer)
   ,Bind$2:function(Self, Stage$1) {
      $Check(Self,"")._gl$1.activeTexture(33984+Stage$1);
      $Check(Self,"")._gl$1.bindTexture(3553,$Check(Self,"")._Texture);
   }
   /// function TG2Texture2DBase.GetProjection() : TG2Mat
   ,GetProjection:function(Self) {
      var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var OffsetX$2 = 0;
      var OffsetY$2 = 0;
      OffsetX$2 = 0.5+(0.5/$Check(Self,"")._RealWidth);
      OffsetY$2 = 0.5+(0.5/$Check(Self,"")._RealHeight);
      Result = G2MatIdentity();
      TG2Mat$SetE00(Result,0.5);
      TG2Mat$SetE11(Result,(-0.5));
      TG2Mat$SetE22(Result,1);
      TG2Mat$SetE30(Result,OffsetX$2);
      TG2Mat$SetE31(Result,OffsetY$2);
      TG2Mat$SetE33(Result,1);
      return Result
   }
   ,Destroy:TG2TextureBase.Destroy
   ,Create$48:TG2TextureBase.Create$48
   ,Release$1:TG2TextureBase.Release$1
};
/// TG2Texture2DRT = class (TG2Texture2DBase)
var TG2Texture2DRT = {
   $ClassName:"TG2Texture2DRT",
   $Parent:TG2Texture2DBase
   ,$Init:function ($) {
      TG2Texture2DBase.$Init($);
      $._FrameBuffer = $._RenderBuffer = null;
   }
   /// constructor TG2Texture2DRT.Create()
   ,Create$48:function(Self) {
      TG2TextureBase.Create$48(Self);
      $Check(Self,"")._FrameBuffer = $Check(Self,"")._gl$1.createFramebuffer();
      $Check(Self,"")._RenderBuffer = $Check(Self,"")._gl$1.createRenderbuffer();
      return Self
   }
   /// function TG2Texture2DRT.Make(const NewWidth: Integer; const NewHeight: Integer) : Boolean
   ,Make:function(Self, NewWidth, NewHeight) {
      var Result = false;
      Result = false;
      $Check(Self,"")._Width = NewWidth;
      $Check(Self,"")._Height = NewHeight;
      $Check(Self,"")._RealWidth = 1;
      while ($Check(Self,"")._RealWidth<$Check(Self,"")._Width) {
         $Check(Self,"")._RealWidth = $Check(Self,"")._RealWidth<<1;
      }
      $Check(Self,"")._RealHeight = 1;
      while ($Check(Self,"")._RealHeight<$Check(Self,"")._Height) {
         $Check(Self,"")._RealHeight = $Check(Self,"")._RealHeight<<1;
      }
      $Check(Self,"")._SizeTU = $Check(Self,"")._Width/$Check(Self,"")._RealWidth;
      $Check(Self,"")._SizeTV = $Check(Self,"")._Height/$Check(Self,"")._RealHeight;
      $Check(Self,"")._gl$1.bindTexture(3553,$Check(Self,"")._Texture);
      $Check(Self,"")._gl$1.texImage2D(3553,0,6408,$Check(Self,"")._RealWidth,$Check(Self,"")._RealHeight,0,6408,5121,null);
      $Check(Self,"")._gl$1.texParameteri(3553,10240,9729);
      $Check(Self,"")._gl$1.texParameteri(3553,10241,9729);
      $Check(Self,"")._gl$1.texParameteri(3553,10242,33071);
      $Check(Self,"")._gl$1.texParameteri(3553,10243,33071);
      $Check(Self,"")._gl$1.bindFramebuffer(36160,$Check(Self,"")._FrameBuffer);
      $Check(Self,"")._gl$1.bindRenderbuffer(36161,$Check(Self,"")._RenderBuffer);
      $Check(Self,"")._gl$1.renderbufferStorage(36161,33189,$Check(Self,"")._RealWidth,$Check(Self,"")._RealHeight);
      $Check(Self,"")._gl$1.framebufferRenderbuffer(36160,36096,36161,$Check(Self,"")._RenderBuffer);
      $Check(Self,"")._gl$1.framebufferTexture2D(36160,36064,3553,null,0);
      $Check(Self,"")._gl$1.bindFramebuffer(36160,null);
      Result = true;
      return Result
   }
   /// procedure TG2Texture2DRT.Release()
   ,Release$1:function(Self) {
      TG2TextureBase.Release$1(Self);
      $Check(Self,"")._gl$1.deleteRenderbuffer($Check(Self,"")._RenderBuffer);
      $Check(Self,"")._gl$1.deleteFramebuffer($Check(Self,"")._FrameBuffer);
   }
   ,Destroy:TG2TextureBase.Destroy
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,Release$1$:function($){return $.ClassType.Release$1($)}
};
/// TG2Texture2D = class (TG2Texture2DBase)
var TG2Texture2D = {
   $ClassName:"TG2Texture2D",
   $Parent:TG2Texture2DBase
   ,$Init:function ($) {
      TG2Texture2DBase.$Init($);
      $._Image$1 = undefined;
      $._OnLoadProc$1 = null;
   }
   /// constructor TG2Texture2D.Create()
   ,Create$48:function(Self) {
      TG2TextureBase.Create$48(Self);
      $Check(Self,"")._OnLoadProc$1 = null;
      return Self
   }
   /// procedure TG2Texture2D.Load(const FileName: String; TextureUsage: TG2TextureUsage = 0)
   ,Load$1:function(Self, FileName, TextureUsage$1) {
      var fname = "";
      $Check(Self,"")._Usage = $Check(Self,"")._Usage;
      
    Self._Image$1 = new Image();
  $Check(Self,"")._Image$1.onload = $Event0(Self,TG2Texture2D.OnLoad$1);
      $Check(Self,"")._Image$1.onerror = $Event0(Self,TG2Texture2D.OnError$1);
      fname = FileName;
      if (PreventCaching) {
         fname = fname+"?c="+G2Time().toString();
      }
      $Check(Self,"")._Image$1.src = FileName;
      $Check(Self,"")._State = 1;
      $Check(g2,"")._LoadingItems+=1;
   }
   /// procedure TG2Texture2D.OnError()
   ,OnError$1:function(Self) {
      $Check(Self,"")._State = 3;
      $Check(g2,"")._LoadingItems-=1;
   }
   /// procedure TG2Texture2D.OnLoad()
   ,OnLoad$1:function(Self) {
      $Check(Self,"")._gl$1.bindTexture(3553,$Check(Self,"")._Texture);
      
    (Self._gl$1).pixelStorei((Self._gl$1).UNPACK_FLIP_Y_WEBGL, false);
	  (Self._gl$1).texImage2D((Self._gl$1).TEXTURE_2D, 0, (Self._gl$1).RGBA, (Self._gl$1).RGBA, (Self._gl$1).UNSIGNED_BYTE, Self._Image$1);
    (Self._gl$1).texParameteri((Self._gl$1).TEXTURE_2D, (Self._gl$1).TEXTURE_WRAP_S, (Self._gl$1).REPEAT);
    (Self._gl$1).texParameteri((Self._gl$1).TEXTURE_2D, (Self._gl$1).TEXTURE_WRAP_T, (Self._gl$1).REPEAT);
    (Self._gl$1).texParameteri((Self._gl$1).TEXTURE_2D, (Self._gl$1).TEXTURE_MAG_FILTER, (Self._gl$1).LINEAR);
    (Self._gl$1).texParameteri((Self._gl$1).TEXTURE_2D, (Self._gl$1).TEXTURE_MIN_FILTER, (Self._gl$1).LINEAR_MIPMAP_LINEAR);
    (Self._gl$1).generateMipmap((Self._gl$1).TEXTURE_2D);
    (Self._gl$1).bindTexture((Self._gl$1).TEXTURE_2D, null);
  $Check(Self,"")._RealWidth = parseInt($Check(Self,"")._Image$1.width,10);
      $Check(Self,"")._RealHeight = parseInt($Check(Self,"")._Image$1.height,10);
      $Check(Self,"")._Width = $Check(Self,"")._RealWidth;
      $Check(Self,"")._Height = $Check(Self,"")._RealHeight;
      switch ($Check(Self,"")._Usage) {
         case 0 :
         case 2 :
            $Check(Self,"")._SizeTU = 1;
            $Check(Self,"")._SizeTV = 1;
            break;
         case 1 :
            $Check(Self,"")._SizeTU = $Check(Self,"")._Width/$Check(Self,"")._RealWidth;
            $Check(Self,"")._SizeTV = $Check(Self,"")._Height/$Check(Self,"")._RealHeight;
            break;
      }
      $Check(Self,"")._State = 2;
      $Check(g2,"")._LoadingItems-=1;
      if ($Check(Self,"")._OnLoadProc$1) {
         $CheckFunc($Check(Self,"")._OnLoadProc$1,"")();
      }
   }
   ,Destroy:TG2TextureBase.Destroy
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,Release$1:TG2TextureBase.Release$1
};
/// TG2ShaderProgram = class (TG2Resource)
var TG2ShaderProgram = {
   $ClassName:"TG2ShaderProgram",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._gl$2 = $._PixelShader = $._ShaderProgram = $._VertexShader = null;
   }
   /// procedure TG2ShaderProgram.Compile(const VertexShaderSource: String; const PixelShaderSource: String)
   ,Compile:function(Self, VertexShaderSource, PixelShaderSource) {
      $Check(Self,"")._gl$2.shaderSource($Check(Self,"")._VertexShader,VertexShaderSource);
      $Check(Self,"")._gl$2.shaderSource($Check(Self,"")._PixelShader,PixelShaderSource);
      $Check(Self,"")._gl$2.compileShader($Check(Self,"")._VertexShader);
      if (!$Check(Self,"")._gl$2.getShaderParameter($Check(Self,"")._VertexShader,35713)) {
         alert("VertexShader error: "+$Check(Self,"")._gl$2.getShaderInfoLog($Check(Self,"")._VertexShader));
      }
      $Check(Self,"")._gl$2.compileShader($Check(Self,"")._PixelShader);
      if (!$Check(Self,"")._gl$2.getShaderParameter($Check(Self,"")._PixelShader,35713)) {
         alert("PixelShader error: "+$Check(Self,"")._gl$2.getShaderInfoLog($Check(Self,"")._PixelShader));
      }
      $Check(Self,"")._gl$2.attachShader($Check(Self,"")._ShaderProgram,$Check(Self,"")._VertexShader);
      $Check(Self,"")._gl$2.attachShader($Check(Self,"")._ShaderProgram,$Check(Self,"")._PixelShader);
      $Check(Self,"")._gl$2.linkProgram($Check(Self,"")._ShaderProgram);
   }
   /// constructor TG2ShaderProgram.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      $Check(Self,"")._gl$2 = $Check($Check(g2,"")._Gfx,"").gl$1;
      $Check(Self,"")._ShaderProgram = $Check(Self,"")._gl$2.createProgram();
      $Check(Self,"")._VertexShader = $Check(Self,"")._gl$2.createShader(35633);
      $Check(Self,"")._PixelShader = $Check(Self,"")._gl$2.createShader(35632);
      TG2Resource.SetParent(Self,g2);
      return Self
   }
   /// destructor TG2ShaderProgram.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"")._gl$2.deleteShader($Check(Self,"")._PixelShader);
      $Check(Self,"")._gl$2.deleteShader($Check(Self,"")._VertexShader);
      $Check(Self,"")._gl$2.deleteProgram($Check(Self,"")._ShaderProgram);
      TG2Resource.Destroy(Self);
   }
   /// function TG2ShaderProgram.GetShaderAttribute(const AttributeName: String) : GLint
   ,GetShaderAttribute:function(Self, AttributeName) {
      return $Check($Check(g2,"")._Gfx,"").gl$1.getAttribLocation($Check(Self,"")._ShaderProgram,AttributeName);
   }
   /// function TG2ShaderProgram.GetShaderUniform(const UniformName: String) : JWebGLUniformLocation
   ,GetShaderUniform:function(Self, UniformName) {
      return $Check($Check(g2,"")._Gfx,"").gl$1.getUniformLocation($Check(Self,"")._ShaderProgram,UniformName);
   }
   /// procedure TG2ShaderProgram.Use()
   ,Use:function(Self) {
      if ($Check($Check(g2,"")._Gfx,"")._Shader$4!==Self) {
         $Check($Check(g2,"")._Gfx,"")._Shader$4 = Self;
         $Check($Check(g2,"")._Gfx,"").gl$1.useProgram($Check(Self,"")._ShaderProgram);
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2Scene3D = class (TG2Resource)
var TG2Scene3D = {
   $ClassName:"TG2Scene3D",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $.gl = $.ShaderParticles = $._OcTreeRoot = null;
      $.P = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      $.ShaderB = [null,null,null,null,null];
      $.ShaderBL = [null,null,null,null,null];
      $.V$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      $._Ambient = {Arr$1:[0,0,0,0]};
      $._Frames = {_ItemCount$5:0,_Items$5:[]};
      $._Frustum = {_Planes:[{d:0,n$3:{Arr$2:[0,0,0]}},{d:0,n$3:{Arr$2:[0,0,0]}},{d:0,n$3:{Arr$2:[0,0,0]}},{d:0,n$3:{Arr$2:[0,0,0]}},{d:0,n$3:{Arr$2:[0,0,0]}},{d:0,n$3:{Arr$2:[0,0,0]}}],_RefP:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},_RefV:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}};
      $._Meshes = {_ItemCount$5:0,_Items$5:[]};
      $._MeshInst = {_ItemCount$5:0,_Items$5:[]};
      $._NewParticles = {_ItemCount$5:0,_Items$5:[]};
      $._Nodes = {_ItemCount$5:0,_Items$5:[]};
      $._ParticleGroups = {_ItemCount$5:0,_Items$5:[]};
      $._ParticleRenders = {_ItemCount$5:0,_Items$5:[]};
      $._Particles = {_ItemCount$5:0,_Items$5:[]};
      $._ParticlesSorted = {_ItemCount$2:0,_Items$2:[]};
      $._StatParticlesRendered = 0;
      $._Textures = {_ItemCount$5:0,_Items$5:[]};
      $._UpdatingParticles = false;
   }
   /// procedure TG2Scene3D.Build()
   ,Build:function(Self) {
      /* null */
   }
   /// constructor TG2Scene3D.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      $Check(Self,"").gl = $Check($Check(g2,"")._Gfx,"").gl$1;
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._Frustum._RefV = TG2Mat$CopyRef$5($Check(Self,"").V$1);
      $Check(Self,"")._Frustum._RefP = TG2Mat$CopyRef$5($Check(Self,"").P);
      TG2QuickList$Clear$10($Check(Self,"")._Textures);
      TG2QuickList$Clear$10($Check(Self,"")._Nodes);
      TG2QuickList$Clear$10($Check(Self,"")._Frames);
      TG2QuickList$Clear$10($Check(Self,"")._MeshInst);
      TG2QuickList$Clear$10($Check(Self,"")._Meshes);
      TG2QuickList$Clear$10($Check(Self,"")._Particles);
      TG2QuickList$Clear$10($Check(Self,"")._NewParticles);
      TG2QuickList$Clear$10($Check(Self,"")._ParticleGroups);
      TG2QuickList$Clear$10($Check(Self,"")._ParticleRenders);
      $Check(Self,"")._OcTreeRoot = null;
      $Check(Self,"")._UpdatingParticles = false;
      $Check(Self,"")._StatParticlesRendered = 0;
      $Check(Self,"")._Ambient = G2Vec4(0.0784313725490196,0.0784313725490196,0.0784313725490196,1);
      $Check(Self,"").ShaderB[0] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderB[0],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderB[0],"\r\n    uniform mat4 WVP;\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_Position = vec4(a_Position0, 1) * WVP;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform vec4 LightAmbient;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * LightAmbient;\r\n    }\r\n  ");
      $Check(Self,"").ShaderB[1] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderB[1],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderB[1],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute float a_BlendIndex0;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = SkinPallete[int(a_BlendIndex0)];\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform vec4 LightAmbient;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * LightAmbient;\r\n    }\r\n  ");
      $Check(Self,"").ShaderB[2] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderB[2],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderB[2],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_BlendIndex0;\r\n    attribute vec2 a_BlendWeight0;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform vec4 LightAmbient;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * LightAmbient;\r\n    }\r\n  ");
      $Check(Self,"").ShaderB[3] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderB[3],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderB[3],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec3 a_BlendIndex0;\r\n    attribute vec3 a_BlendWeight0;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1] +\r\n        SkinPallete[int(a_BlendIndex0[2])] * a_BlendWeight0[2]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform vec4 LightAmbient;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * LightAmbient;\r\n    }\r\n  ");
      $Check(Self,"").ShaderB[4] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderB[4],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderB[4],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec4 a_BlendIndex0;\r\n    attribute vec4 a_BlendWeight0;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1] +\r\n        SkinPallete[int(a_BlendIndex0[2])] * a_BlendWeight0[2] +\r\n        SkinPallete[int(a_BlendIndex0[3])] * a_BlendWeight0[3]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform vec4 LightAmbient;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * LightAmbient;\r\n    }\r\n  ");
      $Check(Self,"").ShaderBL[0] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderBL[0],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderBL[0],"\r\n    uniform mat4 WVP;\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_TexCoord1;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_Position = vec4(a_Position0, 1) * WVP;\r\n      v_TexCoord = vec4(a_TexCoord0, a_TexCoord1);\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform sampler2D Tex1;\r\n    uniform vec4 LightAmbient;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord.xy) * (texture2D(Tex1, v_TexCoord.zw) + LightAmbient);\r\n    }\r\n  ");
      $Check(Self,"").ShaderBL[1] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderBL[1],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderBL[1],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_TexCoord1;\r\n    attribute float a_BlendIndex0;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = SkinPallete[int(a_BlendIndex0)];\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = vec4(a_TexCoord0, a_TexCoord1);\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform sampler2D Tex1;\r\n    uniform vec4 LightAmbient;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord.xy) * (texture2D(Tex1, v_TexCoord.zw) + LightAmbient);\r\n    }\r\n  ");
      $Check(Self,"").ShaderBL[2] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderBL[2],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderBL[2],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_TexCoord1;\r\n    attribute vec2 a_BlendIndex0;\r\n    attribute vec2 a_BlendWeight0;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = vec4(a_TexCoord0, a_TexCoord1);\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform sampler2D Tex1;\r\n    uniform vec4 LightAmbient;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord.xy) * (texture2D(Tex1, v_TexCoord.zw) + LightAmbient);\r\n    }\r\n  ");
      $Check(Self,"").ShaderBL[3] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderBL[3],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderBL[3],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_TexCoord1;\r\n    attribute vec3 a_BlendIndex0;\r\n    attribute vec3 a_BlendWeight0;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1] +\r\n        SkinPallete[int(a_BlendIndex0[2])] * a_BlendWeight0[2]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = vec4(a_TexCoord0, a_TexCoord1);\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform sampler2D Tex1;\r\n    uniform vec4 LightAmbient;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord.xy) * (texture2D(Tex1, v_TexCoord.zw) + LightAmbient);\r\n    }\r\n  ");
      $Check(Self,"").ShaderBL[4] = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderBL[4],Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderBL[4],"\r\n    const int MAX_BONE_COUNT = 60;\r\n    uniform mat4 WVP;\r\n    uniform mat4 SkinPallete[MAX_BONE_COUNT];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute vec2 a_TexCoord1;\r\n    attribute vec4 a_BlendIndex0;\r\n    attribute vec4 a_BlendWeight0;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      mat4 FinalMatrix = (\r\n        SkinPallete[int(a_BlendIndex0[0])] * a_BlendWeight0[0] +\r\n        SkinPallete[int(a_BlendIndex0[1])] * a_BlendWeight0[1] +\r\n        SkinPallete[int(a_BlendIndex0[2])] * a_BlendWeight0[2] +\r\n        SkinPallete[int(a_BlendIndex0[3])] * a_BlendWeight0[3]\r\n      );\r\n      vec4 SkinPos = vec4(a_Position0, 1) * FinalMatrix;\r\n      gl_Position = SkinPos * WVP;\r\n      v_TexCoord = vec4(a_TexCoord0, a_TexCoord1);\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    uniform sampler2D Tex1;\r\n    uniform vec4 LightAmbient;\r\n    varying vec4 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord.xy) * (texture2D(Tex1, v_TexCoord.zw) + LightAmbient);\r\n    }\r\n  ");
      $Check(Self,"").ShaderParticles = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"").ShaderParticles,Self);
      TG2ShaderProgram.Compile($Check(Self,"").ShaderParticles,"\r\n    uniform mat4 WVP;\r\n    uniform mat4 TransformPallete[60];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute float a_BlendIndex0;\r\n    varying vec2 v_TexCoord;\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      int ind = int(a_BlendIndex0);\r\n      gl_Position = (\r\n        vec4(a_Position0 * mat3(TransformPallete[ind]) +\r\n        vec3(\r\n          TransformPallete[ind][0][3],\r\n          TransformPallete[ind][1][3],\r\n          TransformPallete[ind][2][3]\r\n        ), 1) * WVP\r\n      );\r\n      v_TexCoord = a_TexCoord0;\r\n      v_Color = vec4(\r\n        TransformPallete[ind][3][0],\r\n        TransformPallete[ind][3][1],\r\n        TransformPallete[ind][3][2],\r\n        TransformPallete[ind][3][3]\r\n      );\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    varying vec2 v_TexCoord;\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * v_Color;\r\n    }\r\n  ");
      return Self
   }
   /// destructor TG2Scene3D.Destroy()
   ,Destroy:function(Self) {
      var i$14 = 0;
      while ($Check(Self,"")._Nodes._ItemCount$5>0) {
         TObject.Free($As(TG2QuickList$GetItem$11($Check(Self,"")._Nodes,0),TG2S3DNode))      }
      while ($Check(Self,"")._Meshes._ItemCount$5>0) {
         TObject.Free($As(TG2QuickList$GetItem$11($Check(Self,"")._Meshes,0),TG2S3DMesh))      }
      var $temp4;
      for(i$14 = 0,$temp4 = $Check(Self,"")._Textures._ItemCount$5;i$14<$temp4;i$14++) {
         TObject.Free($Check($As(TG2QuickList$GetItem$11($Check(Self,"")._Textures,i$14),TG2S3DTexture),"").Texture$1);
         TObject.Free($As(TG2QuickList$GetItem$11($Check(Self,"")._Textures,i$14),TG2S3DTexture));
      }
      TG2QuickList$Clear$10($Check(Self,"")._Textures);
      TG2Resource.Destroy(Self);
   }
   /// function TG2Scene3D.FindTexture(const TextureName: String; Usage: TG2TextureUsage = 0) : TG2Texture2D
   ,FindTexture:function(Self, TextureName, Usage$1) {
      var Result = null;
      var i$15 = 0;
      var pt = null;
      var $temp5;
      for(i$15 = 0,$temp5 = $Check(Self,"")._Textures._ItemCount$5;i$15<$temp5;i$15++) {
         if ($Check($As(TG2QuickList$GetItem$11($Check(Self,"")._Textures,i$15),TG2S3DTexture),"").Name$6==TextureName) {
            Result = $Check($As(TG2QuickList$GetItem$11($Check(Self,"")._Textures,i$15),TG2S3DTexture),"").Texture$1;
            return Result;
         }
      }
      pt = TObject.Create($New(TG2S3DTexture));
      $Check(pt,"").Name$6 = TextureName;
      $Check(pt,"").Texture$1 = TG2Resource.Create$48$($New(TG2Texture2D));
      TG2Texture2D.Load$1($Check(pt,"").Texture$1,TextureName,Usage$1);
      TG2QuickList$Add$11($Check(Self,"")._Textures,pt);
      Result = $Check(pt,"").Texture$1;
      return Result
   }
   /// function TG2Scene3D.GetFrame(const Index: Integer) : TG2S3DFrame
   ,GetFrame:function(Self, Index$1) {
      return $As(TG2QuickList$GetItem$11($Check(Self,"")._Frames,Index$1),TG2S3DFrame);
   }
   /// function TG2Scene3D.GetFrameCount() : Integer
   ,GetFrameCount:function(Self) {
      return $Check(Self,"")._Frames._ItemCount$5;
   }
   /// function TG2Scene3D.GetMesh(const Index: Integer) : TG2S3DMesh
   ,GetMesh:function(Self, Index$2) {
      return $As(TG2QuickList$GetItem$11($Check(Self,"")._Meshes,Index$2),TG2S3DMesh);
   }
   /// function TG2Scene3D.GetMeshCount() : Integer
   ,GetMeshCount:function(Self) {
      return $Check(Self,"")._Meshes._ItemCount$5;
   }
   /// function TG2Scene3D.GetMeshInst(const Index: Integer) : TG2S3DMeshInst
   ,GetMeshInst:function(Self, Index$3) {
      return $As(TG2QuickList$GetItem$11($Check(Self,"")._MeshInst,Index$3),TG2S3DMeshInst);
   }
   /// function TG2Scene3D.GetMeshInstCount() : Integer
   ,GetMeshInstCount:function(Self) {
      return $Check(Self,"")._MeshInst._ItemCount$5;
   }
   /// function TG2Scene3D.GetNode(const Index: Integer) : TG2S3DNode
   ,GetNode:function(Self, Index$4) {
      return $As(TG2QuickList$GetItem$11($Check(Self,"")._Nodes,Index$4),TG2S3DNode);
   }
   /// function TG2Scene3D.GetNodeCount() : Integer
   ,GetNodeCount:function(Self) {
      return $Check(Self,"")._Nodes._ItemCount$5;
   }
   /// function TG2Scene3D.GetStatParticleCount() : Integer
   ,GetStatParticleCount:function(Self) {
      return $Check(Self,"")._Particles._ItemCount$5;
   }
   /// function TG2Scene3D.GetStatParticleGroupCount() : Integer
   ,GetStatParticleGroupCount:function(Self) {
      return $Check(Self,"")._ParticleGroups._ItemCount$5;
   }
   /// procedure TG2Scene3D.OcTreeBreak()
   ,OcTreeBreak:function(Self) {
      $Check(Self,"")._OcTreeRoot = null;
   }
   /// procedure TG2Scene3D.OcTreeBuild(const MinV: TG2Vec3; const MaxV: TG2Vec3; const Depth: Integer)
   ,OcTreeBuild:function(Self, MinV$2, MaxV$2, Depth) {
      if ($Check(Self,"")._OcTreeRoot!==null) {
         TG2Scene3D.OcTreeBreak(Self);
      }
   }
   /// procedure TG2Scene3D.ParticleAdd(const Particle: TG2S3DParticle)
   ,ParticleAdd:function(Self, Particle) {
      var i$16 = 0;
      var n$4 = 0;
      var Bounds = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      var g$1 = null;
      var ps = 0;
      if ($Check(Self,"")._UpdatingParticles) {
         TG2QuickList$Add$11($Check(Self,"")._NewParticles,Particle);
         return;
      }
      TG2QuickList$Add$11($Check(Self,"")._Particles,Particle);
      n$4 = -1;
      var $temp6;
      for(i$16 = 0,$temp6 = $Check(Self,"")._ParticleRenders._ItemCount$5;i$16<$temp6;i$16++) {
         if ($Is($As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleRenders,i$16),TG2S3DParticleRender),TG2S3DParticleRender)) {
            n$4 = i$16;
            break;
         }
      }
      if (n$4==(-1)) {
         n$4 = $Check(Self,"")._ParticleRenders._ItemCount$5;
         TG2QuickList$Add$11($Check(Self,"")._ParticleRenders,TG2S3DParticleRender.Create$57$($NewDyn($Check(Particle,"")._RenderClass,""),Self));
      }
      $Check(Particle,"")._ParticleRender = $As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleRenders,n$4),TG2S3DParticleRender);
      ps = $Check(Particle,"")._Size$1*2;
      TG2Vec3$SetX$1(Bounds.MinV,(TG2Vec3$GetX$1($Check(Particle,"")._Pos)-ps));
      TG2Vec3$SetY$1(Bounds.MinV,(TG2Vec3$GetY$1($Check(Particle,"")._Pos)-ps));
      TG2Vec3$SetZ$1(Bounds.MinV,(TG2Vec3$GetZ$1($Check(Particle,"")._Pos)-ps));
      TG2Vec3$SetX$1(Bounds.MaxV,(TG2Vec3$GetX$1($Check(Particle,"")._Pos)+ps));
      TG2Vec3$SetY$1(Bounds.MaxV,(TG2Vec3$GetY$1($Check(Particle,"")._Pos)+ps));
      TG2Vec3$SetZ$1(Bounds.MaxV,(TG2Vec3$GetZ$1($Check(Particle,"")._Pos)+ps));
      g$1 = null;
      var $temp7;
      for(i$16 = 0,$temp7 = $Check(Self,"")._ParticleGroups._ItemCount$5;i$16<$temp7;i$16++) {
         if ((($Check(Particle,"")._Size$1>=$Check($As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$16),TG2S3DParticleGroup),"").MinSize)&&($Check(Particle,"")._Size$1<=$Check($As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$16),TG2S3DParticleGroup),"").MaxSize))&&TG2AABox$Intersect$2(Bounds,$Check($As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$16),TG2S3DParticleGroup),"").AABox)) {
            g$1 = $As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$16),TG2S3DParticleGroup);
            $Check(g$1,"").MaxSize = (($Check(g$1,"").MaxSize*0.1*$Check(g$1,"").Items$10._ItemCount$5)+$Check(Particle,"")._Size$1)/($Check(g$1,"").Items$10._ItemCount$5+1);
            $Check(g$1,"").MinSize = $Check(g$1,"").MaxSize*0.1;
            $Check(g$1,"").MaxSize*=10;
            TG2QuickList$Add$11($Check(g$1,"").Items$10,Particle);
            TG2AABox$Merge($Check(g$1,"").AABox,TG2S3DParticle.GetAABox(Particle));
            $Check(Particle,"")._Group = g$1;
            return;
         }
      }
      g$1 = TObject.Create($New(TG2S3DParticleGroup));
      TG2QuickList$Add$11($Check(Self,"")._ParticleGroups,g$1);
      TG2QuickList$Clear$10($Check(g$1,"").Items$10);
      TG2QuickList$Add$11($Check(g$1,"").Items$10,Particle);
      $Check(g$1,"").AABox = TG2S3DParticle.GetAABox(Particle);
      $Check(g$1,"").MinSize = $Check(Particle,"")._Size$1*0.1;
      $Check(g$1,"").MaxSize = $Check(Particle,"")._Size$1*0.1;
      $Check(Particle,"")._Group = g$1;
   }
   /// procedure TG2Scene3D.Render()
   ,Render$2:function(Self) {
      var i$17 = 0;
      var j = 0;
      var g$2 = 0;
      var m = 0;
      var W = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var VP = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var WVP = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var Mesh$1 = null;
      var Inst = null;
      var Geom = null;
      var Material$1 = null;
      var PrevDepthEnable = false;
      var VB$3 = null;
      var ShaderMethod = 0;
      var Tex = [null,null];
      var Shader$1 = null;
      TG2Core.SetRenderControl(g2,null);
      TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,2);
      TG2Frustum$Update$8($Check(Self,"")._Frustum);
      PrevDepthEnable = $Check($Check(g2,"")._Gfx,"")._DepthEnable;
      TG2Gfx.SetDepthEnable($Check(g2,"")._Gfx,true);
      $Check(Self,"").gl.enable(2884);
      VP = G2MatMul($Check(Self,"").V$1,$Check(Self,"").P);
      Tex[0] = null;
      Tex[1] = null;
      var $temp8;
      for(i$17 = 0,$temp8 = $Check(Self,"")._MeshInst._ItemCount$5;i$17<$temp8;i$17++) {
         Inst = $As(TG2QuickList$GetItem$11($Check(Self,"")._MeshInst,i$17),TG2S3DMeshInst);
         Mesh$1 = $Check(Inst,"")._Mesh;
         if (TG2Frustum$CheckBox$1($Check(Self,"")._Frustum,G2BoxToAABox(TG2S3DMeshInst.GetBBox(Inst)))!=2) {
            var $temp9;
            for(g$2 = 0,$temp9 = $Check(Mesh$1,"")._GeomCount;g$2<$temp9;g$2++) {
               Geom = TG2S3DMesh.GetGeom(Mesh$1,g$2);
               if ($Check(Geom,"").Skinned) {
                  VB$3 = $Check($As($Check(Geom,"").Data$1,TG2S3DGeomDataSkinned),"").VB$2;
                  Copy$TG2Mat($Check(Inst,"")._Transform,W);
                  ShaderMethod = $Check($As($Check(Geom,"").Data$1,TG2S3DGeomDataSkinned),"").MaxWeights;
               } else {
                  VB$3 = $Check($As($Check(Geom,"").Data$1,TG2S3DGeomDataStatic),"").VB$1;
                  W = G2MatMul($DIdxR($Check(Inst,"").Transforms$1,$Check(Geom,"").NodeID,"").TransformCom,$Check(Inst,"")._Transform);
                  ShaderMethod = 0;
               }
               WVP = G2MatTranspose(G2MatMul(W,VP));
               TG2IndexBuffer.Bind$3($Check(Geom,"").IB);
               var $temp10;
               for(m = 0,$temp10 = $Check(Geom,"").GCount;m<$temp10;m++) {
                  Material$1 = $DIdxR($Check(Inst,"").Materials,$DIdxR($Check(Geom,"").Groups,m,"").Material,"");
                  if ($Check(Material$1,"").ChannelCount>0) {
                     if ($DIdxR($Check(Material$1,"").Channels,0,"").MapLight!==null) {
                        Shader$1 = $Check(Self,"").ShaderBL[$Idx(ShaderMethod,0,4,"")];
                        TG2ShaderProgram.Use(Shader$1);
                        $Check(Self,"").gl.uniform1i(TG2ShaderProgram.GetShaderUniform(Shader$1,"Tex1"),1);
                        if (Tex[1]!==$DIdxR($Check(Material$1,"").Channels,0,"").MapLight) {
                           Tex[1] = $DIdxR($Check(Material$1,"").Channels,0,"").MapLight;
                           TG2Texture2DBase.Bind$2(Tex[1],1);
                           $Check(Self,"").gl.texParameteri(3553,10241,9729);
                           $Check(Self,"").gl.texParameteri(3553,10240,9729);
                        }
                     } else {
                        Shader$1 = $Check(Self,"").ShaderB[$Idx(ShaderMethod,0,4,"")];
                        TG2ShaderProgram.Use(Shader$1);
                     }
                     if ($DIdxR($Check(Material$1,"").Channels,0,"").MapDiffuse!==null) {
                        $Check(Self,"").gl.uniform1i(TG2ShaderProgram.GetShaderUniform(Shader$1,"Tex0"),0);
                        if (Tex[0]!==$DIdxR($Check(Material$1,"").Channels,0,"").MapDiffuse) {
                           Tex[0] = $DIdxR($Check(Material$1,"").Channels,0,"").MapDiffuse;
                           TG2Texture2DBase.Bind$2(Tex[0],0);
                           $Check(Self,"").gl.texParameteri(3553,10241,9987);
                           $Check(Self,"").gl.texParameteri(3553,10240,9729);
                        }
                     }
                  } else {
                     Shader$1 = $Check(Self,"").ShaderB[0];
                     TG2ShaderProgram.Use(Shader$1);
                     $Check(Self,"").gl.uniform1i(TG2ShaderProgram.GetShaderUniform(Shader$1,"Tex0"),0);
                  }
                  if ($Check(Geom,"").Skinned) {
                     var $temp11;
                     for(j = 0,$temp11 = $Check($As($Check(Geom,"").Data$1,TG2S3DGeomDataSkinned),"").BoneCount;j<$temp11;j++) {
                        $Check(Self,"").gl.uniformMatrix4fv(TG2ShaderProgram.GetShaderUniform(Shader$1,("SkinPallete["+j.toString()+"]")),false,TG2Mat$ToFloat32Array$4(G2MatTranspose($DIdxR($Check(TG2S3DMeshInst.GetSkin(Inst,g$2),"").Transforms,j,""))));
                     }
                  }
                  $Check(Self,"").gl.uniformMatrix4fv(TG2ShaderProgram.GetShaderUniform(Shader$1,"WVP"),false,TG2Mat$ToFloat32Array$4(WVP));
                  $Check(Self,"").gl.uniform4fv(TG2ShaderProgram.GetShaderUniform(Shader$1,"LightAmbient"),TG2Vec4$ToFloat32Array($Check(Self,"")._Ambient));
                  TG2VertexBuffer.Bind(VB$3);
                  $Check(Self,"").gl.drawElements(4,$DIdxR($Check(Geom,"").Groups,m,"").FaceCount$1*3,5123,$DIdxR($Check(Geom,"").Groups,m,"").FaceStart$1*6);
                  TG2VertexBuffer.Unbind(VB$3);
               }
               TG2IndexBuffer.Unbind$1($Check(Geom,"").IB);
            }
         }
      }
      $Check(Self,"").gl.disable(2884);
      TG2Gfx.SetDepthEnable($Check(g2,"")._Gfx,PrevDepthEnable);
      TG2Scene3D.RenderParticles(Self);
   }
   /// procedure TG2Scene3D.RenderParticles()
   ,RenderParticles:function(Self) {
      var gi = 0;
      var i$18 = 0;
      var ViewDir = {Arr$2:[0,0,0]};
      var g$3 = null;
      var pt$1 = null;
      var CurRender = null;
      if (!$Check(Self,"")._ParticleGroups._ItemCount$5) {
         return;
      }
      $Check(Self,"")._StatParticlesRendered = 0;
      CurRender = null;
      ViewDir = TG2Vec3$Norm(G2Vec3(TG2Mat$GetE02($Check(Self,"").V$1),TG2Mat$GetE12($Check(Self,"").V$1),TG2Mat$GetE22($Check(Self,"").V$1)));
      TG2QuickSortList$Clear$7($Check(Self,"")._ParticlesSorted);
      var $temp12;
      for(gi = 0,$temp12 = $Check(Self,"")._ParticleGroups._ItemCount$5;gi<$temp12;gi++) {
         g$3 = $As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,gi),TG2S3DParticleGroup);
         if (TG2Frustum$CheckBox$1($Check(Self,"")._Frustum,$Check(g$3,"").AABox)!=2) {
            var $temp13;
            for(i$18 = 0,$temp13 = $Check(g$3,"").Items$10._ItemCount$5;i$18<$temp13;i$18++) {
               pt$1 = $As(TG2QuickList$GetItem$11($Check(g$3,"").Items$10,i$18),TG2S3DParticle);
               if ($Check(pt$1,"")._DepthSorted) {
                  TG2QuickSortList$Add$7($Check(Self,"")._ParticlesSorted,pt$1,TG2Vec3$Dot(ViewDir,$Check(pt$1,"")._Pos));
               } else {
                  if (CurRender!==$Check(pt$1,"")._ParticleRender) {
                     if (CurRender!==null) {
                        TG2S3DParticleRender.RenderEnd$($Check(CurRender,""));
                     }
                     CurRender = $Check(pt$1,"")._ParticleRender;
                     TG2S3DParticleRender.RenderBegin$($Check(CurRender,""));
                  }
                  TG2S3DParticleRender.RenderParticle$($Check(CurRender,""),pt$1);
                  ++$Check(Self,"")._StatParticlesRendered;
               }
            }
         }
      }
      for(i$18 = $Check(Self,"")._ParticlesSorted._ItemCount$2-1;i$18>=0;i$18--) {
         pt$1 = $As(TG2QuickSortList$GetItem$8($Check(Self,"")._ParticlesSorted,i$18),TG2S3DParticle);
         if (CurRender!==$Check(pt$1,"")._ParticleRender) {
            if (CurRender!==null) {
               TG2S3DParticleRender.RenderEnd$($Check(CurRender,""));
            }
            CurRender = $Check(pt$1,"")._ParticleRender;
            TG2S3DParticleRender.RenderBegin$($Check(CurRender,""));
         }
         TG2S3DParticleRender.RenderParticle$($Check(CurRender,""),pt$1);
         ++$Check(Self,"")._StatParticlesRendered;
      }
      if (CurRender!==null) {
         TG2S3DParticleRender.RenderEnd$($Check(CurRender,""));
      }
   }
   /// procedure TG2Scene3D.Update()
   ,Update$5:function(Self) {
      var i$19 = 0;
      var n$5 = 0;
      var pt$2 = null;
      var g$4 = null;
      $Check(Self,"")._UpdatingParticles = true;
      var $temp14;
      for(i$19 = 0,$temp14 = $Check(Self,"")._ParticleGroups._ItemCount$5;i$19<$temp14;i$19++) {
         g$4 = $As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$19),TG2S3DParticleGroup);
         $Check(g$4,"").AABox = TG2S3DParticle.GetAABox($As(TG2QuickList$GetItem$11($Check(g$4,"").Items$10,0),TG2S3DParticle));
         $Check(g$4,"").MaxSize = 0;
      }
      n$5 = $Check(Self,"")._Particles._ItemCount$5;
      i$19 = 0;
      while (i$19<n$5) {
         pt$2 = $As(TG2QuickList$GetItem$11($Check(Self,"")._Particles,i$19),TG2S3DParticle);
         TG2S3DParticle.Update$6$($Check(pt$2,""));
         g$4 = $Check($As(TG2QuickList$GetItem$11($Check(Self,"")._Particles,i$19),TG2S3DParticle),"")._Group;
         if ($Check(pt$2,"")._Dead) {
            TG2QuickList$Remove$8($Check(g$4,"").Items$10,pt$2);
            TObject.Free(pt$2);
            TG2QuickList$Delete$6($Check(Self,"")._Particles,i$19);
            if ($Check(g$4,"").Items$10._ItemCount$5<1) {
               TG2QuickList$Remove$8($Check(Self,"")._ParticleGroups,g$4);
               TObject.Free(g$4);
            }
            --n$5;
         } else {
            $Check(g$4,"").MaxSize+=$Check(pt$2,"")._Size$1;
            TG2AABox$Merge($Check(g$4,"").AABox,TG2S3DParticle.GetAABox(pt$2));
            ++i$19;
         }
      }
      var $temp15;
      for(i$19 = 0,$temp15 = $Check(Self,"")._ParticleGroups._ItemCount$5;i$19<$temp15;i$19++) {
         g$4 = $As(TG2QuickList$GetItem$11($Check(Self,"")._ParticleGroups,i$19),TG2S3DParticleGroup);
         $Check(g$4,"").MaxSize/=$Check(g$4,"").Items$10._ItemCount$5;
         $Check(g$4,"").MinSize = $Check(g$4,"").MaxSize*0.1;
         $Check(g$4,"").MaxSize*=10;
      }
      $Check(Self,"")._UpdatingParticles = false;
      var $temp16;
      for(i$19 = 0,$temp16 = $Check(Self,"")._NewParticles._ItemCount$5;i$19<$temp16;i$19++) {
         TG2Scene3D.ParticleAdd(Self,$As(TG2QuickList$GetItem$11($Check(Self,"")._NewParticles,i$19),TG2S3DParticle));
      }
      TG2QuickList$Clear$10($Check(Self,"")._NewParticles);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,Render$2$:function($){return $.ClassType.Render$2($)}
   ,Update$5$:function($){return $.ClassType.Update$5($)}
};
/// TG2S3DTexture = class (TObject)
var TG2S3DTexture = {
   $ClassName:"TG2S3DTexture",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Name$6 = "";
      $.Texture$1 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DParticleRender = class (TObject)
var TG2S3DParticleRender = {
   $ClassName:"TG2S3DParticleRender",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $._gl$3 = $._Scene = null;
   }
   /// constructor TG2S3DParticleRender.Create(const Scene: TG2Scene3D)
   ,Create$57:function(Self, Scene) {
      TObject.Create(Self);
      $Check(Self,"")._Scene = Scene;
      $Check(Self,"")._gl$3 = $Check($Check(g2,"")._Gfx,"").gl$1;
      return Self
   }
   /// destructor TG2S3DParticleRender.Destroy()
   ,Destroy:function(Self) {
      TObject.Destroy(Self);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$57$:function($){return $.ClassType.Create$57.apply($.ClassType, arguments)}
   ,RenderBegin$:function($){return $.ClassType.RenderBegin($)}
   ,RenderEnd$:function($){return $.ClassType.RenderEnd($)}
   ,RenderParticle$:function($){return $.ClassType.RenderParticle.apply($.ClassType, arguments)}
};
/// TG2S3DParticleRenderFlat = class (TG2S3DParticleRender)
var TG2S3DParticleRenderFlat = {
   $ClassName:"TG2S3DParticleRenderFlat",
   $Parent:TG2S3DParticleRender
   ,$Init:function ($) {
      TG2S3DParticleRender.$Init($);
      $._CurBlendMode = 0;
      $._CurFilter = 0;
      $._CurQuad = $._MaxQuads = 0;
      $._CurTexture = $._IB = $._Shader = $._UniformTex0 = $._UniformWVP = $._VB$1 = null;
   }
   /// constructor TG2S3DParticleRenderFlat.Create(const Scene: TG2Scene3D)
   ,Create$57:function(Self, Scene$1) {
      var Decl$2 = [];
      var i$20 = 0;
      TG2S3DParticleRender.Create$57(Self,Scene$1);
      $Check(Self,"")._MaxQuads = 45;
      $Check(Self,"")._Shader = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2Resource.SetParent($Check(Self,"")._Shader,$Check(Self,"")._Scene);
      TG2ShaderProgram.Compile($Check(Self,"")._Shader,"\r\n    uniform mat4 WVP;\r\n    uniform mat4 TransformPallete[60];\r\n    attribute vec3 a_Position0;\r\n    attribute vec2 a_TexCoord0;\r\n    attribute float a_BlendIndex0;\r\n    varying vec2 v_TexCoord;\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      int ind = int(a_BlendIndex0);\r\n      gl_Position = (\r\n        vec4(a_Position0 * mat3(TransformPallete[ind]) +\r\n        vec3(\r\n          TransformPallete[ind][0][3],\r\n          TransformPallete[ind][1][3],\r\n          TransformPallete[ind][2][3]\r\n        ), 1) * WVP\r\n      );\r\n      v_TexCoord = a_TexCoord0;\r\n      v_Color = vec4(\r\n        TransformPallete[ind][3][0],\r\n        TransformPallete[ind][3][1],\r\n        TransformPallete[ind][3][2],\r\n        TransformPallete[ind][3][3]\r\n      );\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    varying vec2 v_TexCoord;\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * v_Color;\r\n    }\r\n  ");
      $Check(Self,"")._UniformWVP = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader,"WVP");
      $Check(Self,"")._UniformTex0 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader,"Tex0");
      $ArraySetLenC(Decl$2,3,function (){return {Element:0,Count$4:0}});
      $DIdxR(Decl$2,0,"").Element = 1;
      $DIdxR(Decl$2,0,"").Count$4 = 3;
      $DIdxR(Decl$2,1,"").Element = 6;
      $DIdxR(Decl$2,1,"").Count$4 = 2;
      $DIdxR(Decl$2,2,"").Element = 8;
      $DIdxR(Decl$2,2,"").Count$4 = 1;
      $Check(Self,"")._VB$1 = TG2Resource.Create$48$($New(TG2VertexBuffer));
      TG2VertexBuffer.Initialize$1($Check(Self,"")._VB$1,Decl$2,($Check(Self,"")._MaxQuads*4));
      TG2VertexBuffer.Lock($Check(Self,"")._VB$1,2);
      var $temp17;
      for(i$20 = 0,$temp17 = $Check(Self,"")._MaxQuads;i$20<$temp17;i$20++) {
         TG2VertexBuffer.WriteVec3($Check(Self,"")._VB$1,G2Vec3((-0.5),0.5,0));
         TG2VertexBuffer.WriteVec2($Check(Self,"")._VB$1,G2Vec2(0,0));
         TG2VertexBuffer.WriteFloat32($Check(Self,"")._VB$1,(i$20));
         TG2VertexBuffer.WriteVec3($Check(Self,"")._VB$1,G2Vec3(0.5,0.5,0));
         TG2VertexBuffer.WriteVec2($Check(Self,"")._VB$1,G2Vec2(1,0));
         TG2VertexBuffer.WriteFloat32($Check(Self,"")._VB$1,(i$20));
         TG2VertexBuffer.WriteVec3($Check(Self,"")._VB$1,G2Vec3((-0.5),(-0.5),0));
         TG2VertexBuffer.WriteVec2($Check(Self,"")._VB$1,G2Vec2(0,1));
         TG2VertexBuffer.WriteFloat32($Check(Self,"")._VB$1,(i$20));
         TG2VertexBuffer.WriteVec3($Check(Self,"")._VB$1,G2Vec3(0.5,(-0.5),0));
         TG2VertexBuffer.WriteVec2($Check(Self,"")._VB$1,G2Vec2(1,1));
         TG2VertexBuffer.WriteFloat32($Check(Self,"")._VB$1,(i$20));
      }
      TG2VertexBuffer.UnLock($Check(Self,"")._VB$1);
      $Check(Self,"")._IB = TG2Resource.Create$48$($New(TG2IndexBuffer));
      TG2IndexBuffer.Initialize$2($Check(Self,"")._IB,($Check(Self,"")._MaxQuads*6));
      TG2IndexBuffer.Lock$1($Check(Self,"")._IB,2);
      var $temp18;
      for(i$20 = 0,$temp18 = $Check(Self,"")._MaxQuads;i$20<$temp18;i$20++) {
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+0));
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+1));
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+2));
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+2));
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+1));
         TG2IndexBuffer.WriteIntU16($Check(Self,"")._IB,((i$20*4)+3));
      }
      TG2IndexBuffer.UnLock$1($Check(Self,"")._IB);
      return Self
   }
   /// destructor TG2S3DParticleRenderFlat.Destroy()
   ,Destroy:function(Self) {
      TObject.Free($Check(Self,"")._VB$1);
      TObject.Free($Check(Self,"")._IB);
      TG2S3DParticleRender.Destroy(Self);
   }
   /// procedure TG2S3DParticleRenderFlat.RenderBegin()
   ,RenderBegin:function(Self) {
      var WVP$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Gfx.SetDepthEnable($Check(g2,"")._Gfx,true);
      TG2Gfx.SetDepthWriteEnable($Check(g2,"")._Gfx,false);
      TG2ShaderProgram.Use($Check(Self,"")._Shader);
      WVP$1 = G2MatTranspose(G2MatMul($Check($Check(Self,"")._Scene,"").V$1,$Check($Check(Self,"")._Scene,"").P));
      $Check(Self,"")._gl$3.uniformMatrix4fv($Check(Self,"")._UniformWVP,false,TG2Mat$ToFloat32Array$4(WVP$1));
      $Check(Self,"")._gl$3.uniform1i($Check(Self,"")._UniformTex0,0);
      TG2VertexBuffer.Bind($Check(Self,"")._VB$1);
      TG2IndexBuffer.Bind$3($Check(Self,"")._IB);
      $Check(Self,"")._CurQuad = 0;
      $Check(Self,"")._CurTexture = null;
      $Check(Self,"")._CurBlendMode = 0;
      $Check(Self,"")._CurFilter = 0;
   }
   /// procedure TG2S3DParticleRenderFlat.RenderEnd()
   ,RenderEnd:function(Self) {
      if ($Check(Self,"")._CurQuad>0) {
         TG2S3DParticleRenderFlat.RenderFlush(Self);
      }
      TG2IndexBuffer.Unbind$1($Check(Self,"")._IB);
      TG2VertexBuffer.Unbind($Check(Self,"")._VB$1);
      TG2Gfx.SetDepthEnable($Check(g2,"")._Gfx,false);
      TG2Gfx.SetDepthWriteEnable($Check(g2,"")._Gfx,true);
   }
   /// procedure TG2S3DParticleRenderFlat.RenderFlush()
   ,RenderFlush:function(Self) {
      if (!$Check(Self,"")._CurQuad) {
         return;
      }
      $Check(Self,"")._gl$3.drawElements(4,$Check(Self,"")._CurQuad*6,5123,0);
      $Check(Self,"")._CurQuad = 0;
   }
   /// procedure TG2S3DParticleRenderFlat.RenderParticle(const Particle: TG2S3DParticle)
   ,RenderParticle:function(Self, Particle$1) {
      var p = null;
      var m$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      p = $As(Particle$1,TG2S3DParticleFlat);
      if (((($Check(p,"")._Texture$1!==$Check(Self,"")._CurTexture)||($Check(p,"")._Filter!=$Check(Self,"")._CurFilter))||($Check(p,"")._BlendMode!=$Check(Self,"")._CurBlendMode))||($Check(Self,"")._CurQuad>=($Check(Self,"")._MaxQuads-1))) {
         if ($Check(Self,"")._CurQuad>0) {
            TG2S3DParticleRenderFlat.RenderFlush(Self);
         }
         if ($Check(p,"")._Texture$1!==$Check(Self,"")._CurTexture) {
            $Check(Self,"")._CurTexture = $Check(p,"")._Texture$1;
            TG2Texture2DBase.Bind$2($Check(Self,"")._CurTexture,0);
         }
         $Check(Self,"")._CurFilter = $Check(p,"")._Filter;
         switch ($Check(Self,"")._CurFilter) {
            case 1 :
               $Check(Self,"")._gl$3.texParameteri(3553,10241,9728);
               $Check(Self,"")._gl$3.texParameteri(3553,10240,9728);
               break;
            case 2 :
               $Check(Self,"")._gl$3.texParameteri(3553,10241,9729);
               $Check(Self,"")._gl$3.texParameteri(3553,10240,9729);
               break;
         }
         if ($Check(p,"")._BlendMode!=$Check(Self,"")._CurBlendMode) {
            $Check(Self,"")._CurBlendMode = $Check(p,"")._BlendMode;
            TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,$Check(Self,"")._CurBlendMode);
         }
      }
      m$1 = G2Mat$1($Check(p,"")._VecX,$Check(p,"")._VecY,G2Vec3(0,0,0),$Check(p,"")._Pos);
      TG2Mat$SetE03(m$1,TG2Vec4$GetX($Check(p,"")._Color));
      TG2Mat$SetE13(m$1,TG2Vec4$GetY($Check(p,"")._Color));
      TG2Mat$SetE23(m$1,TG2Vec4$GetZ($Check(p,"")._Color));
      TG2Mat$SetE33(m$1,TG2Vec4$GetW($Check(p,"")._Color));
      $Check(Self,"")._gl$3.uniformMatrix4fv(TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader,("TransformPallete["+$Check(Self,"")._CurQuad.toString()+"]")),false,TG2Mat$ToFloat32Array$4(G2MatTranspose(m$1)));
      ++$Check(Self,"")._CurQuad;
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$57$:function($){return $.ClassType.Create$57.apply($.ClassType, arguments)}
   ,RenderBegin$:function($){return $.ClassType.RenderBegin($)}
   ,RenderEnd$:function($){return $.ClassType.RenderEnd($)}
   ,RenderParticle$:function($){return $.ClassType.RenderParticle.apply($.ClassType, arguments)}
};
/// TG2S3DParticleGroup = class (TObject)
var TG2S3DParticleGroup = {
   $ClassName:"TG2S3DParticleGroup",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.AABox = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      $.Items$10 = {_ItemCount$5:0,_Items$5:[]};
      $.MinSize = 0;
      $.MaxSize = 0;
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DParticle = class (TObject)
var TG2S3DParticle = {
   $ClassName:"TG2S3DParticle",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $._Dead = $._DepthSorted = false;
      $._Group = $._ParticleRender = null;
      $._Pos = {Arr$2:[0,0,0]};
      $._RenderClass = null;
      $._Size$1 = 0;
   }
   /// constructor TG2S3DParticle.Create()
   ,Create$59:function(Self) {
      TObject.Create(Self);
      $Check(Self,"")._ParticleRender = null;
      $Check(Self,"")._RenderClass = null;
      $Check(Self,"")._Size$1 = 0;
      TG2Vec3$SetValue$1($Check(Self,"")._Pos,0,0,0);
      $Check(Self,"")._Dead = false;
      return Self
   }
   /// destructor TG2S3DParticle.Destroy()
   ,Destroy:function(Self) {
      TObject.Destroy(Self);
   }
   /// procedure TG2S3DParticle.Die()
   ,Die:function(Self) {
      $Check(Self,"")._Dead = true;
   }
   /// function TG2S3DParticle.GetAABox() : TG2AABox
   ,GetAABox:function(Self) {
      var Result = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      TG2Vec3$SetX$1(Result.MinV,(TG2Vec3$GetX$1($Check(Self,"")._Pos)-$Check(Self,"")._Size$1));
      TG2Vec3$SetY$1(Result.MinV,(TG2Vec3$GetY$1($Check(Self,"")._Pos)-$Check(Self,"")._Size$1));
      TG2Vec3$SetZ$1(Result.MinV,(TG2Vec3$GetZ$1($Check(Self,"")._Pos)-$Check(Self,"")._Size$1));
      TG2Vec3$SetX$1(Result.MaxV,(TG2Vec3$GetX$1($Check(Self,"")._Pos)+$Check(Self,"")._Size$1));
      TG2Vec3$SetY$1(Result.MaxV,(TG2Vec3$GetY$1($Check(Self,"")._Pos)+$Check(Self,"")._Size$1));
      TG2Vec3$SetZ$1(Result.MaxV,(TG2Vec3$GetZ$1($Check(Self,"")._Pos)+$Check(Self,"")._Size$1));
      return Result
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$59$:function($){return $.ClassType.Create$59($)}
   ,Update$6$:function($){return $.ClassType.Update$6($)}
};
/// TG2S3DParticleFlat = class (TG2S3DParticle)
var TG2S3DParticleFlat = {
   $ClassName:"TG2S3DParticleFlat",
   $Parent:TG2S3DParticle
   ,$Init:function ($) {
      TG2S3DParticle.$Init($);
      $._BlendMode = 0;
      $._Color = {Arr$1:[0,0,0,0]};
      $._Filter = 0;
      $._Texture$1 = null;
      $._VecX = {Arr$2:[0,0,0]};
      $._VecY = {Arr$2:[0,0,0]};
   }
   /// constructor TG2S3DParticleFlat.Create()
   ,Create$59:function(Self) {
      TG2S3DParticle.Create$59(Self);
      $Check(Self,"")._RenderClass = TG2S3DParticleRenderFlat;
      TG2Vec3$SetValue$1($Check(Self,"")._VecX,1,0,0);
      TG2Vec3$SetValue$1($Check(Self,"")._VecY,0,1,0);
      TG2S3DParticleFlat.UpdateSize(Self);
      $Check(Self,"")._Texture$1 = null;
      $Check(Self,"")._Color = G2Vec4(1,1,1,1);
      $Check(Self,"")._Filter = 2;
      $Check(Self,"")._BlendMode = 2;
      $Check(Self,"")._DepthSorted = true;
      return Self
   }
   /// destructor TG2S3DParticleFlat.Destroy()
   ,Destroy:function(Self) {
      TG2S3DParticle.Destroy(Self);
   }
   /// procedure TG2S3DParticleFlat.MakeAxis(const View: TG2Mat; const Pos0: TG2Vec3; const Pos1: TG2Vec3; const Width: TG2Float)
   ,MakeAxis:function(Self, View$1, Pos0, Pos1, Width$13) {
      $Check(Self,"")._Pos = G2Vec3FloatMul(G2Vec3Add(Pos0,Pos1),0.5);
      TG2S3DParticleFlat.SetVecY(Self,G2Vec3FloatMul(G2Vec3Sub(Pos1,Pos0),0.5));
      TG2S3DParticleFlat.SetVecX(Self,G2Vec3FloatMul(TG2Vec3$Norm(TG2Vec3$Cross($Check(Self,"")._VecY,G2Vec3(TG2Mat$GetE02(View$1),TG2Mat$GetE12(View$1),TG2Mat$GetE22(View$1)))),(Width$13*0.5)));
   }
   /// procedure TG2S3DParticleFlat.MakeBillboard(const View: TG2Mat; const Width: TG2Float; const Height: TG2Float; const Rotation: TG2Float)
   ,MakeBillboard:function(Self, View$2, Width$14, Height$11, Rotation$3) {
      var s$7 = {};
      s$7.v = 0;
      var c$9 = {};
      c$9.v = 0;
      var vx$1 = {Arr$2:[0,0,0]};
      var vy$1 = {Arr$2:[0,0,0]};
      G2SinCos(Rotation$3,s$7,c$9);
      vx$1 = G2Vec3FloatMul(TG2Vec3$Norm(G2Vec3(TG2Mat$GetE00(View$2),TG2Mat$GetE10(View$2),TG2Mat$GetE20(View$2))),(Width$14*0.5));
      vy$1 = G2Vec3FloatMul(TG2Vec3$Norm(G2Vec3(TG2Mat$GetE01(View$2),TG2Mat$GetE11(View$2),TG2Mat$GetE21(View$2))),(Height$11*0.5));
      TG2S3DParticleFlat.SetVecX(Self,G2Vec3Sub(G2Vec3FloatMul(vx$1,s$7.v),G2Vec3FloatMul(vy$1,c$9.v)));
      TG2S3DParticleFlat.SetVecY(Self,G2Vec3Add(G2Vec3FloatMul(vy$1,s$7.v),G2Vec3FloatMul(vx$1,c$9.v)));
   }
   /// procedure TG2S3DParticleFlat.SetVecX(const Value: TG2Vec3)
   ,SetVecX:function(Self, Value$1) {
      Copy$TG2Vec3(Value$1,$Check(Self,"")._VecX);
      TG2S3DParticleFlat.UpdateSize(Self);
   }
   /// procedure TG2S3DParticleFlat.SetVecY(const Value: TG2Vec3)
   ,SetVecY:function(Self, Value$2) {
      Copy$TG2Vec3(Value$2,$Check(Self,"")._VecY);
      TG2S3DParticleFlat.UpdateSize(Self);
   }
   /// procedure TG2S3DParticleFlat.Update()
   ,Update$6:function(Self) {
      /* null */
   }
   /// procedure TG2S3DParticleFlat.UpdateSize()
   ,UpdateSize:function(Self) {
      $Check(Self,"")._Size$1 = Math.sqrt(Math.pow(TG2Vec3$Len($Check(Self,"")._VecX),2)+Math.pow(TG2Vec3$Len($Check(Self,"")._VecY),2));
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$59$:function($){return $.ClassType.Create$59($)}
   ,Update$6$:function($){return $.ClassType.Update$6($)}
};
/// TG2S3DOcTreeNode = class (TObject)
var TG2S3DOcTreeNode = {
   $ClassName:"TG2S3DOcTreeNode",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Parent$3 = null;
      $.SubNodes = [];
      $.DivX = $.DivY = $.DivZ = 0;
      $.AABox$2 = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      $.Frames$1 = {_ItemCount$5:0,_Items$5:[]};
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DNode = class (TObject)
var TG2S3DNode = {
   $ClassName:"TG2S3DNode",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $._Scene$1 = $._UserData = null;
      $._Transform = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   }
   /// constructor TG2S3DNode.Create(const Scene: TG2Scene3D)
   ,Create$61:function(Self, Scene$2) {
      TObject.Create(Self);
      $Check(Self,"")._Scene$1 = Scene$2;
      $Check(Self,"")._Transform = G2MatIdentity();
      $Check(Self,"")._UserData = null;
      TG2QuickList$Add$11($Check($Check(Self,"")._Scene$1,"")._Nodes,Self);
      return Self
   }
   /// destructor TG2S3DNode.Destroy()
   ,Destroy:function(Self) {
      TG2QuickList$Remove$8($Check($Check(Self,"")._Scene$1,"")._Nodes,Self);
      if ($Check(Self,"")._UserData!==null) {
         TObject.Free($Check(Self,"")._UserData);
      }
      TObject.Destroy(Self);
   }
   /// procedure TG2S3DNode.SetTransform(const Value: TG2Mat)
   ,SetTransform:function(Self, Value$3) {
      Copy$TG2Mat(Value$3,$Check(Self,"")._Transform);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$61$:function($){return $.ClassType.Create$61.apply($.ClassType, arguments)}
   ,SetTransform$:function($){return $.ClassType.SetTransform.apply($.ClassType, arguments)}
};
/// TG2S3DMeshNode = class (TObject)
var TG2S3DMeshNode = {
   $ClassName:"TG2S3DMeshNode",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.OwnerID = 0;
      $.Name$7 = "";
      $.Transform$2 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      $.SubNodesID = [];
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DMeshMaterial = class (TObject)
var TG2S3DMeshMaterial = {
   $ClassName:"TG2S3DMeshMaterial",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.ChannelCount = 0;
      $.Channels = [];
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DMeshInstSkin = class (TObject)
var TG2S3DMeshInstSkin = {
   $ClassName:"TG2S3DMeshInstSkin",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Transforms = [];
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DFrame = class (TG2S3DNode)
var TG2S3DFrame = {
   $ClassName:"TG2S3DFrame",
   $Parent:TG2S3DNode
   ,$Init:function ($) {
      TG2S3DNode.$Init($);
   }
   /// constructor TG2S3DFrame.Create(const Scene: TG2Scene3D)
   ,Create$61:function(Self, Scene$3) {
      TG2S3DNode.Create$61(Self,Scene$3);
      TG2QuickList$Add$11($Check($Check(Self,"")._Scene$1,"")._Frames,Self);
      return Self
   }
   /// destructor TG2S3DFrame.Destroy()
   ,Destroy:function(Self) {
      TG2QuickList$Remove$8($Check($Check(Self,"")._Scene$1,"")._Frames,Self);
      TG2S3DNode.Destroy(Self);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$61$:function($){return $.ClassType.Create$61.apply($.ClassType, arguments)}
   ,SetTransform:TG2S3DNode.SetTransform
   ,GetAABox$1$:function($){return $.ClassType.GetAABox$1($)}
};
/// TG2S3DMeshInst = class (TG2S3DFrame)
var TG2S3DMeshInst = {
   $ClassName:"TG2S3DMeshInst",
   $Parent:TG2S3DFrame
   ,$Init:function ($) {
      TG2S3DFrame.$Init($);
      $.Materials = [];
      $.Transforms$1 = [];
      $.UserData$1 = [];
      $._AutoComputeTransforms = false;
      $._Mesh = null;
      $._RootNodes = [];
      $._Skins = [];
   }
   /// procedure TG2S3DMeshInst.ComputeSkinTransforms()
   ,ComputeSkinTransforms:function(Self) {
      var i$21 = 0;
      var j$1 = 0;
      var DataSkinned = null;
      var $temp19;
      for(i$21 = 0,$temp19 = $Check($Check(Self,"")._Mesh,"")._GeomCount;i$21<$temp19;i$21++) {
         if ($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,i$21),"").Skinned) {
            DataSkinned = $As($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,i$21),"").Data$1,TG2S3DGeomDataSkinned);
            var $temp20;
            for(j$1 = 0,$temp20 = $Check(DataSkinned,"").BoneCount;j$1<$temp20;j$1++) {
               $DIdxW($Check($DIdxR($Check(Self,"")._Skins,i$21,""),"").Transforms,j$1,G2MatMul($DIdxR($Check(DataSkinned,"").Bones,j$1,"").Bind$5,$DIdxR($Check(Self,"").Transforms$1,$DIdxR($Check(DataSkinned,"").Bones,j$1,"").NodeID$7,"").TransformCom),"");
            }
         }
      }
   }
   /// procedure TG2S3DMeshInst.ComputeTransforms()
   ,ComputeTransforms:function(Self) {
      var i$22 = 0;
      function ComputeNode(NodeID$9) {
         var i$23 = 0;
         if ($Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,NodeID$9),"").OwnerID>(-1)) {
            $DIdxR($Check(Self,"").Transforms$1,NodeID$9,"").TransformCom = G2MatMul($DIdxR($Check(Self,"").Transforms$1,NodeID$9,"").TransformCur,$DIdxR($Check(Self,"").Transforms$1,$Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,NodeID$9),"").OwnerID,"").TransformCom);
         } else {
            Copy$TG2Mat($DIdxR($Check(Self,"").Transforms$1,NodeID$9,"").TransformCur,$DIdxR($Check(Self,"").Transforms$1,NodeID$9,"").TransformCom);
         }
         var $temp21;
         for(i$23 = 0,$temp21 = $Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,NodeID$9),"").SubNodesID.length;i$23<$temp21;i$23++) {
            ComputeNode($DIdxR($Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,NodeID$9),"").SubNodesID,i$23,""));
         }
      };
      var $temp22;
      for(i$22 = 0,$temp22 = $Check(Self,"")._RootNodes.length;i$22<$temp22;i$22++) {
         ComputeNode($DIdxR($Check(Self,"")._RootNodes,i$22,""));
      }
      TG2S3DMeshInst.ComputeSkinTransforms(Self);
   }
   /// constructor TG2S3DMeshInst.Create(const Scene: TG2Scene3D)
   ,Create$61:function(Self, Scene$4) {
      TG2S3DFrame.Create$61(Self,Scene$4);
      $Check(Self,"")._Mesh = null;
      $Check(Self,"")._AutoComputeTransforms = true;
      TG2QuickList$Add$11($Check($Check(Self,"")._Scene$1,"")._MeshInst,Self);
      return Self
   }
   /// destructor TG2S3DMeshInst.Destroy()
   ,Destroy:function(Self) {
      TG2QuickList$Remove$8($Check($Check(Self,"")._Scene$1,"")._MeshInst,Self);
      TG2S3DMeshInst.SetMesh(Self,null);
      TG2S3DFrame.Destroy(Self);
   }
   /// procedure TG2S3DMeshInst.FrameSet(const AnimName: String; const Frame: Single)
   ,FrameSet:function(Self, AnimName$1, Frame) {
      var AnimIndex$1 = 0;
      var i$24 = 0;
      var f0 = 0;
      var f1 = 0;
      var f$1 = 0;
      var s0 = {Arr$2:[0,0,0]};
      var r0 = {Arr$4:[0,0,0,0]};
      var t0 = {Arr$2:[0,0,0]};
      var ms = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var mr$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var mt = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      AnimIndex$1 = TG2S3DMesh.AnimIndex($Check(Self,"")._Mesh,AnimName$1);
      if (AnimIndex$1>(-1)) {
         if (Frame<0) {
            f$1 = ($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").FrameCount$1-(Trunc(Math.abs(Frame))%$Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").FrameCount$1))+Frac(Frame);
         } else {
            f$1 = Frame;
         }
         f0 = Trunc(f$1)%$Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").FrameCount$1;
         f1 = (f0+1)%$Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").FrameCount$1;
         f$1 = Frac(f$1);
         var $temp23;
         for(i$24 = 0,$temp23 = $Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").NodeCount$1;i$24<$temp23;i$24++) {
            s0 = G2LerpVec3($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f0,"").Scaling$1,$DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f1,"").Scaling$1,f$1);
            r0 = G2QuatSlerp($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f0,"").Rotation$2,$DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f1,"").Rotation$2,f$1);
            t0 = G2LerpVec3($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f0,"").Translation$1,$DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").Frames$3,f1,"").Translation$1,f$1);
            ms = G2MatScaling$1(s0);
            mr$1 = G2MatRotation$2(r0);
            mt = G2MatTranslation$1(t0);
            $DIdxR($Check(Self,"").Transforms$1,$DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$1),"").Nodes$1,i$24,"").NodeID$8,"").TransformCur = G2MatMul(G2MatMul(ms,mr$1),mt);
         }
         if ($Check(Self,"")._AutoComputeTransforms) {
            TG2S3DMeshInst.ComputeTransforms(Self);
         }
      }
   }
   /// procedure TG2S3DMeshInst.FrameSetFast(const AnimName: String; const Frame: Integer)
   ,FrameSetFast:function(Self, AnimName$2, Frame$1) {
      var AnimIndex$2 = 0;
      var i$25 = 0;
      var f0$1 = 0;
      var ms$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var mr$2 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var mt$1 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      AnimIndex$2 = TG2S3DMesh.AnimIndex($Check(Self,"")._Mesh,AnimName$2);
      if (AnimIndex$2>(-1)) {
         if (Frame$1<0) {
            f0$1 = $Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").FrameCount$1-(Math.abs(Frame$1)%$Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").FrameCount$1);
         } else {
            f0$1 = Frame$1%$Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").FrameCount$1;
         }
         var $temp24;
         for(i$25 = 0,$temp24 = $Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").NodeCount$1;i$25<$temp24;i$25++) {
            ms$1 = G2MatScaling$1($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").Nodes$1,i$25,"").Frames$3,f0$1,"").Scaling$1);
            mr$2 = G2MatRotation$2($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").Nodes$1,i$25,"").Frames$3,f0$1,"").Rotation$2);
            mt$1 = G2MatTranslation$1($DIdxR($DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").Nodes$1,i$25,"").Frames$3,f0$1,"").Translation$1);
            $DIdxR($Check(Self,"").Transforms$1,$DIdxR($Check(TG2S3DMesh.GetAnim($Check(Self,"")._Mesh,AnimIndex$2),"").Nodes$1,i$25,"").NodeID$8,"").TransformCur = G2MatMul(G2MatMul(ms$1,mr$2),mt$1);
         }
         if ($Check(Self,"")._AutoComputeTransforms) {
            TG2S3DMeshInst.ComputeTransforms(Self);
         }
      }
   }
   /// function TG2S3DMeshInst.GetAABox() : TG2AABox
   ,GetAABox$1:function(Self) {
      return G2BoxToAABox(TG2S3DMeshInst.GetBBox(Self));
   }
   /// function TG2S3DMeshInst.GetBBox() : TG2Box
   ,GetBBox:function(Self) {
      var Result = {c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}};
      var i$26 = 0;
      var b$3 = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      if ($Check($Check(Self,"")._Mesh,"")._GeomCount<1) {
         TG2Box$SetValue$10(Result,G2Vec3(0,0,0),G2Vec3(0,0,0),G2Vec3(0,0,0),G2Vec3(0,0,0));
         return Result;
      }
      b$3 = G2BoxToAABox(TG2S3DMeshInst.GetGeomBBox(Self,0));
      var $temp25;
      for(i$26 = 1,$temp25 = $Check($Check(Self,"")._Mesh,"")._GeomCount;i$26<$temp25;i$26++) {
         TG2AABox$Merge(b$3,G2BoxToAABox(TG2S3DMeshInst.GetGeomBBox(Self,i$26)));
      }
      Result = G2AABoxToBox(b$3);
      return Result
   }
   /// function TG2S3DMeshInst.GetGeomBBox(const Index: Integer) : TG2Box
   ,GetGeomBBox:function(Self, Index$5) {
      var Result = {c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}};
      var DataSkinned$1 = null;
      var i$27 = 0;
      var j$2 = 0;
      var b$4 = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
      if ($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,Index$5),"").Skinned) {
         DataSkinned$1 = $As($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,Index$5),"").Data$1,TG2S3DGeomDataSkinned);
         var $temp26;
         for(i$27 = 0,$temp26 = $Check(DataSkinned$1,"").BoneCount;i$27<$temp26;i$27++) {
            if ($DIdxR($Check(DataSkinned$1,"").Bones,i$27,"").VCount$3>0) {
               b$4 = G2BoxToAABox(TG2Box$Transform$3($DIdxR($Check(DataSkinned$1,"").Bones,i$27,"").BBox$3,$DIdxR($Check($DIdxR($Check(Self,"")._Skins,Index$5,""),"").Transforms,i$27,"")));
               break;
            }
         }
         var $temp27;
         for(j$2 = i$27+1,$temp27 = $Check(DataSkinned$1,"").BoneCount;j$2<$temp27;j$2++) {
            if ($DIdxR($Check(DataSkinned$1,"").Bones,j$2,"").VCount$3>0) {
               TG2AABox$Merge(b$4,G2BoxToAABox(TG2Box$Transform$3($DIdxR($Check(DataSkinned$1,"").Bones,j$2,"").BBox$3,$DIdxR($Check($DIdxR($Check(Self,"")._Skins,Index$5,""),"").Transforms,j$2,""))));
            }
         }
         Result = G2AABoxToBox(b$4);
      } else {
         Result = TG2Box$Transform$3($Check($As($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,Index$5),"").Data$1,TG2S3DGeomDataStatic),"").BBox$1,$DIdxR($Check(Self,"").Transforms$1,$Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,Index$5),"").NodeID,"").TransformCom);
      }
      return Result
   }
   /// function TG2S3DMeshInst.GetSkin(const Index: Integer) : TG2S3DMeshInstSkin
   ,GetSkin:function(Self, Index$6) {
      return $DIdxR($Check(Self,"")._Skins,Index$6,"");
   }
   /// procedure TG2S3DMeshInst.SetMesh(const Value: TG2S3DMesh)
   ,SetMesh:function(Self, Value$4) {
      var i$28 = 0;
      var r$3 = 0;
      if (Value$4===$Check(Self,"")._Mesh) {
         return;
      }
      if ($Check(Self,"")._Mesh!==null) {
         var $temp28;
         for(i$28 = 0,$temp28 = $Check($Check(Self,"")._Mesh,"")._NodeCount;i$28<$temp28;i$28++) {
            TObject.Free($DIdxR($Check(Self,"").UserData$1,i$28,""));
            $DIdxW($Check(Self,"").UserData$1,i$28,null,"");
         }
         TG2QuickList$Remove$8($Check($Check(Self,"")._Mesh,"")._Instances,Self);
      }
      $Check(Self,"")._Mesh = Value$4;
      var $temp29;
      for(i$28 = 0,$temp29 = $Check(Self,"")._Skins.length;i$28<$temp29;i$28++) {
         if ($DIdxR($Check(Self,"")._Skins,i$28,"")!==null) {
            TObject.Free($DIdxR($Check(Self,"")._Skins,i$28,""));
            $DIdxW($Check(Self,"")._Skins,i$28,null,"");
         }
      }
      if ($Check(Self,"")._Mesh!==null) {
         $ArraySetLenC($Check(Self,"").UserData$1,$Check($Check(Self,"")._Mesh,"")._NodeCount,function (){return null});
         var $temp30;
         for(i$28 = 0,$temp30 = $Check($Check(Self,"")._Mesh,"")._NodeCount;i$28<$temp30;i$28++) {
            $DIdxW($Check(Self,"").UserData$1,i$28,null,"");
         }
         $ArraySetLenC($Check(Self,"").Materials,$Check($Check(Self,"")._Mesh,"")._MaterialCount,function (){return null});
         var $temp31;
         for(i$28 = 0,$temp31 = $Check($Check(Self,"")._Mesh,"")._MaterialCount;i$28<$temp31;i$28++) {
            $DIdxW($Check(Self,"").Materials,i$28,TG2S3DMesh.GetMaterial($Check(Self,"")._Mesh,i$28),"");
         }
         $ArraySetLenC($Check(Self,"").Transforms$1,$Check($Check(Self,"")._Mesh,"")._NodeCount,function (){return {TransformDef:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},TransformCur:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},TransformCom:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}}});
         r$3 = 0;
         $ArraySetLen($Check(Self,"")._RootNodes,$Check($Check(Self,"")._Mesh,"")._NodeCount,0);
         var $temp32;
         for(i$28 = 0,$temp32 = $Check($Check(Self,"")._Mesh,"")._NodeCount;i$28<$temp32;i$28++) {
            if ($Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,i$28),"").OwnerID==(-1)) {
               $DIdxW($Check(Self,"")._RootNodes,i$28,i$28,"");
               ++r$3;
            }
            Copy$TG2Mat($Check(TG2S3DMesh.GetNode$1($Check(Self,"")._Mesh,i$28),"").Transform$2,$DIdxR($Check(Self,"").Transforms$1,i$28,"").TransformDef);
            Copy$TG2Mat($DIdxR($Check(Self,"").Transforms$1,i$28,"").TransformDef,$DIdxR($Check(Self,"").Transforms$1,i$28,"").TransformCur);
            $DIdxR($Check(Self,"").Transforms$1,i$28,"").TransformCom = G2MatIdentity();
         }
         $ArraySetLenC($Check(Self,"")._Skins,$Check($Check(Self,"")._Mesh,"")._GeomCount,function (){return null});
         var $temp33;
         for(i$28 = 0,$temp33 = $Check($Check(Self,"")._Mesh,"")._GeomCount;i$28<$temp33;i$28++) {
            if ($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,i$28),"").Skinned) {
               $DIdxW($Check(Self,"")._Skins,i$28,TObject.Create($New(TG2S3DMeshInstSkin)),"");
               $ArraySetLenC($Check($DIdxR($Check(Self,"")._Skins,i$28,""),"").Transforms,$Check($As($Check(TG2S3DMesh.GetGeom($Check(Self,"")._Mesh,i$28),"").Data$1,TG2S3DGeomDataSkinned),"").BoneCount,function (){return {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}});
            }
         }
         if (r$3<$Check(Self,"")._RootNodes.length) {
            $ArraySetLen($Check(Self,"")._RootNodes,r$3,0);
         }
         TG2S3DMeshInst.ComputeTransforms(Self);
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$61$:function($){return $.ClassType.Create$61.apply($.ClassType, arguments)}
   ,SetTransform:TG2S3DNode.SetTransform
   ,GetAABox$1$:function($){return $.ClassType.GetAABox$1($)}
};
/// TG2S3DMeshGeom = class (TObject)
var TG2S3DMeshGeom = {
   $ClassName:"TG2S3DMeshGeom",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Data$1 = $.IB = null;
      $.Decl = [];
      $.FCount = $.GCount = $.NodeID = $.TCount = $.VCount = 0;
      $.Groups = [];
      $.Skinned = $.Visible$2 = false;
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DMeshAnim = class (TObject)
var TG2S3DMeshAnim = {
   $ClassName:"TG2S3DMeshAnim",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Name$8 = "";
      $.FrameRate = $.FrameCount$1 = $.NodeCount$1 = 0;
      $.Nodes$1 = [];
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DMesh = class (TG2ResourceAsync)
var TG2S3DMesh = {
   $ClassName:"TG2S3DMesh",
   $Parent:TG2ResourceAsync
   ,$Init:function ($) {
      TG2ResourceAsync.$Init($);
      $._AnimCount = $._GeomCount = $._MaterialCount = $._NodeCount = 0;
      $._Anims = [];
      $._DataManager = $._Scene$2 = null;
      $._Geoms = [];
      $._Instances = {_ItemCount$5:0,_Items$5:[]};
      $._Loaded = false;
      $._Materials = [];
      $._Nodes$1 = [];
   }
   /// function TG2S3DMesh.AnimIndex(const Name: String) : Integer
   ,AnimIndex:function(Self, Name$13) {
      var Result = 0;
      var i$29 = 0;
      var $temp34;
      for(i$29 = 0,$temp34 = $Check(Self,"")._AnimCount;i$29<$temp34;i$29++) {
         if ($Check($DIdxR($Check(Self,"")._Anims,i$29,""),"").Name$8==Name$13) {
            Result = i$29;
            return Result;
         }
      }
      Result = -1;
      return Result
   }
   /// constructor TG2S3DMesh.Create(const Scene: TG2Scene3D)
   ,Create$64:function(Self, Scene$5) {
      TG2ResourceAsync.Create$48(Self);
      $Check(Self,"")._Loaded = false;
      $Check(Self,"")._NodeCount = 0;
      $Check(Self,"")._GeomCount = 0;
      $Check(Self,"")._AnimCount = 0;
      $Check(Self,"")._MaterialCount = 0;
      TG2QuickList$Clear$10($Check(Self,"")._Instances);
      $Check(Self,"")._Scene$2 = Scene$5;
      TG2QuickList$Add$11($Check($Check(Self,"")._Scene$2,"")._Meshes,Self);
      $Check(Self,"")._DataManager = TG2Resource.Create$48$($New(TG2DataManager));
      TG2Resource.SetParent($Check(Self,"")._DataManager,Self);
      $Check($Check(Self,"")._DataManager,"")._OnLoadProc$2 = $Event0(Self,TG2S3DMesh.OnLoad$2);
      return Self
   }
   /// destructor TG2S3DMesh.Destroy()
   ,Destroy:function(Self) {
      TObject.Free($Check(Self,"")._DataManager);
      TG2QuickList$Remove$8($Check($Check(Self,"")._Scene$2,"")._Meshes,Self);
      TG2S3DMesh.Release$3(Self);
      TG2Resource.Destroy(Self);
   }
   /// function TG2S3DMesh.GetAnim(const Index: Integer) : TG2S3DMeshAnim
   ,GetAnim:function(Self, Index$7) {
      return $DIdxR($Check(Self,"")._Anims,Index$7,"");
   }
   /// function TG2S3DMesh.GetGeom(const Index: Integer) : TG2S3DMeshGeom
   ,GetGeom:function(Self, Index$8) {
      return $DIdxR($Check(Self,"")._Geoms,Index$8,"");
   }
   /// function TG2S3DMesh.GetMaterial(const Index: Integer) : TG2S3DMeshMaterial
   ,GetMaterial:function(Self, Index$9) {
      return $DIdxR($Check(Self,"")._Materials,Index$9,"");
   }
   /// function TG2S3DMesh.GetNode(const Index: Integer) : TG2S3DMeshNode
   ,GetNode$1:function(Self, Index$10) {
      return $DIdxR($Check(Self,"")._Nodes$1,Index$10,"");
   }
   /// procedure TG2S3DMesh.Load(const FileName: String)
   ,Load$2:function(Self, FileName$1) {
      TG2DataManager.Load$5($Check(Self,"")._DataManager,FileName$1);
      $Check(Self,"")._State = 1;
      $Check(g2,"")._LoadingItems+=1;
   }
   /// procedure TG2S3DMesh.LoadData(const MeshData: TG2MeshData)
   ,LoadData:function(Self, MeshData) {
      var i$30 = 0;
      var j$3 = 0;
      var n$6 = 0;
      var OffsetVertex = 0;
      var OffsetTexCoords = 0;
      var OffsetBlendIndices = 0;
      var OffsetBlendWeights = 0;
      var DataStatic = null;
      var DataSkinned$2 = null;
      var MinV$3 = {Arr$2:[0,0,0]};
      var MaxV$3 = {Arr$2:[0,0,0]};
      var v$6 = {Arr$2:[0,0,0]};
      $Check(Self,"")._NodeCount = $Check(MeshData,"").NodeCount$3;
      $ArraySetLenC($Check(Self,"")._Nodes$1,$Check(Self,"")._NodeCount,function (){return null});
      var $temp35;
      for(i$30 = 0,$temp35 = $Check(Self,"")._NodeCount;i$30<$temp35;i$30++) {
         $DIdxW($Check(Self,"")._Nodes$1,i$30,TObject.Create($New(TG2S3DMeshNode)),"");
         $Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").Name$7 = $DIdxR($Check(MeshData,"").Nodes$3,i$30,"").Name$9;
         $Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID = $DIdxR($Check(MeshData,"").Nodes$3,i$30,"").OwnerID$1;
         Copy$TG2Mat($DIdxR($Check(MeshData,"").Nodes$3,i$30,"").Transform$5,$Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").Transform$2);
         $Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").SubNodesID.length=0;
      }
      var $temp36;
      for(i$30 = 0,$temp36 = $Check(Self,"")._NodeCount;i$30<$temp36;i$30++) {
         if ($Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID>(-1)) {
            $ArraySetLen($Check($DIdxR($Check(Self,"")._Nodes$1,$Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID,""),"").SubNodesID,($Check($DIdxR($Check(Self,"")._Nodes$1,$Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID,""),"").SubNodesID.length+1),0);
            $DIdxW($Check($DIdxR($Check(Self,"")._Nodes$1,$Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID,""),"").SubNodesID,($Check($DIdxR($Check(Self,"")._Nodes$1,$Check($DIdxR($Check(Self,"")._Nodes$1,i$30,""),"").OwnerID,""),"").SubNodesID.length-1),i$30,"");
         }
      }
      $Check(Self,"")._GeomCount = $Check(MeshData,"").GeomCount$1;
      $ArraySetLenC($Check(Self,"")._Geoms,$Check(Self,"")._GeomCount,function (){return null});
      var $temp37;
      for(i$30 = 0,$temp37 = $Check(Self,"")._GeomCount;i$30<$temp37;i$30++) {
         $DIdxW($Check(Self,"")._Geoms,i$30,TObject.Create($New(TG2S3DMeshGeom)),"");
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").NodeID = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").NodeID$3;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").VCount = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").VCount$1;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").FCount = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").FCount$1;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").GCount = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").MCount;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").TCount$1;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Visible$2 = true;
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Skinned = $DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID>(-1);
         $ArraySetLenC($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,(5+$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount),function (){return {Element:0,Count$4:0}});
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,0,"").Element = 1;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,0,"").Count$4 = 3;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,1,"").Element = 2;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,1,"").Count$4 = 4;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,2,"").Element = 3;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,2,"").Count$4 = 3;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,3,"").Element = 4;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,3,"").Count$4 = 3;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,4,"").Element = 5;
         $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,4,"").Count$4 = 3;
         var $temp38;
         for(j$3 = 5,$temp38 = (5+$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount);j$3<$temp38;j$3++) {
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,j$3,"").Element = 6;
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,j$3,"").Count$4 = 2;
         }
         if ($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Skinned) {
            DataSkinned$2 = TObject.Create($New(TG2S3DGeomDataSkinned));
            $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Data$1 = DataSkinned$2;
            $Check(DataSkinned$2,"").MaxWeights = $DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").MaxWeights$1;
            $Check(DataSkinned$2,"").BoneCount = $DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").BoneCount$1;
            $ArraySetLenC($Check(DataSkinned$2,"").Bones,$Check(DataSkinned$2,"").BoneCount,function (){return {NodeID$7:0,Bind$5:{Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},BBox$3:{c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}},VCount$3:0}});
            var $temp39;
            for(j$3 = 0,$temp39 = $Check(DataSkinned$2,"").BoneCount;j$3<$temp39;j$3++) {
               $DIdxR($Check(DataSkinned$2,"").Bones,j$3,"").NodeID$7 = $DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Bones$1,j$3,"").NodeID$4;
               Copy$TG2Mat($DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Bones$1,j$3,"").Bind$4,$DIdxR($Check(DataSkinned$2,"").Bones,j$3,"").Bind$5);
               Copy$TG2Box($DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Bones$1,j$3,"").BBox$2,$DIdxR($Check(DataSkinned$2,"").Bones,j$3,"").BBox$3);
               $DIdxR($Check(DataSkinned$2,"").Bones,j$3,"").VCount$3 = $DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Bones$1,j$3,"").VCount$2;
            }
            n$6 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl.length;
            if ($Check(DataSkinned$2,"").MaxWeights==1) {
               $ArraySetLenC($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl.length+1),function (){return {Element:0,Count$4:0}});
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Element = 8;
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Count$4 = 1;
            } else {
               $ArraySetLenC($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl.length+($Check(DataSkinned$2,"").MaxWeights*2)),function (){return {Element:0,Count$4:0}});
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Element = 8;
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Count$4 = $Check(DataSkinned$2,"").MaxWeights;
               ++n$6;
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Element = 7;
               $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,n$6,"").Count$4 = $Check(DataSkinned$2,"").MaxWeights;
            }
            $Check(DataSkinned$2,"").VB$2 = TG2Resource.Create$48$($New(TG2VertexBuffer));
            TG2VertexBuffer.Initialize$1($Check(DataSkinned$2,"").VB$2,$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").VCount);
            TG2VertexBuffer.Lock($Check(DataSkinned$2,"").VB$2,2);
            var $temp40;
            for(j$3 = 0,$temp40 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").VCount;j$3<$temp40;j$3++) {
               OffsetVertex = $Check($Check(DataSkinned$2,"").VB$2,"")._VertexSize*j$3;
               OffsetTexCoords = OffsetVertex+64;
               OffsetBlendIndices = OffsetTexCoords+($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount*8);
               OffsetBlendWeights = OffsetBlendIndices+($Check(DataSkinned$2,"").MaxWeights*4);
               $Check($Check(DataSkinned$2,"").VB$2,"")._Position = OffsetVertex;
               TG2VertexBuffer.WriteVec3($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3);
               TG2VertexBuffer.WriteVec4($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Color$4);
               TG2VertexBuffer.WriteVec3($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Normal);
               TG2VertexBuffer.WriteVec3($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Tangent);
               TG2VertexBuffer.WriteVec3($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Binormal);
               $Check($Check(DataSkinned$2,"").VB$2,"")._Position = OffsetTexCoords;
               var $temp41;
               for(n$6 = 0,$temp41 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount;n$6<$temp41;n$6++) {
                  TG2VertexBuffer.WriteVec2($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").TexCoords,n$6,""));
               }
               if ($Check(DataSkinned$2,"").MaxWeights==1) {
                  TG2VertexBuffer.WriteFloat32($Check(DataSkinned$2,"").VB$2,($DIdxR($DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Vertices$1,j$3,"").Weights,0,"").BoneID));
               } else {
                  var $temp42;
                  for(n$6 = 0,$temp42 = $Check(DataSkinned$2,"").MaxWeights;n$6<$temp42;n$6++) {
                     $Check($Check(DataSkinned$2,"").VB$2,"")._Position = OffsetBlendIndices;
                     TG2VertexBuffer.WriteFloat32($Check(DataSkinned$2,"").VB$2,($DIdxR($DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Vertices$1,j$3,"").Weights,n$6,"").BoneID));
                     OffsetBlendIndices+=4;
                     $Check($Check(DataSkinned$2,"").VB$2,"")._Position = OffsetBlendWeights;
                     TG2VertexBuffer.WriteFloat32($Check(DataSkinned$2,"").VB$2,$DIdxR($DIdxR($DIdxR($Check(MeshData,"").Skins$1,$DIdxR($Check(MeshData,"").Geoms$1,i$30,"").SkinID,"").Vertices$1,j$3,"").Weights,n$6,"").Weight$1);
                     OffsetBlendWeights+=4;
                  }
               }
            }
            TG2VertexBuffer.UnLock($Check(DataSkinned$2,"").VB$2);
         } else {
            DataStatic = TObject.Create($New(TG2S3DGeomDataStatic));
            $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Data$1 = DataStatic;
            $Check(DataStatic,"").VB$1 = TG2Resource.Create$48$($New(TG2VertexBuffer));
            TG2VertexBuffer.Initialize$1($Check(DataStatic,"").VB$1,$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Decl,$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").VCount);
            TG2VertexBuffer.Lock($Check(DataStatic,"").VB$1,2);
            Copy$TG2Vec3($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,0,"").Position$3,MinV$3);
            Copy$TG2Vec3(MinV$3,MaxV$3);
            var $temp43;
            for(j$3 = 0,$temp43 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").VCount;j$3<$temp43;j$3++) {
               OffsetVertex = $Check($Check(DataStatic,"").VB$1,"")._VertexSize*j$3;
               OffsetTexCoords = OffsetVertex+64;
               $Check($Check(DataStatic,"").VB$1,"")._Position = OffsetVertex;
               TG2VertexBuffer.WriteVec3($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3);
               TG2VertexBuffer.WriteVec4($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Color$4);
               TG2VertexBuffer.WriteVec3($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Normal);
               TG2VertexBuffer.WriteVec3($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Tangent);
               TG2VertexBuffer.WriteVec3($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Binormal);
               $Check($Check(DataStatic,"").VB$1,"")._Position = OffsetTexCoords;
               var $temp44;
               for(n$6 = 0,$temp44 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").TCount;n$6<$temp44;n$6++) {
                  TG2VertexBuffer.WriteVec2($Check(DataStatic,"").VB$1,$DIdxR($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").TexCoords,n$6,""));
               }
               if (TG2Vec3$GetX$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)>TG2Vec3$GetX$1(MaxV$3)) {
                  TG2Vec3$SetX$1(MaxV$3,TG2Vec3$GetX$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               } else if (TG2Vec3$GetX$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)<TG2Vec3$GetX$1(MinV$3)) {
                  TG2Vec3$SetX$1(MinV$3,TG2Vec3$GetX$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               }
               if (TG2Vec3$GetY$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)>TG2Vec3$GetY$1(MaxV$3)) {
                  TG2Vec3$SetY$1(MaxV$3,TG2Vec3$GetY$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               } else if (TG2Vec3$GetY$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)<TG2Vec3$GetY$1(MinV$3)) {
                  TG2Vec3$SetY$1(MinV$3,TG2Vec3$GetY$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               }
               if (TG2Vec3$GetZ$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)>TG2Vec3$GetZ$1(MaxV$3)) {
                  TG2Vec3$SetZ$1(MaxV$3,TG2Vec3$GetZ$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               } else if (TG2Vec3$GetZ$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3)<TG2Vec3$GetZ$1(MinV$3)) {
                  TG2Vec3$SetZ$1(MinV$3,TG2Vec3$GetZ$1($DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Vertices,j$3,"").Position$3));
               }
            }
            TG2VertexBuffer.UnLock($Check(DataStatic,"").VB$1);
            $Check(DataStatic,"").BBox$1.c$3 = G2Vec3FloatMul(G2Vec3Add(MinV$3,MaxV$3),0.5);
            v$6 = G2Vec3FloatMul(G2Vec3Sub(MaxV$3,MinV$3),0.5);
            TG2Vec3$SetValue$1($Check(DataStatic,"").BBox$1.vx,TG2Vec3$GetX$1(v$6),0,0);
            TG2Vec3$SetValue$1($Check(DataStatic,"").BBox$1.vy,0,TG2Vec3$GetY$1(v$6),0);
            TG2Vec3$SetValue$1($Check(DataStatic,"").BBox$1.vz,0,0,TG2Vec3$GetZ$1(v$6));
         }
         $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB = TG2Resource.Create$48$($New(TG2IndexBuffer));
         TG2IndexBuffer.Initialize$2($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB,($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").FCount*3));
         TG2IndexBuffer.Lock$1($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB,2);
         var $temp45;
         for(j$3 = 0,$temp45 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").FCount;j$3<$temp45;j$3++) {
            TG2IndexBuffer.WriteIntU16($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Faces,j$3,"")[0]);
            TG2IndexBuffer.WriteIntU16($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Faces,j$3,"")[1]);
            TG2IndexBuffer.WriteIntU16($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB,$DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Faces,j$3,"")[2]);
         }
         TG2IndexBuffer.UnLock$1($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").IB);
         $ArraySetLenC($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,$Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").GCount,function (){return {Material:0,VertexStart$1:0,VertexCount$2:0,FaceStart$1:0,FaceCount$1:0}});
         var $temp46;
         for(j$3 = 0,$temp46 = $Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").GCount;j$3<$temp46;j$3++) {
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,j$3,"").Material = $DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Groups$1,j$3,"").MaterialID;
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,j$3,"").VertexStart$1 = $DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Groups$1,j$3,"").VertexStart;
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,j$3,"").VertexCount$2 = $DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Groups$1,j$3,"").VertexCount$1;
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,j$3,"").FaceStart$1 = $DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Groups$1,j$3,"").FaceStart;
            $DIdxR($Check($DIdxR($Check(Self,"")._Geoms,i$30,""),"").Groups,j$3,"").FaceCount$1 = $DIdxR($DIdxR($Check(MeshData,"").Geoms$1,i$30,"").Groups$1,j$3,"").FaceCount;
         }
      }
      $Check(Self,"")._MaterialCount = $Check(MeshData,"").MaterialCount$1;
      $ArraySetLenC($Check(Self,"")._Materials,$Check(Self,"")._MaterialCount,function (){return null});
      var $temp47;
      for(i$30 = 0,$temp47 = $Check(Self,"")._MaterialCount;i$30<$temp47;i$30++) {
         $DIdxW($Check(Self,"")._Materials,i$30,TObject.Create($New(TG2S3DMeshMaterial)),"");
         $Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").ChannelCount = $DIdxR($Check(MeshData,"").Materials$2,i$30,"").ChannelCount$1;
         $ArraySetLenC($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,$Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").ChannelCount,function (){return {Name$12:"",TwoSided$1:false,MapDiffuse:null,MapLight:null}});
         var $temp48;
         for(j$3 = 0,$temp48 = $Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").ChannelCount;j$3<$temp48;j$3++) {
            $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").Name$12 = $DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").Name$11;
            $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").TwoSided$1 = $DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").TwoSided;
            if ($DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").DiffuseMap.length>0) {
               $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").MapDiffuse = TG2Scene3D.FindTexture($Check(Self,"")._Scene$2,$DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").DiffuseMap,2);
            } else {
               $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").MapDiffuse = null;
            }
            if ($DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").LightMap.length>0) {
               $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").MapLight = TG2Scene3D.FindTexture($Check(Self,"")._Scene$2,$DIdxR($DIdxR($Check(MeshData,"").Materials$2,i$30,"").Channels$1,j$3,"").LightMap,0);
            } else {
               $DIdxR($Check($DIdxR($Check(Self,"")._Materials,i$30,""),"").Channels,j$3,"").MapLight = null;
            }
         }
      }
      $Check(Self,"")._AnimCount = $Check(MeshData,"").AnimCount$1;
      $ArraySetLenC($Check(Self,"")._Anims,$Check(Self,"")._AnimCount,function (){return null});
      var $temp49;
      for(i$30 = 0,$temp49 = $Check(Self,"")._AnimCount;i$30<$temp49;i$30++) {
         $DIdxW($Check(Self,"")._Anims,i$30,TObject.Create($New(TG2S3DMeshAnim)),"");
         $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Name$8 = $DIdxR($Check(MeshData,"").Anims$1,i$30,"").Name$10;
         $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").FrameCount$1 = $DIdxR($Check(MeshData,"").Anims$1,i$30,"").FrameCount$2;
         $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").FrameRate = $DIdxR($Check(MeshData,"").Anims$1,i$30,"").FrameRate$1;
         $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").NodeCount$1 = $DIdxR($Check(MeshData,"").Anims$1,i$30,"").NodeCount$4;
         $ArraySetLenC($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,$Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").NodeCount$1,function (){return {NodeID$8:0,Frames$3:[]}});
         var $temp50;
         for(j$3 = 0,$temp50 = $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").NodeCount$1;j$3<$temp50;j$3++) {
            $DIdxR($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,j$3,"").NodeID$8 = $DIdxR($DIdxR($Check(MeshData,"").Anims$1,i$30,"").Nodes$4,j$3,"").NodeID$5;
            $ArraySetLenC($DIdxR($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,j$3,"").Frames$3,$Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").FrameCount$1,function (){return {Scaling$1:{Arr$2:[0,0,0]},Rotation$2:{Arr$4:[0,0,0,0]},Translation$1:{Arr$2:[0,0,0]}}});
            var $temp51;
            for(n$6 = 0,$temp51 = $Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").FrameCount$1;n$6<$temp51;n$6++) {
               Copy$TG2Vec3($DIdxR($DIdxR($DIdxR($Check(MeshData,"").Anims$1,i$30,"").Nodes$4,j$3,"").Frames$2,n$6,"").Scaling,$DIdxR($DIdxR($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,j$3,"").Frames$3,n$6,"").Scaling$1);
               Copy$TG2Quat($DIdxR($DIdxR($DIdxR($Check(MeshData,"").Anims$1,i$30,"").Nodes$4,j$3,"").Frames$2,n$6,"").Rotation$1,$DIdxR($DIdxR($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,j$3,"").Frames$3,n$6,"").Rotation$2);
               Copy$TG2Vec3($DIdxR($DIdxR($DIdxR($Check(MeshData,"").Anims$1,i$30,"").Nodes$4,j$3,"").Frames$2,n$6,"").Translation,$DIdxR($DIdxR($Check($DIdxR($Check(Self,"")._Anims,i$30,""),"").Nodes$1,j$3,"").Frames$3,n$6,"").Translation$1);
            }
         }
      }
      $Check(Self,"")._Loaded = true;
   }
   /// function TG2S3DMesh.NewInst() : TG2S3DMeshInst
   ,NewInst:function(Self) {
      var Result = null;
      Result = TG2S3DNode.Create$61$($New(TG2S3DMeshInst),$Check(Self,"")._Scene$2);
      TG2S3DMeshInst.SetMesh(Result,Self);
      return Result
   }
   /// procedure TG2S3DMesh.OnLoad()
   ,OnLoad$2:function(Self) {
      var i$31 = 0;
      var MeshLoader = null;
      var MeshData$1 = null;
      $Check(g2,"")._LoadingItems-=1;
      MeshLoader = null;
      var $temp52;
      for(i$31 = 0,$temp52 = G2MeshLoaders.length;i$31<$temp52;i$31++) {
         if (TG2MeshLoader.CanLoad$($Check($DIdxR(G2MeshLoaders,i$31,""),""),$Check(Self,"")._DataManager)) {
            MeshLoader = TG2MeshLoader.Create$73($NewDyn($DIdxR(G2MeshLoaders,i$31,""),""));
            break;
         }
      }
      if (MeshLoader===null) {
         $Check(Self,"")._State = 3;
         return;
      }
      TG2MeshLoader.Load$4$($Check(MeshLoader,""),$Check(Self,"")._DataManager);
      MeshData$1 = TG2MeshLoader.ExportMeshData$($Check(MeshLoader,""));
      TG2S3DMesh.LoadData(Self,MeshData$1);
      TObject.Free(MeshData$1);
      $Check(Self,"")._Loaded = true;
      $Check(Self,"")._State = 2;
   }
   /// procedure TG2S3DMesh.Release()
   ,Release$3:function(Self) {
      var i$32 = 0;
      if ($Check(Self,"")._Loaded) {
         while ($Check(Self,"")._Instances._ItemCount$5>0) {
            TObject.Free($As(TG2QuickList$Pop$5($Check(Self,"")._Instances),TG2S3DMeshInst))         }
         var $temp53;
         for(i$32 = 0,$temp53 = $Check(Self,"")._GeomCount;i$32<$temp53;i$32++) {
            TObject.Free($Check($DIdxR($Check(Self,"")._Geoms,i$32,""),"").IB);
            if ($Check($DIdxR($Check(Self,"")._Geoms,i$32,""),"").Skinned) {
               TObject.Free($As($Check($DIdxR($Check(Self,"")._Geoms,i$32,""),"").Data$1,TG2S3DGeomDataSkinned));
            } else {
               TObject.Free($Check($As($Check($DIdxR($Check(Self,"")._Geoms,i$32,""),"").Data$1,TG2S3DGeomDataStatic),"").VB$1);
               TObject.Free($As($Check($DIdxR($Check(Self,"")._Geoms,i$32,""),"").Data$1,TG2S3DGeomDataStatic));
            }
         }
         $Check(Self,"")._Loaded = false;
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48:TG2ResourceAsync.Create$48
};
/// TG2S3DGeomData = class (TObject)
var TG2S3DGeomData = {
   $ClassName:"TG2S3DGeomData",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DGeomDataStatic = class (TG2S3DGeomData)
var TG2S3DGeomDataStatic = {
   $ClassName:"TG2S3DGeomDataStatic",
   $Parent:TG2S3DGeomData
   ,$Init:function ($) {
      TG2S3DGeomData.$Init($);
      $.BBox$1 = {c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}};
      $.VB$1 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2S3DGeomDataSkinned = class (TG2S3DGeomData)
var TG2S3DGeomDataSkinned = {
   $ClassName:"TG2S3DGeomDataSkinned",
   $Parent:TG2S3DGeomData
   ,$Init:function ($) {
      TG2S3DGeomData.$Init($);
      $.MaxWeights = $.BoneCount = 0;
      $.Bones = [];
      $.VB$2 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2RenderControl = class (TG2Resource)
var TG2RenderControl = {
   $ClassName:"TG2RenderControl",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._gl$4 = null;
   }
   /// constructor TG2RenderControl.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._gl$4 = $Check($Check(g2,"")._Gfx,"").gl$1;
      return Self
   }
   /// procedure TG2RenderControl.RenderStart()
   ,RenderStart:function(Self) {
      /* null */
   }
   /// procedure TG2RenderControl.RenderStop()
   ,RenderStop:function(Self) {
      /* null */
   }
   ,Destroy:TG2Resource.Destroy
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,RenderStart$:function($){return $.ClassType.RenderStart($)}
   ,RenderStop$:function($){return $.ClassType.RenderStop($)}
};
/// TG2RenderControlPrim2D = class (TG2RenderControl)
var TG2RenderControlPrim2D = {
   $ClassName:"TG2RenderControlPrim2D",
   $Parent:TG2RenderControl
   ,$Init:function ($) {
      TG2RenderControl.$Init($);
      $._ArrColors = [];
      $._ArrPositions = [];
      $._AttribColor = 0;
      $._AttribPosition = 0;
      $._BufferColors = $._BufferPositions = $._Shader$1 = $._UniformWVP$1 = null;
      $._CurBlendMode$1 = 0;
      $._CurPoint = $._MaxPoints = 0;
      $._CurPrimType = 0;
   }
   /// constructor TG2RenderControlPrim2D.Create()
   ,Create$48:function(Self) {
      TG2RenderControl.Create$48(Self);
      $Check(Self,"")._Shader$1 = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2ShaderProgram.Compile($Check(Self,"")._Shader$1,"\r\n    uniform mat4 WVP;\r\n    attribute vec3 a_Position0;\r\n    attribute vec4 a_Color0;\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      gl_Position = vec4(a_Position0, 1) * WVP;\r\n      v_Color = a_Color0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    varying vec4 v_Color;\r\n    void main () {\r\n      gl_FragColor = v_Color;\r\n    }\r\n  ");
      TG2Resource.SetParent($Check(Self,"")._Shader$1,Self);
      $Check(Self,"")._AttribPosition = TG2ShaderProgram.GetShaderAttribute($Check(Self,"")._Shader$1,"a_Position0");
      $Check(Self,"")._AttribColor = TG2ShaderProgram.GetShaderAttribute($Check(Self,"")._Shader$1,"a_Color0");
      $Check(Self,"")._UniformWVP$1 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader$1,"WVP");
      $Check(Self,"")._MaxPoints = 2048;
      $Check(Self,"")._BufferPositions = $Check(Self,"")._gl$4.createBuffer();
      $Check(Self,"")._BufferColors = $Check(Self,"")._gl$4.createBuffer();
      return Self
   }
   /// destructor TG2RenderControlPrim2D.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"")._gl$4.deleteBuffer($Check(Self,"")._BufferPositions);
      $Check(Self,"")._gl$4.deleteBuffer($Check(Self,"")._BufferColors);
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2RenderControlPrim2D.Flush()
   ,Flush:function(Self) {
      var VertsPositions = null;
      var VertsColors = null;
      
    VertsPositions = new Float32Array(Self._ArrPositions);
    VertsColors = new Float32Array(Self._ArrColors);
  $Check(Self,"")._gl$4.bindBuffer(34962,$Check(Self,"")._BufferPositions);
      $Check(Self,"")._gl$4.bufferData(34962,VertsPositions,35048);
      $Check(Self,"")._gl$4.vertexAttribPointer($Check(Self,"")._AttribPosition,3,5126,false,0,0);
      $Check(Self,"")._gl$4.bindBuffer(34962,$Check(Self,"")._BufferColors);
      $Check(Self,"")._gl$4.bufferData(34962,VertsColors,35048);
      $Check(Self,"")._gl$4.vertexAttribPointer($Check(Self,"")._AttribColor,4,5126,false,0,0);
      switch ($Check(Self,"")._CurPrimType) {
         case 1 :
            $Check(Self,"")._gl$4.drawArrays(1,0,$Check(Self,"")._CurPoint);
            break;
         case 2 :
            $Check(Self,"")._gl$4.drawArrays(4,0,$Check(Self,"")._CurPoint);
            break;
      }
      $Check(Self,"")._CurPoint = 0;
      $Check(Self,"")._ArrPositions.length=0;
      $Check(Self,"")._ArrColors.length=0;
   }
   /// procedure TG2RenderControlPrim2D.PrimAdd(const Position: TG2Vec2; const Color: TG2Vec4)
   ,PrimAdd:function(Self, Position$4, Color$5) {
      var i$33 = 0;
      if (((($Check(Self,"")._CurPrimType==1)&&(($Check(Self,"")._MaxPoints-$Check(Self,"")._CurPoint)<4))&&(($Check(Self,"")._CurPoint%2)==0))||((($Check(Self,"")._CurPrimType==2)&&(($Check(Self,"")._MaxPoints-$Check(Self,"")._CurPoint)<6))&&(($Check(Self,"")._CurPoint%3)==0))) {
         TG2RenderControlPrim2D.Flush(Self);
      }
      i$33 = $Check(Self,"")._CurPoint*3;
      $DIdxW($Check(Self,"")._ArrPositions,i$33+0,TG2Vec2$GetX$2(Position$4),"");
      $DIdxW($Check(Self,"")._ArrPositions,i$33+1,TG2Vec2$GetY$2(Position$4),"");
      $DIdxW($Check(Self,"")._ArrPositions,i$33+2,0,"");
      i$33 = $Check(Self,"")._CurPoint*4;
      $DIdxW($Check(Self,"")._ArrColors,i$33+0,TG2Vec4$GetX(Color$5),"");
      $DIdxW($Check(Self,"")._ArrColors,i$33+1,TG2Vec4$GetY(Color$5),"");
      $DIdxW($Check(Self,"")._ArrColors,i$33+2,TG2Vec4$GetZ(Color$5),"");
      $DIdxW($Check(Self,"")._ArrColors,i$33+3,TG2Vec4$GetW(Color$5),"");
      $Check(Self,"")._CurPoint+=1;
   }
   /// procedure TG2RenderControlPrim2D.PrimBegin(const PrimType: TG2Prim2DType; const BlendMode: TG2BlendMode)
   ,PrimBegin:function(Self, PrimType, BlendMode$2) {
      if (!$Check(Self,"")._CurPoint) {
         $Check(Self,"")._CurPrimType = PrimType;
         $Check(Self,"")._CurBlendMode$1 = BlendMode$2;
         TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,$Check(Self,"")._CurBlendMode$1);
      } else if (((($Check(Self,"")._CurPrimType!=PrimType)||($Check(Self,"")._CurBlendMode$1!=BlendMode$2))||((($Check(Self,"")._CurPrimType==1)&&(($Check(Self,"")._MaxPoints-$Check(Self,"")._CurPoint)<4))&&(($Check(Self,"")._CurPoint%2)==0)))||((($Check(Self,"")._CurPrimType==2)&&(($Check(Self,"")._MaxPoints-$Check(Self,"")._CurPoint)<6))&&(($Check(Self,"")._CurPoint%3)==0))) {
         TG2RenderControlPrim2D.Flush(Self);
         $Check(Self,"")._CurPrimType = PrimType;
         $Check(Self,"")._CurBlendMode$1 = BlendMode$2;
         TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,$Check(Self,"")._CurBlendMode$1);
      }
   }
   /// procedure TG2RenderControlPrim2D.PrimEnd()
   ,PrimEnd:function(Self) {
      if ($Check(Self,"")._CurPoint>0) {
         TG2RenderControlPrim2D.Flush(Self);
      }
   }
   /// procedure TG2RenderControlPrim2D.PrimQuadCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const BlendMode: TG2BlendMode)
   ,PrimQuadCol:function(Self, Pos0$1, Pos1$1, Pos2, Pos3, Col0, Col1, Col2, Col3, BlendMode$3) {
      TG2RenderControlPrim2D.PrimBegin(Self,2,BlendMode$3);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos0$1,Col0);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos1$1,Col1);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos2,Col2);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos2,Col2);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos1$1,Col1);
      TG2RenderControlPrim2D.PrimAdd(Self,Pos3,Col3);
   }
   /// procedure TG2RenderControlPrim2D.RenderStart()
   ,RenderStart:function(Self) {
      var WVP$2 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2ShaderProgram.Use($Check(Self,"")._Shader$1);
      if ($Check($Check(g2,"")._Gfx,"")._RenderTarget===null) {
         WVP$2 = G2MatOrth2D((TG2Params.GetWidth$2($Check(g2,"")._Params)),(TG2Params.GetHeight$2($Check(g2,"")._Params)),0,1,false,true);
      } else {
         WVP$2 = G2MatOrth2D(($Check($Check($Check(g2,"")._Gfx,"")._RenderTarget,"")._Width),($Check($Check($Check(g2,"")._Gfx,"")._RenderTarget,"")._Height),0,1,false,false);
      }
      WVP$2 = G2MatTranspose(WVP$2);
      $Check($Check(g2,"")._Gfx,"").gl$1.uniformMatrix4fv($Check(Self,"")._UniformWVP$1,false,TG2Mat$ToFloat32Array$4(WVP$2));
      $Check($Check(g2,"")._Gfx,"").gl$1.enableVertexAttribArray($Check(Self,"")._AttribPosition);
      $Check($Check(g2,"")._Gfx,"").gl$1.enableVertexAttribArray($Check(Self,"")._AttribColor);
      $Check(Self,"")._CurPoint = 0;
      $Check(Self,"")._CurPrimType = 0;
      $Check(Self,"")._CurBlendMode$1 = 0;
      $Check(Self,"")._ArrPositions.length=0;
      $Check(Self,"")._ArrColors.length=0;
   }
   /// procedure TG2RenderControlPrim2D.RenderStop()
   ,RenderStop:function(Self) {
      if ($Check(Self,"")._CurPoint>0) {
         TG2RenderControlPrim2D.Flush(Self);
      }
      $Check(Self,"")._gl$4.disableVertexAttribArray($Check(Self,"")._AttribPosition);
      $Check(Self,"")._gl$4.disableVertexAttribArray($Check(Self,"")._AttribColor);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,RenderStart$:function($){return $.ClassType.RenderStart($)}
   ,RenderStop$:function($){return $.ClassType.RenderStop($)}
};
/// TG2RenderControlPic2D = class (TG2RenderControl)
var TG2RenderControlPic2D = {
   $ClassName:"TG2RenderControlPic2D",
   $Parent:TG2RenderControl
   ,$Init:function ($) {
      TG2RenderControl.$Init($);
      $._ArrColors$1 = [];
      $._ArrPositions$1 = [];
      $._ArrTexCoords = [];
      $._AttribColor$1 = 0;
      $._AttribPosition$1 = 0;
      $._AttribTexCoord = 0;
      $._BufferColors$1 = $._BufferIndices = $._BufferPositions$1 = $._BufferTexCoords = $._CurTexture$1 = $._Shader$2 = $._UniformTex0$1 = $._UniformWVP$2 = null;
      $._CurBlendMode$2 = 0;
      $._CurQuad$1 = $._MaxQuads$1 = 0;
   }
   /// constructor TG2RenderControlPic2D.Create()
   ,Create$48:function(Self) {
      var QuadIndPk = [0,0,0,0,0,0];
      var QuadIndPk = [0, 1, 2, 2, 1, 3];
      var QuadInd = [];
      var i$34 = 0;
      var j$4 = 0;
      TG2RenderControl.Create$48(Self);
      $Check(Self,"")._Shader$2 = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2ShaderProgram.Compile($Check(Self,"")._Shader$2,"\r\n    uniform mat4 WVP;\r\n    attribute vec3 a_Position0;\r\n    attribute vec4 a_Color0;\r\n    attribute vec2 a_TexCoord0;\r\n    varying vec4 v_Color;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_Position = vec4(a_Position0, 1) * WVP;\r\n      v_Color = a_Color0;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    varying vec4 v_Color;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * v_Color;\r\n    }\r\n  ");
      TG2Resource.SetParent($Check(Self,"")._Shader$2,Self);
      $Check(Self,"")._AttribPosition$1 = TG2ShaderProgram.GetShaderAttribute($Check(Self,"")._Shader$2,"a_Position0");
      $Check(Self,"")._AttribColor$1 = TG2ShaderProgram.GetShaderAttribute($Check(Self,"")._Shader$2,"a_Color0");
      $Check(Self,"")._AttribTexCoord = TG2ShaderProgram.GetShaderAttribute($Check(Self,"")._Shader$2,"a_TexCoord0");
      $Check(Self,"")._UniformWVP$2 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader$2,"WVP");
      $Check(Self,"")._UniformTex0$1 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader$2,"Tex0");
      $Check(Self,"")._MaxQuads$1 = 2048;
      $Check(Self,"")._BufferPositions$1 = $Check(Self,"")._gl$4.createBuffer();
      $Check(Self,"")._BufferColors$1 = $Check(Self,"")._gl$4.createBuffer();
      $Check(Self,"")._BufferTexCoords = $Check(Self,"")._gl$4.createBuffer();
      $Check(Self,"")._BufferIndices = $Check(Self,"")._gl$4.createBuffer();
      $ArraySetLen(QuadInd,($Check(Self,"")._MaxQuads$1*6),0);
      var $temp54;
      for(i$34 = 0,$temp54 = $Check(Self,"")._MaxQuads$1;i$34<$temp54;i$34++) {
         for(j$4 = 0;j$4<=5;j$4++) {
            $DIdxW(QuadInd,(i$34*6)+j$4,QuadIndPk[$Idx(j$4,0,5,"")]+(i$34*4),"");
         }
      }
      $Check(Self,"")._gl$4.bindBuffer(34963,$Check(Self,"")._BufferIndices);
      $Check(Self,"")._gl$4.bufferData(34963,new Uint16Array(QuadInd),35044);
      return Self
   }
   /// destructor TG2RenderControlPic2D.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"")._gl$4.deleteBuffer($Check(Self,"")._BufferPositions$1);
      $Check(Self,"")._gl$4.deleteBuffer($Check(Self,"")._BufferColors$1);
      $Check(Self,"")._gl$4.deleteBuffer($Check(Self,"")._BufferIndices);
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2RenderControlPic2D.Flush()
   ,Flush$1:function(Self) {
      var VertsPositions$1 = null;
      var VertsColors$1 = null;
      var VertsTexCoords = null;
      VertsPositions$1 = new Float32Array($Check(Self,"")._ArrPositions$1);
      VertsColors$1 = new Float32Array($Check(Self,"")._ArrColors$1);
      VertsTexCoords = new Float32Array($Check(Self,"")._ArrTexCoords);
      $Check(Self,"")._gl$4.bindBuffer(34962,$Check(Self,"")._BufferPositions$1);
      $Check(Self,"")._gl$4.bufferData(34962,VertsPositions$1,35048);
      $Check(Self,"")._gl$4.vertexAttribPointer($Check(Self,"")._AttribPosition$1,3,5126,false,0,0);
      $Check(Self,"")._gl$4.bindBuffer(34962,$Check(Self,"")._BufferColors$1);
      $Check(Self,"")._gl$4.bufferData(34962,VertsColors$1,35048);
      $Check(Self,"")._gl$4.vertexAttribPointer($Check(Self,"")._AttribColor$1,4,5126,false,0,0);
      $Check(Self,"")._gl$4.bindBuffer(34962,$Check(Self,"")._BufferTexCoords);
      $Check(Self,"")._gl$4.bufferData(34962,VertsTexCoords,35048);
      $Check(Self,"")._gl$4.vertexAttribPointer($Check(Self,"")._AttribTexCoord,2,5126,false,0,0);
      $Check(Self,"")._gl$4.bindBuffer(34963,$Check(Self,"")._BufferIndices);
      $Check(Self,"")._gl$4.drawElements(4,$Check(Self,"")._CurQuad$1*6,5123,0);
      $Check(Self,"")._CurQuad$1 = 0;
      $Check(Self,"")._ArrPositions$1.length=0;
      $Check(Self,"")._ArrColors$1.length=0;
      $Check(Self,"")._ArrTexCoords.length=0;
   }
   /// procedure TG2RenderControlPic2D.PicQuadCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Tex0: TG2Vec2; const Tex1: TG2Vec2; const Tex2: TG2Vec2; const Tex3: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; const BlendMode: TG2BlendMode; const Filter: TG2Filter)
   ,PicQuadCol:function(Self, Pos0$2, Pos1$2, Pos2$1, Pos3$1, Tex0, Tex1, Tex2, Tex3, Col0$1, Col1$1, Col2$1, Col3$1, Texture$3, BlendMode$4, Filter$1) {
      var i$35 = 0;
      if (!$Check(Self,"")._CurQuad$1) {
         $Check(Self,"")._CurTexture$1 = Texture$3;
         $Check(Self,"")._CurBlendMode$2 = BlendMode$4;
         TG2Texture2DBase.Bind$2($Check(Self,"")._CurTexture$1,0);
         TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,$Check(Self,"")._CurBlendMode$2);
      } else if ((($Check(Self,"")._CurQuad$1>=($Check(Self,"")._MaxQuads$1-1))||($Check(Self,"")._CurTexture$1!==Texture$3))||($Check(Self,"")._CurBlendMode$2!=BlendMode$4)) {
         TG2RenderControlPic2D.Flush$1(Self);
         if ($Check(Self,"")._CurTexture$1!==Texture$3) {
            $Check(Self,"")._CurTexture$1 = Texture$3;
            TG2Texture2DBase.Bind$2($Check(Self,"")._CurTexture$1,0);
         }
         if ($Check(Self,"")._CurBlendMode$2!=BlendMode$4) {
            $Check(Self,"")._CurBlendMode$2 = BlendMode$4;
            TG2Gfx.SetBlendMode($Check(g2,"")._Gfx,$Check(Self,"")._CurBlendMode$2);
         }
      }
      i$35 = $Check(Self,"")._CurQuad$1*12;
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+0,TG2Vec2$GetX$2(Pos0$2),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+1,TG2Vec2$GetY$2(Pos0$2),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+2,0,"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+3,TG2Vec2$GetX$2(Pos1$2),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+4,TG2Vec2$GetY$2(Pos1$2),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+5,0,"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+6,TG2Vec2$GetX$2(Pos2$1),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+7,TG2Vec2$GetY$2(Pos2$1),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+8,0,"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+9,TG2Vec2$GetX$2(Pos3$1),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+10,TG2Vec2$GetY$2(Pos3$1),"");
      $DIdxW($Check(Self,"")._ArrPositions$1,i$35+11,0,"");
      i$35 = $Check(Self,"")._CurQuad$1*16;
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+0,TG2Vec4$GetX(Col0$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+1,TG2Vec4$GetY(Col0$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+2,TG2Vec4$GetZ(Col0$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+3,TG2Vec4$GetW(Col0$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+4,TG2Vec4$GetX(Col1$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+5,TG2Vec4$GetY(Col1$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+6,TG2Vec4$GetZ(Col1$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+7,TG2Vec4$GetW(Col1$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+8,TG2Vec4$GetX(Col2$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+9,TG2Vec4$GetY(Col2$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+10,TG2Vec4$GetZ(Col2$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+11,TG2Vec4$GetW(Col2$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+12,TG2Vec4$GetX(Col3$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+13,TG2Vec4$GetY(Col3$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+14,TG2Vec4$GetZ(Col3$1),"");
      $DIdxW($Check(Self,"")._ArrColors$1,i$35+15,TG2Vec4$GetW(Col3$1),"");
      i$35 = $Check(Self,"")._CurQuad$1*8;
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+0,TG2Vec2$GetX$2(Tex0),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+1,TG2Vec2$GetY$2(Tex0),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+2,TG2Vec2$GetX$2(Tex1),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+3,TG2Vec2$GetY$2(Tex1),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+4,TG2Vec2$GetX$2(Tex2),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+5,TG2Vec2$GetY$2(Tex2),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+6,TG2Vec2$GetX$2(Tex3),"");
      $DIdxW($Check(Self,"")._ArrTexCoords,i$35+7,TG2Vec2$GetY$2(Tex3),"");
      $Check(Self,"")._CurQuad$1+=1;
   }
   /// procedure TG2RenderControlPic2D.RenderStart()
   ,RenderStart:function(Self) {
      var WVP$3 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2ShaderProgram.Use($Check(Self,"")._Shader$2);
      if ($Check($Check(g2,"")._Gfx,"")._RenderTarget===null) {
         WVP$3 = G2MatOrth2D((TG2Params.GetWidth$2($Check(g2,"")._Params)),(TG2Params.GetHeight$2($Check(g2,"")._Params)),0,1,false,true);
      } else {
         WVP$3 = G2MatOrth2D(($Check($Check($Check(g2,"")._Gfx,"")._RenderTarget,"")._Width),($Check($Check($Check(g2,"")._Gfx,"")._RenderTarget,"")._Height),0,1,false,false);
      }
      WVP$3 = G2MatTranspose(WVP$3);
      $Check(Self,"")._gl$4.uniformMatrix4fv($Check(Self,"")._UniformWVP$2,false,TG2Mat$ToFloat32Array$4(WVP$3));
      $Check(Self,"")._gl$4.uniform1i($Check(Self,"")._UniformTex0$1,0);
      $Check(Self,"")._gl$4.enableVertexAttribArray($Check(Self,"")._AttribPosition$1);
      $Check(Self,"")._gl$4.enableVertexAttribArray($Check(Self,"")._AttribColor$1);
      $Check(Self,"")._gl$4.enableVertexAttribArray($Check(Self,"")._AttribTexCoord);
      $Check(Self,"")._CurQuad$1 = 0;
      $Check(Self,"")._CurTexture$1 = null;
      $Check(Self,"")._CurBlendMode$2 = 0;
      $Check(Self,"")._ArrPositions$1.length=0;
      $Check(Self,"")._ArrColors$1.length=0;
      $Check(Self,"")._ArrTexCoords.length=0;
   }
   /// procedure TG2RenderControlPic2D.RenderStop()
   ,RenderStop:function(Self) {
      if ($Check(Self,"")._CurQuad$1>0) {
         TG2RenderControlPic2D.Flush$1(Self);
      }
      $Check(Self,"")._gl$4.disableVertexAttribArray($Check(Self,"")._AttribPosition$1);
      $Check(Self,"")._gl$4.disableVertexAttribArray($Check(Self,"")._AttribColor$1);
      $Check(Self,"")._gl$4.disableVertexAttribArray($Check(Self,"")._AttribTexCoord);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,RenderStart$:function($){return $.ClassType.RenderStart($)}
   ,RenderStop$:function($){return $.ClassType.RenderStop($)}
};
/// TG2RenderControlBuffer = class (TG2RenderControl)
var TG2RenderControlBuffer = {
   $ClassName:"TG2RenderControlBuffer",
   $Parent:TG2RenderControl
   ,$Init:function ($) {
      TG2RenderControl.$Init($);
      $._Shader$3 = $._UniformTex0$2 = $._UniformWVP$3 = null;
   }
   /// constructor TG2RenderControlBuffer.Create()
   ,Create$48:function(Self) {
      TG2RenderControl.Create$48(Self);
      $Check(Self,"")._Shader$3 = TG2Resource.Create$48$($New(TG2ShaderProgram));
      TG2ShaderProgram.Compile($Check(Self,"")._Shader$3,"\r\n    uniform mat4 WVP;\r\n    attribute vec3 a_Position0;\r\n    attribute vec4 a_Color0;\r\n    attribute vec2 a_TexCoord0;\r\n    varying vec4 v_Color;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_Position = vec4(a_Position0, 1) * WVP;\r\n      v_Color = a_Color0;\r\n      v_TexCoord = a_TexCoord0;\r\n    }\r\n  ","\r\n    #ifdef GL_ES\r\n    precision mediump float;\r\n    #endif\r\n    uniform sampler2D Tex0;\r\n    varying vec4 v_Color;\r\n    varying vec2 v_TexCoord;\r\n    void main () {\r\n      gl_FragColor = texture2D(Tex0, v_TexCoord) * v_Color;\r\n    }\r\n  ");
      TG2Resource.SetParent($Check(Self,"")._Shader$3,Self);
      $Check(Self,"")._UniformWVP$3 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader$3,"WVP");
      $Check(Self,"")._UniformTex0$2 = TG2ShaderProgram.GetShaderUniform($Check(Self,"")._Shader$3,"Tex0");
      return Self
   }
   /// destructor TG2RenderControlBuffer.Destroy()
   ,Destroy:function(Self) {
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2RenderControlBuffer.RenderPrimitive(const VB: TG2VertexBuffer; const PrimitiveType: TG2PrimitiveType; const VertexStart: Integer; const PrimitiveCount: Integer; const Texture: TG2Texture2DBase; const W: TG2Mat; const V: TG2Mat; const P: TG2Mat)
   ,RenderPrimitive$1:function(Self, VB$4, PrimitiveType, VertexStart$2, PrimitiveCount, Texture$4, W$1, V$2, P$1) {
      var WVP$4 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Texture2DBase.Bind$2(Texture$4,0);
      WVP$4 = G2MatTranspose(G2MatMul(G2MatMul(W$1,V$2),P$1));
      $Check(Self,"")._gl$4.uniformMatrix4fv($Check(Self,"")._UniformWVP$3,false,TG2Mat$ToFloat32Array$4(WVP$4));
      $Check(Self,"")._gl$4.uniform1i($Check(Self,"")._UniformTex0$2,0);
      TG2VertexBuffer.Bind(VB$4);
      $Check(Self,"")._gl$4.drawArrays(4,VertexStart$2,PrimitiveCount*3);
      TG2VertexBuffer.Unbind(VB$4);
   }
   /// procedure TG2RenderControlBuffer.RenderPrimitive(const VB: TG2VertexBuffer; const IB: TG2IndexBuffer; const PrimitiveType: TG2PrimitiveType; const VertexStart: Integer; const VertexCount: Integer; const IndexStart: Integer; const PrimitiveCount: Integer; const Texture: TG2Texture2DBase; const W: TG2Mat; const V: TG2Mat; const P: TG2Mat)
   ,RenderPrimitive:function(Self, VB$5, IB$2, PrimitiveType$1, VertexStart$3, VertexCount$3, IndexStart, PrimitiveCount$1, Texture$5, W$2, V$3, P$2) {
      var WVP$5 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Texture2DBase.Bind$2(Texture$5,0);
      WVP$5 = G2MatTranspose(G2MatMul(G2MatMul(W$2,V$3),P$2));
      $Check(Self,"")._gl$4.uniformMatrix4fv($Check(Self,"")._UniformWVP$3,false,TG2Mat$ToFloat32Array$4(WVP$5));
      $Check(Self,"")._gl$4.uniform1i($Check(Self,"")._UniformTex0$2,0);
      TG2VertexBuffer.Bind(VB$5);
      TG2IndexBuffer.Bind$3(IB$2);
      $Check(Self,"")._gl$4.drawElements(4,PrimitiveCount$1*3,5123,0);
      TG2IndexBuffer.Unbind$1(IB$2);
      TG2VertexBuffer.Unbind(VB$5);
   }
   /// procedure TG2RenderControlBuffer.RenderStart()
   ,RenderStart:function(Self) {
      TG2ShaderProgram.Use($Check(Self,"")._Shader$3);
   }
   /// procedure TG2RenderControlBuffer.RenderStop()
   ,RenderStop:function(Self) {
      /* null */
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
   ,RenderStart$:function($){return $.ClassType.RenderStart($)}
   ,RenderStop$:function($){return $.ClassType.RenderStop($)}
};
/// TG2PrimitiveType enumeration
var TG2PrimitiveType = { 1:"ptPointList", 2:"ptLineList", 3:"ptLineStrip", 4:"ptTriangleList", 5:"ptTriangleStrip", 6:"ptTriangleFan" };
/// TG2Prim2DType enumeration
var TG2Prim2DType = [ "ptNone", "ptLines", "ptTriangles" ];
/// TG2Params = class (TObject)
var TG2Params = {
   $ClassName:"TG2Params",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TG2Params.GetWidth() : Integer
   ,GetWidth$2:function(Self) {
      return TG2Core.GetWidth$3(g2);
   }
   /// procedure TG2Params.SetWidth(const Value: Integer)
   ,SetWidth$2:function(Self, Value$5) {
      TG2Core.SetWidth$3(g2,Value$5);
   }
   /// function TG2Params.GetHeight() : Integer
   ,GetHeight$2:function(Self) {
      return TG2Core.GetHeight$3(g2);
   }
   /// procedure TG2Params.SetHeight(const Value: Integer)
   ,SetHeight$1:function(Self, Value$6) {
      TG2Core.SetHeight$2(g2,Value$6);
   }
   ,Destroy:TObject.Destroy
};
/// TG2LocalStorage = class (TObject)
var TG2LocalStorage = {
   $ClassName:"TG2LocalStorage",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TG2LocalStorage.GetKey(const Key: String) : String
   ,GetKey:function(Self, Key) {
      var Result = "";
      
    Result = window.localStorage.getItem(Key);
    if (Result == null) Result = "";
  return Result
   }
   /// procedure TG2LocalStorage.SetKey(const Key: String; const Value: String)
   ,SetKey:function(Self, Key$1, Value$7) {
      
    window.localStorage.setItem(Key$1, Value$7);
     }
   ,Destroy:TObject.Destroy
};
/// TG2Link = class (TObject)
var TG2Link = {
   $ClassName:"TG2Link",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Next = $.Prev = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkScroll = class (TG2Link)
var TG2LinkScroll = {
   $ClassName:"TG2LinkScroll",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkRender = class (TG2Link)
var TG2LinkRender = {
   $ClassName:"TG2LinkRender",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc$1 = null;
      $.Order = 0;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkProc = class (TG2Link)
var TG2LinkProc = {
   $ClassName:"TG2LinkProc",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc$2 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkPrint = class (TG2Link)
var TG2LinkPrint = {
   $ClassName:"TG2LinkPrint",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc$3 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkMouse = class (TG2Link)
var TG2LinkMouse = {
   $ClassName:"TG2LinkMouse",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc$4 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2LinkKey = class (TG2Link)
var TG2LinkKey = {
   $ClassName:"TG2LinkKey",
   $Parent:TG2Link
   ,$Init:function ($) {
      TG2Link.$Init($);
      $.Proc$5 = null;
   }
   ,Destroy:TObject.Destroy
};
/// TG2IndexBuffer = class (TG2Resource)
var TG2IndexBuffer = {
   $ClassName:"TG2IndexBuffer",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._Data$1 = $._DataBuffer$1 = $._gl$5 = $._IB$1 = null;
      $._IndexCount = $._Position$1 = 0;
      $._Locked$1 = false;
      $._LockMode$1 = 0;
   }
   /// procedure TG2IndexBuffer.Bind()
   ,Bind$3:function(Self) {
      $Check(Self,"")._gl$5.bindBuffer(34963,$Check(Self,"")._IB$1);
   }
   /// constructor TG2IndexBuffer.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._gl$5 = $Check($Check(g2,"")._Gfx,"").gl$1;
      $Check(Self,"")._IB$1 = $Check(Self,"")._gl$5.createBuffer();
      return Self
   }
   /// destructor TG2IndexBuffer.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"")._gl$5.deleteBuffer($Check(Self,"")._IB$1);
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2IndexBuffer.Initialize(const Count: Integer)
   ,Initialize$2:function(Self, Count$12) {
      $Check(Self,"")._IndexCount = Count$12;
      $Check(Self,"")._Locked$1 = false;
      $Check(Self,"")._LockMode$1 = 0;
      $Check(Self,"")._gl$5.bindBuffer(34963,$Check(Self,"")._IB$1);
      $Check(Self,"")._gl$5.bufferData(34963,$Check(Self,"")._IndexCount*2,35044);
       Self._DataBuffer$1 = new ArrayBuffer(Self._IndexCount * 2);  Self._Data$1 = new DataView(Self._DataBuffer$1);    }
   /// procedure TG2IndexBuffer.Lock(LockMode: TG2BufferLockMode = 2)
   ,Lock$1:function(Self, LockMode$1) {
      if ($Check(Self,"")._Locked$1) {
         TG2IndexBuffer.UnLock$1(Self);
      }
      $Check(Self,"")._LockMode$1 = LockMode$1;
      $Check(Self,"")._Locked$1 = true;
      $Check(Self,"")._Position$1 = 0;
   }
   /// procedure TG2IndexBuffer.Unbind()
   ,Unbind$1:function(Self) {
      /* null */
   }
   /// procedure TG2IndexBuffer.UnLock()
   ,UnLock$1:function(Self) {
      if (!$Check(Self,"")._Locked$1) {
         return;
      }
      switch ($Check(Self,"")._LockMode$1) {
         case 2 :
            TG2IndexBuffer.WriteBufferData$1(Self);
            break;
      }
      $Check(Self,"")._Locked$1 = false;
   }
   /// procedure TG2IndexBuffer.WriteBufferData()
   ,WriteBufferData$1:function(Self) {
      $Check(Self,"")._gl$5.bindBuffer(34963,$Check(Self,"")._IB$1);
      $Check(Self,"")._gl$5.bufferSubData(34963,0,$Check(Self,"")._DataBuffer$1);
   }
   /// procedure TG2IndexBuffer.WriteIntU16(const n: Integer)
   ,WriteIntU16:function(Self, n$7) {
      $Check(Self,"")._Data$1.setUint16($Check(Self,"")._Position$1,n$7,true);
      $Check(Self,"")._Position$1+=2;
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2Gfx = class (TObject)
var TG2Gfx = {
   $ClassName:"TG2Gfx",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.gl$1 = $._RenderTarget = $._Shader$4 = null;
      $._BlendEnable = $._DepthEnable = $._DepthWriteEnable = false;
      $._BlendMode$1 = 0;
      $._Handle = undefined;
   }
   /// constructor TG2Gfx.Create(const Handle: THandle)
   ,Create$70:function(Self, Handle$6) {
      var Properties$1 = undefined;
      $Check(Self,"")._Handle = Handle$6;
      Properties$1 = G2NewVariant();
      Properties$1.antialias = false;
      $Check(Self,"").gl$1 = Handle$6.getContext("experimental-webgl",Properties$1);
      $Check(Self,"")._RenderTarget = null;
      $Check(Self,"")._DepthEnable = false;
      $Check(Self,"")._DepthWriteEnable = true;
      TG2Gfx.SetDefaults(Self);
      return Self
   }
   /// destructor TG2Gfx.Destroy()
   ,Destroy:function(Self) {
      TObject.Destroy(Self);
   }
   /// procedure TG2Gfx.SetBlendMode(const Value: TG2BlendMode)
   ,SetBlendMode:function(Self, Value$8) {
      if (Value$8!=$Check(Self,"")._BlendMode$1) {
         $Check(Self,"")._BlendMode$1 = Value$8;
         if (($Check(Self,"")._BlendMode$1==1)==$Check(Self,"")._BlendEnable) {
            $Check(Self,"")._BlendEnable = !$Check(Self,"")._BlendEnable;
            if ($Check(Self,"")._BlendEnable) {
               $Check(Self,"").gl$1.enable(3042);
            } else {
               $Check(Self,"").gl$1.disable(3042);
            }
         }
         switch ($Check(Self,"")._BlendMode$1) {
            case 1 :
               $Check(Self,"").gl$1.blendFunc(1,0);
               break;
            case 2 :
               $Check(Self,"").gl$1.blendFuncSeparate(770,771,1,1);
               break;
            case 3 :
               $Check(Self,"").gl$1.blendFuncSeparate(1,1,1,1);
               break;
            case 4 :
               $Check(Self,"").gl$1.blendFuncSeparate(0,769,0,771);
               break;
            case 5 :
               $Check(Self,"").gl$1.blendFuncSeparate(0,768,1,770);
               break;
         }
      }
   }
   /// procedure TG2Gfx.SetDefaults()
   ,SetDefaults:function(Self) {
      if ($Check(Self,"")._RenderTarget===null) {
         $Check(Self,"").gl$1.viewport(0,0,TG2Params.GetWidth$2($Check(g2,"")._Params),TG2Params.GetHeight$2($Check(g2,"")._Params));
      } else {
         $Check(Self,"").gl$1.viewport(0,0,$Check($Check(Self,"")._RenderTarget,"")._Width,$Check($Check(Self,"")._RenderTarget,"")._Height);
      }
      $Check(Self,"").gl$1.clearColor(1,1,1,1);
      $Check(Self,"").gl$1.clearDepth(1);
      $Check(Self,"").gl$1.cullFace(1028);
      $Check(Self,"").gl$1.disable(2884);
      $Check(Self,"")._BlendMode$1 = 0;
      $Check(Self,"")._BlendEnable = false;
      TG2Gfx.SetBlendMode(Self,1);
   }
   /// procedure TG2Gfx.SetDepthEnable(const Value: Boolean)
   ,SetDepthEnable:function(Self, Value$9) {
      if (Value$9==$Check(Self,"")._DepthEnable) {
         return;
      }
      $Check(Self,"")._DepthEnable = Value$9;
      if ($Check(Self,"")._DepthEnable) {
         $Check(Self,"").gl$1.enable(2929);
      } else {
         $Check(Self,"").gl$1.disable(2929);
      }
   }
   /// procedure TG2Gfx.SetDepthWriteEnable(const Value: Boolean)
   ,SetDepthWriteEnable:function(Self, Value$10) {
      if (Value$10==$Check(Self,"")._DepthWriteEnable) {
         return;
      }
      $Check(Self,"")._DepthWriteEnable = Value$10;
      $Check(Self,"").gl$1.depthMask($Check(Self,"")._DepthWriteEnable);
   }
   /// procedure TG2Gfx.SetRenderTarget(const Value: TG2Texture2DRT)
   ,SetRenderTarget:function(Self, Value$11) {
      if ($Check(Self,"")._RenderTarget!==Value$11) {
         TG2Core.SetRenderControl(g2,null);
         if ($Check(Self,"")._RenderTarget!==null) {
            $Check(Self,"").gl$1.framebufferTexture2D(36160,36064,3553,null,0);
            $Check(Self,"").gl$1.bindFramebuffer(36160,null);
         }
         $Check(Self,"")._RenderTarget = Value$11;
         if ($Check(Self,"")._RenderTarget===null) {
            TG2Gfx.SetDefaults(Self);
         } else {
            $Check(Self,"").gl$1.bindFramebuffer(36160,$Check($Check(Self,"")._RenderTarget,"")._FrameBuffer);
            $Check(Self,"").gl$1.framebufferTexture2D(36160,36064,3553,$Check($Check(Self,"")._RenderTarget,"")._Texture,0);
            TG2Gfx.SetDefaults(Self);
         }
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
};
/// TG2FontCharProps = record
function Copy$TG2FontCharProps(s,d) {
   d.Width$11=s.Width$11;
   d.Height$9=s.Height$9;
   d.OffsetX$1=s.OffsetX$1;
   d.OffsetY$1=s.OffsetY$1;
   return d;
}
function Clone$TG2FontCharProps($) {
   return {
      Width$11:$.Width$11,
      Height$9:$.Height$9,
      OffsetX$1:$.OffsetX$1,
      OffsetY$1:$.OffsetY$1
   }
}
/// TG2Font = class (TG2ResourceAsync)
var TG2Font = {
   $ClassName:"TG2Font",
   $Parent:TG2ResourceAsync
   ,$Init:function ($) {
      TG2ResourceAsync.$Init($);
      $._CharSpaceX = $._CharSpaceY = 0;
      $._DataManager$1 = $._Texture$2 = null;
      $._Props = function () {
         for (var r=[],i=0; i<256; i++) r.push({Width$11:0,Height$9:0,OffsetX$1:0,OffsetY$1:0});
         return r
      }();
   }
   /// constructor TG2Font.Create()
   ,Create$48:function(Self) {
      TG2ResourceAsync.Create$48(Self);
      TG2Resource.SetParent(Self,g2);
      $Check(Self,"")._DataManager$1 = TG2Resource.Create$48$($New(TG2DataManager));
      $Check($Check(Self,"")._DataManager$1,"")._OnLoadProc$2 = $Event0(Self,TG2Font.OnLoadHeader);
      $Check(Self,"")._Texture$2 = TG2Resource.Create$48$($New(TG2Texture2D));
      $Check($Check(Self,"")._Texture$2,"")._OnLoadProc$1 = $Event0(Self,TG2Font.OnLoadTexture);
      return Self
   }
   /// destructor TG2Font.Destroy()
   ,Destroy:function(Self) {
      TObject.Free($Check(Self,"")._Texture$2);
      TObject.Free($Check(Self,"")._DataManager$1);
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2Font.Load(const FontHeader: String; const FontImage: String)
   ,Load$3:function(Self, FontHeader, FontImage) {
      TG2Texture2D.Load$1($Check(Self,"")._Texture$2,FontImage,0);
      TG2DataManager.Load$5($Check(Self,"")._DataManager$1,FontHeader);
      $Check(Self,"")._State = 1;
      $Check(g2,"")._LoadingItems+=1;
   }
   /// procedure TG2Font.OnLoadCheck()
   ,OnLoadCheck:function(Self) {
      var i$36 = 0;
      if (($Check($Check(Self,"")._DataManager$1,"")._State==2)&&($Check($Check(Self,"")._Texture$2,"")._State==2)) {
         $Check(Self,"")._CharSpaceX = $Div($Check($Check(Self,"")._Texture$2,"")._Width,16);
         $Check(Self,"")._CharSpaceY = $Div($Check($Check(Self,"")._Texture$2,"")._Height,16);
         for(i$36 = 0;i$36<=255;i$36++) {
            $Check(Self,"")._Props[$Idx(i$36,0,255,"")].OffsetX$1 = $Div($Check(Self,"")._CharSpaceX-$Check(Self,"")._Props[$Idx(i$36,0,255,"")].Width$11,2);
            $Check(Self,"")._Props[$Idx(i$36,0,255,"")].OffsetY$1 = $Div($Check(Self,"")._CharSpaceY-$Check(Self,"")._Props[$Idx(i$36,0,255,"")].Height$9,2);
         }
         $Check(g2,"")._LoadingItems-=1;
         $Check(Self,"")._State = 2;
      }
   }
   /// procedure TG2Font.OnLoadHeader()
   ,OnLoadHeader:function(Self) {
      var HeaderDefinition = "";
      var HeaderVersion = 0;
      var HeaderFontFace = "";
      var HeaderFontSize = 0;
      var i$37 = 0;
      HeaderDefinition = TG2DataManager.ReadString($Check(Self,"")._DataManager$1,4);
      if (HeaderDefinition!="G2FH") {
         return;
      }
      HeaderVersion = TG2DataManager.ReadIntU32($Check(Self,"")._DataManager$1);
      if (HeaderVersion!=65536) {
         return;
      }
      HeaderFontFace = TG2DataManager.ReadStringNT($Check(Self,"")._DataManager$1);
      HeaderFontSize = TG2DataManager.ReadIntS32($Check(Self,"")._DataManager$1);
      TG2DataManager.Skip($Check(Self,"")._DataManager$1,8);
      for(i$37 = 0;i$37<=255;i$37++) {
         $Check(Self,"")._Props[$Idx(i$37,0,255,"")].Width$11 = TG2DataManager.ReadIntU8($Check(Self,"")._DataManager$1);
         $Check(Self,"")._Props[$Idx(i$37,0,255,"")].Height$9 = TG2DataManager.ReadIntU8($Check(Self,"")._DataManager$1);
      }
      TG2Font.OnLoadCheck(Self);
   }
   /// procedure TG2Font.OnLoadTexture()
   ,OnLoadTexture:function(Self) {
      TG2Font.OnLoadCheck(Self);
   }
   /// procedure TG2Font.Print(const x: TG2Float; const y: TG2Float; const Text: String)
   ,Print$6:function(Self, x$7, y$6, Text$2) {
      TG2Font.Print$5(Self,x$7,y$6,1,1,Text$2);
   }
   /// procedure TG2Font.Print(const x: TG2Float; const y: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Text: String)
   ,Print$5:function(Self, x$8, y$7, ScaleX, ScaleY, Text$3) {
      TG2Font.Print$4(Self,x$8,y$7,ScaleX,ScaleY,Text$3,2,1);
   }
   /// procedure TG2Font.Print(const x: TG2Float; const y: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Text: String; const BlendMode: TG2BlendMode; const Filter: TG2Filter)
   ,Print$4:function(Self, x$9, y$8, ScaleX$1, ScaleY$1, Text$4, BlendMode$5, Filter$2) {
      TG2Font.Print$3(Self,x$9,y$8,ScaleX$1,ScaleY$1,G2Vec4(1,1,1,1),Text$4,BlendMode$5,Filter$2);
   }
   /// procedure TG2Font.Print(const x: TG2Float; const y: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Color: TG2Vec4; const Text: String; const BlendMode: TG2BlendMode; const Filter: TG2Filter)
   ,Print$3:function(Self, x$10, y$9, ScaleX$2, ScaleY$2, Color$6, Text$5, BlendMode$6, Filter$3) {
      var i$38 = 0;
      var c$10 = 0;
      var tu1 = 0;
      var tv1 = 0;
      var tu2 = 0;
      var tv2 = 0;
      var x1 = 0;
      var y1 = 0;
      var x2 = 0;
      var y2 = 0;
      var CharTU = 0;
      var CharTV = 0;
      var CurPos = 0;
      CharTU = $Check(Self,"")._CharSpaceX/$Check($Check(Self,"")._Texture$2,"")._RealWidth;
      CharTV = $Check(Self,"")._CharSpaceY/$Check($Check(Self,"")._Texture$2,"")._RealHeight;
      CurPos = x$10;
      var $temp55;
      for(i$38 = 0,$temp55 = Text$5.length;i$38<$temp55;i$38++) {
         c$10 = $SCodeIdx(Text$5,i$38+1,"");
         tu1 = (c$10%16)*CharTU;
         tv1 = ($Div(c$10,16))*CharTV;
         tu2 = tu1+CharTU;
         tv2 = tv1+CharTV;
         x1 = CurPos-($Check(Self,"")._Props[$Idx(c$10,0,255,"")].OffsetX$1*ScaleX$2);
         y1 = y$9-($Check(Self,"")._Props[$Idx(c$10,0,255,"")].OffsetY$1*ScaleY$2);
         x2 = x1+($Check(Self,"")._CharSpaceX*ScaleX$2);
         y2 = y1+($Check(Self,"")._CharSpaceY*ScaleY$2);
         CurPos+=$Check(Self,"")._Props[$Idx(c$10,0,255,"")].Width$11*ScaleX$2;
         TG2Core.PicQuadCol$2(g2,x1,y1,x2,y1,x1,y2,x2,y2,tu1,tv1,tu2,tv1,tu1,tv2,tu2,tv2,Color$6,Color$6,Color$6,Color$6,$Check(Self,"")._Texture$2,BlendMode$6,Filter$3);
      }
   }
   /// function TG2Font.TextHeight(const Text: String) : Integer
   ,TextHeight:function(Self, Text$6) {
      var Result = 0;
      var i$39 = 0;
      var b$5 = 0;
      Result = 0;
      var $temp56;
      for(i$39 = 1,$temp56 = Text$6.length;i$39<=$temp56;i$39++) {
         b$5 = $SCodeIdx(Text$6,i$39,"");
         if ($Check(Self,"")._Props[$Idx(b$5,0,255,"")].Height$9>Result) {
            Result = $Check(Self,"")._Props[$Idx(b$5,0,255,"")].Height$9;
         }
      }
      return Result
   }
   /// function TG2Font.TextWidth(const Text: String) : Integer
   ,TextWidth:function(Self, Text$7) {
      var Result = 0;
      var i$40 = 0;
      Result = 0;
      var $temp57;
      for(i$40 = 1,$temp57 = Text$7.length;i$40<=$temp57;i$40++) {
         Result+=$Check(Self,"")._Props[$Idx($SCodeIdx(Text$7,i$40,""),0,255,"")].Width$11;
      }
      return Result
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2Filter enumeration
var TG2Filter = [ "tfNone", "tfPoint", "tfLinear" ];
/// TG2Core = class (TG2Resource)
var TG2Core = {
   $ClassName:"TG2Core",
   $Parent:TG2Resource
   ,$Init:function ($) {
      TG2Resource.$Init($);
      $._Body = $._Canvas = $._Gfx = $._LinkFinalize = $._LinkInitialize = $._LinkKeyDown = $._LinkKeyUp = $._LinkMouseDown = $._LinkMouseUp = $._LinkPrint = $._LinkRender = $._LinkScroll = $._LinkUpdate = $._LocalStorage = $._Params = $._RenderControl = $._RenderControlBuffer = $._RenderControlPic2D = $._RenderControlPrim2D = null;
      $._ClearColor = {Arr$1:[0,0,0,0]};
      $._FPS = $._LastFPSUpdate = $._LastTick = $._LoadingItems = $._TargetUPS = $._TimeToUpdate = $._TotalFrames = 0;
      $._MousePos = {x$5:0,y$4:0};
      $._TimerEnable = $._TimerPause = false;
   }
   /// procedure TG2Core.CallbackFinalizeAdd(const ProcFinalize: TG2Proc)
   ,CallbackFinalizeAdd:function(Self, ProcFinalize) {
      var Link$1 = null;
      Link$1 = TObject.Create($New(TG2LinkProc));
      $Check(Link$1,"").Proc$2 = ProcFinalize;
      if ($Check(Self,"")._LinkFinalize!==null) {
         $Check($Check(Self,"")._LinkFinalize,"").Prev = Link$1;
      }
      $Check(Link$1,"").Prev = null;
      $Check(Link$1,"").Next = $Check(Self,"")._LinkFinalize;
      $Check(Self,"")._LinkFinalize = Link$1;
   }
   /// procedure TG2Core.CallbackFinalizeRemove(const ProcFinalize: TG2Proc)
   ,CallbackFinalizeRemove:function(Self, ProcFinalize$1) {
      var Link$2 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackInitializeAdd(const ProcInitialize: TG2Proc)
   ,CallbackInitializeAdd:function(Self, ProcInitialize) {
      var Link$3 = null;
      Link$3 = TObject.Create($New(TG2LinkProc));
      $Check(Link$3,"").Proc$2 = ProcInitialize;
      if ($Check(Self,"")._LinkInitialize!==null) {
         $Check($Check(Self,"")._LinkInitialize,"").Prev = Link$3;
      }
      $Check(Link$3,"").Prev = null;
      $Check(Link$3,"").Next = $Check(Self,"")._LinkInitialize;
      $Check(Self,"")._LinkInitialize = Link$3;
   }
   /// procedure TG2Core.CallbackInitializeRemove(const ProcInitialize: TG2Proc)
   ,CallbackInitializeRemove:function(Self, ProcInitialize$1) {
      var Link$4 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackKeyDownAdd(const ProcKeyDown: TG2ProcKey)
   ,CallbackKeyDownAdd:function(Self, ProcKeyDown) {
      var Link$5 = null;
      Link$5 = TObject.Create($New(TG2LinkKey));
      $Check(Link$5,"").Proc$5 = ProcKeyDown;
      if ($Check(Self,"")._LinkKeyDown!==null) {
         $Check($Check(Self,"")._LinkKeyDown,"").Prev = Link$5;
      }
      $Check(Link$5,"").Prev = null;
      $Check(Link$5,"").Next = $Check(Self,"")._LinkKeyDown;
      $Check(Self,"")._LinkKeyDown = Link$5;
   }
   /// procedure TG2Core.CallbackKeyDownRemove(const ProcKeyDown: TG2ProcKey)
   ,CallbackKeyDownRemove:function(Self, ProcKeyDown$1) {
      var Link$6 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackKeyUpAdd(const ProcKeyUp: TG2ProcKey)
   ,CallbackKeyUpAdd:function(Self, ProcKeyUp) {
      var Link$7 = null;
      Link$7 = TObject.Create($New(TG2LinkKey));
      $Check(Link$7,"").Proc$5 = ProcKeyUp;
      if ($Check(Self,"")._LinkKeyUp!==null) {
         $Check($Check(Self,"")._LinkKeyUp,"").Prev = Link$7;
      }
      $Check(Link$7,"").Prev = null;
      $Check(Link$7,"").Next = $Check(Self,"")._LinkKeyUp;
      $Check(Self,"")._LinkKeyUp = Link$7;
   }
   /// procedure TG2Core.CallbackKeyUpRemove(const ProcKeyUp: TG2ProcKey)
   ,CallbackKeyUpRemove:function(Self, ProcKeyUp$1) {
      var Link$8 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackMouseDownAdd(const ProcMouseDown: TG2ProcMouse)
   ,CallbackMouseDownAdd:function(Self, ProcMouseDown) {
      var Link$9 = null;
      Link$9 = TObject.Create($New(TG2LinkMouse));
      $Check(Link$9,"").Proc$4 = ProcMouseDown;
      if ($Check(Self,"")._LinkMouseDown!==null) {
         $Check($Check(Self,"")._LinkMouseDown,"").Prev = Link$9;
      }
      $Check(Link$9,"").Prev = null;
      $Check(Link$9,"").Next = $Check(Self,"")._LinkMouseDown;
      $Check(Self,"")._LinkMouseDown = Link$9;
   }
   /// procedure TG2Core.CallbackMouseDownRemove(const ProcMouseDown: TG2ProcMouse)
   ,CallbackMouseDownRemove:function(Self, ProcMouseDown$1) {
      var Link$10 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackMouseUpAdd(const ProcMouseUp: TG2ProcMouse)
   ,CallbackMouseUpAdd:function(Self, ProcMouseUp) {
      var Link$11 = null;
      Link$11 = TObject.Create($New(TG2LinkMouse));
      $Check(Link$11,"").Proc$4 = ProcMouseUp;
      if ($Check(Self,"")._LinkMouseUp!==null) {
         $Check($Check(Self,"")._LinkMouseUp,"").Prev = Link$11;
      }
      $Check(Link$11,"").Prev = null;
      $Check(Link$11,"").Next = $Check(Self,"")._LinkMouseUp;
      $Check(Self,"")._LinkMouseUp = Link$11;
   }
   /// procedure TG2Core.CallbackMouseUpRemove(const ProcMouseUp: TG2ProcMouse)
   ,CallbackMouseUpRemove:function(Self, ProcMouseUp$1) {
      var Link$12 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackPrintAdd(const ProcPrint: TG2ProcChar)
   ,CallbackPrintAdd:function(Self, ProcPrint) {
      var Link$13 = null;
      Link$13 = TObject.Create($New(TG2LinkPrint));
      $Check(Link$13,"").Proc$3 = ProcPrint;
      if ($Check(Self,"")._LinkPrint!==null) {
         $Check($Check(Self,"")._LinkPrint,"").Prev = Link$13;
      }
      $Check(Link$13,"").Prev = null;
      $Check(Link$13,"").Next = $Check(Self,"")._LinkPrint;
      $Check(Self,"")._LinkPrint = Link$13;
   }
   /// procedure TG2Core.CallbackPrintRemove(const ProcPrint: TG2ProcChar)
   ,CallbackPrintRemove:function(Self, ProcPrint$1) {
      var Link$14 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackRenderAdd(const ProcRender: TG2Proc; Order: TG2Float = 0)
   ,CallbackRenderAdd:function(Self, ProcRender, Order$4) {
      var Link$15 = null;
      var List = null;
      Link$15 = TObject.Create($New(TG2LinkRender));
      $Check(Link$15,"").Proc$1 = ProcRender;
      $Check(Link$15,"").Order = Order$4;
      $Check(Link$15,"").Prev = null;
      $Check(Link$15,"").Next = null;
      if ($Check(Self,"")._LinkRender===null) {
         $Check(Self,"")._LinkRender = Link$15;
      } else {
         List = $Check(Self,"")._LinkRender;
         while (List!==null) {
            if ($Check(List,"").Order>=$Check(Link$15,"").Order) {
               $Check(Link$15,"").Next = List;
               $Check(Link$15,"").Prev = $Check(List,"").Prev;
               if ($Check(List,"").Prev!==null) {
                  $Check($Check(List,"").Prev,"").Next = Link$15;
               }
               $Check(List,"").Prev = Link$15;
               if (List===$Check(Self,"")._LinkRender) {
                  $Check(Self,"")._LinkRender = Link$15;
               }
               return;
            } else if ($Check(List,"").Next===null) {
               $Check(List,"").Next = Link$15;
               $Check(Link$15,"").Prev = List;
               return;
            } else {
               List = $As($Check(List,"").Next,TG2LinkRender);
            }
         }
      }
   }
   /// procedure TG2Core.CallbackRenderRemove(const ProcRender: TG2Proc)
   ,CallbackRenderRemove:function(Self, ProcRender$1) {
      var Link$16 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackScrollAdd(const ProcScroll: TG2ProcScroll)
   ,CallbackScrollAdd:function(Self, ProcScroll) {
      var Link$17 = null;
      Link$17 = TObject.Create($New(TG2LinkScroll));
      $Check(Link$17,"").Proc = ProcScroll;
      if ($Check(Self,"")._LinkScroll!==null) {
         $Check($Check(Self,"")._LinkScroll,"").Prev = Link$17;
      }
      $Check(Link$17,"").Prev = null;
      $Check(Link$17,"").Next = $Check(Self,"")._LinkScroll;
      $Check(Self,"")._LinkScroll = Link$17;
   }
   /// procedure TG2Core.CallbackScrollRemove(const ProcScroll: TG2ProcScroll)
   ,CallbackScrollRemove:function(Self, ProcScroll$1) {
      var Link$18 = null;
      /* null */
   }
   /// procedure TG2Core.CallbackUpdateAdd(const ProcUpdate: TG2Proc)
   ,CallbackUpdateAdd:function(Self, ProcUpdate) {
      var Link$19 = null;
      Link$19 = TObject.Create($New(TG2LinkProc));
      $Check(Link$19,"").Proc$2 = ProcUpdate;
      if ($Check(Self,"")._LinkUpdate!==null) {
         $Check($Check(Self,"")._LinkUpdate,"").Prev = Link$19;
      }
      $Check(Link$19,"").Prev = null;
      $Check(Link$19,"").Next = $Check(Self,"")._LinkUpdate;
      $Check(Self,"")._LinkUpdate = Link$19;
   }
   /// procedure TG2Core.CallbackUpdateRemove(const ProcUpdate: TG2Proc)
   ,CallbackUpdateRemove:function(Self, ProcUpdate$1) {
      var Link$20 = null;
      /* null */
   }
   /// procedure TG2Core.ClearLinks(var List: TG2Link)
   ,ClearLinks:function(Self, List$1) {
      var Link$21 = null;
      while (List$1.v!==null) {
         Link$21 = List$1.v;
         List$1.v = $Check(List$1.v,"").Next;
         TObject.Free(Link$21);
      }
   }
   /// constructor TG2Core.Create()
   ,Create$48:function(Self) {
      TG2Resource.Create$48(Self);
      $Check(Self,"")._Gfx = null;
      $Check(Self,"")._Params = null;
      TG2Vec4$SetValue($Check(Self,"")._ClearColor,0.5,0.5,0.5,1);
      $Check(Self,"")._LinkInitialize = null;
      $Check(Self,"")._LinkFinalize = null;
      $Check(Self,"")._LinkUpdate = null;
      $Check(Self,"")._LinkRender = null;
      $Check(Self,"")._LinkPrint = null;
      $Check(Self,"")._LinkKeyDown = null;
      $Check(Self,"")._LinkKeyUp = null;
      $Check(Self,"")._LinkMouseDown = null;
      $Check(Self,"")._LinkMouseUp = null;
      $Check(Self,"")._LinkScroll = null;
      return Self
   }
   /// destructor TG2Core.Destroy()
   ,Destroy:function(Self) {
      var List$2 = {};
      List$2.v = null;
      List$2.v = $Check(Self,"")._LinkInitialize;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkFinalize;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkUpdate;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkRender;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkPrint;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkKeyDown;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkKeyUp;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkMouseDown;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkMouseUp;
      TG2Core.ClearLinks(Self,List$2);
      List$2.v = $Check(Self,"")._LinkScroll;
      TG2Core.ClearLinks(Self,List$2);
      if ($Check(Self,"")._Params!==null) {
         TObject.Free($Check(Self,"")._Params);
         $Check(Self,"")._Params = null;
      }
      if ($Check(Self,"")._Gfx!==null) {
         TObject.Free($Check(Self,"")._Gfx);
         $Check(Self,"")._Gfx = null;
      }
      TG2Resource.Destroy(Self);
   }
   /// procedure TG2Core.Finalize()
   ,Finalize$1:function(Self) {
      var Link$22 = null;
      Link$22 = $Check(Self,"")._LinkFinalize;
      while (Link$22!==null) {
         $CheckFunc($Check(Link$22,"").Proc$2,"")();
         Link$22 = $As($Check(Link$22,"").Next,TG2LinkProc);
      }
   }
   /// function TG2Core.GetDeltaTime() : TG2Float
   ,GetDeltaTime:function(Self) {
      return 1000/$Check(Self,"")._TargetUPS;
   }
   /// function TG2Core.GetHeight() : Integer
   ,GetHeight$3:function(Self) {
      return parseInt(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).height,10);
   }
   /// function TG2Core.GetWidth() : Integer
   ,GetWidth$3:function(Self) {
      return parseInt(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).width,10);
   }
   /// procedure TG2Core.Initialize()
   ,Initialize$3:function(Self) {
      var t$2 = 0;
      var WndWidth = 0;
      var WndHeight = 0;
      var h$1 = undefined;
      var Link$23 = null;
      t$2 = G2Time();
      $Check(Self,"")._Body = TW3Component.Create$38$($New(TDocumentBody),null);
      $Check($Check(Self,"")._Body,"").FHandle$3.style.textAlign = "center";
      
    WndWidth = window.innerWidth;
    WndHeight = window.innerHeight;
  $Check(Self,"")._Canvas = TW3GraphicContext.Create$27$($New(TW3GraphicContext),$Check($Check(Self,"")._Body,"").FHandle$3);
      TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).width = WndWidth;
      TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).height = WndHeight;
      $Check(Self,"")._Params = TObject.Create($New(TG2Params));
      h$1 = $Check($Check(Self,"")._Body,"").FHandle$3;
      h$1.onmousemove = $Event1(Self,TG2Core.OnMouseMove$1);
      h$1.onmouseup = $Event1(Self,TG2Core.OnMouseUp$1);
      h$1 = TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,""));
      h$1.onmousedown = $Event1(Self,TG2Core.OnMouseDown$1);
      w3_AddEvent(h$1,"mousewheel",$Event0(Self,TG2Core.OnScroll),false);
      $Check(Self,"")._TargetUPS = 60;
      $Check(Self,"")._TotalFrames = 0;
      $Check(Self,"")._FPS = 0;
      $Check(Self,"")._LastFPSUpdate = t$2;
      $Check(Self,"")._LastTick = t$2;
      $Check(Self,"")._TimeToUpdate = 0;
      $Check(Self,"")._TimerPause = false;
      $Check(Self,"")._TimerEnable = true;
      $Check(Self,"")._Gfx = TG2Gfx.Create$70($New(TG2Gfx),TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")));
      $Check(Self,"")._LocalStorage = TObject.Create($New(TG2LocalStorage));
      $Check(Self,"")._RenderControl = null;
      $Check(Self,"")._RenderControlPrim2D = TG2Resource.Create$48$($New(TG2RenderControlPrim2D));
      $Check(Self,"")._RenderControlPic2D = TG2Resource.Create$48$($New(TG2RenderControlPic2D));
      $Check(Self,"")._RenderControlBuffer = TG2Resource.Create$48$($New(TG2RenderControlBuffer));
      
    window.RequestAnimFrame = (
      function() {
        return (
          window.requestAnimationFrame ||
          window.webkitRequestAnimationFrame ||
          window.mozRequestAnimationFrame ||
          window.oRequestAnimationFrame ||
          window.msRequestAnimationFrame ||
          function(callback){
            window.setTimeout(callback, 1000 / 60);
          }
        );
      }
    )();
  TG2Core.OnTimer(Self);
      Link$23 = $Check(Self,"")._LinkInitialize;
      while (Link$23!==null) {
         $CheckFunc($Check(Link$23,"").Proc$2,"")();
         Link$23 = $As($Check(Link$23,"").Next,TG2LinkProc);
      }
   }
   /// procedure TG2Core.OnMouseDown(const e: Variant)
   ,OnMouseDown$1:function(Self, e$5) {
      var Button$1 = 0;
      var Link$24 = null;
      {var $temp58 = e$5.button;
         if ($temp58==2) {
            Button$1 = 2;
         }
          else if ($temp58==4) {
            Button$1 = 3;
         }
          else {
            Button$1 = 1;
         }
      }
      Link$24 = $Check(Self,"")._LinkMouseDown;
      while (Link$24!==null) {
         $CheckFunc($Check(Link$24,"").Proc$4,"")(Button$1,$Check(Self,"")._MousePos.x$5,$Check(Self,"")._MousePos.y$4);
         Link$24 = $As($Check(Link$24,"").Next,TG2LinkMouse);
      }
   }
   /// procedure TG2Core.OnMouseMove(const e: Variant)
   ,OnMouseMove$1:function(Self, e$6) {
      var ox = 0;
      var oy = 0;
      var o = undefined;
      var Link$25 = null;
      $Check(Self,"")._MousePos.x$5 = parseInt(e$6.clientX,10);
      $Check(Self,"")._MousePos.y$4 = parseInt(e$6.clientY,10);
      ox = 0;
      oy = 0;
      o = TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,""));
      do {
         ox = parseInt((ox+o.offsetLeft),10);
         oy = parseInt((oy+o.offsetTop),10);
         o = o.offsetParent;
      } while (!(o==null));
      $Check(Self,"")._MousePos.x$5-=ox;
      $Check(Self,"")._MousePos.y$4-=oy;
   }
   /// procedure TG2Core.OnMouseUp(const e: Variant)
   ,OnMouseUp$1:function(Self, e$7) {
      var Button$2 = 0;
      var Link$26 = null;
      {var $temp59 = e$7.button;
         if ($temp59==2) {
            Button$2 = 2;
         }
          else if ($temp59==4) {
            Button$2 = 3;
         }
          else {
            Button$2 = 1;
         }
      }
      Link$26 = $Check(Self,"")._LinkMouseUp;
      while (Link$26!==null) {
         $CheckFunc($Check(Link$26,"").Proc$4,"")(Button$2,$Check(Self,"")._MousePos.x$5,$Check(Self,"")._MousePos.y$4);
         Link$26 = $As($Check(Link$26,"").Next,TG2LinkMouse);
      }
   }
   /// procedure TG2Core.OnRender()
   ,OnRender:function(Self) {
      var Link$27 = null;
      $Check($Check(g2,"")._Gfx,"").gl$1.clearColor(TG2Vec4$GetX($Check(g2,"")._ClearColor),TG2Vec4$GetY($Check(g2,"")._ClearColor),TG2Vec4$GetZ($Check(g2,"")._ClearColor),TG2Vec4$GetW($Check(g2,"")._ClearColor));
      $Check($Check(g2,"")._Gfx,"").gl$1.clearDepth(1);
      $Check($Check(g2,"")._Gfx,"").gl$1.clear(16640);
      Link$27 = $Check(Self,"")._LinkRender;
      while (Link$27!==null) {
         $CheckFunc($Check(Link$27,"").Proc$1,"")();
         Link$27 = $As($Check(Link$27,"").Next,TG2LinkRender);
      }
      TG2Core.SetRenderControl(g2,null);
      TG2Gfx.SetRenderTarget($Check(g2,"")._Gfx,null);
   }
   /// procedure TG2Core.OnScroll()
   ,OnScroll:function(Self) {
      var Shift = 0;
      var Link$28 = null;
      
    Shift = event.detail ? event.detail * -1 : event.wheelDelta / 40;
  Link$28 = $Check(Self,"")._LinkScroll;
      while (Link$28!==null) {
         $CheckFunc($Check(Link$28,"").Proc,"")(Shift);
         Link$28 = $As($Check(Link$28,"").Next,TG2LinkScroll);
      }
   }
   /// procedure TG2Core.OnTimer()
   ,OnTimer:function(Self) {
      var i$41 = 0;
      var t$3 = 0;
      var UpdateTime = 0;
      var UpdateCount = 0;
      var RenderCallback = null;
      if ($Check(Self,"")._TimerEnable) {
         t$3 = G2Time();
         if (!$Check(Self,"")._TimerPause) {
            $Check(Self,"")._TimeToUpdate = t$3-$Check(Self,"")._LastTick;
         }
         $Check(Self,"")._LastTick = t$3;
         UpdateTime = Trunc(1000/$Check(Self,"")._TargetUPS);
         UpdateCount = Trunc($Check(Self,"")._TimeToUpdate/UpdateTime);
         if (UpdateCount>2) {
            UpdateCount = 2;
         }
         var $temp60;
         for(i$41 = 0,$temp60 = UpdateCount;i$41<$temp60;i$41++) {
            TG2Core.OnUpdate(Self);
         }
         $Check(Self,"")._TimeToUpdate-=UpdateCount*UpdateTime;
         if ((t$3-$Check(Self,"")._LastFPSUpdate)>=2000) {
            $Check(Self,"")._LastFPSUpdate = t$3;
            $Check(Self,"")._FPS = Trunc($Check(Self,"")._TotalFrames*0.5);
            $Check(Self,"")._TotalFrames = 0;
         }
         TG2Core.OnRender(Self);
         $Check(Self,"")._TotalFrames+=1;
         RenderCallback = $Event0(Self,TG2Core.OnTimer);
         
      window.RequestAnimFrame(RenderCallback);
          }
   }
   /// procedure TG2Core.OnUpdate()
   ,OnUpdate:function(Self) {
      var Link$29 = null;
      Link$29 = $Check(Self,"")._LinkUpdate;
      while (Link$29!==null) {
         $CheckFunc($Check(Link$29,"").Proc$2,"")();
         Link$29 = $As($Check(Link$29,"").Next,TG2LinkProc);
      }
   }
   /// procedure TG2Core.PicQuad(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const x3: TG2Float; const y3: TG2Float; const tu0: TG2Float; const tv0: TG2Float; const tu1: TG2Float; const tv1: TG2Float; const tu2: TG2Float; const tv2: TG2Float; const tu3: TG2Float; const tv3: TG2Float; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicQuad$1:function(Self, x0, y0, x1$1, y1$1, x2$1, y2$1, x3, y3, tu0, tv0, tu1$1, tv1$1, tu2$1, tv2$1, tu3, tv3, Col, Texture$6, BlendMode$7, Filtering) {
      TG2Core.PicQuadCol$2(Self,x0,y0,x1$1,y1$1,x2$1,y2$1,x3,y3,tu0,tv0,tu1$1,tv1$1,tu2$1,tv2$1,tu3,tv3,Col,Col,Col,Col,Texture$6,BlendMode$7,Filtering);
   }
   /// procedure TG2Core.PicQuad(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Tex0: TG2Vec2; const Tex1: TG2Vec2; const Tex2: TG2Vec2; const Tex3: TG2Vec2; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicQuad:function(Self, Pos0$3, Pos1$3, Pos2$2, Pos3$2, Tex0$1, Tex1$1, Tex2$1, Tex3$1, Col$1, Texture$7, BlendMode$8, Filtering$1) {
      TG2Core.PicQuadCol$1(Self,Pos0$3,Pos1$3,Pos2$2,Pos3$2,Tex0$1,Tex1$1,Tex2$1,Tex3$1,Col$1,Col$1,Col$1,Col$1,Texture$7,BlendMode$8,Filtering$1);
   }
   /// procedure TG2Core.PicQuadCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const x3: TG2Float; const y3: TG2Float; const tu0: TG2Float; const tv0: TG2Float; const tu1: TG2Float; const tv1: TG2Float; const tu2: TG2Float; const tv2: TG2Float; const tu3: TG2Float; const tv3: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicQuadCol$2:function(Self, x0$1, y0$1, x1$2, y1$2, x2$2, y2$2, x3$1, y3$1, tu0$1, tv0$1, tu1$2, tv1$2, tu2$2, tv2$2, tu3$1, tv3$1, Col0$2, Col1$2, Col2$2, Col3$2, Texture$8, BlendMode$9, Filtering$2) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPic2D);
      TG2RenderControlPic2D.PicQuadCol($Check(Self,"")._RenderControlPic2D,G2Vec2(x0$1,y0$1),G2Vec2(x1$2,y1$2),G2Vec2(x2$2,y2$2),G2Vec2(x3$1,y3$1),G2Vec2(tu0$1,tv0$1),G2Vec2(tu1$2,tv1$2),G2Vec2(tu2$2,tv2$2),G2Vec2(tu3$1,tv3$1),Col0$2,Col1$2,Col2$2,Col3$2,Texture$8,BlendMode$9,Filtering$2);
   }
   /// procedure TG2Core.PicQuadCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Tex0: TG2Vec2; const Tex1: TG2Vec2; const Tex2: TG2Vec2; const Tex3: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicQuadCol$1:function(Self, Pos0$4, Pos1$4, Pos2$3, Pos3$3, Tex0$2, Tex1$2, Tex2$2, Tex3$2, Col0$3, Col1$3, Col2$3, Col3$3, Texture$9, BlendMode$10, Filtering$3) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPic2D);
      TG2RenderControlPic2D.PicQuadCol($Check(Self,"")._RenderControlPic2D,Pos0$4,Pos1$4,Pos2$3,Pos3$3,Tex0$2,Tex1$2,Tex2$2,Tex3$2,Col0$3,Col1$3,Col2$3,Col3$3,Texture$9,BlendMode$10,Filtering$3);
   }
   /// procedure TG2Core.PicRect(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const Col: TG2Vec4; const CenterX: TG2Float; const CenterY: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Rotation: TG2Float; const FlipU: Boolean; const FlipV: Boolean; const Texture: TG2Texture2DBase; const FrameWidth: Integer; const FrameHeight: Integer; const FrameID: Integer; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$7:function(Self, x$11, y$10, Width$15, Height$12, Col$2, CenterX, CenterY, ScaleX$3, ScaleY$3, Rotation$4, FlipU, FlipV, Texture$10, FrameWidth, FrameHeight, FrameID, BlendMode$11, Filtering$4) {
      TG2Core.PicRectCol$7(Self,x$11,y$10,Width$15,Height$12,Col$2,Col$2,Col$2,Col$2,CenterX,CenterY,ScaleX$3,ScaleY$3,Rotation$4,FlipU,FlipV,Texture$10,FrameWidth,FrameHeight,FrameID,BlendMode$11,Filtering$4);
   }
   /// procedure TG2Core.PicRect(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const Col: TG2Vec4; const CenterX: TG2Float; const CenterY: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Rotation: TG2Float; const FlipU: Boolean; const FlipV: Boolean; const Texture: TG2Texture2DBase; const FrameWidth: Integer; const FrameHeight: Integer; const FrameID: Integer; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$6:function(Self, Pos$3, Width$16, Height$13, Col$3, CenterX$1, CenterY$1, ScaleX$4, ScaleY$4, Rotation$5, FlipU$1, FlipV$1, Texture$11, FrameWidth$1, FrameHeight$1, FrameID$1, BlendMode$12, Filtering$5) {
      TG2Core.PicRectCol$6(Self,Pos$3,Width$16,Height$13,Col$3,Col$3,Col$3,Col$3,CenterX$1,CenterY$1,ScaleX$4,ScaleY$4,Rotation$5,FlipU$1,FlipV$1,Texture$11,FrameWidth$1,FrameHeight$1,FrameID$1,BlendMode$12,Filtering$5);
   }
   /// procedure TG2Core.PicRect(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const tu0: TG2Float; const tv0: TG2Float; const tu1: TG2Float; const tv1: TG2Float; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$5:function(Self, x$12, y$11, Width$17, Height$14, tu0$2, tv0$2, tu1$3, tv1$3, Col$4, Texture$12, BlendMode$13, Filtering$6) {
      TG2Core.PicRectCol$1(Self,x$12,y$11,Width$17,Height$14,Col$4,Col$4,Col$4,Col$4,tu0$2,tv0$2,tu1$3,tv1$3,Texture$12,BlendMode$13,Filtering$6);
   }
   /// procedure TG2Core.PicRect(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const TexRect: TG2Vec4; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$4:function(Self, Pos$4, Width$18, Height$15, TexRect, Col$5, Texture$13, BlendMode$14, Filtering$7) {
      TG2Core.PicRectCol(Self,Pos$4,Width$18,Height$15,Col$5,Col$5,Col$5,Col$5,TexRect,Texture$13,BlendMode$14,Filtering$7);
   }
   /// procedure TG2Core.PicRect(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$3:function(Self, x$13, y$12, Width$19, Height$16, Col$6, Texture$14, BlendMode$15, Filtering$8) {
      TG2Core.PicRectCol$3(Self,x$13,y$12,Width$19,Height$16,Col$6,Col$6,Col$6,Col$6,Texture$14,BlendMode$15,Filtering$8);
   }
   /// procedure TG2Core.PicRect(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$2:function(Self, Pos$5, Width$20, Height$17, Col$7, Texture$15, BlendMode$16, Filtering$9) {
      TG2Core.PicRectCol$2(Self,Pos$5,Width$20,Height$17,Col$7,Col$7,Col$7,Col$7,Texture$15,BlendMode$16,Filtering$9);
   }
   /// procedure TG2Core.PicRect(const x: TG2Float; const y: TG2Float; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect$1:function(Self, x$14, y$13, Col$8, Texture$16, BlendMode$17, Filtering$10) {
      TG2Core.PicRectCol$5(Self,x$14,y$13,Col$8,Col$8,Col$8,Col$8,Texture$16,BlendMode$17,Filtering$10);
   }
   /// procedure TG2Core.PicRect(const Pos: TG2Vec2; const Col: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRect:function(Self, Pos$6, Col$9, Texture$17, BlendMode$18, Filtering$11) {
      TG2Core.PicRectCol$5(Self,TG2Vec2$GetX$2(Pos$6),TG2Vec2$GetY$2(Pos$6),Col$9,Col$9,Col$9,Col$9,Texture$17,BlendMode$18,Filtering$11);
   }
   /// procedure TG2Core.PicRectCol(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const CenterX: TG2Float; const CenterY: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Rotation: TG2Float; const FlipU: Boolean; const FlipV: Boolean; const Texture: TG2Texture2DBase; const FrameWidth: Integer; const FrameHeight: Integer; const FrameID: Integer; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$7:function(Self, x$15, y$14, Width$21, Height$18, Col0$4, Col1$4, Col2$4, Col3$4, CenterX$2, CenterY$2, ScaleX$5, ScaleY$5, Rotation$6, FlipU$2, FlipV$2, Texture$18, FrameWidth$2, FrameHeight$2, FrameID$2, BlendMode$19, Filtering$12) {
      var Pts = [{Arr$3:[0,0]},{Arr$3:[0,0]},{Arr$3:[0,0]},{Arr$3:[0,0]}];
      var w$5 = 0;
      var h$2 = 0;
      var mr$3 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      var pc = 0;
      var py = 0;
      var px = 0;
      var tu = 0;
      var tv = 0;
      var tr0 = {Arr$3:[0,0]};
      var tr1 = {Arr$3:[0,0]};
      var tc0 = {Arr$3:[0,0]};
      var tc1 = {Arr$3:[0,0]};
      var tc2 = {Arr$3:[0,0]};
      var tc3 = {Arr$3:[0,0]};
      mr$3 = G2MatRotationZ(Rotation$6);
      w$5 = Width$21*ScaleX$5;
      h$2 = Height$18*ScaleY$5;
      TG2Vec2$SetValue$2(Pts[0],((-w$5)*CenterX$2),((-h$2)*CenterY$2));
      TG2Vec2$SetValue$2(Pts[1],(TG2Vec2$GetX$2(Pts[0])+w$5),TG2Vec2$GetY$2(Pts[0]));
      TG2Vec2$SetValue$2(Pts[2],TG2Vec2$GetX$2(Pts[0]),(TG2Vec2$GetY$2(Pts[0])+h$2));
      TG2Vec2$SetValue$2(Pts[3],(TG2Vec2$GetX$2(Pts[0])+w$5),(TG2Vec2$GetY$2(Pts[0])+h$2));
      Pts[0] = G2Vec2MatMul3x3(Pts[0],mr$3);
      Pts[1] = G2Vec2MatMul3x3(Pts[1],mr$3);
      Pts[2] = G2Vec2MatMul3x3(Pts[2],mr$3);
      Pts[3] = G2Vec2MatMul3x3(Pts[3],mr$3);
      TG2Vec2$SetX$2(Pts[0],(TG2Vec2$GetX$2(Pts[0])+x$15));
      TG2Vec2$SetY$2(Pts[0],(TG2Vec2$GetY$2(Pts[0])+y$14));
      TG2Vec2$SetX$2(Pts[1],(TG2Vec2$GetX$2(Pts[1])+x$15));
      TG2Vec2$SetY$2(Pts[1],(TG2Vec2$GetY$2(Pts[1])+y$14));
      TG2Vec2$SetX$2(Pts[2],(TG2Vec2$GetX$2(Pts[2])+x$15));
      TG2Vec2$SetY$2(Pts[2],(TG2Vec2$GetY$2(Pts[2])+y$14));
      TG2Vec2$SetX$2(Pts[3],(TG2Vec2$GetX$2(Pts[3])+x$15));
      TG2Vec2$SetY$2(Pts[3],(TG2Vec2$GetY$2(Pts[3])+y$14));
      tu = (FrameWidth$2/$Check(Texture$18,"")._Width)*$Check(Texture$18,"")._SizeTU;
      tv = (FrameHeight$2/$Check(Texture$18,"")._Height)*$Check(Texture$18,"")._SizeTV;
      pc = $Div($Check(Texture$18,"")._Width,FrameWidth$2);
      px = FrameID$2%pc;
      py = $Div(FrameID$2,pc);
      TG2Vec2$SetValue$2(tr0,(px*tu),(py*tv));
      TG2Vec2$SetValue$2(tr1,((px*tu)+tu),((py*tv)+tv));
      if (FlipU$2) {
         TG2Vec2$SetX$2(tc0,TG2Vec2$GetX$2(tr1));
         TG2Vec2$SetX$2(tc1,TG2Vec2$GetX$2(tr0));
         TG2Vec2$SetX$2(tc2,TG2Vec2$GetX$2(tr1));
         TG2Vec2$SetX$2(tc3,TG2Vec2$GetX$2(tr0));
      } else {
         TG2Vec2$SetX$2(tc0,TG2Vec2$GetX$2(tr0));
         TG2Vec2$SetX$2(tc1,TG2Vec2$GetX$2(tr1));
         TG2Vec2$SetX$2(tc2,TG2Vec2$GetX$2(tr0));
         TG2Vec2$SetX$2(tc3,TG2Vec2$GetX$2(tr1));
      }
      if (FlipV$2) {
         TG2Vec2$SetY$2(tc0,TG2Vec2$GetY$2(tr1));
         TG2Vec2$SetY$2(tc2,TG2Vec2$GetY$2(tr0));
         TG2Vec2$SetY$2(tc1,TG2Vec2$GetY$2(tr1));
         TG2Vec2$SetY$2(tc3,TG2Vec2$GetY$2(tr0));
      } else {
         TG2Vec2$SetY$2(tc0,TG2Vec2$GetY$2(tr0));
         TG2Vec2$SetY$2(tc2,TG2Vec2$GetY$2(tr1));
         TG2Vec2$SetY$2(tc1,TG2Vec2$GetY$2(tr0));
         TG2Vec2$SetY$2(tc3,TG2Vec2$GetY$2(tr1));
      }
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPic2D);
      TG2RenderControlPic2D.PicQuadCol($Check(Self,"")._RenderControlPic2D,Pts[0],Pts[1],Pts[2],Pts[3],tc0,tc1,tc2,tc3,Col0$4,Col1$4,Col2$4,Col3$4,Texture$18,BlendMode$19,Filtering$12);
   }
   /// procedure TG2Core.PicRectCol(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const CenterX: TG2Float; const CenterY: TG2Float; const ScaleX: TG2Float; const ScaleY: TG2Float; const Rotation: TG2Float; const FlipU: Boolean; const FlipV: Boolean; const Texture: TG2Texture2DBase; const FrameWidth: Integer; const FrameHeight: Integer; const FrameID: Integer; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$6:function(Self, Pos$7, Width$22, Height$19, Col0$5, Col1$5, Col2$5, Col3$5, CenterX$3, CenterY$3, ScaleX$6, ScaleY$6, Rotation$7, FlipU$3, FlipV$3, Texture$19, FrameWidth$3, FrameHeight$3, FrameID$3, BlendMode$20, Filtering$13) {
      TG2Core.PicRectCol$7(Self,TG2Vec2$GetX$2(Pos$7),TG2Vec2$GetY$2(Pos$7),Width$22,Height$19,Col0$5,Col1$5,Col2$5,Col3$5,CenterX$3,CenterY$3,ScaleX$6,ScaleY$6,Rotation$7,FlipU$3,FlipV$3,Texture$19,FrameWidth$3,FrameHeight$3,FrameID$3,BlendMode$20,Filtering$13);
   }
   /// procedure TG2Core.PicRectCol(const x: TG2Float; const y: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$5:function(Self, x$16, y$15, Col0$6, Col1$6, Col2$6, Col3$6, Texture$20, BlendMode$21, Filtering$14) {
      TG2Core.PicRectCol$3(Self,x$16,y$15,($Check(Texture$20,"")._Width),($Check(Texture$20,"")._Height),Col0$6,Col1$6,Col2$6,Col3$6,Texture$20,BlendMode$21,Filtering$14);
   }
   /// procedure TG2Core.PicRectCol(const Pos: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$4:function(Self, Pos$8, Col0$7, Col1$7, Col2$7, Col3$7, Texture$21, BlendMode$22, Filtering$15) {
      TG2Core.PicRectCol$3(Self,TG2Vec2$GetX$2(Pos$8),TG2Vec2$GetY$2(Pos$8),($Check(Texture$21,"")._Width),($Check(Texture$21,"")._Height),Col0$7,Col1$7,Col2$7,Col3$7,Texture$21,BlendMode$22,Filtering$15);
   }
   /// procedure TG2Core.PicRectCol(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$3:function(Self, x$17, y$16, Width$23, Height$20, Col0$8, Col1$8, Col2$8, Col3$8, Texture$22, BlendMode$23, Filtering$16) {
      TG2Core.PicRectCol$1(Self,x$17,y$16,Width$23,Height$20,Col0$8,Col1$8,Col2$8,Col3$8,0,0,$Check(Texture$22,"")._SizeTU,$Check(Texture$22,"")._SizeTV,Texture$22,BlendMode$23,Filtering$16);
   }
   /// procedure TG2Core.PicRectCol(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$2:function(Self, Pos$9, Width$24, Height$21, Col0$9, Col1$9, Col2$9, Col3$9, Texture$23, BlendMode$24, Filtering$17) {
      TG2Core.PicRectCol$3(Self,TG2Vec2$GetX$2(Pos$9),TG2Vec2$GetY$2(Pos$9),Width$24,Height$21,Col0$9,Col1$9,Col2$9,Col3$9,Texture$23,BlendMode$24,Filtering$17);
   }
   /// procedure TG2Core.PicRectCol(const x: TG2Float; const y: TG2Float; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const tu0: TG2Float; const tv0: TG2Float; const tu1: TG2Float; const tv1: TG2Float; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol$1:function(Self, x$18, y$17, Width$25, Height$22, Col0$10, Col1$10, Col2$10, Col3$10, tu0$3, tv0$3, tu1$4, tv1$4, Texture$24, BlendMode$25, Filtering$18) {
      var x0$2 = 0;
      var y0$2 = 0;
      var x1$3 = 0;
      var y1$3 = 0;
      x0$2 = x$18;
      y0$2 = y$17;
      x1$3 = x0$2+Width$25;
      y1$3 = y0$2+Height$22;
      TG2Core.PicQuadCol$2(Self,x0$2,y0$2,x1$3,y0$2,x0$2,y1$3,x1$3,y1$3,tu0$3,tv0$3,tu1$4,tv0$3,tu0$3,tv1$4,tu1$4,tv1$4,Col0$10,Col1$10,Col2$10,Col3$10,Texture$24,BlendMode$25,Filtering$18);
   }
   /// procedure TG2Core.PicRectCol(const Pos: TG2Vec2; const Width: TG2Float; const Height: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; const TexRect: TG2Vec4; const Texture: TG2Texture2DBase; BlendMode: TG2BlendMode = 2; Filtering: TG2Filter = 1)
   ,PicRectCol:function(Self, Pos$10, Width$26, Height$23, Col0$11, Col1$11, Col2$11, Col3$11, TexRect$1, Texture$25, BlendMode$26, Filtering$19) {
      TG2Core.PicRectCol$1(Self,TG2Vec2$GetX$2(Pos$10),TG2Vec2$GetY$2(Pos$10),Width$26,Height$23,Col0$11,Col1$11,Col2$11,Col3$11,TG2Vec4$GetX(TexRect$1),TG2Vec4$GetY(TexRect$1),TG2Vec4$GetZ(TexRect$1),TG2Vec4$GetW(TexRect$1),Texture$25,BlendMode$26,Filtering$19);
   }
   /// procedure TG2Core.PrimAdd(const Position: TG2Vec2; const Color: TG2Vec4)
   ,PrimAdd$1:function(Self, Position$5, Color$7) {
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Position$5,Color$7);
   }
   /// procedure TG2Core.PrimBegin(const PrimType: TG2Prim2DType; BlendMode: TG2BlendMode = 2)
   ,PrimBegin$1:function(Self, PrimType$1, BlendMode$27) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,PrimType$1,BlendMode$27);
   }
   /// procedure TG2Core.PrimCircleCol(const x: TG2Float; const y: TG2Float; const Radius: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; Segments: Integer = 16; BlendMode: TG2BlendMode = 2)
   ,PrimCircleCol$1:function(Self, x$19, y$18, Radius, Col0$12, Col1$12, Segments, BlendMode$28) {
      TG2Core.PrimCircleCol(Self,G2Vec2(x$19,y$18),Radius,Col0$12,Col1$12,Segments,BlendMode$28);
   }
   /// procedure TG2Core.PrimCircleCol(const Pos: TG2Vec2; const Radius: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; Segments: Integer = 16; BlendMode: TG2BlendMode = 2)
   ,PrimCircleCol:function(Self, Pos$11, Radius$1, Col0$13, Col1$13, Segments$1, BlendMode$29) {
      var i$42 = 0;
      var s$8 = {};
      s$8.v = 0;
      var c$11 = {};
      c$11.v = 0;
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,2,BlendMode$29);
      var $temp61;
      for(i$42 = 0,$temp61 = Segments$1;i$42<$temp61;i$42++) {
         G2SinCos(((i$42/Segments$1)*6.28318530717959),s$8,c$11);
         TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos$11,Col0$13);
         TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2((TG2Vec2$GetX$2(Pos$11)+(c$11.v*Radius$1)),(TG2Vec2$GetY$2(Pos$11)+(s$8.v*Radius$1))),Col1$13);
         G2SinCos((((i$42+1)/Segments$1)*6.28318530717959),s$8,c$11);
         TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2((TG2Vec2$GetX$2(Pos$11)+(c$11.v*Radius$1)),(TG2Vec2$GetY$2(Pos$11)+(s$8.v*Radius$1))),Col1$13);
      }
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimCircleHollow(const x: TG2Float; const y: TG2Float; const Radius: TG2Float; const Col: TG2Vec4; Segments: Integer = 16; BlendMode: TG2BlendMode = 2)
   ,PrimCircleHollow$1:function(Self, x$20, y$19, Radius$2, Col$10, Segments$2, BlendMode$30) {
      var s$9 = {};
      s$9.v = 0;
      var c$12 = {};
      c$12.v = 0;
      var i$43 = 0;
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$30);
      s$9.v = 0;
      c$12.v = 1;
      var $temp62;
      for(i$43 = 0,$temp62 = Segments$2;i$43<$temp62;i$43++) {
         TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2((x$20+(c$12.v*Radius$2)),(y$19+(s$9.v*Radius$2))),Col$10);
         G2SinCos((((i$43+1)/Segments$2)*6.28318530717959),s$9,c$12);
         TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2((x$20+(c$12.v*Radius$2)),(y$19+(s$9.v*Radius$2))),Col$10);
      }
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimCircleHollow(const Pos: TG2Vec2; const Radius: TG2Float; const Col: TG2Vec4; Segments: Integer = 16; BlendMode: TG2BlendMode = 2)
   ,PrimCircleHollow:function(Self, Pos$12, Radius$3, Col$11, Segments$3, BlendMode$31) {
      TG2Core.PrimCircleHollow$1(Self,TG2Vec2$GetX$2(Pos$12),TG2Vec2$GetY$2(Pos$12),Radius$3,Col$11,Segments$3,BlendMode$31);
   }
   /// procedure TG2Core.PrimEnd()
   ,PrimEnd$1:function(Self) {
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimLine(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimLine$1:function(Self, x0$3, y0$3, x1$4, y1$4, Col$12, BlendMode$32) {
      TG2Core.PrimLineCol(Self,G2Vec2(x0$3,y0$3),G2Vec2(x1$4,y1$4),Col$12,Col$12,BlendMode$32);
   }
   /// procedure TG2Core.PrimLine(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimLine:function(Self, Pos0$5, Pos1$5, Col$13, BlendMode$33) {
      TG2Core.PrimLineCol(Self,Pos0$5,Pos1$5,Col$13,Col$13,BlendMode$33);
   }
   /// procedure TG2Core.PrimLineCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimLineCol$1:function(Self, x0$4, y0$4, x1$5, y1$5, Col0$14, Col1$14, BlendMode$34) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$34);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$4,y0$4),Col0$14);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$5,y1$5),Col1$14);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimLineCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimLineCol:function(Self, Pos0$6, Pos1$6, Col0$15, Col1$15, BlendMode$35) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$35);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$6,Col0$15);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$6,Col1$15);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimQuad(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const x3: TG2Float; const y3: TG2Float; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuad$1:function(Self, x0$5, y0$5, x1$6, y1$6, x2$3, y2$3, x3$2, y3$2, Col$14, BlendMode$36) {
      TG2Core.PrimQuadCol$2(Self,x0$5,y0$5,x1$6,y1$6,x2$3,y2$3,x3$2,y3$2,Col$14,Col$14,Col$14,Col$14,BlendMode$36);
   }
   /// procedure TG2Core.PrimQuad(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuad:function(Self, Pos0$7, Pos1$7, Pos2$4, Pos3$4, Col$15, BlendMode$37) {
      TG2Core.PrimQuadCol$1(Self,Pos0$7,Pos1$7,Pos2$4,Pos3$4,Col$15,Col$15,Col$15,Col$15,BlendMode$37);
   }
   /// procedure TG2Core.PrimQuadCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const x3: TG2Float; const y3: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuadCol$2:function(Self, x0$6, y0$6, x1$7, y1$7, x2$4, y2$4, x3$3, y3$3, Col0$16, Col1$16, Col2$12, Col3$12, BlendMode$38) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,2,BlendMode$38);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$6,y0$6),Col0$16);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$7,y1$7),Col1$16);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$4,y2$4),Col2$12);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$4,y2$4),Col2$12);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$7,y1$7),Col1$16);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x3$3,y3$3),Col3$12);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimQuadCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuadCol$1:function(Self, Pos0$8, Pos1$8, Pos2$5, Pos3$5, Col0$17, Col1$17, Col2$13, Col3$13, BlendMode$39) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,2,BlendMode$39);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$8,Col0$17);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$8,Col1$17);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$5,Col2$13);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$5,Col2$13);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$8,Col1$17);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos3$5,Col3$13);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimQuadHollowCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const x3: TG2Float; const y3: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuadHollowCol$1:function(Self, x0$7, y0$7, x1$8, y1$8, x2$5, y2$5, x3$4, y3$4, Col0$18, Col1$18, Col2$14, Col3$14, BlendMode$40) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$40);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$7,y0$7),Col0$18);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$8,y1$8),Col1$18);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$8,y1$8),Col1$18);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x3$4,y3$4),Col3$14);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x3$4,y3$4),Col3$14);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$5,y2$5),Col2$14);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$5,y2$5),Col2$14);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$7,y0$7),Col0$18);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimQuadHollowCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Pos3: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimQuadHollowCol:function(Self, Pos0$9, Pos1$9, Pos2$6, Pos3$6, Col0$19, Col1$19, Col2$15, Col3$15, BlendMode$41) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$41);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$9,Col0$19);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$9,Col1$19);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$9,Col1$19);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos3$6,Col3$15);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos3$6,Col3$15);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$6,Col2$15);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$6,Col2$15);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$9,Col0$19);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimRect(const x: TG2Float; const y: TG2Float; const w: TG2Float; const h: TG2Float; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimRect:function(Self, x$21, y$20, w$6, h$3, Col$16, BlendMode$42) {
      TG2Core.PrimRectCol(Self,x$21,y$20,w$6,h$3,Col$16,Col$16,Col$16,Col$16,BlendMode$42);
   }
   /// procedure TG2Core.PrimRectCol(const x: TG2Float; const y: TG2Float; const w: TG2Float; const h: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimRectCol:function(Self, x$22, y$21, w$7, h$4, Col0$20, Col1$20, Col2$16, Col3$16, BlendMode$43) {
      var xh = 0;
      var yh = 0;
      xh = x$22+w$7;
      yh = y$21+h$4;
      TG2Core.PrimQuadCol$2(Self,x$22,y$21,xh,y$21,x$22,yh,xh,yh,Col0$20,Col1$20,Col2$16,Col3$16,BlendMode$43);
   }
   /// procedure TG2Core.PrimRectHollow(const x: TG2Float; const y: TG2Float; const w: TG2Float; const h: TG2Float; const Col: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimRectHollow:function(Self, x$23, y$22, w$8, h$5, Col$17, BlendMode$44) {
      TG2Core.PrimQuadHollowCol$1(Self,x$23,y$22,(x$23+w$8),y$22,x$23,(y$22+h$5),(x$23+w$8),(y$22+h$5),Col$17,Col$17,Col$17,Col$17,BlendMode$44);
   }
   /// procedure TG2Core.PrimRectHollowCol(const x: TG2Float; const y: TG2Float; const w: TG2Float; const h: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; const Col3: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimRectHollowCol:function(Self, x$24, y$23, w$9, h$6, Col0$21, Col1$21, Col2$17, Col3$17, BlendMode$45) {
      TG2Core.PrimQuadHollowCol$1(Self,x$24,y$23,(x$24+w$9),y$23,x$24,(y$23+h$6),(x$24+w$9),(y$23+h$6),Col0$21,Col1$21,Col2$17,Col3$17,BlendMode$45);
   }
   /// procedure TG2Core.PrimTriCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimTriCol$1:function(Self, x0$8, y0$8, x1$9, y1$9, x2$6, y2$6, Col0$22, Col1$22, Col2$18, BlendMode$46) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,2,BlendMode$46);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$8,y0$8),Col0$22);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$9,y1$9),Col1$22);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$6,y2$6),Col2$18);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimTriCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimTriCol:function(Self, Pos0$10, Pos1$10, Pos2$7, Col0$23, Col1$23, Col2$19, BlendMode$47) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,2,BlendMode$47);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$10,Col0$23);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$10,Col1$23);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$7,Col2$19);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimTriHollowCol(const x0: TG2Float; const y0: TG2Float; const x1: TG2Float; const y1: TG2Float; const x2: TG2Float; const y2: TG2Float; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimTriHollowCol$1:function(Self, x0$9, y0$9, x1$10, y1$10, x2$7, y2$7, Col0$24, Col1$24, Col2$20, BlendMode$48) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$48);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$9,y0$9),Col0$24);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$10,y1$10),Col1$24);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x1$10,y1$10),Col1$24);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$7,y2$7),Col2$20);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x2$7,y2$7),Col2$20);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,G2Vec2(x0$9,y0$9),Col0$24);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.PrimTriHollowCol(const Pos0: TG2Vec2; const Pos1: TG2Vec2; const Pos2: TG2Vec2; const Col0: TG2Vec4; const Col1: TG2Vec4; const Col2: TG2Vec4; BlendMode: TG2BlendMode = 2)
   ,PrimTriHollowCol:function(Self, Pos0$11, Pos1$11, Pos2$8, Col0$25, Col1$25, Col2$21, BlendMode$49) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlPrim2D);
      TG2RenderControlPrim2D.PrimBegin($Check(Self,"")._RenderControlPrim2D,1,BlendMode$49);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$11,Col0$25);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$11,Col1$25);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos1$11,Col1$25);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$8,Col2$21);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos2$8,Col2$21);
      TG2RenderControlPrim2D.PrimAdd($Check(Self,"")._RenderControlPrim2D,Pos0$11,Col0$25);
      TG2RenderControlPrim2D.PrimEnd($Check(Self,"")._RenderControlPrim2D);
   }
   /// procedure TG2Core.RenderPrimitive(const VB: TG2VertexBuffer; const IB: TG2IndexBuffer; const PrimitiveType: TG2PrimitiveType; const VertexStart: Integer; const VertexCount: Integer; const IndexStart: Integer; const PrimitiveCount: Integer; const Texture: TG2Texture2DBase; const W: TG2Mat; const V: TG2Mat; const P: TG2Mat)
   ,RenderPrimitive$3:function(Self, VB$6, IB$3, PrimitiveType$2, VertexStart$4, VertexCount$4, IndexStart$1, PrimitiveCount$2, Texture$26, W$3, V$4, P$3) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlBuffer);
      TG2RenderControlBuffer.RenderPrimitive($Check(Self,"")._RenderControlBuffer,VB$6,IB$3,PrimitiveType$2,VertexStart$4,VertexCount$4,IndexStart$1,PrimitiveCount$2,Texture$26,W$3,V$4,P$3);
   }
   /// procedure TG2Core.RenderPrimitive(const VB: TG2VertexBuffer; const PrimitiveType: TG2PrimitiveType; const VertexStart: Integer; const PrimitiveCount: Integer; const Texture: TG2Texture2DBase; const W: TG2Mat; const V: TG2Mat; const P: TG2Mat)
   ,RenderPrimitive$2:function(Self, VB$7, PrimitiveType$3, VertexStart$5, PrimitiveCount$3, Texture$27, W$4, V$5, P$4) {
      TG2Core.SetRenderControl(Self,$Check(Self,"")._RenderControlBuffer);
      TG2RenderControlBuffer.RenderPrimitive$1($Check(Self,"")._RenderControlBuffer,VB$7,PrimitiveType$3,VertexStart$5,PrimitiveCount$3,Texture$27,W$4,V$5,P$4);
   }
   /// procedure TG2Core.SetHeight(const Value: Integer)
   ,SetHeight$2:function(Self, Value$12) {
      TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).height = Value$12;
   }
   /// procedure TG2Core.SetRenderControl(const Value: TG2RenderControl)
   ,SetRenderControl:function(Self, Value$13) {
      if (Value$13===$Check(Self,"")._RenderControl) {
         return;
      }
      if ($Check(Self,"")._RenderControl!==null) {
         TG2RenderControl.RenderStop$($Check($Check(Self,"")._RenderControl,""));
      }
      $Check(Self,"")._RenderControl = Value$13;
      if ($Check(Self,"")._RenderControl!==null) {
         TG2RenderControl.RenderStart$($Check($Check(Self,"")._RenderControl,""));
      }
   }
   /// procedure TG2Core.SetWidth(const Value: Integer)
   ,SetWidth$3:function(Self, Value$14) {
      TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"")._Canvas,"")).width = Value$14;
   }
   /// procedure TG2Core.Start()
   ,Start$1:function(Self) {
      TG2Core.Initialize$3(g2);
   }
   /// procedure TG2Core.Stop()
   ,Stop$1:function(Self) {
      TG2Core.Finalize$1(g2);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2BufferUsage enumeration
var TG2BufferUsage = [ "buNone", "buWriteOnly", "buReadWrite" ];
/// TG2BufferLockMode enumeration
var TG2BufferLockMode = [ "lmNone", "lmReadOnly", "lmReadWrite" ];
/// TG2BlendMode enumeration
var TG2BlendMode = [ "bmInvalid", "bmDisable", "bmNormal", "bmAdd", "bmSub", "bmMul" ];
function G2TypedArrayCopy(Src, Dst, SrcStart, DstStart, Size$5) {
   
    var DstU8 = new Uint8Array(Dst, DstStart, Size$5);
    var SrcU8 = new Uint8Array(Src, SrcStart, Size$5);
    DstU8.set(SrcU8);
  };
function G2NewVariant() {
   var Result = undefined;
   
    Result = {};
  return Result
};
/// anonymous TRecordSymbol
function Copy$a$34(s,d) {
   d.NodeID$7=s.NodeID$7;
   Copy$TG2Mat(s.Bind$5,d.Bind$5);
   Copy$TG2Box(s.BBox$3,d.BBox$3);
   d.VCount$3=s.VCount$3;
   return d;
}
function Clone$a$34($) {
   return {
      NodeID$7:$.NodeID$7,
      Bind$5:Clone$TG2Mat($.Bind$5),
      BBox$3:Clone$TG2Box($.BBox$3),
      VCount$3:$.VCount$3
   }
}
function Pub$a$34($) {
   return {
      "NodeID" : $.NodeID$7
      ,"Bind" : Pub$TG2Mat($.Bind$5)
      ,"BBox" : Pub$TG2Box($.BBox$3)
      ,"VCount" : $.VCount$3
   }
}
/// anonymous TRecordSymbol
function Copy$a$35(s,d) {
   d.Material=s.Material;
   d.VertexStart$1=s.VertexStart$1;
   d.VertexCount$2=s.VertexCount$2;
   d.FaceStart$1=s.FaceStart$1;
   d.FaceCount$1=s.FaceCount$1;
   return d;
}
function Clone$a$35($) {
   return {
      Material:$.Material,
      VertexStart$1:$.VertexStart$1,
      VertexCount$2:$.VertexCount$2,
      FaceStart$1:$.FaceStart$1,
      FaceCount$1:$.FaceCount$1
   }
}
function Pub$a$35($) {
   return {
      "Material" : $.Material
      ,"VertexStart" : $.VertexStart$1
      ,"VertexCount" : $.VertexCount$2
      ,"FaceStart" : $.FaceStart$1
      ,"FaceCount" : $.FaceCount$1
   }
}
/// anonymous TRecordSymbol
function Copy$a$36(s,d) {
   Copy$TG2Vec3(s.Scaling$1,d.Scaling$1);
   Copy$TG2Quat(s.Rotation$2,d.Rotation$2);
   Copy$TG2Vec3(s.Translation$1,d.Translation$1);
   return d;
}
function Clone$a$36($) {
   return {
      Scaling$1:Clone$TG2Vec3($.Scaling$1),
      Rotation$2:Clone$TG2Quat($.Rotation$2),
      Translation$1:Clone$TG2Vec3($.Translation$1)
   }
}
function Pub$a$36($) {
   return {
      "Scaling" : Pub$TG2Vec3($.Scaling$1)
      ,"Rotation" : Pub$TG2Quat($.Rotation$2)
      ,"Translation" : Pub$TG2Vec3($.Translation$1)
   }
}
/// anonymous TRecordSymbol
function Copy$a$37(s,d) {
   d.NodeID$8=s.NodeID$8;
   d.Frames$3=s.Frames$3;
   return d;
}
function Clone$a$37($) {
   return {
      NodeID$8:$.NodeID$8,
      Frames$3:$.Frames$3
   }
}
function Pub$a$37($) {
   return {
      "NodeID" : $.NodeID$8
      ,"Frames" : $.Frames$3
   }
}
/// anonymous TRecordSymbol
function Copy$a$38(s,d) {
   d.Name$12=s.Name$12;
   d.TwoSided$1=s.TwoSided$1;
   d.MapDiffuse=s.MapDiffuse;
   d.MapLight=s.MapLight;
   return d;
}
function Clone$a$38($) {
   return {
      Name$12:$.Name$12,
      TwoSided$1:$.TwoSided$1,
      MapDiffuse:$.MapDiffuse,
      MapLight:$.MapLight
   }
}
function Pub$a$38($) {
   return {
      "Name" : $.Name$12
      ,"TwoSided" : $.TwoSided$1
      ,"MapDiffuse" : $.MapDiffuse
      ,"MapLight" : $.MapLight
   }
}
/// anonymous TRecordSymbol
function Copy$a$39(s,d) {
   Copy$TG2Mat(s.TransformDef,d.TransformDef);
   Copy$TG2Mat(s.TransformCur,d.TransformCur);
   Copy$TG2Mat(s.TransformCom,d.TransformCom);
   return d;
}
function Clone$a$39($) {
   return {
      TransformDef:Clone$TG2Mat($.TransformDef),
      TransformCur:Clone$TG2Mat($.TransformCur),
      TransformCom:Clone$TG2Mat($.TransformCom)
   }
}
function Pub$a$39($) {
   return {
      "TransformDef" : Pub$TG2Mat($.TransformDef)
      ,"TransformCur" : Pub$TG2Mat($.TransformCur)
      ,"TransformCom" : Pub$TG2Mat($.TransformCom)
   }
}
function WriteLn(value$2) {
   if (window.console) {
      window.console.log(value$2);
   }
};
function w3_unbind(obj_ref, event_name) {
   obj_ref[event_name] = null;
};
function w3_StrToArray(aText, aDelimiter) {
   return (aText).split(aDelimiter);
};
function w3_StrLikeInArray(aLike, aArray) {
   var Result = 0;
   var x = 0;
   var mLen1 = 0;
   var mLen2 = 0;
   Result = -1;
   mLen1 = aLike.length;
   if ((mLen1>0)&&(aArray.length>0)) {
      var $temp63;
      for(x = 0,$temp63 = aArray.length;x<$temp63;x++) {
         mLen2 = $DIdxR(aArray,x,"").length;
         if (mLen2>=mLen1) {
            if ($DIdxR(aArray,x,"").substr(0,mLen1)==aLike) {
               Result = x;
               break;
            }
         }
      }
   }
   return Result
};
function w3_StringReplace(aValue, aToReplace, aNewValue) {
   return StrReplace(aValue,aToReplace,aNewValue);
};
function w3_ShowMessage(aText$1) {
   alert(aText$1);
};
function w3_setStyle(tagRef, aStyleName, aStyleValue) {
   if (tagRef) {
      tagRef.style[aStyleName] = aStyleValue;
   }
};
function w3_setProperty(tagRef$1, aPropName, aValue$1) {
   tagRef$1[aPropName] = aValue$1;
};
function w3_SetInnerHtml(aRef, aValue$2) {
   aRef.innerHTML = aValue$2;
};
function w3_setElementParentByRef(aElement, aParent) {
   if (VarIsValidRef(aParent)) {
      if (VarIsValidRef(aElement)) {
         aParent.appendChild(aElement);
      } else {
         throw Exception.Create($New(Exception),"Failed to add element to parent, element is null");
      }
   }
};
function w3_setElementParentByName(aElement$1, aParentName) {
   var mTemp = undefined;
   mTemp = w3_getElementByName(aParentName);
   if (VarIsValidRef(mTemp)) {
      mTemp.appendChild(aElement$1);
   }
};
function w3_setAttrib(tagRef$2, aAttribName, aValue$3) {
   if (tagRef$2) {
      tagRef$2.setAttribute(aAttribName,aValue$3);
   }
};
function w3_RequestAnimationFrame(aMethod) {
   var Result = undefined;
   if (!vRequestAnimFrame) {
      InitAnimationFrameShim();
   }
   Result = $CheckFunc(vRequestAnimFrame,"")(aMethod);
   return Result
};
function w3_RemoveEvent(a_tagRef, a_eventName, a_callback, a_useCapture) {
   if (a_eventName=="mousewheel") {
      a_eventName = "DOMMouseScroll";
   }
   a_tagRef.removeEventListener(a_eventName,a_callback,a_useCapture);
};
function w3_RemoveElementByRef(aElement$2, aParent$1) {
   if (aParent$1) {
      aParent$1.removeChild(aElement$2);
   }
};
function w3_RemoveClass(tagRef$3, aClassName) {
   var reg = undefined;
   if (w3_HasClass(tagRef$3,aClassName)) {
      
      reg = new RegExp("(\\s|^)" + aClassName + "(\\s|$)");
      (tagRef$3).className=(tagRef$3).className.replace(reg," ").replace('  ',' ').trim();
       }
};
function w3_RegisterBrowserAPI(aDriver) {
   vDriver = aDriver;
};
function w3_Prompt(aText$2, aDefault) {
   return ""+prompt(aText$2,aDefault);
};
function w3_NameToUrlStr(aUrl) {
   return "url("+aUrl+")";
};
function w3_HasClass(tagRef$4, aClassName$1) {
   var Result = false;
   
    Result = ((tagRef$4).className.match(new RegExp("(\\s|^)"+aClassName$1+"(\\s|$)")))?true:false;
  return Result
};
function w3_GetUniqueObjId() {
   var Result = "";
   ++vUniqueNumber;
   Result = "OBJ"+vUniqueNumber.toString();
   return Result
};
function w3_GetUniqueNumber() {
   var Result = 0;
   ++vUniqueNumber;
   Result = vUniqueNumber;
   return Result
};
function w3_getStyleAsStr(tagRef$5, aStyleName$1) {
   var Result = "";
   var mData;
   mData = w3_getStyle(tagRef$5,aStyleName$1);
   if (TVariant.IsString(mData)) {
      Result = TVariant.AsString(mData);
   } else if (TVariant.IsNumber(mData)) {
      Result = TVariant.AsInteger(mData).toString();
   }
   return Result
};
function w3_getStyleAsInt(tagRef$6, aStyleName$2) {
   var Result = 0;
   var mData$1;
   mData$1 = w3_getStyle(tagRef$6,aStyleName$2);
   if (TVariant.IsNumber(mData$1)) {
      Result = parseInt(mData$1,10);
   } else if (TVariant.IsString(mData$1)) {
      Result = parseInt(mData$1,10);
   }
   if (isNaN(Result)) {
      Result = 0;
   }
   return Result
};
function w3_getStyleAsFloat(tagRef$7, aStyleName$3) {
   var Result = 0;
   var mData$2 = undefined;
   mData$2 = w3_getStyle(tagRef$7,aStyleName$3);
   if (VarIsValidRef(mData$2)) {
      try {
         if (TVariant.IsNumber(mData$2)) {
            Result = TVariant.AsFloat(mData$2);
            if (isNaN(Result)) {
               Result = 0;
            }
         } else if (TVariant.IsString(mData$2)) {
            Result = Number(mData$2);
            if (isNaN(Result)) {
               Result = 0;
            }
         }
      } catch ($e) {
         var e$8 = $W($e);
         /* null */
      }
   }
   return Result
};
function w3_getStyle(tagRef$8, aStyleName$4) {
   var Result = undefined;
   var mObj = undefined;
   mObj = document.defaultView.getComputedStyle(tagRef$8,null);
   if (mObj) {
      Result = mObj.getPropertyValue(aStyleName$4);
   }
   return Result
};
function w3_getPropertyAsStr(tagRef$9, aPropName$1) {
   var Result = "";
   if (tagRef$9) {
      Result = ""+tagRef$9[aPropName$1];
   }
   return Result
};
function w3_getPropertyAsInt(tagRef$10, aPropName$2) {
   var Result = 0;
   if (tagRef$10) {
      Result = parseInt(tagRef$10[aPropName$2],10);
   }
   return Result
};
function w3_getPropertyAsFloat(tagRef$11, aPropName$3) {
   var Result = 0;
   if (tagRef$11) {
      Result = Number(tagRef$11[aPropName$3]);
   }
   return Result
};
function w3_getPropertyAsBool(tagRef$12, aPropName$4) {
   var Result = false;
   if (tagRef$12) {
      Result = (tagRef$12[aPropName$4]?true:false);
   }
   return Result
};
function w3_getProperty(tagRef$13, aPropName$5) {
   return tagRef$13[aPropName$5];
};
function w3_getIsSafari() {
   var Result = false;
   
    if (navigator.userAgent.match(/Safari/i)) Result=true;
  return Result
};
function w3_getIsOpera() {
   var Result = false;
   
    if (navigator.userAgent.match(/Opera/i)) Result=true;
  return Result
};
function w3_getIsMobile() {
   var Result = false;
   
    if (navigator.userAgent.match(/mobi/i)) Result=true;
  return Result
};
function w3_getIsIPod() {
   var Result = false;
   
    if (navigator.userAgent.match(/iPod/i)) Result=true;
  return Result
};
function w3_getIsIPhone() {
   var Result = false;
   
    if (navigator.userAgent.match(/iPhone/i)) Result=true;
  return Result
};
function w3_getIsIPad() {
   var Result = false;
   
    if (navigator.userAgent.match(/iPad/i)) Result=true;
  return Result
};
function w3_getIsInternetExplorer() {
   var Result = false;
   
    if (navigator.userAgent.match(/MSIE/i)) Result=true;
  return Result
};
function w3_getIsFirefox() {
   var Result = false;
   
    if (navigator.userAgent.match(/Firefox/i)) Result=true;
  return Result
};
function w3_getIsChrome() {
   var Result = false;
   
    if (navigator.userAgent.match(/Chrome/i)) Result=true;
  return Result
};
function w3_getIsAndroid() {
   var Result = false;
   
    if (navigator.userAgent.match(/Android/i)) Result=true;
  return Result
};
function w3_GetInnerHtml(aRef$1) {
   return ""+aRef$1.innerHTML;
};
function w3_getElementByName(aElementName) {
   return document.getElementByName(aElementName);
};
function w3_getCursorCSSName(aCursor) {
   var Result = "";
   switch (aCursor) {
      case 0 :
         Result = "auto";
         break;
      case 2 :
         Result = "inherited";
         break;
      case 3 :
         Result = "url";
         break;
      case 4 :
         Result = "crosshair";
         break;
      case 5 :
         Result = "help";
         break;
      case 6 :
         Result = "move";
         break;
      case 7 :
         Result = "pointer";
         break;
      case 8 :
         Result = "progress";
         break;
      case 9 :
         Result = "text";
         break;
      case 10 :
         Result = "wait";
         break;
      case 11 :
         Result = "n-resize";
         break;
      case 12 :
         Result = "s-resize";
         break;
      case 13 :
         Result = "e-resize";
         break;
      case 14 :
         Result = "w-resize";
         break;
      case 15 :
         Result = "ne-resize";
         break;
      case 16 :
         Result = "nw-resize";
         break;
      case 17 :
         Result = "se-resize";
         break;
      case 18 :
         Result = "sw-resize";
         break;
      default :
         Result = "default";
   }
   return Result
};
function w3_getCalcStyleFor(tagRef$14) {
   return document.defaultView.getComputedStyle(tagRef$14,null);
};
function w3_GetBrowserName() {
   var Result = "";
   switch (w3_BrowserVendor()) {
      case 0 :
         Result = "Unknown browser";
         break;
      case 1 :
         Result = "Safari mobile";
         break;
      case 2 :
         Result = "Chrome mobile";
         break;
      case 3 :
         Result = "Chrome";
         break;
      case 4 :
         Result = "Safari";
         break;
      case 5 :
         Result = "FireFox";
         break;
      case 6 :
         Result = "Opera";
         break;
      case 7 :
         Result = "Internet explorer";
         break;
   }
   return Result
};
function w3_getAttribAsStr(tagRef$15, aAttribName$1) {
   var Result = "";
   var mValue;
   mValue = tagRef$15.getAttribute(aAttribName$1,0);
   if (mValue) {
      Result = ""+mValue;
   }
   return Result
};
function w3_getAttribAsInt(tagRef$16, aAttribName$2) {
   var Result = 0;
   var mValue$1;
   mValue$1 = tagRef$16.getAttribute(aAttribName$2,0);
   if (mValue$1) {
      Result = parseInt(mValue$1,10);
   }
   return Result
};
function w3_getAttrib(tagRef$17, aAttribName$3) {
   var Result = undefined;
   if (tagRef$17) {
      Result = tagRef$17.getAttribute(aAttribName$3);
   }
   return Result
};
function w3_Event() {
   return event;
};
function w3_DOMReady() {
   return document.readyState=="complete";
};
function w3_CSSPrefixDef(aCSS) {
   return "-"+$Check(BrowserAPI(),"").FCSSToken+"-"+aCSS;
};
function w3_CSSPrefix(aCSS$1) {
   return $Check(BrowserAPI(),"").FCSSToken+aCSS$1;
};
function w3_createHtmlElement(aTypeName) {
   return document.createElement(aTypeName);
};
function w3_CancelAnimationFrame(handle) {
   if (!vCancelAnimFrame) {
      InitAnimationFrameShim();
   }
   $CheckFunc(vCancelAnimFrame,"")(handle);
};
function w3_Callback(aMethod$1, aDelay) {
   setTimeout(aMethod$1,aDelay);
};
function w3_BrowserVendor() {
   var Result = 0;
   if (vDriver===null) {
      BrowserAPI();
   }
   Result = vVendor;
   return Result
};
function w3_bind2(obj_ref$1, event_name$1, callback) {
   obj_ref$1[event_name$1] = callback;
};
function w3_bind(obj_id, event_name$2, callback$1) {
   document.getElementById(obj_id)[event_name$2] = callback$1;
};
function w3_base64encode(aValue$4) {
   var Result = "";
   if (VarIsValidRef(aValue$4)) {
      Result = ""+window.btoa(aValue$4);
   }
   return Result
};
function w3_base64decode(aValue$5) {
   var Result = undefined;
   if (aValue$5!="") {
      Result = window.atob(aValue$5);
   } else {
      Result = undefined;
   }
   return Result
};
function w3_AddEvent(a_tagRef$1, a_eventName$1, a_callback$1, a_useCapture$1) {
   if (a_eventName$1=="mousewheel") {
      a_eventName$1 = "DOMMouseScroll";
   }
   a_tagRef$1.addEventListener(a_eventName$1,a_callback$1,a_useCapture$1);
};
function w3_AddClass(tagRef$18, aClassName$2) {
   if (!w3_HasClass(tagRef$18,aClassName$2)) {
      tagRef$18.className+=" "+aClassName$2;
   }
};
function VarIsValidRef(aRef$2) {
   var Result = false;
   
    Result = !((aRef$2 == null) || (aRef$2 == undefined));
  return Result
};
function VariantToObj(Value$15) {
   var Result = null;
   
    Result = Value$15;
  return Result
};
function VariantExtend(target$4, prop) {
   var Result = undefined;
   var n = undefined;
   
     for (n in prop) if ((prop).hasOwnProperty(n)) target$4[n]=prop[n];
     Result = target$4;
   return Result
};
function VariantExtend$1(target$5, prop$1) {
   var Result = null;
   var n$1 = undefined;
   
     for (n$1 in prop$1) if ((prop$1).hasOwnProperty(n$1)) target$5[n$1]=prop$1[n];
     Result = target$5;
   return Result
};
/// TW3CustomBrowserAPI = class (TObject)
var TW3CustomBrowserAPI = {
   $ClassName:"TW3CustomBrowserAPI",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FCSSAnimation = $.FCSSBackgroundColor = $.FCSSBackgroundImage = $.FCSSBackgroundPos = $.FCSSBackgroundSize = $.FCSSToken = $.FCSSTransform = "";
   }
   /// function TW3CustomBrowserAPI.DevicePixelRatio() : Float
   ,DevicePixelRatio:function() {
      var Result = 0;
      
   Result = window.devicePixelRatio || 1;
   return Result
   }
   ,Destroy:TObject.Destroy
};
/// TW3WebkitBrowserAPI = class (TW3CustomBrowserAPI)
var TW3WebkitBrowserAPI = {
   $ClassName:"TW3WebkitBrowserAPI",
   $Parent:TW3CustomBrowserAPI
   ,$Init:function ($) {
      TW3CustomBrowserAPI.$Init($);
   }
   /// constructor TW3WebkitBrowserAPI.Create()
   ,Create$5:function(Self) {
      $Check(Self,"").FCSSToken = "webkit";
      $Check(Self,"").FCSSBackgroundImage = "background-image";
      $Check(Self,"").FCSSBackgroundSize = "webkitbackgroundSize";
      $Check(Self,"").FCSSBackgroundPos = "webkitbackgroundPosition";
      $Check(Self,"").FCSSBackgroundColor = "webkitbackgroundColor";
      $Check(Self,"").FCSSTransform = "webkitTransform";
      $Check(Self,"").FCSSAnimation = "webkitAnimation";
      return Self
   }
   ,Destroy:TObject.Destroy
};
/// TW3RGBA = record
function Copy$TW3RGBA(s,d) {
   d.A$1=s.A$1;
   d.B=s.B;
   d.G=s.G;
   d.R=s.R;
   return d;
}
function Clone$TW3RGBA($) {
   return {
      A$1:$.A$1,
      B:$.B,
      G:$.G,
      R:$.R
   }
}
/// function TW3RGBA.Brighter(var Self: TW3RGBA; aPercent: Integer) : TW3RGBA
function TW3RGBA$Brighter(Self$2, aPercent) {
   var Result = {A$1:0,B:0,G:0,R:0};
   var f$2 = 0;
   f$2 = ClampInt(aPercent,0,100)/100;
   Result.R = Math.round(Self$2.R*f$2)+Math.round(255-(f$2*255));
   Result.G = Math.round(Self$2.G*f$2)+Math.round(255-(f$2*255));
   Result.B = Math.round(Self$2.B*f$2)+Math.round(255-(f$2*255));
   Result.A$1 = Self$2.A$1;
   return Result
}
/// function TW3RGBA.Create(const R: Integer; const G: Integer; const B: Integer; const A: Integer) : TW3RGBA
function Create$6(R$2, G$2, B$2, A$3) {
   var Result = {A$1:0,B:0,G:0,R:0};
   Result.R = R$2;
   Result.G = G$2;
   Result.B = B$2;
   Result.A$1 = A$3;
   return Result
}
/// function TW3RGBA.Darker(var Self: TW3RGBA; aPercent: Integer) : TW3RGBA
function TW3RGBA$Darker(Self$3, aPercent$1) {
   var Result = {A$1:0,B:0,G:0,R:0};
   var f$3 = 0;
   f$3 = ClampInt(aPercent$1,0,100)/100;
   Result.R = ClampInt(Self$3.R-Math.round(Self$3.R*f$3),0,255);
   Result.G = ClampInt(Self$3.G-Math.round(Self$3.G*f$3),0,255);
   Result.B = ClampInt(Self$3.B-Math.round(Self$3.B*f$3),0,255);
   Result.A$1 = Self$3.A$1;
   return Result
}
/// function TW3RGBA.GetIntensity(var Self: TW3RGBA) : Integer
function TW3RGBA$GetIntensity(Self$4) {
   var Result = 0;
   Result = Self$4.R+Self$4.G+Self$4.B;
   if (Result>0) {
      Result = $Div(Result,3);
   }
   return Result
}
/// function TW3RGBA.GetIntensityOf(const aValue: TW3RGBA) : Integer
function GetIntensityOf(aValue$6) {
   var Result = 0;
   Result = aValue$6.R+aValue$6.G+aValue$6.B;
   if (Result>0) {
      Result = $Div(Result,3);
   }
   return Result
}
/// function TW3RGBA.Negative(var Self: TW3RGBA) : TW3RGBA
function TW3RGBA$Negative(Self$5) {
   var Result = {A$1:0,B:0,G:0,R:0};
   Result.R = 255-Self$5.R;
   Result.G = 255-Self$5.G;
   Result.B = 255-Self$5.B;
   Result.A$1 = Self$5.A$1;
   return Result
}
/// function TW3RGBA.NegativeOf(const aValue: TW3RGBA) : TW3RGBA
function NegativeOf(aValue$7) {
   var Result = {A$1:0,B:0,G:0,R:0};
   Result.R = 255-aValue$7.R;
   Result.G = 255-aValue$7.G;
   Result.B = 255-aValue$7.B;
   Result.A$1 = aValue$7.A$1;
   return Result
}
/// function TW3RGBA.ToColor(var Self: TW3RGBA) : TColor
function TW3RGBA$ToColor(Self$6) {
   return RGBToColor(Self$6.R,Self$6.G,Self$6.B);
}
/// function TW3RGBA.ToString(var Self: TW3RGBA) : String
function TW3RGBA$ToString(Self$7) {
   return ColorToWebStr$1(Self$7.R,Self$7.G,Self$7.B,Self$7.A$1);
}
/// TW3OwnedObject = class (TObject)
var TW3OwnedObject = {
   $ClassName:"TW3OwnedObject",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FOwner = null;
   }
   /// function TW3OwnedObject.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject) {
      return true;
   }
   /// constructor TW3OwnedObject.Create(AOwner: TObject)
   ,Create$7:function(Self, AOwner) {
      TObject.Create(Self);
      if (TW3OwnedObject.AcceptParent$($Check(Self,""),AOwner)) {
         $Check(Self,"").FOwner = AOwner;
      } else {
         throw EW3Exception.CreateFmt($New(EW3OwnedObject),"Method %s in class %s threw exception [%s]",["constructor", TObject.ClassName($Check(Self,"").ClassType), "Unsuitable owner object-type error"]);
      }
      return Self
   }
   ,Destroy:TObject.Destroy
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7$:function($){return $.ClassType.Create$7.apply($.ClassType, arguments)}
};
/// TW3OperaBrowserAPI = class (TW3CustomBrowserAPI)
var TW3OperaBrowserAPI = {
   $ClassName:"TW3OperaBrowserAPI",
   $Parent:TW3CustomBrowserAPI
   ,$Init:function ($) {
      TW3CustomBrowserAPI.$Init($);
   }
   /// constructor TW3OperaBrowserAPI.Create()
   ,Create$8:function(Self) {
      $Check(Self,"").FCSSToken = "O";
      $Check(Self,"").FCSSBackgroundImage = "OBackgroundImage";
      $Check(Self,"").FCSSBackgroundSize = "OBackgroundSize";
      $Check(Self,"").FCSSBackgroundPos = "OBackgroundPosition";
      $Check(Self,"").FCSSBackgroundColor = "backgroundColor";
      $Check(Self,"").FCSSTransform = "OTransform";
      $Check(Self,"").FCSSAnimation = "OAnimation";
      return Self
   }
   ,Destroy:TObject.Destroy
};
/// TW3IEBrowserAPI = class (TW3CustomBrowserAPI)
var TW3IEBrowserAPI = {
   $ClassName:"TW3IEBrowserAPI",
   $Parent:TW3CustomBrowserAPI
   ,$Init:function ($) {
      TW3CustomBrowserAPI.$Init($);
   }
   /// constructor TW3IEBrowserAPI.Create()
   ,Create$9:function(Self) {
      $Check(Self,"").FCSSToken = "ms";
      $Check(Self,"").FCSSBackgroundImage = "msBackgroundImage";
      $Check(Self,"").FCSSBackgroundSize = "msBackgroundSize";
      $Check(Self,"").FCSSBackgroundPos = "msBackgroundPosition";
      $Check(Self,"").FCSSBackgroundColor = "backgroundColor";
      $Check(Self,"").FCSSTransform = "msTransform";
      $Check(Self,"").FCSSAnimation = "msAnimation";
      return Self
   }
   ,Destroy:TObject.Destroy
};
/// TW3FirefoxBrowserAPI = class (TW3CustomBrowserAPI)
var TW3FirefoxBrowserAPI = {
   $ClassName:"TW3FirefoxBrowserAPI",
   $Parent:TW3CustomBrowserAPI
   ,$Init:function ($) {
      TW3CustomBrowserAPI.$Init($);
   }
   /// constructor TW3FirefoxBrowserAPI.Create()
   ,Create$10:function(Self) {
      $Check(Self,"").FCSSToken = "Moz";
      $Check(Self,"").FCSSBackgroundImage = "backgroundImage";
      $Check(Self,"").FCSSBackgroundSize = "backgroundSize";
      $Check(Self,"").FCSSBackgroundPos = "backgroundPosition";
      $Check(Self,"").FCSSBackgroundColor = "backgroundColor";
      $Check(Self,"").FCSSTransform = "MozTransform";
      $Check(Self,"").FCSSAnimation = "MozAnimation";
      return Self
   }
   ,Destroy:TObject.Destroy
};
/// TW3BrowserVendor enumeration
var TW3BrowserVendor = [ "bvUnknown", "bviOS", "bvAndroid", "bvChrome", "bvSafari", "bvFirefox", "bvOpera", "bvIE" ];
/// TVariant = class (TObject)
var TVariant = {
   $ClassName:"TVariant",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TVariant.AsBool(const aValue: Variant) : Boolean
   ,AsBool:function(aValue$8) {
      var Result = false;
      if (VarIsValidRef(aValue$8)) {
         Result = (aValue$8?true:false);
      }
      return Result
   }
   /// function TVariant.AsFloat(const aValue: Variant) : Float
   ,AsFloat:function(aValue$9) {
      var Result = 0;
      if (VarIsValidRef(aValue$9)) {
         Result = Number(aValue$9);
      }
      return Result
   }
   /// function TVariant.AsInteger(const aValue: Variant) : Integer
   ,AsInteger:function(aValue$10) {
      var Result = 0;
      if (VarIsValidRef(aValue$10)) {
         Result = parseInt(aValue$10,10);
      }
      return Result
   }
   /// function TVariant.AsObject(const aValue: Variant) : TObject
   ,AsObject:function(aValue$11) {
      var Result = null;
      if (VarIsValidRef(aValue$11)) {
         
      Result = aValue$11;
          } else {
         Result = null;
      }
      return Result
   }
   /// function TVariant.AsString(const aValue: Variant) : String
   ,AsString:function(aValue$12) {
      var Result = "";
      if (VarIsValidRef(aValue$12)) {
         Result = ""+aValue$12;
      }
      return Result
   }
   /// function TVariant.CreateArray() : Variant
   ,CreateArray:function() {
      var Result = undefined;
      
    return [];
  return Result
   }
   /// function TVariant.CreateObject() : Variant
   ,CreateObject:function() {
      var Result = undefined;
      
    return {};
  return Result
   }
   /// function TVariant.IsBool(const aValue: Variant) : Boolean
   ,IsBool:function(aValue$13) {
      var Result = false;
      
    if (aValue$13 == null) return false;
    if (aValue$13 == undefined) return false;
    if (typeof(aValue$13) === "boolean") return true;
  return Result
   }
   /// function TVariant.IsInteger(const aValue: Variant) : Boolean
   ,IsInteger:function(aValue$14) {
      var Result = false;
      
    if (aValue$14 == null) return false;
    if (aValue$14 == undefined) return false;
    if (typeof(aValue$14) === "number") if (parseInt(aValue$14) === aValue$14) return true;
  return Result
   }
   /// function TVariant.IsNAN(const aValue: Variant) : Boolean
   ,IsNAN:function(aValue$15) {
      return isNaN(Number(aValue$15));
   }
   /// function TVariant.IsNull(const aValue: Variant) : Boolean
   ,IsNull:function(aValue$16) {
      return (aValue$16===null);
   }
   /// function TVariant.IsNumber(const aValue: Variant) : Boolean
   ,IsNumber:function(aValue$17) {
      var Result = false;
      
    if (aValue$17 == null) return false;
    if (aValue$17 == undefined) return false;
    if (typeof(aValue$17) === "number") return true;
  return Result
   }
   /// function TVariant.IsString(const aValue: Variant) : Boolean
   ,IsString:function(aValue$18) {
      var Result = false;
      
    if (aValue$18 == null) return false;
    if (aValue$18 == undefined) return false;
    if (typeof(aValue$18) === "string") return true;
  return Result
   }
   /// function TVariant.OwnProperties(const aValue: Variant) : TStrArray
   ,OwnProperties:function(aValue$19) {
      var Result = [];
      var buf = undefined;
      
    for (buf in aValue$19) if ((aValue$19).hasOwnProperty(buf)) (Result).push(buf);
  return Result
   }
   /// function TVariant.Properties(const aValue: Variant) : TStrArray
   ,Properties:function(aValue$20) {
      var Result = [];
      var buf$1 = undefined;
      
    for (buf$1 in aValue$20) (Result).push(buf$1);
  return Result
   }
   ,Destroy:TObject.Destroy
};
/// TRectF = record
function Copy$TRectF(s,d) {
   d.Bottom=s.Bottom;
   d.Left=s.Left;
   d.Right=s.Right;
   d.Top=s.Top;
   return d;
}
function Clone$TRectF($) {
   return {
      Bottom:$.Bottom,
      Left:$.Left,
      Right:$.Right,
      Top:$.Top
   }
}
/// function TRectF.BottomRight(var Self: TRectF) : TPointF
function TRectF$BottomRight(Self$8) {
   var Result = {X:0,Y:0};
   Result.X = Self$8.Right;
   Result.Y = Self$8.Bottom;
   return Result
}
/// function TRectF.CenterPoint(var Self: TRectF) : TPointF
function TRectF$CenterPoint(Self$9) {
   var Result = {X:0,Y:0};
   Result.X = (Self$9.Right+Self$9.Left)*0.5;
   Result.Y = (Self$9.Bottom+Self$9.Top)*0.5;
   return Result
}
/// function TRectF.Clip(var Self: TRectF; const RectToClip: TRectF) : TRectF
function TRectF$Clip(Self$10, RectToClip) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   Result.Left = Math.max(Self$10.Left,RectToClip.Left);
   Result.Top = Math.max(Self$10.Top,RectToClip.Top);
   Result.Right = Math.min(Self$10.Right,RectToClip.Right);
   Result.Bottom = Math.min(Self$10.Bottom,RectToClip.Bottom);
   return Result
}
/// function TRectF.Compare(var Self: TRectF; const aRect: TRectF) : Boolean
function TRectF$Compare(Self$11, aRect) {
   return (((Self$11.Left==aRect.Left)&&(Self$11.Top==aRect.Top))&&(Self$11.Right==aRect.Right))&&(Self$11.Bottom==aRect.Bottom);
}
/// function TRectF.ContainsCol(var Self: TRectF; const aCol: Float) : Boolean
function TRectF$ContainsCol(Self$12, aCol) {
   return (aCol>=Self$12.Left)&&(aCol<=Self$12.Right);
}
/// function TRectF.ContainsPoint(var Self: TRectF; const aPoint: TPointF) : Boolean
function TRectF$ContainsPoint(Self$13, aPoint) {
   return (((aPoint.X>=Self$13.Left)&&(aPoint.X<=Self$13.Right))&&(aPoint.Y>=Self$13.Top))&&(aPoint.Y<=Self$13.Bottom);
}
/// function TRectF.ContainsPos(var Self: TRectF; const aLeft: Float; const aTop: Float) : Boolean
function TRectF$ContainsPos(Self$14, aLeft, aTop) {
   return (((aLeft>=Self$14.Left)&&(aLeft<=Self$14.Right))&&(aTop>=Self$14.Top))&&(aTop<=Self$14.Bottom);
}
/// function TRectF.ContainsRect(var Self: TRectF; const aRect: TRectF) : Boolean
function TRectF$ContainsRect(Self$15, aRect$1) {
   return TRectF$Expose(Self$15,aRect$1)!=2;
}
/// function TRectF.ContainsRow(var Self: TRectF; const aRow: Float) : Boolean
function TRectF$ContainsRow(Self$16, aRow) {
   return (aRow>=Self$16.Top)&&(aRow<=Self$16.Bottom);
}
/// function TRectF.Create(const topLeft: TPointF; const bottomRight: TPointF) : TRectF
function Create$12(topLeft, bottomRight) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   Result.Left = topLeft.X;
   Result.Top = topLeft.Y;
   Result.Right = bottomRight.X;
   Result.Bottom = bottomRight.Y;
   return Result
}
/// function TRectF.Create(const aLeft: Float; const aTop: Float; const aRight: Float; const aBottom: Float) : TRectF
function Create$11(aLeft$1, aTop$1, aRight, aBottom) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   Result.Left = aLeft$1;
   Result.Top = aTop$1;
   Result.Right = aRight;
   Result.Bottom = aBottom;
   return Result
}
/// function TRectF.CreateBounded(x1: Float; y1: Float; x2: Float; y2: Float) : TRectF
function CreateBounded(x1$11, y1$11, x2$8, y2$8) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   if (x1$11<x2$8) {
      Result.Left = x1$11;
      Result.Right = x2$8;
   } else {
      Result.Left = x2$8;
      Result.Right = x1$11;
   }
   if (y1$11<y2$8) {
      Result.Top = y1$11;
      Result.Bottom = y2$8;
   } else {
      Result.Top = y2$8;
      Result.Bottom = y1$11;
   }
   return Result
}
/// function TRectF.CreateSized(const aWidth: Float; const aHeight: Float) : TRectF
function CreateSized$1(aWidth, aHeight) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   Result.Left = 0;
   Result.Top = 0;
   Result.Right = aWidth;
   Result.Bottom = aHeight;
   return Result
}
/// function TRectF.CreateSized(const aLeft: Float; const aTop: Float; const aWidth: Float; const aHeight: Float) : TRectF
function CreateSized(aLeft$2, aTop$2, aWidth$1, aHeight$1) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   Result.Left = aLeft$2;
   Result.Top = aTop$2;
   Result.Right = aLeft$2+aWidth$1;
   Result.Bottom = aTop$2+aHeight$1;
   return Result
}
/// function TRectF.Empty(var Self: TRectF) : Boolean
function TRectF$Empty(Self$17) {
   return (Self$17.Left==Self$17.Right)&&(Self$17.Top==Self$17.Bottom);
}
/// function TRectF.Expose(var Self: TRectF; const aChildRect: TRectF) : TExposure
function TRectF$Expose(Self$18, aChildRect) {
   var Result = 0;
   if ((((aChildRect.Left>=Self$18.Right)||(aChildRect.Top>=Self$18.Bottom))||(aChildRect.Right<=Self$18.Left))||(aChildRect.Bottom<=Self$18.Top)) {
      Result = 2;
   } else if ((((aChildRect.Left<Self$18.Left)||(aChildRect.Top<Self$18.Top))||(aChildRect.Right>(Self$18.Right-1)))||(aChildRect.Bottom>(Self$18.Bottom-1))) {
      Result = 1;
   } else {
      Result = 0;
   }
   return Result
}
/// function TRectF.Extend(var Self: TRectF; x: Float; y: Float) : Boolean
function TRectF$Extend$1(Self$19, x$25, y$24) {
   var Result = false;
   if (x$25<Self$19.Left) {
      Self$19.Left = x$25;
      Result = true;
   } else if (x$25>Self$19.Right) {
      Self$19.Right = x$25;
      Result = true;
   }
   if (y$24<Self$19.Top) {
      Self$19.Top = y$24;
      Result = true;
   } else if (y$24>Self$19.Bottom) {
      Self$19.Bottom = y$24;
      Result = true;
   }
   return Result
}
/// function TRectF.Extend(var Self: TRectF; const aPoint: TPointF) : Boolean
function TRectF$Extend(Self$20, aPoint$1) {
   return TRectF$Extend$1(Self$20,aPoint$1.X,aPoint$1.Y);
}
/// function TRectF.FitWithin(var Self: TRectF; const aChildRect: TRectF) : TRectF
function TRectF$FitWithin(Self$21, aChildRect$1) {
   var Result = {Bottom:0,Left:0,Right:0,Top:0};
   var x1$12 = 0;
   var y1$12 = 0;
   var rc = {Bottom:0,Left:0,Right:0,Top:0};
   var x$26 = 0;
   var y$25 = 0;
   var wd = 0;
   var hd = 0;
   wd = TRectF$Width(aChildRect$1);
   hd = TRectF$Height(aChildRect$1);
   if ((wd<1)||(hd<1)) {
      Copy$TRectF({Bottom:0,Left:0,Right:0,Top:0},Result);
      return Result;
   }
   if ((TRectF$Width(Self$21)>wd)&&(TRectF$Height(Self$21)>hd)) {
      Copy$TRectF(Self$21,Result);
      x$26 = (TRectF$Width(Self$21)-wd)/2;
      y$25 = (TRectF$Height(Self$21)-hd)/2;
      Result = Create$11((Result.Left+x$26),(Result.Top+y$25),(Result.Left+wd),(Result.Top+hd));
   } else {
      x1$12 = TRectF$Width(Self$21)/wd;
      y1$12 = TRectF$Height(Self$21)/hd;
      if (x1$12>y1$12) {
         x$26 = Trunc(wd*y1$12);
         rc = Create$11(((TRectF$Width(Self$21)-x$26)/2),0,(rc.Left+x$26),TRectF$Height(Self$21));
      } else {
         y$25 = Trunc(hd*x1$12);
         rc = Create$11(0,((TRectF$Height(Self$21)-y$25)/2),TRectF$Width(Self$21),(rc.Top+y$25));
      }
      Result = Create$11((rc.Left+Self$21.Left),(rc.Top+Self$21.Top),(rc.Right+Self$21.Left),(rc.Bottom+Self$21.Top));
   }
   return Result
}
/// function TRectF.Height(var Self: TRectF) : Float
function TRectF$Height(Self$22) {
   return Self$22.Bottom-Self$22.Top;
}
/// function TRectF.Intersect(var Self: TRectF; const aRect: TRectF; var intersection: TRectF) : Boolean
function TRectF$Intersect(Self$23, aRect$2, intersection) {
   var Result = false;
   Copy$TRectF(Self$23,intersection);
   if (aRect$2.Left>Self$23.Left) {
      intersection.Left = aRect$2.Left;
   }
   if (aRect$2.Top>Self$23.Top) {
      intersection.Top = aRect$2.Top;
   }
   if (aRect$2.Right<Self$23.Right) {
      intersection.Right = aRect$2.Right;
   }
   if (aRect$2.Bottom<Self$23.Bottom) {
      intersection.Bottom = aRect$2.Bottom;
   }
   Result = (intersection.Right>intersection.Left)&&(intersection.Bottom>intersection.Top);
   if (!Result) {
      Copy$TRectF({Bottom:0,Left:0,Right:0,Top:0},intersection);
   }
   return Result
}
/// procedure TRectF.Move(var Self: TRectF; const aCol: Float; const aRow: Float; const Center: Boolean)
function TRectF$Move(Self$24, aCol$1, aRow$1, Center) {
   var wd$1 = 0;
   var hd$1 = 0;
   wd$1 = Self$24.Right-Self$24.Left;
   hd$1 = Self$24.Bottom-Self$24.Top;
   if (Center) {
      Self$24.Left = aCol$1-(wd$1*0.5);
      Self$24.Top = aRow$1-(hd$1*0.5);
      Self$24.Right = aCol$1+(wd$1*0.5);
      Self$24.Bottom = aCol$1+(hd$1*0.5);
   } else {
      Self$24.Left = aCol$1;
      Self$24.Top = aRow$1;
      Self$24.Right = aCol$1+wd$1;
      Self$24.Bottom = aRow$1+hd$1;
   }
}
/// procedure TRectF.MoveBy(var Self: TRectF; x: Float; y: Float)
function TRectF$MoveBy(Self$25, x$27, y$26) {
   Self$25.Left+=x$27;
   Self$25.Right+=x$27;
   Self$25.Top+=y$26;
   Self$25.Bottom+=y$26;
}
/// procedure TRectF.SetBounds(var Self: TRectF; aLeft: Float; aTop: Float; aRight: Float; aBottom: Float)
function TRectF$SetBounds(Self$26, aLeft$3, aTop$3, aRight$1, aBottom$1) {
   Self$26.Left = aLeft$3;
   Self$26.Top = aTop$3;
   Self$26.Right = aRight$1;
   Self$26.Bottom = aBottom$1;
}
/// function TRectF.TopLeft(var Self: TRectF) : TPointF
function TRectF$TopLeft(Self$27) {
   var Result = {X:0,Y:0};
   Result.X = Self$27.Left;
   Result.Y = Self$27.Top;
   return Result
}
/// function TRectF.ToPolygon(var Self: TRectF) : TPointArrayF
function TRectF$ToPolygon(Self$28) {
   return [Create$15(Self$28.Left,Self$28.Top), Create$15(Self$28.Right,Self$28.Top), Create$15(Self$28.Right,Self$28.Bottom), Create$15(Self$28.Left,Self$28.Bottom)].slice();
}
/// function TRectF.ToString(var Self: TRectF) : String
function TRectF$ToString$1(Self$29) {
   return (Self$29.Left.toString()+","+Self$29.Top.toString()+","+Self$29.Right.toString()+","+Self$29.Bottom.toString());
}
/// function TRectF.Width(var Self: TRectF) : Float
function TRectF$Width(Self$30) {
   return Self$30.Right-Self$30.Left;
}
/// TRect = record
function Copy$TRect(s,d) {
   d.Bottom$1=s.Bottom$1;
   d.Left$1=s.Left$1;
   d.Right$1=s.Right$1;
   d.Top$1=s.Top$1;
   return d;
}
function Clone$TRect($) {
   return {
      Bottom$1:$.Bottom$1,
      Left$1:$.Left$1,
      Right$1:$.Right$1,
      Top$1:$.Top$1
   }
}
/// function TRect.BottomRight(var Self: TRect) : TPoint
function TRect$BottomRight$1(Self$31) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Self$31.Right$1;
   Result.Y$1 = Self$31.Bottom$1;
   return Result
}
/// function TRect.CenterPoint(var Self: TRect) : TPoint
function TRect$CenterPoint$1(Self$32) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = $Div(Self$32.Right$1+Self$32.Left$1,2);
   Result.Y$1 = $Div(Self$32.Top$1+Self$32.Bottom$1,2);
   return Result
}
/// function TRect.Clip(var Self: TRect; const RectToClip: TRect) : TRect
function TRect$Clip$1(Self$33, RectToClip$1) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   Result.Left$1 = Math.max(Self$33.Left$1,RectToClip$1.Left$1);
   Result.Top$1 = Math.max(Self$33.Top$1,RectToClip$1.Top$1);
   Result.Right$1 = Math.min(Self$33.Right$1,RectToClip$1.Right$1);
   Result.Bottom$1 = Math.min(Self$33.Bottom$1,RectToClip$1.Bottom$1);
   return Result
}
/// function TRect.Compare(var Self: TRect; const aRect: TRect) : Boolean
function TRect$Compare$1(Self$34, aRect$3) {
   return (((Self$34.Left$1==aRect$3.Left$1)&&(Self$34.Top$1==aRect$3.Top$1))&&(Self$34.Right$1==aRect$3.Right$1))&&(Self$34.Bottom$1==aRect$3.Bottom$1);
}
/// function TRect.ContainsCol(var Self: TRect; const aCol: Integer) : Boolean
function TRect$ContainsCol$1(Self$35, aCol$2) {
   return (aCol$2>=Self$35.Left$1)&&(aCol$2<=Self$35.Right$1);
}
/// function TRect.ContainsPoint(var Self: TRect; const aPoint: TPoint) : Boolean
function TRect$ContainsPoint$1(Self$36, aPoint$2) {
   return (((aPoint$2.X$1>=Self$36.Left$1)&&(aPoint$2.X$1<=Self$36.Right$1))&&(aPoint$2.Y$1>=Self$36.Top$1))&&(aPoint$2.Y$1<=Self$36.Bottom$1);
}
/// function TRect.ContainsPos(var Self: TRect; const aLeft: Integer; const aTop: Integer) : Boolean
function TRect$ContainsPos$1(Self$37, aLeft$4, aTop$4) {
   return (((aLeft$4>=Self$37.Left$1)&&(aLeft$4<=Self$37.Right$1))&&(aTop$4>=Self$37.Top$1))&&(aTop$4<=Self$37.Bottom$1);
}
/// function TRect.ContainsRect(var Self: TRect; const aRect: TRect) : Boolean
function TRect$ContainsRect$1(Self$38, aRect$4) {
   return TRect$Expose$1(Self$38,aRect$4)!=2;
}
/// function TRect.ContainsRow(var Self: TRect; const aRow: Integer) : Boolean
function TRect$ContainsRow$1(Self$39, aRow$2) {
   return (aRow$2>=Self$39.Top$1)&&(aRow$2<=Self$39.Bottom$1);
}
/// function TRect.Create(const topLeft: TPoint; const bottomRight: TPoint) : TRect
function Create$14(topLeft$1, bottomRight$1) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   Result.Left$1 = topLeft$1.X$1;
   Result.Top$1 = topLeft$1.Y$1;
   Result.Right$1 = bottomRight$1.X$1;
   Result.Bottom$1 = bottomRight$1.Y$1;
   return Result
}
/// function TRect.Create(const aLeft: Integer; const aTop: Integer; const aRight: Integer; const aBottom: Integer) : TRect
function Create$13(aLeft$5, aTop$5, aRight$2, aBottom$2) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   Result.Left$1 = aLeft$5;
   Result.Top$1 = aTop$5;
   Result.Right$1 = aRight$2;
   Result.Bottom$1 = aBottom$2;
   return Result
}
/// function TRect.CreateSized(const aWidth: Integer; const aHeight: Integer) : TRect
function CreateSized$3(aWidth$2, aHeight$2) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   Result.Left$1 = 0;
   Result.Top$1 = 0;
   Result.Right$1 = aWidth$2;
   Result.Bottom$1 = aHeight$2;
   return Result
}
/// function TRect.CreateSized(const aLeft: Integer; const aTop: Integer; const aWidth: Integer; const aHeight: Integer) : TRect
function CreateSized$2(aLeft$6, aTop$6, aWidth$3, aHeight$3) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   Result.Left$1 = aLeft$6;
   Result.Top$1 = aTop$6;
   Result.Right$1 = aLeft$6+aWidth$3;
   Result.Bottom$1 = aTop$6+aHeight$3;
   return Result
}
/// function TRect.Empty(var Self: TRect) : Boolean
function TRect$Empty$1(Self$40) {
   return (Self$40.Left$1==Self$40.Right$1)&&(Self$40.Top$1==Self$40.Bottom$1);
}
/// function TRect.Expose(var Self: TRect; const aChildRect: TRect) : TExposure
function TRect$Expose$1(Self$41, aChildRect$2) {
   var Result = 0;
   if ((((aChildRect$2.Left$1>=Self$41.Right$1)||(aChildRect$2.Top$1>=Self$41.Bottom$1))||(aChildRect$2.Right$1<=Self$41.Left$1))||(aChildRect$2.Bottom$1<=Self$41.Top$1)) {
      Result = 2;
   } else if ((((aChildRect$2.Left$1<Self$41.Left$1)||(aChildRect$2.Top$1<Self$41.Top$1))||(aChildRect$2.Right$1>(Self$41.Right$1-1)))||(aChildRect$2.Bottom$1>(Self$41.Bottom$1-1))) {
      Result = 1;
   } else {
      Result = 0;
   }
   return Result
}
/// function TRect.Extend(var Self: TRect; const aPoint: TPoint) : Boolean
function TRect$Extend$3(Self$42, aPoint$3) {
   return TRect$Extend$2(Self$42,aPoint$3.X$1,aPoint$3.Y$1);
}
/// function TRect.Extend(var Self: TRect; x: Integer; y: Integer) : Boolean
function TRect$Extend$2(Self$43, x$28, y$27) {
   var Result = false;
   if (x$28<Self$43.Left$1) {
      Self$43.Left$1 = x$28;
      Result = true;
   } else if (x$28>Self$43.Right$1) {
      Self$43.Right$1 = x$28;
      Result = true;
   }
   if (y$27<Self$43.Top$1) {
      Self$43.Top$1 = y$27;
      Result = true;
   } else if (y$27>Self$43.Bottom$1) {
      Self$43.Bottom$1 = y$27;
      Result = true;
   }
   return Result
}
/// function TRect.FitWithin(var Self: TRect; const aChildRect: TRect) : TRect
function TRect$FitWithin$1(Self$44, aChildRect$3) {
   var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
   var x1$13 = 0;
   var y1$13 = 0;
   var x$29 = 0;
   var y$28 = 0;
   var wd$2 = 0;
   var hd$2 = 0;
   wd$2 = TRect$Width$1(aChildRect$3);
   hd$2 = TRect$Height$1(aChildRect$3);
   if ((wd$2<1)||(hd$2<1)) {
      Copy$TRect({Bottom$1:0,Left$1:0,Right$1:0,Top$1:0},Result);
      return Result;
   }
   if ((TRect$Width$1(Self$44)>wd$2)&&(TRect$Height$1(Self$44)>hd$2)) {
      Copy$TRect(Self$44,Result);
      x$29 = $Div(TRect$Width$1(Self$44)-wd$2,2);
      y$28 = $Div(TRect$Height$1(Self$44)-hd$2,2);
      Result = Create$13((Result.Left$1+x$29),(Result.Top$1+y$28),(Result.Left$1+wd$2),(Result.Top$1+hd$2));
   } else {
      x1$13 = TRect$Width$1(Self$44)/wd$2;
      y1$13 = TRect$Height$1(Self$44)/hd$2;
      if (x1$13>y1$13) {
         x$29 = Trunc(wd$2*y1$13);
         Result = Create$13(((TRect$Width$1(Self$44)-x$29)>>>1),0,(aChildRect$3.Left$1+x$29),TRect$Height$1(Self$44));
      } else {
         y$28 = Trunc(hd$2*x1$13);
         Result = Create$13(0,((TRect$Height$1(Self$44)-y$28)>>>1),TRect$Width$1(Self$44),(aChildRect$3.Top$1+y$28));
      }
      TRect$MoveBy$1(Result,Self$44.Left$1,Self$44.Top$1);
   }
   return Result
}
/// function TRect.Height(var Self: TRect) : Integer
function TRect$Height$1(Self$45) {
   return Self$45.Bottom$1-Self$45.Top$1;
}
/// function TRect.Intersect(var Self: TRect; const aRect: TRect; var intersection: TRect) : Boolean
function TRect$Intersect$1(Self$46, aRect$5, intersection$1) {
   var Result = false;
   Copy$TRect(Self$46,intersection$1);
   if (aRect$5.Left$1>Self$46.Left$1) {
      intersection$1.Left$1 = aRect$5.Left$1;
   }
   if (aRect$5.Top$1>Self$46.Top$1) {
      intersection$1.Top$1 = aRect$5.Top$1;
   }
   if (aRect$5.Right$1<Self$46.Right$1) {
      intersection$1.Right$1 = aRect$5.Right$1;
   }
   if (aRect$5.Bottom$1<Self$46.Bottom$1) {
      intersection$1.Bottom$1 = aRect$5.Bottom$1;
   }
   Result = (intersection$1.Right$1>intersection$1.Left$1)&&(intersection$1.Bottom$1>intersection$1.Top$1);
   if (!Result) {
      Copy$TRect({Bottom$1:0,Left$1:0,Right$1:0,Top$1:0},intersection$1);
   }
   return Result
}
/// procedure TRect.Move(var Self: TRect; const aCol: Integer; const aRow: Integer; const Center: Boolean)
function TRect$Move$1(Self$47, aCol$3, aRow$3, Center$1) {
   var wd$3 = 0;
   var hd$3 = 0;
   wd$3 = TRect$Width$1(Self$47);
   hd$3 = TRect$Height$1(Self$47);
   if (Center$1) {
      Self$47.Left$1 = aCol$3-($Div(wd$3,2));
      Self$47.Top$1 = aRow$3-($Div(hd$3,2));
      Self$47.Right$1 = aCol$3+($Div(wd$3,2));
      Self$47.Bottom$1 = aCol$3+($Div(hd$3,2));
   } else {
      Self$47.Left$1 = aCol$3;
      Self$47.Top$1 = aRow$3;
      Self$47.Right$1 = aCol$3+wd$3;
      Self$47.Bottom$1 = aRow$3+hd$3;
   }
}
/// procedure TRect.MoveBy(var Self: TRect; dX: Integer; dY: Integer)
function TRect$MoveBy$1(Self$48, dX, dY) {
   (Self$48.Left$1+= dX);
   (Self$48.Right$1+= dX);
   (Self$48.Top$1+= dY);
   (Self$48.Bottom$1+= dY);
}
/// procedure TRect.SetBounds(var Self: TRect; aLeft: Integer; aTop: Integer; aRight: Integer; aBottom: Integer)
function TRect$SetBounds$1(Self$49, aLeft$7, aTop$7, aRight$3, aBottom$3) {
   Self$49.Left$1 = aLeft$7;
   Self$49.Top$1 = aTop$7;
   Self$49.Right$1 = aRight$3;
   Self$49.Bottom$1 = aBottom$3;
}
/// function TRect.TopLeft(var Self: TRect) : TPoint
function TRect$TopLeft$1(Self$50) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Self$50.Left$1;
   Result.Y$1 = Self$50.Top$1;
   return Result
}
/// function TRect.ToPolygon(var Self: TRect) : TPointArray
function TRect$ToPolygon$1(Self$51) {
   return [Create$16(Self$51.Left$1,Self$51.Top$1), Create$16(Self$51.Right$1,Self$51.Top$1), Create$16(Self$51.Right$1,Self$51.Bottom$1), Create$16(Self$51.Left$1,Self$51.Bottom$1)].slice();
}
/// function TRect.ToString(var Self: TRect) : String
function TRect$ToString$2(Self$52) {
   return (Self$52.Left$1.toString()+","+Self$52.Top$1.toString()+","+Self$52.Right$1.toString()+","+Self$52.Bottom$1.toString());
}
/// function TRect.Width(var Self: TRect) : Integer
function TRect$Width$1(Self$53) {
   return Self$53.Right$1-Self$53.Left$1;
}
/// TPointF = record
function Copy$TPointF(s,d) {
   d.X=s.X;
   d.Y=s.Y;
   return d;
}
function Clone$TPointF($) {
   return {
      X:$.X,
      Y:$.Y
   }
}
/// function TPointF.AngleTo(var Self: TPointF; const aPoint: TPointF) : Float
function TPointF$AngleTo(Self$54, aPoint$4) {
   var Result = 0;
   var dx = 0;
   var dy = 0;
   dx = aPoint$4.X-Self$54.X;
   dy = aPoint$4.X-Self$54.Y;
   if (Math.abs(dx)<0.01) {
      if (dy>0) {
         Result = 1.5707963267949;
      } else {
         Result = -1.5707963267949;
      }
   } else {
      Result = Math.atan(dy/dx);
   }
   return Result
}
/// function TPointF.Compare(var Self: TPointF; const aPoint: TPointF) : Boolean
function TPointF$Compare$2(Self$55, aPoint$5) {
   return (aPoint$5.X==Self$55.X)&&(aPoint$5.Y==Self$55.Y);
}
/// function TPointF.Create(const aCol: Float; const aRow: Float) : TPointF
function Create$15(aCol$4, aRow$4) {
   var Result = {X:0,Y:0};
   Result.X = aCol$4;
   Result.Y = aRow$4;
   return Result
}
/// function TPointF.Displace(var Self: TPointF; radius: Float; angle: Float) : TPointF
function TPointF$Displace(Self$56, radius, angle) {
   var Result = {X:0,Y:0};
   Result.X = Self$56.X+(radius*Math.cos(angle));
   Result.Y = Self$56.X+(radius*Math.sin(angle));
   return Result
}
/// function TPointF.Distance(var Self: TPointF; const aPoint: TPointF) : Float
function TPointF$Distance(Self$57, aPoint$6) {
   return Math.sqrt(Math.pow(Self$57.X-aPoint$6.X,2)+Math.pow(Self$57.Y-aPoint$6.Y,2));
}
/// function TPointF.Expand(var Self: TPointF; const b: Float) : TPointF
function TPointF$Expand$1(Self$58, b$6) {
   var Result = {X:0,Y:0};
   Result.X = Self$58.X*b$6;
   Result.Y = Self$58.Y*b$6;
   return Result
}
/// function TPointF.Expand(var Self: TPointF; const b: TPointF) : TPointF
function TPointF$Expand(Self$59, b$7) {
   var Result = {X:0,Y:0};
   Result.X = Self$59.X*b$7.X;
   Result.Y = Self$59.Y*b$7.Y;
   return Result
}
/// function TPointF.Offset(var Self: TPointF; const b: Float) : TPointF
function TPointF$Offset$1(Self$60, b$8) {
   var Result = {X:0,Y:0};
   Result.X = Self$60.X+b$8;
   Result.Y = Self$60.Y+b$8;
   return Result
}
/// function TPointF.Offset(var Self: TPointF; const b: TPointF) : TPointF
function TPointF$Offset(Self$61, b$9) {
   var Result = {X:0,Y:0};
   Result.X = Self$61.X+b$9.X;
   Result.Y = Self$61.Y+b$9.Y;
   return Result
}
/// function TPointF.ToString(var Self: TPointF) : String
function TPointF$ToString$3(Self$62) {
   return (Self$62.X.toString()+","+Self$62.Y.toString());
}
/// TPoint = record
function Copy$TPoint(s,d) {
   d.X$1=s.X$1;
   d.Y$1=s.Y$1;
   return d;
}
function Clone$TPoint($) {
   return {
      X$1:$.X$1,
      Y$1:$.Y$1
   }
}
/// function TPoint.AngleTo(var Self: TPoint; const aPoint: TPoint) : Float
function TPoint$AngleTo$1(Self$63, aPoint$7) {
   var Result = 0;
   var dx$1 = 0;
   var dy$1 = 0;
   dx$1 = aPoint$7.X$1-Self$63.X$1;
   dy$1 = aPoint$7.Y$1-Self$63.Y$1;
   if (!dx$1) {
      if (dy$1<0) {
         Result = 1.5707963267949;
      } else {
         Result = -1.5707963267949;
      }
   } else {
      Result = Math.atan(dy$1/dx$1);
   }
   return Result
}
/// function TPoint.Compare(var Self: TPoint; const aPoint: TPoint) : Boolean
function TPoint$Compare$3(Self$64, aPoint$8) {
   return (aPoint$8.X$1==Self$64.X$1)&&(aPoint$8.Y$1==Self$64.Y$1);
}
/// function TPoint.Create(const aCol: Integer; const aRow: Integer) : TPoint
function Create$16(aCol$5, aRow$5) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = aCol$5;
   Result.Y$1 = aRow$5;
   return Result
}
/// function TPoint.Displace(var Self: TPoint; radius: Float; angle: Float) : TPoint
function TPoint$Displace$1(Self$65, radius$1, angle$1) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(Self$65.X$1+(radius$1*Math.cos(angle$1)));
   Result.Y$1 = Math.round(Self$65.Y$1+(radius$1*Math.sin(angle$1)));
   return Result
}
/// function TPoint.Distance(var Self: TPoint; const aPoint: TPoint) : Float
function TPoint$Distance$1(Self$66, aPoint$9) {
   return Math.sqrt(Math.pow(Self$66.X$1-aPoint$9.X$1,2)+Math.pow(Self$66.Y$1-aPoint$9.Y$1,2));
}
/// function TPoint.Expand(var Self: TPoint; const b: Float) : TPoint
function TPoint$Expand$3(Self$67, b$10) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(Self$67.X$1*b$10);
   Result.Y$1 = Math.round(Self$67.Y$1*b$10);
   return Result
}
/// function TPoint.Expand(var Self: TPoint; const b: TPoint) : TPoint
function TPoint$Expand$2(Self$68, b$11) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(Self$68.X$1*b$11.X$1);
   Result.Y$1 = Math.round(Self$68.Y$1*b$11.Y$1);
   return Result
}
/// function TPoint.Offset(var Self: TPoint; const b: Integer) : TPoint
function TPoint$Offset$3(Self$69, b$12) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Self$69.X$1+b$12;
   Result.Y$1 = Self$69.Y$1+b$12;
   return Result
}
/// function TPoint.Offset(var Self: TPoint; const b: TPoint) : TPoint
function TPoint$Offset$2(Self$70, b$13) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Self$70.X$1+b$13.X$1;
   Result.Y$1 = Self$70.Y$1+b$13.Y$1;
   return Result
}
/// function TPoint.ToString(var Self: TPoint) : String
function TPoint$ToString$4(Self$71) {
   return (Self$71.X$1.toString()+","+Self$71.Y$1.toString());
}
/// TInteger = class (TObject)
var TInteger = {
   $ClassName:"TInteger",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TInteger.Average(const anArray: TIntArray) : Float
   ,Average:function(anArray) {
      var Result = 0;
      var mCount = 0;
      mCount = anArray.length;
      if (!mCount) {
         Result = 0;
      } else {
         Result = TInteger.Sum(anArray)/mCount;
      }
      return Result
   }
   /// function TInteger.Diff(const Primary: Integer; const Secondary: Integer) : Integer
   ,Diff:function(Primary, Secondary) {
      var Result = 0;
      if (Primary!=Secondary) {
         if (Primary>Secondary) {
            Result = Primary-Secondary;
         } else {
            Result = Secondary-Primary;
         }
         if (Result<0) {
            Result = (Result-1)^(-1);
         }
      } else {
         Result = 0;
      }
      return Result
   }
   /// function TInteger.EnsureRange(const aValue: Integer; const aMin: Integer; const aMax: Integer) : Integer
   ,EnsureRange:function(aValue$21, aMin, aMax) {
      return ClampInt(aValue$21,aMin,aMax);
   }
   /// function TInteger.GetBit(index: Integer; const buffer: Integer) : Boolean
   ,GetBit:function(index, buffer$1) {
      var Result = false;
      if ((index>=0)&&(index<=31)) {
         Result = ((buffer$1&(1<<index))!=0);
      } else {
         throw Exception.Create($New(Exception),"Invalid bit index, expected 0..31");
      }
      return Result
   }
   /// function TInteger.Largest(const anArray: TIntArray) : Integer
   ,Largest$1:function(Self, anArray$1) {
      var Result = 0;
      var a$40 = 0;
      var x$30 = 0;
      var $temp64;
      for(a$40 = 0,$temp64 = anArray$1.length;a$40<$temp64;a$40++) {
         x$30 = $DIdxR(anArray$1,a$40,"");
         if (x$30>Result) {
            Result = x$30;
         }
      }
      return Result
   }
   /// function TInteger.Largest(const Primary: Integer; const Secondary: Integer) : Integer
   ,Largest:function(Self, Primary$1, Secondary$1) {
      var Result = 0;
      if (Primary$1>Secondary$1) {
         Result = Primary$1;
      } else {
         Result = Secondary$1;
      }
      return Result
   }
   /// function TInteger.Middle(const Primary: Integer; const Secondary: Integer) : Integer
   ,Middle:function(Primary$2, Secondary$2) {
      return $Div(Primary$2+Secondary$2,2);
   }
   /// function TInteger.PercentOfValue(const Value: Integer; const Total: Integer) : Integer
   ,PercentOfValue:function(Value$16, Total) {
      var Result = 0;
      if (Value$16<=Total) {
         Result = Trunc((Value$16/Total)*100);
      } else {
         Result = 0;
      }
      return Result
   }
   /// procedure TInteger.SetBit(index: Integer; aValue: Boolean; var buffer: Integer)
   ,SetBit:function(index$1, aValue$22, buffer$2) {
      if ((index$1>=0)&&(index$1<=31)) {
         if (aValue$22) {
            buffer$2.v = buffer$2.v|(1<<index$1);
         } else {
            buffer$2.v = buffer$2.v&(~(1<<index$1));
         }
      } else {
         throw Exception.Create($New(Exception),"Invalid bit index, expected 0..31");
      }
   }
   /// function TInteger.Sign(const Value: Integer) : Integer
   ,Sign$2:function(Self, Value$17) {
      return $Sign(Value$17);
   }
   /// function TInteger.Smallest(const anArray: TIntArray) : Integer
   ,Smallest$1:function(Self, anArray$2) {
      var Result = 0;
      var a$41 = 0;
      var x$31 = 0;
      Result = (anArray$2.length-1);
      if (Result>=0) {
         Result = $DIdxR(anArray$2,0,"");
         var $temp65;
         for(a$41 = 0,$temp65 = anArray$2.length;a$41<$temp65;a$41++) {
            x$31 = $DIdxR(anArray$2,a$41,"");
            if (x$31<Result) {
               Result = x$31;
            }
         }
      } else {
         Result = 0;
      }
      return Result
   }
   /// function TInteger.Smallest(const Primary: Integer; const Secondary: Integer) : Integer
   ,Smallest:function(Self, Primary$3, Secondary$3) {
      var Result = 0;
      if (Primary$3<Secondary$3) {
         Result = Primary$3;
      } else {
         Result = Secondary$3;
      }
      return Result
   }
   /// procedure TInteger.Sort(var Domain: TIntArray)
   ,Sort:function(Self, Domain) {
      Domain.v.sort($CmpNum);
   }
   /// function TInteger.Sum(const anArray: TIntArray) : Integer
   ,Sum:function(anArray$3) {
      var Result = 0;
      var a$42 = 0;
      var x$32 = 0;
      Result = 0;
      var $temp66;
      for(a$42 = 0,$temp66 = anArray$3.length;a$42<$temp66;a$42++) {
         x$32 = $DIdxR(anArray$3,a$42,"");
         Result+=x$32;
      }
      return Result
   }
   /// procedure TInteger.Swap(var Primary: Integer; var Secondary: Integer)
   ,Swap:function(Primary$4, Secondary$4) {
      var temp = 0;
      temp = Primary$4.v;
      Primary$4.v = Secondary$4.v;
      Secondary$4.v = temp;
   }
   /// function TInteger.ToHex(const aValue: Integer) : String
   ,ToHex:function(aValue$23) {
      var Result = "";
      Result = IntToHex(aValue$23,16);
      if (Result.length<2) {
         do {
            Result = "0"+Result;
         } while (!(Result.length>=2));
      }
      Result = Result.substr((Result.length-1)-1,2);
      return Result
   }
   /// function TInteger.ToNearest(const Value: Integer; const Factor: Integer) : Integer
   ,ToNearest:function(Value$18, Factor) {
      var Result = 0;
      var FTemp = 0;
      Result = Value$18;
      FTemp = Value$18%Factor;
      if (FTemp>0) {
         (Result+= (Factor-FTemp));
      }
      return Result
   }
   /// function TInteger.ToNearestSigned(const Value: Integer; const Factor: Integer) : Integer
   ,ToNearestSigned:function(Value$19, Factor$1) {
      return (1+($Div(Value$19-1,Factor$1)))*Factor$1;
   }
   /// function TInteger.ToPxStr(const aValue: Integer) : String
   ,ToPxStr:function(aValue$24) {
      return aValue$24.toString()+"px";
   }
   /// function TInteger.WrapRange(const aValue: Integer; const aLowRange: Integer; const aHighRange: Integer) : Integer
   ,WrapRange:function(aValue$25, aLowRange, aHighRange) {
      var Result = 0;
      if (aValue$25>aHighRange) {
         Result = aLowRange+TInteger.Diff(aHighRange,(aValue$25-1));
         if (Result>aHighRange) {
            Result = TInteger.WrapRange(Result,aLowRange,aHighRange);
         }
      } else if (aValue$25<aLowRange) {
         Result = aHighRange-TInteger.Diff(aLowRange,(aValue$25+1));
         if (Result<aLowRange) {
            Result = TInteger.WrapRange(Result,aLowRange,aHighRange);
         }
      } else {
         Result = aValue$25;
      }
      return Result
   }
   ,Destroy:TObject.Destroy
};
/// TFloat = class (TObject)
var TFloat = {
   $ClassName:"TFloat",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TFloat.PercentOfValue(const Value: Double; Total: Double) : Double
   ,PercentOfValue$1:function(Value$20, Total$1) {
      var Result = 0;
      if (Value$20<=Total$1) {
         Result = (Value$20/Total$1)*100;
      } else {
         Result = 0;
      }
      return Result
   }
   ,Destroy:TObject.Destroy
};
/// TExposure enumeration
var TExposure = [ "esVisible", "esPartly", "esNone" ];
/// TCursor enumeration
var TCursor = [ "crAuto", "crDefault", "crInherited", "crURL", "crCrossHair", "crHelp", "crMove", "crPointer", "crProgress", "crText", "crWait", "crNResize", "crSResize", "crEResize", "crWResize", "crNEResize", "crNWReSize", "crSEResize", "crSWResize" ];
function StrToColor(aColorStr) {
   aColorStr={v:aColorStr};
   var Result = {v:0};
   try {
      var mTemp$1 = "";
      var xpos = 0;
      var r = 0;
      var g = 0;
      var b = 0;
      aColorStr.v = Trim$_String_(aColorStr.v);
      if (!aColorStr.v.length) {
         return Result.v;
      }
      if (($SIdx(aColorStr.v,1,"")=="#")||($SIdx(aColorStr.v,1,"")=="$")) {
         Result.v = parseInt("0x"+Trim$_String_Integer_Integer_(aColorStr.v,1,0),16);
      } else {
         if ((aColorStr.v).substr(0,2)=="0x") {
            Result.v = parseInt(aColorStr.v,16);
         } else if (((aColorStr.v).substr(0,4)).toLowerCase()=="rgb(") {
            aColorStr.v = Trim$_String_Integer_Integer_(aColorStr.v,4,0);
            try {
               xpos = (aColorStr.v.indexOf(",")+1);
               if (xpos>1) {
                  mTemp$1 = aColorStr.v.substr(0,(xpos-1));
                  Delete(aColorStr,1,xpos);
                  if ($SIdx(mTemp$1,1,"")=="$") {
                     mTemp$1 = "0x"+Trim$_String_Integer_Integer_(mTemp$1,1,0);
                  }
                  r = parseInt(mTemp$1,10);
               }
               xpos = (aColorStr.v.indexOf(",")+1);
               if (xpos>1) {
                  mTemp$1 = aColorStr.v.substr(0,(xpos-1));
                  Delete(aColorStr,1,xpos);
                  if ($SIdx(mTemp$1,1,"")=="$") {
                     mTemp$1 = "0x"+Trim$_String_Integer_Integer_(mTemp$1,1,0);
                  }
                  g = parseInt(mTemp$1,10);
               }
               xpos = (aColorStr.v.indexOf(")")+1);
               if (xpos>1) {
                  mTemp$1 = aColorStr.v.substr(0,(xpos-1));
                  if ($SIdx(mTemp$1,1,"")=="$") {
                     mTemp$1 = "0x"+Trim$_String_Integer_Integer_(mTemp$1,1,0);
                  }
                  b = parseInt(mTemp$1,10);
               }
               Result.v = RGBToColor(r,g,b);
            } catch ($e) {
               var e$9 = $W($e);
               return Result.v;
            }
         }
      }
   } finally {return Result.v}
};
function RGBToColor(aRed, aGreen, aBlue) {
   return (aBlue|(aGreen<<8))|(aRed<<16);
};
function OffsetPoint(a$43, b$14) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = a$43.X$1+b$14.X$1;
   Result.Y$1 = a$43.Y$1+b$14.Y$1;
   return Result
};
function OffsetPoint$1(a$44, b$15) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = a$44.X$1+b$15;
   Result.Y$1 = a$44.Y$1+b$15;
   return Result
};
function OffsetPoint$2(a$45, b$16) {
   var Result = {X:0,Y:0};
   Result.X = a$45.X+b$16.X;
   Result.Y = a$45.Y+b$16.Y;
   return Result
};
function OffsetPoint$3(a$46, b$17) {
   var Result = {X:0,Y:0};
   Result.X = a$46.X+b$17;
   Result.Y = a$46.Y+b$17;
   return Result
};
function OffsetPoint$4(a$47, b$18) {
   var Result = {X:0,Y:0};
   Result.X = a$47.X+b$18;
   Result.Y = a$47.Y+b$18;
   return Result
};
function ObjToVariant(value$3) {
   return value$3;
};
function MinusPoint(a$48, b$19) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = a$48.X$1-b$19.X$1;
   Result.Y$1 = a$48.Y$1-b$19.Y$1;
   return Result
};
function MinusPoint$1(a$49, b$20) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = a$49.X$1-b$20;
   Result.Y$1 = a$49.Y$1-b$20;
   return Result
};
function MinusPoint$2(a$50, b$21) {
   var Result = {X:0,Y:0};
   Result.X = a$50.X-b$21.X;
   Result.Y = a$50.Y-b$21.Y;
   return Result
};
function MinusPoint$3(a$51, b$22) {
   var Result = {X:0,Y:0};
   Result.X = a$51.X-b$22;
   Result.Y = a$51.Y-b$22;
   return Result
};
function MinusPoint$4(a$52, b$23) {
   var Result = {X:0,Y:0};
   Result.X = a$52.X-b$23;
   Result.Y = a$52.Y-b$23;
   return Result
};
function InitVendorInfo() {
   /* null */
};
function HSLtoColor(H, S, L) {
   var Result = 0;
   var M1 = 0;
   var M2 = 0;
   function HueToColor(Hue) {
      var Result = 0;
      var V = 0;
      Hue-=Math.floor(Hue);
      if ((6*Hue)<1) {
         V = M1+((M2-M1)*Hue*6);
      } else if ((2*Hue)<1) {
         V = M2;
      } else if ((3*Hue)<2) {
         V = M1+((M2-M1)*(0.666666666666667-Hue)*6);
      } else {
         V = M1;
      }
      Result = Math.round(255*V);
      return Result
   };
   if (S==0) {
      Result = Math.round(255*L);
      Result = (Result|(Result<<8))|(Result<<16);
   } else {
      if (L<=0.5) {
         M2 = L*(1+S);
      } else {
         M2 = (L+S)-(L*S);
      }
      M1 = (2*L)-M2;
      Result = (HueToColor(H-0.333333333333333)|(HueToColor(H)<<8))|(HueToColor(H+0.333333333333333)<<16);
   }
   return Result
};
function ExpandPoint(a$53, b$24) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(a$53.X$1*b$24.X$1);
   Result.Y$1 = Math.round(a$53.Y$1*b$24.Y$1);
   return Result
};
function ExpandPoint$1(a$54, b$25) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(a$54.X$1*b$25);
   Result.Y$1 = Math.round(a$54.Y$1*b$25);
   return Result
};
function ExpandPoint$2(a$55, b$26) {
   var Result = {X$1:0,Y$1:0};
   Result.X$1 = Math.round(a$55.X$1*b$26);
   Result.Y$1 = Math.round(a$55.Y$1*b$26);
   return Result
};
function ExpandPoint$3(a$56, b$27) {
   var Result = {X:0,Y:0};
   Result.X = a$56.X*b$27.X;
   Result.Y = a$56.Y*b$27.Y;
   return Result
};
function ExpandPoint$4(a$57, b$28) {
   var Result = {X:0,Y:0};
   Result.X = a$57.X*b$28;
   Result.Y = a$57.Y*b$28;
   return Result
};
function ExpandPoint$5(a$58, b$29) {
   var Result = {X:0,Y:0};
   Result.X = a$58.X*b$29;
   Result.Y = a$58.Y*b$29;
   return Result
};
/// EW3Exception = class (Exception)
var EW3Exception = {
   $ClassName:"EW3Exception",
   $Parent:Exception
   ,$Init:function ($) {
      Exception.$Init($);
   }
   /// constructor EW3Exception.CreateFmt(aText: String; const aValues: array of const)
   ,CreateFmt:function(Self, aText$3, aValues) {
      Exception.Create(Self,Format(aText$3,aValues.slice(0)));
      return Self
   }
   ,Destroy:Exception.Destroy
};
/// EW3OwnedObject = class (EW3Exception)
var EW3OwnedObject = {
   $ClassName:"EW3OwnedObject",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
function ColorToWebStr(aColor, alpha$1) {
   return ColorToWebStr$1((aColor>>>16)&255,(aColor>>>8)&255,aColor&255,alpha$1);
};
function ColorToWebStr$1(r$4, g$5, b$30, a$59) {
   return (a$59==255)?"#"+IntToHex2(r$4)+IntToHex2(g$5)+IntToHex2(b$30):"rgba("+r$4.toString()+","+g$5.toString()+","+b$30.toString()+","+FloatToStr$_Float_(a$59/255)+")";
};
function ColorToStrA(aColor$1, alpha$2) {
   return ColorToWebStr(aColor$1,alpha$2);
};
function ColorToStr(aColor$2) {
   var Result = "";
   var rgb = 0;
   rgb = (((aColor$2>>>16)&255)|(aColor$2&65280))|((aColor$2&255)<<16);
   Result = "0x"+IntToHex(rgb,6);
   return Result
};
function BrowserAPI() {
   var Result = null;
   if (vDriver===null) {
      InternalInitVendorInfo();
   }
   Result = vDriver;
   return Result
};
function InternalInitVendorInfo() {
   if (w3_getIsAndroid()) {
      vVendor = 2;
   } else if (w3_getIsSafari()) {
      vVendor = 4;
   } else if (w3_getIsFirefox()) {
      vVendor = 5;
   } else if (w3_getIsChrome()) {
      vVendor = 3;
   } else if (w3_getIsInternetExplorer()) {
      vVendor = 7;
   } else if (w3_getIsOpera()) {
      vVendor = 6;
   }
   if (!vVendor) {
      if ((w3_getIsIPhone()||w3_getIsIPad())||w3_getIsIPod()) {
         vVendor = 1;
      }
   }
   switch (vVendor) {
      case 1 :
      case 4 :
      case 3 :
      case 2 :
         w3_RegisterBrowserAPI(TW3WebkitBrowserAPI.Create$5($New(TW3WebkitBrowserAPI)));
         break;
      case 5 :
         w3_RegisterBrowserAPI(TW3FirefoxBrowserAPI.Create$10($New(TW3FirefoxBrowserAPI)));
         break;
      case 7 :
         w3_RegisterBrowserAPI(TW3IEBrowserAPI.Create$9($New(TW3IEBrowserAPI)));
         break;
      case 6 :
         w3_RegisterBrowserAPI(TW3OperaBrowserAPI.Create$8($New(TW3OperaBrowserAPI)));
         break;
      default :
         w3_RegisterBrowserAPI(TW3FirefoxBrowserAPI.Create$10($New(TW3FirefoxBrowserAPI)))   }
};
function InitAnimationFrameShim() {
   
    vRequestAnimFrame = (function(){
      return  window.requestAnimationFrame       ||
              window.webkitRequestAnimationFrame ||
              window.mozRequestAnimationFrame    ||
              window.msRequestAnimationFrame     ||
              function( callback ){
                return window.setTimeout(callback, 1000 / 60);
              };
    })();
    vCancelAnimFrame = (function(){
      return  window.cancelAnimationFrame       ||
              window.webkitCancelAnimationFrame ||
              window.mozCancelAnimationFrame    ||
              window.msCancelAnimationFrame     ||
              function( handle ){
                window.clearTimeout(handle);
              };
    })();
  };
/// TW3DisplayViewArangeType enumeration
var TW3DisplayViewArangeType = [ "dvaSizeToView", "dvaVStack", "dvaHStack" ];
/// TW3TagObj = class (TObject)
var TW3TagObj = {
   $ClassName:"TW3TagObj",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.a$5 = $.FUpdating = 0;
      $.FHandle$3 = undefined;
      $.FObjReady = false;
      $.FOwner$3 = undefined;
      $.FTagId = "";
   }
   /// procedure TW3TagObj.AfterUpdate()
   ,AfterUpdate:function(Self) {
      /* null */
   }
   /// procedure TW3TagObj.BeginUpdate()
   ,BeginUpdate:function(Self) {
      ++$Check(Self,"").FUpdating;
   }
   /// constructor TW3TagObj.Create()
   ,Create$37:function(Self) {
      TObject.Create(Self);
      $Check(Self,"").FObjReady = false;
      try {
         $Check(Self,"").FTagId = TW3TagObj.MakeElementTagId$($Check(Self,""));
         $Check(Self,"").FHandle$3 = TW3TagObj.MakeElementTagObj$($Check(Self,""));
      } catch ($e) {
         var e$10 = $W($e);
         EW3TagObj.RaiseCntErrMethod("TW3TagObj.Create",Self,$Check(e$10,"").FMessage)      }
      if (TVariant.AsObject($Check(Self,"").FHandle$3)!==TVariant.AsObject(document.body)) {
         if ($Check(Self,"").FTagId.length>0) {
            w3_setAttrib($Check(Self,"").FHandle$3,"id",$Check(Self,"").FTagId);
         }
      }
      TW3TagObj.StyleTagObject$($Check(Self,""));
      TW3TagObj.BeginUpdate(Self);
      try {
         TW3TagObj.InitializeObject$($Check(Self,""));
      } finally {
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
      $Check(Self,"").FObjReady = true;
      return Self
   }
   /// destructor TW3TagObj.Destroy()
   ,Destroy:function(Self) {
      if ($Check(Self,"").FHandle$3) {
         try {
            TW3TagObj.UnHookEvents$($Check(Self,""));
            TW3TagObj.RemoveFrom(Self);
         } finally {
            TW3TagObj.FinalizeObject$($Check(Self,""));
            $Check(Self,"").FTagId = "";
            $Check(Self,"").FHandle$3 = null;
         }
      }
      TObject.Destroy(Self);
   }
   /// procedure TW3TagObj.EndUpdate()
   ,EndUpdate:function(Self) {
      if ($Check(Self,"").FUpdating>0) {
         --$Check(Self,"").FUpdating;
         if (!$Check(Self,"").FUpdating) {
            TW3TagObj.AfterUpdate$($Check(Self,""));
         }
      }
   }
   /// procedure TW3TagObj.FinalizeObject()
   ,FinalizeObject:function(Self) {
      /* null */
   }
   /// function TW3TagObj.getAttached() : Boolean
   ,getAttached:function(Self) {
      return VarIsValidRef($Check(Self,"").FOwner$3);
   }
   /// function TW3TagObj.GetInnerHTML() : String
   ,GetInnerHTML:function(Self) {
      var Result = "";
      if ($Check(Self,"").FHandle$3) {
         Result = ""+$Check(Self,"").FHandle$3.innerHTML;
      }
      return Result
   }
   /// function TW3TagObj.GetInnerText() : String
   ,GetInnerText:function(Self) {
      var Result = "";
      if ($Check(Self,"").FHandle$3) {
         Result = ""+$Check(Self,"").FHandle$3.innerText;
      }
      return Result
   }
   /// function TW3TagObj.getUpdating() : Boolean
   ,getUpdating:function(Self) {
      return $Check(Self,"").FUpdating>0;
   }
   /// procedure TW3TagObj.InitializeObject()
   ,InitializeObject:function(Self) {
      /* null */
   }
   /// procedure TW3TagObj.InsertInto(const OwnerHandle: THandle)
   ,InsertInto:function(Self, OwnerHandle) {
      if (OwnerHandle) {
         if ($Check(Self,"").FHandle$3) {
            try {
               if ($Check(Self,"").FOwner$3) {
                  TW3TagObj.RemoveFrom(Self);
               }
               w3_setElementParentByRef($Check(Self,"").FHandle$3,OwnerHandle);
               $Check(Self,"").FOwner$3 = OwnerHandle;
            } catch ($e) {
               var e$11 = $W($e);
               EW3TagObj.RaiseCntErrMethod("TW3TagObj.InsertInto",Self,$Check(e$11,"").FMessage)            }
         } else {
            EW3TagObj.RaiseCntErrMethod("TW3TagObj.InsertInto",Self,"Internal tag-object is null error");
         }
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3TagObj.InsertInto",Self,"owner is NIL error");
      }
   }
   /// function TW3TagObj.MakeElementTagId() : String
   ,MakeElementTagId:function(Self) {
      return w3_GetUniqueObjId();
   }
   /// function TW3TagObj.MakeElementTagObj() : THandle
   ,MakeElementTagObj:function(Self) {
      return w3_createHtmlElement("div");
   }
   /// procedure TW3TagObj.RemoveFrom()
   ,RemoveFrom:function(Self) {
      if ($Check(Self,"").FOwner$3) {
         if ($Check(Self,"").FHandle$3) {
            try {
               w3_RemoveElementByRef($Check(Self,"").FHandle$3,$Check(Self,"").FOwner$3);
            } catch ($e) {
               var e$12 = $W($e);
               EW3TagObj.RaiseCntErrMethod("TW3TagObj.RemoveFrom",Self,$Check(e$12,"").FMessage)            }
            $Check(Self,"").FOwner$3 = undefined;
         } else {
            EW3TagObj.RaiseCntErrMethod("TW3TagObj.RemoveFrom",Self,"Internal tag-object is null error");
         }
      }
   }
   /// procedure TW3TagObj.SetInnerHTML(aValue: String)
   ,SetInnerHTML:function(Self, aValue$26) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.innerHTML = aValue$26;
      }
   }
   /// procedure TW3TagObj.SetInnerText(aValue: String)
   ,SetInnerText:function(Self, aValue$27) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.innerText = aValue$27;
      }
   }
   /// procedure TW3TagObj.StyleTagObject()
   ,StyleTagObject:function(Self) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.style["visibility"] = "hidden";
         $Check(Self,"").FHandle$3.style["display"] = "none";
         $Check(Self,"").FHandle$3.style["position"] = "absolute";
         $Check(Self,"").FHandle$3.style["overflow"] = "hidden";
         $Check(Self,"").FHandle$3.style["left"] = "0px";
         $Check(Self,"").FHandle$3.style["top"] = "0px";
      }
   }
   /// procedure TW3TagObj.UnHookEvents()
   ,UnHookEvents:function(Self) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.onresize = null;
         $Check(Self,"").FHandle$3.onselectstart = null;
         $Check(Self,"").FHandle$3.onfocus = null;
         $Check(Self,"").FHandle$3.onblur = null;
         $Check(Self,"").FHandle$3.onchange = null;
         $Check(Self,"").FHandle$3.onmousedown = null;
         $Check(Self,"").FHandle$3.onmouseup = null;
         $Check(Self,"").FHandle$3.onmousemove = null;
         $Check(Self,"").FHandle$3.onmouseover = null;
         $Check(Self,"").FHandle$3.onmouseout = null;
         $Check(Self,"").FHandle$3.onclick = null;
         $Check(Self,"").FHandle$3.ondblclick = null;
         $Check(Self,"").FHandle$3.onkeydown = null;
         $Check(Self,"").FHandle$3.onkeyup = null;
         $Check(Self,"").FHandle$3.onkeypress = null;
         $Check(Self,"").FHandle$3.webkitAnimationStart = null;
         $Check(Self,"").FHandle$3.webkitAnimationEnd = null;
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,AfterUpdate$:function($){return $.ClassType.AfterUpdate($)}
   ,Create$37$:function($){return $.ClassType.Create$37($)}
   ,EndUpdate$:function($){return $.ClassType.EndUpdate($)}
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId$:function($){return $.ClassType.MakeElementTagId($)}
   ,MakeElementTagObj$:function($){return $.ClassType.MakeElementTagObj($)}
   ,StyleTagObject$:function($){return $.ClassType.StyleTagObject($)}
   ,UnHookEvents$:function($){return $.ClassType.UnHookEvents($)}
};
/// TW3Component = class (TW3TagObj)
var TW3Component = {
   $ClassName:"TW3Component",
   $Parent:TW3TagObj
   ,$Init:function ($) {
      TW3TagObj.$Init($);
      $.FChildren = [];
      $.FName$1 = "";
      $.FParent = null;
   }
   /// procedure TW3Component.CBNoBehavior()
   ,CBNoBehavior:function(Self) {
      if (event) {
         event.preventDefault();
      }
   }
   /// procedure TW3Component.ChildAdded(aChild: TW3Component)
   ,ChildAdded:function(Self, aChild) {
      /* null */
   }
   /// function TW3Component.ChildByHandle(const aHandle: THandle) : TW3Component
   ,ChildByHandle:function(Self, aHandle) {
      var Result = null;
      var x$33 = 0;
      var mObj$1 = null;
      Result = null;
      var $temp67;
      for(x$33 = 0,$temp67 = TW3Component.GetChildCount(Self);x$33<$temp67;x$33++) {
         mObj$1 = TW3Component.GetChildObject(Self,x$33);
         if ($Check(mObj$1,"").FHandle$3==aHandle) {
            Result = mObj$1;
            break;
         }
      }
      return Result
   }
   /// function TW3Component.ChildByName(const compName: String) : TW3Component
   ,ChildByName:function(Self, compName) {
      var Result = null;
      var lcName = "";
      var i$44 = 0;
      lcName = (Trim$_String_(compName)).toLowerCase();
      var $temp68;
      for(i$44 = 0,$temp68 = TW3Component.GetChildCount(Self);i$44<$temp68;i$44++) {
         Result = TW3Component.GetChildObject(Self,i$44);
         if (($Check(Result,"").FName$1).toLowerCase()==lcName) {
            return Result;
         }
      }
      Result = null;
      return Result
   }
   /// procedure TW3Component.ChildRemoved(aChild: TW3Component)
   ,ChildRemoved:function(Self, aChild$1) {
      /* null */
   }
   /// constructor TW3Component.Create(AOwner: TW3Component)
   ,Create$38:function(Self, AOwner$1) {
      $Check(Self,"").FParent = AOwner$1;
      TW3TagObj.Create$37(Self);
      if ($Check(Self,"").FParent!==null) {
         TW3Component.RegisterChild($Check(Self,"").FParent,Self);
      }
      return Self
   }
   /// procedure TW3Component.EnumChildren(childProc: procedure (child: TW3Component))
   ,EnumChildren:function(Self, childProc) {
      var a$60 = 0;
      var child = null;
      var a$61 = [];
      a$61 = $Check(Self,"").FChildren;
      var $temp69;
      for(a$60 = 0,$temp69 = a$61.length;a$60<$temp69;a$60++) {
         child = $DIdxR(a$61,a$60,"");
         $CheckFunc(childProc,"")(child);
      }
   }
   /// procedure TW3Component.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TW3Component.FreeChildren(Self);
      if ($Check(Self,"").FParent!==null) {
         TW3Component.UnRegisterChild($Check(Self,"").FParent,Self);
      }
      $Check(Self,"").FChildren.length=0;
      TW3TagObj.FinalizeObject(Self);
   }
   /// procedure TW3Component.FreeChildren()
   ,FreeChildren:function(Self) {
      var oldCount = 0;
      try {
         while ($Check(Self,"").FChildren.length>0) {
            oldCount = $Check(Self,"").FChildren.length;
            TObject.Free($DIdxR($Check(Self,"").FChildren,0,""));
            if (oldCount==$Check(Self,"").FChildren.length) {
               $Check(Self,"").FChildren.shift();
            }
         }
      } finally {
         $Check(Self,"").FChildren.length=0;
      }
   }
   /// function TW3Component.GetChildCount() : Integer
   ,GetChildCount:function(Self) {
      return $Check(Self,"").FChildren.length;
   }
   /// function TW3Component.GetChildObject(index: Integer) : TW3Component
   ,GetChildObject:function(Self, index$2) {
      return $DIdxR($Check(Self,"").FChildren,index$2,"");
   }
   /// procedure TW3Component.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3TagObj.InitializeObject(Self);
   }
   /// procedure TW3Component.RegisterChild(aChild: TW3Component)
   ,RegisterChild:function(Self, aChild$2) {
      if ((aChild$2!==null)&&($Check(Self,"").FChildren.indexOf(aChild$2)<0)) {
         $Check(Self,"").FChildren.push(aChild$2);
         TW3TagObj.InsertInto(aChild$2,$Check(Self,"").FHandle$3);
         TW3Component.ChildAdded$($Check(Self,""),aChild$2);
      }
   }
   /// procedure TW3Component.SetName(Value: String)
   ,SetName:function(Self, Value$21) {
      $Check(Self,"").FName$1 = Value$21;
   }
   /// function TW3Component.TopLevelParent() : TW3Component
   ,TopLevelParent:function(Self) {
      var Result = null;
      Result = $Check(Self,"").FParent;
      while ($Check(Result,"").FParent!==null) {
         Result = $Check(Result,"").FParent;
      }
      return Result
   }
   /// procedure TW3Component.UnRegisterChild(aChild: TW3Component)
   ,UnRegisterChild:function(Self, aChild$3) {
      var mIndex = 0;
      if (aChild$3!==null) {
         mIndex = $Check(Self,"").FChildren.indexOf(aChild$3);
         if (mIndex>=0) {
            $Check(Self,"").FChildren.splice(mIndex,1)
            ;
            TW3Component.ChildRemoved$($Check(Self,""),aChild$3);
         }
         TW3TagObj.RemoveFrom(aChild$3);
      }
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3TagObj.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3TagObj.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior$:function($){return $.ClassType.CBNoBehavior($)}
   ,ChildAdded$:function($){return $.ClassType.ChildAdded.apply($.ClassType, arguments)}
   ,ChildRemoved$:function($){return $.ClassType.ChildRemoved.apply($.ClassType, arguments)}
   ,Create$38$:function($){return $.ClassType.Create$38.apply($.ClassType, arguments)}
};
/// TW3MovableControl = class (TW3Component)
var TW3MovableControl = {
   $ClassName:"TW3MovableControl",
   $Parent:TW3Component
   ,$Init:function ($) {
      TW3Component.$Init($);
      $.FAdjusted = $.FTransparent = $.FUseAlpha = $.FWasMoved = $.FWasSized = false;
      $.FAlpha = 0;
      $.FBackground = $.FBorders = $.FConstraints = null;
      $.FColor = 0;
   }
   /// procedure TW3MovableControl.AdjustToParentBox()
   ,AdjustToParentBox:function(Self) {
      var x$34 = 0;
      var dx$2 = 0;
      var dy$2 = 0;
      var mChild = null;
      var mCtrl = null;
      if ($Check(Self,"").FHandle$3) {
         if (!$Check(Self,"").FAdjusted) {
            $Check(Self,"").FAdjusted = true;
            dx$2 = TW3Borders.getHSpace(TW3MovableControl.getBorder(Self));
            dy$2 = TW3Borders.getVSpace(TW3MovableControl.getBorder(Self));
            var $temp70;
            for(x$34 = 0,$temp70 = TW3Component.GetChildCount(Self);x$34<$temp70;x$34++) {
               mChild = TW3Component.GetChildObject(Self,x$34);
               if ($Is(mChild,TW3MovableControl)) {
                  mCtrl = $As(mChild,TW3MovableControl);
                  if (TW3MovableControl.supportAdjustment$($Check(mCtrl,"").ClassType)) {
                     if ((dx$2>0)||(dy$2>0)) {
                        TW3MovableControl.SetSize$4$($Check(mCtrl,""),TW3MovableControl.GetWidth$1$($Check(mCtrl,""))-dx$2,TW3MovableControl.GetHeight$1$($Check(mCtrl,""))-dy$2);
                     }
                     setTimeout($Event0(mCtrl,TW3MovableControl.AdjustToParentBox$),1);
                  }
               }
            }
         }
      }
   }
   /// procedure TW3MovableControl.AfterUpdate()
   ,AfterUpdate:function(Self) {
      $Check(Self,"").FWasMoved = false;
      $Check(Self,"").FWasSized = false;
   }
   /// function TW3MovableControl.ClientHeight() : Integer
   ,ClientHeight:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FHandle$3) {
         if (VarIsValidRef($Check(Self,"").FHandle$3.clientHeight)) {
            Result = TVariant.AsInteger($Check(Self,"").FHandle$3.clientHeight);
            if (isNaN(Result)||(Result==0)) {
               Result = TW3MovableControl.GetWidth$1$($Check(Self,""));
            }
         } else {
            Result = TW3MovableControl.GetWidth$1$($Check(Self,""));
         }
      }
      return Result
   }
   /// function TW3MovableControl.ClientRect() : TRect
   ,ClientRect:function(Self) {
      var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      Result.Right$1 = TW3MovableControl.ClientWidth(Self);
      Result.Bottom$1 = TW3MovableControl.ClientHeight(Self);
      return Result
   }
   /// function TW3MovableControl.ClientToScreen(pt: TPoint) : TPoint
   ,ClientToScreen:function(Self, pt$3) {
      var Result = {X$1:0,Y$1:0};
      var sr = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      sr = TW3MovableControl.ScreenRect(Self);
      Result.X$1 = pt$3.X$1+sr.Left$1;
      Result.Y$1 = pt$3.Y$1+sr.Top$1;
      return Result
   }
   /// function TW3MovableControl.ClientWidth() : Integer
   ,ClientWidth:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FHandle$3) {
         if (VarIsValidRef($Check(Self,"").FHandle$3.clientWidth)) {
            Result = TVariant.AsInteger($Check(Self,"").FHandle$3.clientWidth);
            if (isNaN(Result)||(Result==0)) {
               Result = TW3MovableControl.GetWidth$1$($Check(Self,""));
            }
         } else {
            Result = TW3MovableControl.GetWidth$1$($Check(Self,""));
         }
      }
      return Result
   }
   /// function TW3MovableControl.ControlAtPoint(const aPoint: TPoint; const Recursive: Boolean) : TW3Component
   ,ControlAtPoint$1:function(Self, aPoint$10, Recursive) {
      var Result = null;
      var mPos = {X$1:0,Y$1:0};
      var mTarget = undefined;
      var mIndex$1 = 0;
      var mControl = null;
      Result = null;
      mPos = TW3MovableControl.ClientToScreen(Self,Clone$TPoint(aPoint$10));
      mTarget = document.elementFromPoint(mPos.X$1,mPos.Y$1);
      if (mTarget) {
         Result = TW3Component.ChildByHandle(Self,mTarget);
         if (Result===null) {
            var $temp71;
            for(mIndex$1 = 0,$temp71 = TW3Component.GetChildCount(Self);mIndex$1<$temp71;mIndex$1++) {
               mControl = TW3Component.GetChildObject(Self,mIndex$1);
               Result = TW3Component.ChildByHandle(mControl,mTarget);
               if (Result!==null) {
                  break;
               }
            }
         }
      }
      return Result
   }
   /// function TW3MovableControl.ControlAtPoint(x: Integer; y: Integer; const Recursive: Boolean) : TW3Component
   ,ControlAtPoint:function(Self, x$35, y$29, Recursive$1) {
      var Result = null;
      var mPos$1 = {X$1:0,Y$1:0};
      var mTarget$1 = undefined;
      var mIndex$2 = 0;
      var mControl$1 = null;
      Result = null;
      mPos$1 = TW3MovableControl.ClientToScreen(Self,Create$16(x$35,y$29));
      mTarget$1 = document.elementFromPoint(mPos$1.X$1,mPos$1.Y$1);
      if (mTarget$1) {
         Result = TW3Component.ChildByHandle(Self,mTarget$1);
         if (Result===null) {
            var $temp72;
            for(mIndex$2 = 0,$temp72 = TW3Component.GetChildCount(Self);mIndex$2<$temp72;mIndex$2++) {
               mControl$1 = TW3Component.GetChildObject(Self,mIndex$2);
               Result = TW3Component.ChildByHandle(mControl$1,mTarget$1);
               if (Result!==null) {
                  break;
               }
            }
         }
      }
      return Result
   }
   /// function TW3MovableControl.DisplayMode() : String
   ,DisplayMode:function(Self) {
      return "inline-block";
   }
   /// procedure TW3MovableControl.FinalizeObject()
   ,FinalizeObject:function(Self) {
      if ($Check(Self,"").FBackground) {
         TObject.Free($Check(Self,"").FBackground);
      }
      if ($Check(Self,"").FBorders) {
         TObject.Free($Check(Self,"").FBorders);
      }
      if ($Check(Self,"").FConstraints) {
         TObject.Free($Check(Self,"").FConstraints);
      }
      TW3Component.FinalizeObject(Self);
   }
   /// function TW3MovableControl.GetBackGround() : TW3ControlBackground
   ,GetBackGround:function(Self) {
      var Result = null;
      if ($Check(Self,"").FBackground===null) {
         $Check(Self,"").FBackground = TW3OwnedObject.Create$7$($New(TW3ControlBackground),Self);
      }
      Result = $Check(Self,"").FBackground;
      return Result
   }
   /// function TW3MovableControl.getBorder() : TW3Borders
   ,getBorder:function(Self) {
      var Result = null;
      if ($Check(Self,"").FBorders===null) {
         $Check(Self,"").FBorders = TW3OwnedObject.Create$7$($New(TW3Borders),Self);
      }
      Result = $Check(Self,"").FBorders;
      return Result
   }
   /// function TW3MovableControl.getBoundsRect() : TRect
   ,getBoundsRect:function(Self) {
      var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      Result.Left$1 = TW3MovableControl.GetLeft$($Check(Self,""));
      Result.Top$1 = TW3MovableControl.GetTop$($Check(Self,""));
      Result.Right$1 = Result.Left$1+TW3MovableControl.GetWidth$1$($Check(Self,""));
      Result.Bottom$1 = Result.Top$1+TW3MovableControl.GetHeight$1$($Check(Self,""));
      return Result
   }
   /// function TW3MovableControl.getConstraints() : TW3Constraints
   ,getConstraints:function(Self) {
      var Result = null;
      if ($Check(Self,"").FConstraints===null) {
         $Check(Self,"").FConstraints = TW3OwnedObject.Create$7$($New(TW3Constraints),Self);
      }
      Result = $Check(Self,"").FConstraints;
      return Result
   }
   /// function TW3MovableControl.GetHeight() : Integer
   ,GetHeight$1:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FHandle$3) {
         Result = parseInt($Check(Self,"").FHandle$3.offsetHeight,10);
      }
      return Result
   }
   /// function TW3MovableControl.GetLeft() : Integer
   ,GetLeft:function(Self) {
      return w3_getStyleAsInt($Check(Self,"").FHandle$3,"left");
   }
   /// function TW3MovableControl.GetTop() : Integer
   ,GetTop:function(Self) {
      return w3_getStyleAsInt($Check(Self,"").FHandle$3,"top");
   }
   /// function TW3MovableControl.getVisible() : Boolean
   ,getVisible:function(Self) {
      var Result = false;
      var mValue$2 = "";
      mValue$2 = w3_getStyleAsStr($Check(Self,"").FHandle$3,"visibility");
      Result = (mValue$2).toLowerCase()=="visible";
      return Result
   }
   /// function TW3MovableControl.GetWasMoved() : Boolean
   ,GetWasMoved:function(Self) {
      return $Check(Self,"").FWasMoved;
   }
   /// function TW3MovableControl.GetWasSized() : Boolean
   ,GetWasSized:function(Self) {
      return $Check(Self,"").FWasSized;
   }
   /// function TW3MovableControl.GetWidth() : Integer
   ,GetWidth$1:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FHandle$3) {
         Result = parseInt($Check(Self,"").FHandle$3.offsetWidth,10);
      }
      return Result
   }
   /// procedure TW3MovableControl.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3Component.InitializeObject(Self);
      $Check(Self,"").FAlpha = 255;
      $Check(Self,"").FColor = 536870911;
      $Check(Self,"").FTransparent = false;
   }
   /// procedure TW3MovableControl.Moved()
   ,Moved:function(Self) {
      /* null */
   }
   /// procedure TW3MovableControl.MoveTo(aLeft: Integer; aTop: Integer)
   ,MoveTo$1:function(Self, aLeft$8, aTop$8) {
      TW3TagObj.BeginUpdate(Self);
      $Check(Self,"").FHandle$3.style["left"] = TInteger.ToPxStr(aLeft$8);
      $Check(Self,"").FHandle$3.style["top"] = TInteger.ToPxStr(aTop$8);
      TW3MovableControl.SetWasMoved(Self);
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3MovableControl.Resize()
   ,Resize:function(Self) {
      /* null */
   }
   /// function TW3MovableControl.ScreenRect() : TRect
   ,ScreenRect:function(Self) {
      var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var elem = undefined;
      if ($Check(Self,"").FHandle$3) {
         elem = $Check(Self,"").FHandle$3;
         while (1) {
            Result.Left$1+=parseInt(elem.offsetLeft,10);
            Result.Top$1+=parseInt(elem.offsetTop,10);
            elem = elem.offsetParent;
            if (elem) {
               Result.Left$1-=parseInt(elem.scrollLeft,10);
               Result.Top$1-=parseInt(elem.scrollTop,10);
            } else {
               break;
            }
         }
         Result.Right$1 = parseInt((Result.Left$1+$Check(Self,"").FHandle$3.offsetWidth),10);
         Result.Bottom$1 = parseInt((Result.Top$1+$Check(Self,"").FHandle$3.offsetHeight),10);
      }
      return Result
   }
   /// function TW3MovableControl.ScreenToClient(pt: TPoint) : TPoint
   ,ScreenToClient:function(Self, pt$4) {
      var Result = {X$1:0,Y$1:0};
      var sr$1 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      sr$1 = TW3MovableControl.ScreenRect(Self);
      Result.X$1 = pt$4.X$1-sr$1.Left$1;
      Result.Y$1 = pt$4.Y$1-sr$1.Top$1;
      return Result
   }
   /// procedure TW3MovableControl.setAlpha(const aValue: Integer)
   ,setAlpha:function(Self, aValue$28) {
      $Check(Self,"").FAlpha = ClampInt(aValue$28,0,255);
      if ($Check(Self,"").FUseAlpha) {
         $Check(Self,"").FHandle$3.style["opacity"] = $Check(Self,"").FAlpha/100;
      }
   }
   /// procedure TW3MovableControl.SetBounds(aRect: TRect)
   ,SetBounds$3:function(Self, aRect$6) {
      TW3MovableControl.SetBounds$2$($Check(Self,""),aRect$6.Left$1,aRect$6.Top$1,TRect$Width$1(aRect$6),TRect$Height$1(aRect$6));
   }
   /// procedure TW3MovableControl.SetBounds(aLeft: Integer; aTop: Integer; aWidth: Integer; aHeight: Integer)
   ,SetBounds$2:function(Self, aLeft$9, aTop$9, aWidth$4, aHeight$4) {
      var mSized = false;
      var mMoved = false;
      aWidth$4 = Math.max(0,aWidth$4);
      aHeight$4 = Math.max(0,aHeight$4);
      mMoved = (aLeft$9!=TW3MovableControl.GetLeft$($Check(Self,"")))||(aTop$9!=TW3MovableControl.GetTop$($Check(Self,"")));
      mSized = (aWidth$4!=TW3MovableControl.GetWidth$1$($Check(Self,"")))||(aHeight$4!=TW3MovableControl.GetHeight$1$($Check(Self,"")));
      TW3TagObj.BeginUpdate(Self);
      $Check(Self,"").FHandle$3.style["left"] = TInteger.ToPxStr(aLeft$9);
      $Check(Self,"").FHandle$3.style["top"] = TInteger.ToPxStr(aTop$9);
      $Check(Self,"").FHandle$3.style["width"] = TInteger.ToPxStr(aWidth$4);
      $Check(Self,"").FHandle$3.style["height"] = TInteger.ToPxStr(aHeight$4);
      if (mMoved) {
         TW3MovableControl.SetWasMoved(Self);
      }
      if (mSized) {
         TW3MovableControl.SetWasSized(Self);
      }
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3MovableControl.setColor(const aValue: TColor)
   ,setColor$3:function(Self, aValue$29) {
      var mText = "";
      if (aValue$29!=$Check(Self,"").FColor) {
         $Check(Self,"").FColor = aValue$29;
         mText = ColorToWebStr($Check(Self,"").FColor,($Check(Self,"").FTransparent)?0:255);
         $Check(Self,"").FHandle$3.style["backgroundColor"] = mText;
      }
   }
   /// procedure TW3MovableControl.setHeight(aValue: Integer)
   ,setHeight:function(Self, aValue$30) {
      aValue$30 = Math.max(aValue$30,0);
      if (aValue$30!=TW3MovableControl.GetHeight$1$($Check(Self,""))) {
         TW3TagObj.BeginUpdate(Self);
         $Check(Self,"").FHandle$3.style["height"] = TInteger.ToPxStr(aValue$30);
         TW3MovableControl.SetWasSized(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3MovableControl.setLeft(const aValue: Integer)
   ,setLeft:function(Self, aValue$31) {
      TW3TagObj.BeginUpdate(Self);
      $Check(Self,"").FHandle$3.style["left"] = TInteger.ToPxStr(aValue$31);
      TW3MovableControl.SetWasMoved(Self);
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3MovableControl.SetSize(aWidth: Integer; aHeight: Integer)
   ,SetSize$4:function(Self, aWidth$5, aHeight$5) {
      aWidth$5 = Math.max(aWidth$5,0);
      aHeight$5 = Math.max(aHeight$5,0);
      if ((aWidth$5!=TW3MovableControl.GetWidth$1$($Check(Self,"")))||(aHeight$5!=TW3MovableControl.GetHeight$1$($Check(Self,"")))) {
         TW3TagObj.BeginUpdate(Self);
         $Check(Self,"").FHandle$3.style["width"] = TInteger.ToPxStr(aWidth$5);
         $Check(Self,"").FHandle$3.style["height"] = TInteger.ToPxStr(aHeight$5);
         TW3MovableControl.SetWasSized(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3MovableControl.setTop(const aValue: Integer)
   ,setTop:function(Self, aValue$32) {
      TW3TagObj.BeginUpdate(Self);
      $Check(Self,"").FHandle$3.style["top"] = TInteger.ToPxStr(aValue$32);
      TW3MovableControl.SetWasMoved(Self);
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3MovableControl.setTransparent(const aValue: Boolean)
   ,setTransparent:function(Self, aValue$33) {
      var mText$1 = "";
      if (aValue$33!=$Check(Self,"").FTransparent) {
         TW3TagObj.BeginUpdate(Self);
         $Check(Self,"").FTransparent = aValue$33;
         mText$1 = ColorToWebStr($Check(Self,"").FColor,(aValue$33)?0:255);
         $Check(Self,"").FHandle$3.style["backgroundColor"] = mText$1;
         TW3MovableControl.SetWasMoved(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3MovableControl.setUseAlpha(const aValue: Boolean)
   ,setUseAlpha:function(Self, aValue$34) {
      var mBlend = 0;
      if (aValue$34==$Check(Self,"").FUseAlpha) {
         return;
      }
      $Check(Self,"").FUseAlpha = aValue$34;
      if (aValue$34) {
         mBlend = $Check(Self,"").FAlpha/100;
      } else {
         mBlend = 1;
      }
      $Check(Self,"").FHandle$3.style["opacity"] = mBlend;
   }
   /// procedure TW3MovableControl.SetVisible(const aValue: Boolean)
   ,SetVisible:function(Self, aValue$35) {
      TW3TagObj.BeginUpdate(Self);
      if (aValue$35) {
         $Check(Self,"").FHandle$3.style["display"] = TW3MovableControl.DisplayMode$($Check(Self,"").ClassType);
         $Check(Self,"").FHandle$3.style["visibility"] = "visible";
         TW3MovableControl.SetWasSized(Self);
      } else {
         $Check(Self,"").FHandle$3.style["display"] = "none";
         $Check(Self,"").FHandle$3.style["visibility"] = "hidden";
      }
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3MovableControl.SetWasMoved()
   ,SetWasMoved:function(Self) {
      $Check(Self,"").FWasMoved = true;
   }
   /// procedure TW3MovableControl.SetWasSized()
   ,SetWasSized:function(Self) {
      $Check(Self,"").FWasSized = true;
   }
   /// procedure TW3MovableControl.SetWidth(aValue: Integer)
   ,SetWidth:function(Self, aValue$36) {
      aValue$36 = Math.max(aValue$36,0);
      if (aValue$36!=TW3MovableControl.GetWidth$1$($Check(Self,""))) {
         TW3TagObj.BeginUpdate(Self);
         $Check(Self,"").FHandle$3.style["width"] = TInteger.ToPxStr(aValue$36);
         TW3MovableControl.SetWasSized(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// function TW3MovableControl.supportAdjustment() : Boolean
   ,supportAdjustment:function(Self) {
      return true;
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate$:function($){return $.ClassType.AfterUpdate($)}
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3TagObj.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox$:function($){return $.ClassType.AdjustToParentBox($)}
   ,DisplayMode$:function($){return $.DisplayMode($)}
   ,getBoundsRect$:function($){return $.ClassType.getBoundsRect($)}
   ,GetHeight$1$:function($){return $.ClassType.GetHeight$1($)}
   ,GetLeft$:function($){return $.ClassType.GetLeft($)}
   ,GetTop$:function($){return $.ClassType.GetTop($)}
   ,getVisible$:function($){return $.ClassType.getVisible($)}
   ,GetWidth$1$:function($){return $.ClassType.GetWidth$1($)}
   ,Moved$:function($){return $.ClassType.Moved($)}
   ,MoveTo$1$:function($){return $.ClassType.MoveTo$1.apply($.ClassType, arguments)}
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3$:function($){return $.ClassType.SetBounds$3.apply($.ClassType, arguments)}
   ,SetBounds$2$:function($){return $.ClassType.SetBounds$2.apply($.ClassType, arguments)}
   ,setHeight$:function($){return $.ClassType.setHeight.apply($.ClassType, arguments)}
   ,setLeft$:function($){return $.ClassType.setLeft.apply($.ClassType, arguments)}
   ,SetSize$4$:function($){return $.ClassType.SetSize$4.apply($.ClassType, arguments)}
   ,setTop$:function($){return $.ClassType.setTop.apply($.ClassType, arguments)}
   ,SetVisible$:function($){return $.ClassType.SetVisible.apply($.ClassType, arguments)}
   ,SetWidth$:function($){return $.ClassType.SetWidth.apply($.ClassType, arguments)}
   ,supportAdjustment$:function($){return $.supportAdjustment($)}
};
/// TW3CustomControl = class (TW3MovableControl)
var TW3CustomControl = {
   $ClassName:"TW3CustomControl",
   $Parent:TW3MovableControl
   ,$Init:function ($) {
      TW3MovableControl.$Init($);
      $.FAngle = 0;
      $.FClassNames = $.FFont = $.FGestureData = $.FNoBehavior = $.FOnAnimationBegins = $.FOnAnimationEnds = $.FOnChanged = $.FOnClick = $.FOnContextPopup = $.FOnDblClick = $.FOnGestureChange = $.FOnGestureEnd = $.FOnGestureStart = $.FOnGotFocus = $.FOnKeyDown = $.FOnKeyPress = $.FOnKeyUp = $.FOnLostFocus = $.FOnMouseDown = $.FOnMouseEnter = $.FOnMouseExit = $.FOnMouseMove = $.FOnMouseUp = $.FOnMouseWheel = $.FOnResize = $.FOnTouchBegins = $.FOnTouchEnds = $.FOnTouchMoves = $.FScrollInfo = $.FTouchData = null;
      $.FMouseCaptured = 0;
      $.FTouchBound = false;
   }
   /// anonymous TSourceMethodSymbol
   ,a$6:function(Self) {
      return vCaptureControl===Self;
   }
   /// procedure TW3CustomControl.AfterUpdate()
   ,AfterUpdate:function(Self) {
      if (TW3MovableControl.GetWasSized(Self)) {
         if ($Check(Self,"").FObjReady) {
            TW3MovableControl.Resize$($Check(Self,""));
         }
         if (!TW3MovableControl.GetWasMoved(Self)) {
            TW3MovableControl.SetWasMoved(Self);
         }
      }
      if (TW3MovableControl.GetWasMoved(Self)) {
         TW3CustomControl.Invalidate$($Check(Self,""));
      }
      TW3MovableControl.AfterUpdate(Self);
   }
   /// procedure TW3CustomControl.BindTouch()
   ,BindTouch:function(Self) {
      if ($Check(Self,"").FTouchBound) {
         return;
      }
      $Check(Self,"").FTouchBound = true;
      $Check(Self,"").FHandle$3.addEventListener("touchstart",$Event1(Self,TW3CustomControl.CMTouchBegins$));
      $Check(Self,"").FHandle$3.addEventListener("touchmove",$Event1(Self,TW3CustomControl.CMTouchMove$));
      $Check(Self,"").FHandle$3.addEventListener("touchend",$Event1(Self,TW3CustomControl.CMTouchEnds$));
   }
   /// procedure TW3CustomControl.BringToFront()
   ,BringToFront:function(Self) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.style.zIndex = (TW3CustomControl.GetMaxZIndex($As($Check(Self,"").FParent,TW3CustomControl))+1);
      }
   }
   /// procedure TW3CustomControl.CBAnimationBegins(const eventObj: Variant)
   ,CBAnimationBegins:function(Self, eventObj) {
      if ($Check(Self,"").FOnAnimationBegins) {
         $CheckFunc($Check(Self,"").FOnAnimationBegins,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBAnimationEnds(const eventObj: Variant)
   ,CBAnimationEnds:function(Self, eventObj$1) {
      if ($Check(Self,"").FOnAnimationEnds) {
         $CheckFunc($Check(Self,"").FOnAnimationEnds,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBChanged(eventObj: JEvent)
   ,CBChanged:function(Self, eventObj$2) {
      if ($Check(Self,"").FOnChanged) {
         $CheckFunc($Check(Self,"").FOnChanged,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBClick(eventObj: JEvent)
   ,CBClick:function(Self, eventObj$3) {
      if ($Check(Self,"").FOnClick) {
         $CheckFunc($Check(Self,"").FOnClick,"")(Self);
      }
   }
   /// function TW3CustomControl.CBContextPopup(event: JMouseEvent) : Boolean
   ,CBContextPopup:function(Self, event) {
      var Result = false;
      var sr$2 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var mp = {X$1:0,Y$1:0};
      var handled = {v:false};
      sr$2 = TW3MovableControl.ScreenRect(Self);
      mp.X$1 = $Check(event,"").clientX-sr$2.Left$1;
      mp.Y$1 = $Check(event,"").clientY-sr$2.Top$1;
      handled.v = false;
      TW3CustomControl.ContextPopup(Self,mp,handled);
      Result = !handled.v;
      return Result
   }
   /// procedure TW3CustomControl.CBDblClick(eventObj: JEvent)
   ,CBDblClick:function(Self, eventObj$4) {
      if ($Check(Self,"").FOnDblClick) {
         $CheckFunc($Check(Self,"").FOnDblClick,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBFocused()
   ,CBFocused:function(Self) {
      if ($Check(Self,"").FOnGotFocus) {
         $CheckFunc($Check(Self,"").FOnGotFocus,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBKeyDown(eventObj: JKeyboardEvent)
   ,CBKeyDown:function(Self, eventObj$5) {
      if ($Check(Self,"").FOnKeyDown) {
         $CheckFunc($Check(Self,"").FOnKeyDown,"")(Self,$Check(eventObj$5,"").keyCode);
      }
   }
   /// procedure TW3CustomControl.CBKeyPress(eventObj: JKeyboardEvent)
   ,CBKeyPress:function(Self, eventObj$6) {
      if ($Check(Self,"").FOnKeyPress) {
         $CheckFunc($Check(Self,"").FOnKeyPress,"")(Self,$Check(eventObj$6,"").charCode);
      }
   }
   /// procedure TW3CustomControl.CBKeyUp(eventObj: JKeyboardEvent)
   ,CBKeyUp:function(Self, eventObj$7) {
      if ($Check(Self,"").FOnKeyUp) {
         $CheckFunc($Check(Self,"").FOnKeyUp,"")(Self,$Check(eventObj$7,"").keyCode);
      }
   }
   /// procedure TW3CustomControl.CBLostFocus()
   ,CBLostFocus:function(Self) {
      if ($Check(Self,"").FOnLostFocus) {
         $CheckFunc($Check(Self,"").FOnLostFocus,"")(Self);
      }
   }
   /// procedure TW3CustomControl.CBMouseDown(eventObj: JMouseEvent)
   ,CBMouseDown:function(Self, eventObj$8) {
      var sr$3 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState = null;
      sr$3 = TW3MovableControl.ScreenRect(Self);
      shiftState = TShiftState.Current();
      $Check(shiftState,"").FMouseButtons = $Check(shiftState,"").FMouseButtons|(1<<$Check(eventObj$8,"").button);
      TShiftState.SetMouseEvent(shiftState,eventObj$8);
      TW3CustomControl.MouseDown$1$($Check(Self,""),$Check(eventObj$8,"").button,shiftState,$Check(eventObj$8,"").clientX-sr$3.Left$1,$Check(eventObj$8,"").clientY-sr$3.Top$1);
   }
   /// procedure TW3CustomControl.CBMouseEnter(eventObj: JMouseEvent)
   ,CBMouseEnter:function(Self, eventObj$9) {
      var sr$4 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState$1 = null;
      sr$4 = TW3MovableControl.ScreenRect(Self);
      shiftState$1 = TShiftState.Current();
      TShiftState.SetMouseEvent(shiftState$1,eventObj$9);
      TW3CustomControl.MouseEnter$($Check(Self,""),shiftState$1,$Check(eventObj$9,"").clientX-sr$4.Left$1,$Check(eventObj$9,"").clientY-sr$4.Top$1);
   }
   /// procedure TW3CustomControl.CBMouseExit(eventObj: JMouseEvent)
   ,CBMouseExit:function(Self, eventObj$10) {
      var sr$5 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState$2 = null;
      sr$5 = TW3MovableControl.ScreenRect(Self);
      shiftState$2 = TShiftState.Current();
      TShiftState.SetMouseEvent(shiftState$2,eventObj$10);
      TW3CustomControl.MouseExit$($Check(Self,""),shiftState$2,$Check(eventObj$10,"").clientX-sr$5.Left$1,$Check(eventObj$10,"").clientY-sr$5.Top$1);
   }
   /// procedure TW3CustomControl.CBMouseMove(eventObj: JMouseEvent)
   ,CBMouseMove:function(Self, eventObj$11) {
      var sr$6 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState$3 = null;
      sr$6 = TW3MovableControl.ScreenRect(Self);
      shiftState$3 = TShiftState.Current();
      TShiftState.SetMouseEvent(shiftState$3,eventObj$11);
      TW3CustomControl.MouseMove$($Check(Self,""),shiftState$3,$Check(eventObj$11,"").clientX-sr$6.Left$1,$Check(eventObj$11,"").clientY-sr$6.Top$1);
   }
   /// procedure TW3CustomControl.CBMouseUp(eventObj: JMouseEvent)
   ,CBMouseUp:function(Self, eventObj$12) {
      var sr$7 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState$4 = null;
      sr$7 = TW3MovableControl.ScreenRect(Self);
      shiftState$4 = TShiftState.Current();
      $Check(shiftState$4,"").FMouseButtons = $Check(shiftState$4,"").FMouseButtons&(~(1<<$Check(eventObj$12,"").button));
      TShiftState.SetMouseEvent(shiftState$4,eventObj$12);
      TW3CustomControl.MouseUp$1$($Check(Self,""),$Check(eventObj$12,"").button,shiftState$4,$Check(eventObj$12,"").clientX-sr$7.Left$1,$Check(eventObj$12,"").clientY-sr$7.Top$1);
   }
   /// procedure TW3CustomControl.CBMouseWheel(eventObj: JMouseWheelEvent)
   ,CBMouseWheel:function(Self, eventObj$13) {
      var wheelDelta$1 = 0;
      var handled$1 = {};
      handled$1.v = false;
      var sr$8 = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var shiftState$5 = null;
      var mousePos = {X$1:0,Y$1:0};
      if ($Check(Self,"").FOnMouseWheel) {
         if (eventObj$13.detail) {
            wheelDelta$1 = $Check(eventObj$13,"").detail*-40;
         } else {
            wheelDelta$1 = $Check(eventObj$13,"").wheelDelta;
         }
         sr$8 = TW3MovableControl.ScreenRect(Self);
         shiftState$5 = TShiftState.Current();
         TShiftState.SetMouseEvent(shiftState$5,eventObj$13);
         mousePos.X$1 = $Check(eventObj$13,"").clientX-sr$8.Left$1;
         mousePos.Y$1 = $Check(eventObj$13,"").clientY-sr$8.Top$1;
         TW3CustomControl.MouseWheel$($Check(Self,""),shiftState$5,wheelDelta$1,mousePos,handled$1);
         if (handled$1.v) {
            eventObj$13.preventDefault();
            eventObj$13.stopPropagation();
         }
      }
   }
   /// procedure TW3CustomControl.CMGestureChange()
   ,CMGestureChange:function(Self) {
      event.preventDefault();
      if ($Check(Self,"").FOnGestureChange) {
         if ($Check(Self,"").FGestureData) {
            TW3GestureData.Update$4($Check(Self,"").FGestureData);
         } else {
            $Check(Self,"").FGestureData = TObject.Create($New(TW3GestureData));
         }
         $CheckFunc($Check(Self,"").FOnGestureChange,"")(Self,$Check(Self,"").FGestureData);
      }
   }
   /// procedure TW3CustomControl.CMGestureEnd()
   ,CMGestureEnd:function(Self) {
      event.preventDefault();
      if ($Check(Self,"").FOnGestureEnd) {
         if ($Check(Self,"").FGestureData) {
            TW3GestureData.Update$4($Check(Self,"").FGestureData);
         } else {
            $Check(Self,"").FGestureData = TObject.Create($New(TW3GestureData));
         }
         $CheckFunc($Check(Self,"").FOnGestureEnd,"")(Self,$Check(Self,"").FGestureData);
      }
   }
   /// procedure TW3CustomControl.CMGestureStart()
   ,CMGestureStart:function(Self) {
      event.preventDefault();
      if ($Check(Self,"").FOnGestureStart) {
         if ($Check(Self,"").FGestureData) {
            TW3GestureData.Update$4($Check(Self,"").FGestureData);
         } else {
            $Check(Self,"").FGestureData = TObject.Create($New(TW3GestureData));
         }
         $CheckFunc($Check(Self,"").FOnGestureStart,"")(Self,$Check(Self,"").FGestureData);
      }
   }
   /// procedure TW3CustomControl.CMTouchBegins(eventObj: JTouchEvent)
   ,CMTouchBegins:function(Self, eventObj$14) {
      eventObj$14.preventDefault();
      if ($Check(Self,"").FOnTouchBegins) {
         if ($Check(Self,"").FTouchData) {
            TW3TouchData.Update$3($Check(Self,"").FTouchData,eventObj$14);
         } else {
            $Check(Self,"").FTouchData = TObject.Create($New(TW3TouchData));
         }
         $CheckFunc($Check(Self,"").FOnTouchBegins,"")(Self,$Check(Self,"").FTouchData);
      }
   }
   /// procedure TW3CustomControl.CMTouchEnds(eventObj: JTouchEvent)
   ,CMTouchEnds:function(Self, eventObj$15) {
      eventObj$15.preventDefault();
      if ($Check(Self,"").FOnTouchEnds) {
         if ($Check(Self,"").FTouchData) {
            TW3TouchData.Update$3($Check(Self,"").FTouchData,eventObj$15);
         } else {
            $Check(Self,"").FTouchData = TObject.Create($New(TW3TouchData));
         }
         $CheckFunc($Check(Self,"").FOnTouchEnds,"")(Self,$Check(Self,"").FTouchData);
      }
   }
   /// procedure TW3CustomControl.CMTouchMove(eventObj: JTouchEvent)
   ,CMTouchMove:function(Self, eventObj$16) {
      eventObj$16.preventDefault();
      if ($Check(Self,"").FOnTouchMoves) {
         if ($Check(Self,"").FTouchData) {
            TW3TouchData.Update$3($Check(Self,"").FTouchData,eventObj$16);
         } else {
            $Check(Self,"").FTouchData = TObject.Create($New(TW3TouchData));
         }
         $CheckFunc($Check(Self,"").FOnTouchMoves,"")(Self,$Check(Self,"").FTouchData);
      }
   }
   /// procedure TW3CustomControl.ContextPopup(const mousePos: TPoint; var handled: Boolean)
   ,ContextPopup:function(Self, mousePos$1, handled$2) {
      if ($Check(Self,"").FOnContextPopup) {
         $CheckFunc($Check(Self,"").FOnContextPopup,"")(Self,mousePos$1,handled$2);
      }
   }
   /// procedure TW3CustomControl.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TObject.Free($Check(Self,"").FFont);
      TObject.Free($Check(Self,"").FClassNames);
      TObject.Free($Check(Self,"").FScrollInfo);
      TObject.Free($Check(Self,"").FTouchData);
      TObject.Free($Check(Self,"").FGestureData);
      TW3MovableControl.FinalizeObject(Self);
   }
   /// function TW3CustomControl.getBorderRadius() : Integer
   ,getBorderRadius:function(Self) {
      return w3_getStyleAsInt($Check(Self,"").FHandle$3,"bordertopleftRadius");
   }
   /// function TW3CustomControl.GetChildrenSortedByYPos() : TW3ComponentArray
   ,GetChildrenSortedByYPos:function(Self) {
      var Result = [];
      var mCount$1 = 0;
      var x$36 = 0;
      var mAltered = false;
      var mObj$2 = null;
      var mLast = null;
      var mCurrent = null;
      Result.length=0;
      mCount$1 = TW3Component.GetChildCount(Self);
      if (mCount$1>0) {
         var $temp73;
         for(x$36 = 0,$temp73 = mCount$1;x$36<$temp73;x$36++) {
            mObj$2 = TW3Component.GetChildObject(Self,x$36);
            if ($Is(mObj$2,TW3CustomControl)) {
               Result.push(mObj$2);
            }
         }
         if (Result.length>1) {
            do {
               mAltered = false;
               var $temp74;
               for(x$36 = 1,$temp74 = mCount$1;x$36<$temp74;x$36++) {
                  mLast = $As($DIdxR(Result,x$36-1,""),TW3CustomControl);
                  mCurrent = $As($DIdxR(Result,x$36,""),TW3CustomControl);
                  if (TW3MovableControl.GetTop$($Check(mCurrent,""))<TW3MovableControl.GetTop$($Check(mLast,""))) {
                     $ArraySwapChk(Result,(x$36-1),x$36,"");
                     mAltered = true;
                  }
               }
            } while (!(mAltered==false));
         }
      }
      return Result
   }
   /// function TW3CustomControl.getClassNames() : TW3CSSClassStyleNames
   ,getClassNames:function(Self) {
      var Result = null;
      if ($Check(Self,"").FClassNames===null) {
         $Check(Self,"").FClassNames = TW3OwnedObject.Create$7$($New(TW3CSSClassStyleNames),Self);
      }
      Result = $Check(Self,"").FClassNames;
      return Result
   }
   /// function TW3CustomControl.GetEnabled() : Boolean
   ,GetEnabled:function(Self) {
      return $Check(Self,"").FHandle$3.disabled!=true;
   }
   /// function TW3CustomControl.getFont() : TW3ControlFont
   ,getFont$1:function(Self) {
      var Result = null;
      if ($Check(Self,"").FFont===null) {
         $Check(Self,"").FFont = TW3ControlFont.Create$39$($New(TW3ControlFont),Self);
      }
      Result = $Check(Self,"").FFont;
      return Result
   }
   /// function TW3CustomControl.gethasFocus() : Boolean
   ,gethasFocus:function(Self) {
      var Result = false;
      if ($Check(Self,"").FHandle$3) {
         Result = ($Check(Self,"").FHandle$3.focused()?true:false);
      }
      return Result
   }
   /// function TW3CustomControl.GetMaxZIndex() : Integer
   ,GetMaxZIndex:function(Self) {
      var Result = 0;
      var iChild = 0;
      var obj = null;
      var objZIndex = 0;
      Result = 0;
      var $temp75;
      for(iChild = 0,$temp75 = TW3Component.GetChildCount(Self);iChild<$temp75;iChild++) {
         obj = TW3Component.GetChildObject(Self,iChild);
         if (((obj!==null)&&$Is(obj,TW3CustomControl))&&$Check(obj,"").FHandle$3) {
            objZIndex = TW3CustomControl.GetZIndexAsInt($As(obj,TW3CustomControl),0);
            if (objZIndex>Result) {
               Result = objZIndex;
            }
            objZIndex = TW3CustomControl.GetMaxZIndex($As(obj,TW3CustomControl));
            if (objZIndex>Result) {
               Result = objZIndex;
            }
         }
      }
      return Result
   }
   /// function TW3CustomControl.getScrollInfo() : TW3ScrollInfo
   ,getScrollInfo:function(Self) {
      var Result = null;
      if ($Check(Self,"").FScrollInfo===null) {
         $Check(Self,"").FScrollInfo = TW3OwnedObject.Create$7$($New(TW3ScrollInfo),Self);
      }
      Result = $Check(Self,"").FScrollInfo;
      return Result
   }
   /// function TW3CustomControl.GetSizeInfo() : TW3ControlSizeInfo
   ,GetSizeInfo:function(Self) {
      var Result = {siClientHeight:0,siClientWidth:0,siHeight:0,siOffsetHeight:0,siOffsetWidth:0,siScrollHeight:0,siScrollWidth:0,siWidth:0};
      Result.siWidth = TW3MovableControl.GetWidth$1$($Check(Self,""));
      Result.siHeight = TW3MovableControl.GetHeight$1$($Check(Self,""));
      Result.siClientWidth = w3_getPropertyAsInt($Check(Self,"").FHandle$3,"clientWidth");
      Result.siClientHeight = w3_getPropertyAsInt($Check(Self,"").FHandle$3,"clientHeight");
      Result.siOffsetWidth = w3_getPropertyAsInt($Check(Self,"").FHandle$3,"offsetWidth");
      Result.siOffsetHeight = w3_getPropertyAsInt($Check(Self,"").FHandle$3,"offsetHeight");
      return Result
   }
   /// function TW3CustomControl.getStyleClass() : String
   ,getStyleClass:function(Self) {
      return w3_getAttribAsStr($Check(Self,"").FHandle$3,"class");
   }
   /// function TW3CustomControl.GetZIndexAsInt(default: Integer = 0) : Integer
   ,GetZIndexAsInt:function(Self, default$1) {
      var Result = 0;
      var mData$3;
      Result = default$1;
      mData$3 = $Check(Self,"").FHandle$3.style["zIndex"];
      if ($Check(Self,"").FHandle$3) {
         if (TVariant.IsNumber(mData$3)) {
            Result = parseInt(mData$3,10);
         } else if (TVariant.IsString(mData$3)) {
            Result = parseInt(mData$3,10);
            if (isNaN(Result)) {
               Result = default$1;
            }
         }
      }
      return Result
   }
   /// function TW3CustomControl.getZoom() : Float
   ,getZoom:function(Self) {
      return w3_getStyleAsFloat($Check(Self,"").FHandle$3,"zoom");
   }
   /// procedure TW3CustomControl.InitializeCapture()
   ,InitializeCapture:function(Self) {
      var doc = undefined;
      doc = document;
      doc.addEventListener("mousedown",function (evt) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseDown$($Check(vCaptureControl,""),evt);
            evt.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("mousemove",function (evt$1) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseMove$($Check(vCaptureControl,""),evt$1);
            evt$1.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("mouseup",function (evt$2) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseUp$($Check(vCaptureControl,""),evt$2);
            evt$2.stopImmediatePropagation();
         }
         vCaptureControl = null;
      },true);
      doc.addEventListener("mouseover",function (evt$3) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseEnter$($Check(vCaptureControl,""),evt$3);
            evt$3.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("mouseout",function (evt$4) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseExit$($Check(vCaptureControl,""),evt$4);
            evt$4.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("mousewheel",function (evt$5) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBMouseWheel$($Check(vCaptureControl,""),evt$5);
            evt$5.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("onclick",function (evt$6) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBClick$($Check(vCaptureControl,""),evt$6);
            evt$6.stopImmediatePropagation();
         }
      },true);
      doc.addEventListener("ondblclick",function (evt$7) {
         if (vCaptureControl!==null) {
            TW3CustomControl.CBDblClick$($Check(vCaptureControl,""),evt$7);
            evt$7.stopImmediatePropagation();
         }
      },true);
      vCaptureInitialized = true;
   }
   /// procedure TW3CustomControl.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3MovableControl.InitializeObject(Self);
      $Check(Self,"").FNoBehavior = $Event0(Self,TW3Component.CBNoBehavior$);
      w3_bind2($Check(Self,"").FHandle$3,"onselectstart",$Event0(Self,TW3Component.CBNoBehavior$));
      w3_bind2($Check(Self,"").FHandle$3,"onfocus",$Event0(Self,TW3CustomControl.CBFocused$));
      w3_bind2($Check(Self,"").FHandle$3,"onblur",$Event0(Self,TW3CustomControl.CBLostFocus$));
   }
   /// procedure TW3CustomControl.Invalidate()
   ,Invalidate:function(Self) {
      /* null */
   }
   /// procedure TW3CustomControl.LayoutChildren()
   ,LayoutChildren:function(Self) {
      var x$37 = 0;
      var mChild$1 = null;
      TW3TagObj.BeginUpdate(Self);
      try {
         var $temp76;
         for(x$37 = 0,$temp76 = TW3Component.GetChildCount(Self);x$37<$temp76;x$37++) {
            mChild$1 = TW3Component.GetChildObject(Self,x$37);
            if ($Is(mChild$1,TW3CustomControl)) {
               setTimeout($Event0($As(mChild$1,TW3CustomControl),TW3CustomControl.LayoutChildren$),10);
            }
         }
      } finally {
         TW3MovableControl.SetWasSized(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3CustomControl.MouseDown(button: TMouseButton; shiftState: TShiftState; x: Integer; y: Integer)
   ,MouseDown$1:function(Self, button$1, shiftState$6, x$38, y$30) {
      if ($Check(Self,"").FOnMouseDown) {
         $CheckFunc($Check(Self,"").FOnMouseDown,"")(Self,button$1,shiftState$6,x$38,y$30);
      }
   }
   /// procedure TW3CustomControl.MouseEnter(shiftState: TShiftState; x: Integer; y: Integer)
   ,MouseEnter:function(Self, shiftState$7, x$39, y$31) {
      if ($Check(Self,"").FOnMouseEnter) {
         $CheckFunc($Check(Self,"").FOnMouseEnter,"")(Self,shiftState$7,x$39,y$31);
      }
   }
   /// procedure TW3CustomControl.MouseExit(shiftState: TShiftState; x: Integer; y: Integer)
   ,MouseExit:function(Self, shiftState$8, x$40, y$32) {
      if ($Check(Self,"").FOnMouseExit) {
         $CheckFunc($Check(Self,"").FOnMouseExit,"")(Self,shiftState$8,x$40,y$32);
      }
   }
   /// procedure TW3CustomControl.MouseMove(shiftState: TShiftState; x: Integer; y: Integer)
   ,MouseMove:function(Self, shiftState$9, x$41, y$33) {
      if ($Check(Self,"").FOnMouseMove) {
         $CheckFunc($Check(Self,"").FOnMouseMove,"")(Self,shiftState$9,x$41,y$33);
      }
   }
   /// procedure TW3CustomControl.MouseUp(button: TMouseButton; shiftState: TShiftState; x: Integer; y: Integer)
   ,MouseUp$1:function(Self, button$2, shiftState$10, x$42, y$34) {
      if ($Check(Self,"").FOnMouseUp) {
         $CheckFunc($Check(Self,"").FOnMouseUp,"")(Self,button$2,shiftState$10,x$42,y$34);
      }
   }
   /// procedure TW3CustomControl.MouseWheel(shift: TShiftState; wheelDelta: Integer; const mousePos: TPoint; var handled: Boolean)
   ,MouseWheel:function(Self, shift, wheelDelta$2, mousePos$2, handled$3) {
      if ($Check(Self,"").FOnMouseWheel) {
         $CheckFunc($Check(Self,"").FOnMouseWheel,"")(Self,shift,wheelDelta$2,mousePos$2,handled$3);
      }
   }
   /// procedure TW3CustomControl.ReleaseCapture()
   ,ReleaseCapture:function(Self) {
      --$Check(Self,"").FMouseCaptured;
      if (!$Check(Self,"").FMouseCaptured) {
         if ($Check(Self,"").FHandle$3.releaseCapture) {
            $Check(Self,"").FHandle$3.releaseCapture();
         }
         vCaptureControl = null;
      } else if ($Check(Self,"").FMouseCaptured<0) {
         $Check(Self,"").FMouseCaptured = 0;
      }
   }
   /// procedure TW3CustomControl.SendToBack()
   ,SendToBack:function(Self) {
      var iChild$1 = 0;
      var obj$1 = null;
      var pushUp = 0;
      var minZIndex = 0;
      var objZIndex$1 = 0;
      var objZIndex$2 = 0;
      if ($Check(Self,"").FHandle$3) {
         minZIndex = 99999;
         if (($Check(Self,"").FParent!==null)&&$Is($Check(Self,"").FParent,TW3Component)) {
            var $temp77;
            for(iChild$1 = 0,$temp77 = TW3Component.GetChildCount($Check(Self,"").FParent);iChild$1<$temp77;iChild$1++) {
               obj$1 = TW3Component.GetChildObject($Check(Self,"").FParent,iChild$1);
               if (((obj$1!==null)&&$Is(obj$1,TW3CustomControl))&&$Check(obj$1,"").FHandle$3) {
                  objZIndex$1 = TW3CustomControl.GetZIndexAsInt($As(obj$1,TW3CustomControl),99999);
                  if (objZIndex$1<minZIndex) {
                     minZIndex = objZIndex$1;
                  }
               }
            }
         }
         if (minZIndex==99999) {
            minZIndex = 0;
         }
         if (($Check(Self,"").FParent!==null)&&$Is($Check(Self,"").FParent,TW3Component)) {
            if (minZIndex<0) {
               pushUp = -minZIndex;
            } else {
               pushUp = 1;
            }
            var $temp78;
            for(iChild$1 = 0,$temp78 = TW3Component.GetChildCount($Check(Self,"").FParent);iChild$1<$temp78;iChild$1++) {
               obj$1 = TW3Component.GetChildObject($Check(Self,"").FParent,iChild$1);
               if ((((obj$1!==null)&&(obj$1!==Self))&&$Is(obj$1,TW3CustomControl))&&$Check(obj$1,"").FHandle$3) {
                  objZIndex$2 = TW3CustomControl.GetZIndexAsInt($As(obj$1,TW3CustomControl),-1);
                  if (objZIndex$2<0) {
                     $Check(obj$1,"").FHandle$3.style.zIndex = (minZIndex+pushUp+1);
                  } else {
                     $Check(obj$1,"").FHandle$3.style.zIndex = (objZIndex$2+pushUp);
                  }
               }
            }
         }
         $Check(Self,"").FHandle$3.style.zIndex = ((minZIndex+pushUp)-1);
      }
   }
   /// procedure TW3CustomControl.setAngle(aValue: Float)
   ,setAngle:function(Self, aValue$37) {
      var mStyle = "";
      if (aValue$37!=$Check(Self,"").FAngle) {
         $Check(Self,"").FAngle = aValue$37;
         mStyle = "rotate("+FloatToStr$_Float_Integer_(aValue$37,2)+"deg)";
         w3_setStyle($Check(Self,"").FHandle$3,w3_CSSPrefix("Transform"),mStyle);
      }
   }
   /// procedure TW3CustomControl.setBorderRadius(aNewRadius: Integer)
   ,setBorderRadius:function(Self, aNewRadius) {
      TW3TagObj.BeginUpdate(Self);
      w3_setStyle($Check(Self,"").FHandle$3,"borderRadius",TInteger.ToPxStr(aNewRadius));
      TW3MovableControl.SetWasSized(Self);
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// procedure TW3CustomControl.SetCapture()
   ,SetCapture:function(Self) {
      if (!$Check(Self,"").FMouseCaptured) {
         if ($Check(Self,"").FHandle$3.setCapture) {
            $Check(Self,"").FHandle$3.setCapture(true);
         } else if (!vCaptureInitialized) {
            TW3CustomControl.InitializeCapture($Check(Self,"").ClassType);
         }
         vCaptureControl = Self;
      }
      ++$Check(Self,"").FMouseCaptured;
   }
   /// procedure TW3CustomControl.SetEnabled(aValue: Boolean)
   ,SetEnabled:function(Self, aValue$38) {
      $Check(Self,"").FHandle$3.disabled = (!aValue$38);
   }
   /// procedure TW3CustomControl.SetFocus()
   ,SetFocus:function(Self) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.focus();
      }
   }
   /// procedure TW3CustomControl.setStyleClass(aStyle: String)
   ,setStyleClass:function(Self, aStyle) {
      w3_setAttrib($Check(Self,"").FHandle$3,"class",aStyle);
   }
   /// procedure TW3CustomControl.setZoom(aValue: Float)
   ,setZoom:function(Self, aValue$39) {
      w3_setStyle($Check(Self,"").FHandle$3,"zoom",aValue$39);
   }
   /// procedure TW3CustomControl.StyleTagObject()
   ,StyleTagObject:function(Self) {
      TW3TagObj.StyleTagObject(Self);
      TW3CustomControl.setStyleClass(Self,TObject.ClassName($Check(Self,"").ClassType));
      TW3MovableControl.SetVisible$($Check(Self,""),true);
   }
   /// procedure TW3CustomControl._setAnimationBegins(const aValue: TAnimationBeginsEvent)
   ,_setAnimationBegins:function(Self, aValue$40) {
      if (aValue$40) {
         $Check(Self,"").FHandle$3[w3_CSSPrefix("AnimationStart")] = $Event1(Self,TW3CustomControl.CBAnimationBegins$);
      } else {
         $Check(Self,"").FHandle$3[w3_CSSPrefix("AnimationStart")] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnAnimationBegins = aValue$40;
   }
   /// procedure TW3CustomControl._setAnimationEnds(const aValue: TAnimationEndsEvent)
   ,_setAnimationEnds:function(Self, aValue$41) {
      if (aValue$41) {
         $Check(Self,"").FHandle$3[w3_CSSPrefix("AnimationEnd")] = $Event1(Self,TW3CustomControl.CBAnimationEnds$);
      } else {
         $Check(Self,"").FHandle$3[w3_CSSPrefix("AnimationEnd")] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnAnimationEnds = aValue$41;
   }
   /// procedure TW3CustomControl._setChanged(const aValue: TChangedEvent)
   ,_setChanged:function(Self, aValue$42) {
      if (aValue$42) {
         $Check(Self,"").FHandle$3["onchange"] = $Event1(Self,TW3CustomControl.CBChanged$);
      } else {
         $Check(Self,"").FHandle$3["onchange"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnChanged = aValue$42;
   }
   /// procedure TW3CustomControl._setContextPopup(const aValue: TContextPopupEvent)
   ,_setContextPopup:function(Self, aValue$43) {
      var mObj$3 = undefined;
      mObj$3 = $Check(Self,"").FHandle$3;
      if (aValue$43) {
         mObj$3["oncontextmenu"] = $Event1(Self,TW3CustomControl.CBContextPopup$);
      } else {
         mObj$3["oncontextmenu"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnContextPopup = aValue$43;
   }
   /// procedure TW3CustomControl._setGestureChange(aValue: TGestureChangeEvent)
   ,_setGestureChange:function(Self, aValue$44) {
      if ($Check(Self,"").FOnGestureChange) {
         w3_RemoveEvent($Check(Self,"").FHandle$3,"gesturechange",$Event0(Self,TW3CustomControl.CMGestureChange$),true);
         $Check(Self,"").FOnGestureChange = null;
      }
      if (aValue$44) {
         $Check(Self,"").FOnGestureChange = aValue$44;
         w3_AddEvent($Check(Self,"").FHandle$3,"gesturechange",$Event0(Self,TW3CustomControl.CMGestureChange$),true);
      }
   }
   /// procedure TW3CustomControl._setGestureEnd(aValue: TGestureEndEvent)
   ,_setGestureEnd:function(Self, aValue$45) {
      if ($Check(Self,"").FOnGestureEnd) {
         w3_RemoveEvent($Check(Self,"").FHandle$3,"gesturestart",$Event0(Self,TW3CustomControl.CMGestureEnd$),true);
         $Check(Self,"").FOnGestureEnd = null;
      }
      if (aValue$45) {
         $Check(Self,"").FOnGestureEnd = aValue$45;
         w3_AddEvent($Check(Self,"").FHandle$3,"gestureend",$Event0(Self,TW3CustomControl.CMGestureEnd$),true);
      }
   }
   /// procedure TW3CustomControl._setGestureStart(aValue: TGestureStartEvent)
   ,_setGestureStart:function(Self, aValue$46) {
      if ($Check(Self,"").FOnGestureStart) {
         w3_RemoveEvent($Check(Self,"").FHandle$3,"gesturestart",$Event0(Self,TW3CustomControl.CMGestureStart$),true);
         $Check(Self,"").FOnGestureStart = null;
      }
      if (aValue$46) {
         $Check(Self,"").FOnGestureStart = aValue$46;
         w3_AddEvent($Check(Self,"").FHandle$3,"gesturestart",$Event0(Self,TW3CustomControl.CMGestureStart$),true);
      }
   }
   /// procedure TW3CustomControl._setGotFocus(const aValue: TGotFocusEvent)
   ,_setGotFocus:function(Self, aValue$47) {
      $Check(Self,"").FOnGotFocus = aValue$47;
   }
   /// procedure TW3CustomControl._setKeyDown(const aValue: TKeyDownEvent)
   ,_setKeyDown:function(Self, aValue$48) {
      $Check(Self,"").FHandle$3["onkeydown"] = $Event1(Self,TW3CustomControl.CBKeyDown$);
      $Check(Self,"").FOnKeyDown = aValue$48;
   }
   /// procedure TW3CustomControl._setKeyPress(const aValue: TKeyPressEvent)
   ,_setKeyPress:function(Self, aValue$49) {
      if (aValue$49) {
         $Check(Self,"").FHandle$3["onkeypress"] = $Event1(Self,TW3CustomControl.CBKeyPress$);
      } else {
         $Check(Self,"").FHandle$3["onkeypress"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnKeyPress = aValue$49;
   }
   /// procedure TW3CustomControl._setKeyUp(const aValue: TKeyUpEvent)
   ,_setKeyUp:function(Self, aValue$50) {
      $Check(Self,"").FHandle$3["onkeyup"] = $Event1(Self,TW3CustomControl.CBKeyUp$);
      $Check(Self,"").FOnKeyUp = aValue$50;
   }
   /// procedure TW3CustomControl._setLostFocus(const aValue: TLostFocusEvent)
   ,_setLostFocus:function(Self, aValue$51) {
      $Check(Self,"").FOnLostFocus = aValue$51;
   }
   /// procedure TW3CustomControl._setMouseClick(const aValue: TMouseClickEvent)
   ,_setMouseClick:function(Self, aValue$52) {
      if (aValue$52) {
         $Check(Self,"").FHandle$3["onclick"] = $Event1(Self,TW3CustomControl.CBClick$);
      } else {
         $Check(Self,"").FHandle$3["onclick"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnClick = aValue$52;
   }
   /// procedure TW3CustomControl._setMouseDblClick(const aValue: TMouseDblClickEvent)
   ,_setMouseDblClick:function(Self, aValue$53) {
      if (aValue$53) {
         $Check(Self,"").FHandle$3["ondblclick"] = $Event1(Self,TW3CustomControl.CBDblClick$);
      } else {
         $Check(Self,"").FHandle$3["ondblclick"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnDblClick = aValue$53;
   }
   /// procedure TW3CustomControl._setMouseDown(const aValue: TMouseDownEvent)
   ,_setMouseDown:function(Self, aValue$54) {
      $Check(Self,"").FHandle$3["onmousedown"] = $Event1(Self,TW3CustomControl.CBMouseDown$);
      $Check(Self,"").FOnMouseDown = aValue$54;
   }
   /// procedure TW3CustomControl._setMouseEnter(const aValue: TMouseEnterEvent)
   ,_setMouseEnter:function(Self, aValue$55) {
      if (aValue$55) {
         $Check(Self,"").FHandle$3["onmouseover"] = $Event1(Self,TW3CustomControl.CBMouseEnter$);
      } else {
         $Check(Self,"").FHandle$3["onmouseover"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnMouseEnter = aValue$55;
   }
   /// procedure TW3CustomControl._setMouseExit(const aValue: TMouseExitEvent)
   ,_setMouseExit:function(Self, aValue$56) {
      if (aValue$56) {
         $Check(Self,"").FHandle$3["onmouseout"] = $Event1(Self,TW3CustomControl.CBMouseExit$);
      } else {
         $Check(Self,"").FHandle$3["onmouseout"] = $Check(Self,"").FNoBehavior;
      }
      $Check(Self,"").FOnMouseExit = aValue$56;
   }
   /// procedure TW3CustomControl._setMouseMove(const aValue: TMouseMoveEvent)
   ,_setMouseMove:function(Self, aValue$57) {
      $Check(Self,"").FHandle$3["onmousemove"] = $Event1(Self,TW3CustomControl.CBMouseMove$);
      $Check(Self,"").FOnMouseMove = aValue$57;
   }
   /// procedure TW3CustomControl._setMouseUp(const aValue: TMouseUpEvent)
   ,_setMouseUp:function(Self, aValue$58) {
      $Check(Self,"").FHandle$3["onmouseup"] = $Event1(Self,TW3CustomControl.CBMouseUp$);
      $Check(Self,"").FOnMouseUp = aValue$58;
   }
   /// procedure TW3CustomControl._setMouseWheel(const aValue: TMouseWheelEvent)
   ,_setMouseWheel:function(Self, aValue$59) {
      var onEventSupported = false;
      var mObj$4 = undefined;
      mObj$4 = $Check(Self,"").FHandle$3;
      
  onEventSupported = 'onmousewheel' in mObj$4;
  if (onEventSupported) {
         if (aValue$59) {
            mObj$4["onmousewheel"] = $Event1(Self,TW3CustomControl.CBMouseWheel$);
         } else {
            mObj$4["onmousewheel"] = $Check(Self,"").FNoBehavior;
         }
      } else if (aValue$59) {
         mObj$4.addEventListener("DOMMouseScroll",$Event1(Self,TW3CustomControl.CBMouseWheel$),false);
      } else {
         mObj$4.removeEventListener("DOMMouseScroll",$Event1(Self,TW3CustomControl.CBMouseWheel$),false);
      }
      $Check(Self,"").FOnMouseWheel = aValue$59;
   }
   /// procedure TW3CustomControl._setResize(const aValue: TReSizeEvent)
   ,_setResize:function(Self, aValue$60) {
      $Check(Self,"").FOnResize = aValue$60;
   }
   /// procedure TW3CustomControl._setTouchBegins(const aValue: TTouchBeginEvent)
   ,_setTouchBegins:function(Self, aValue$61) {
      if (aValue$61) {
         TW3CustomControl.BindTouch(Self);
      }
      $Check(Self,"").FOnTouchBegins = aValue$61;
   }
   /// procedure TW3CustomControl._setTouchEnds(const aValue: TTouchEndEvent)
   ,_setTouchEnds:function(Self, aValue$62) {
      if (aValue$62) {
         TW3CustomControl.BindTouch(Self);
      }
      $Check(Self,"").FOnTouchEnds = aValue$62;
   }
   /// procedure TW3CustomControl._setTouchMoves(const aValue: TTouchMoveEvent)
   ,_setTouchMoves:function(Self, aValue$63) {
      if (aValue$63) {
         TW3CustomControl.BindTouch(Self);
      }
      $Check(Self,"").FOnTouchMoves = aValue$63;
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate$:function($){return $.ClassType.AfterUpdate($)}
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject$:function($){return $.ClassType.StyleTagObject($)}
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins$:function($){return $.ClassType.CBAnimationBegins.apply($.ClassType, arguments)}
   ,CBAnimationEnds$:function($){return $.ClassType.CBAnimationEnds.apply($.ClassType, arguments)}
   ,CBChanged$:function($){return $.ClassType.CBChanged.apply($.ClassType, arguments)}
   ,CBClick$:function($){return $.ClassType.CBClick.apply($.ClassType, arguments)}
   ,CBContextPopup$:function($){return $.ClassType.CBContextPopup.apply($.ClassType, arguments)}
   ,CBDblClick$:function($){return $.ClassType.CBDblClick.apply($.ClassType, arguments)}
   ,CBFocused$:function($){return $.ClassType.CBFocused($)}
   ,CBKeyDown$:function($){return $.ClassType.CBKeyDown.apply($.ClassType, arguments)}
   ,CBKeyPress$:function($){return $.ClassType.CBKeyPress.apply($.ClassType, arguments)}
   ,CBKeyUp$:function($){return $.ClassType.CBKeyUp.apply($.ClassType, arguments)}
   ,CBLostFocus$:function($){return $.ClassType.CBLostFocus($)}
   ,CBMouseDown$:function($){return $.ClassType.CBMouseDown.apply($.ClassType, arguments)}
   ,CBMouseEnter$:function($){return $.ClassType.CBMouseEnter.apply($.ClassType, arguments)}
   ,CBMouseExit$:function($){return $.ClassType.CBMouseExit.apply($.ClassType, arguments)}
   ,CBMouseMove$:function($){return $.ClassType.CBMouseMove.apply($.ClassType, arguments)}
   ,CBMouseUp$:function($){return $.ClassType.CBMouseUp.apply($.ClassType, arguments)}
   ,CBMouseWheel$:function($){return $.ClassType.CBMouseWheel.apply($.ClassType, arguments)}
   ,CMGestureChange$:function($){return $.ClassType.CMGestureChange($)}
   ,CMGestureEnd$:function($){return $.ClassType.CMGestureEnd($)}
   ,CMGestureStart$:function($){return $.ClassType.CMGestureStart($)}
   ,CMTouchBegins$:function($){return $.ClassType.CMTouchBegins.apply($.ClassType, arguments)}
   ,CMTouchEnds$:function($){return $.ClassType.CMTouchEnds.apply($.ClassType, arguments)}
   ,CMTouchMove$:function($){return $.ClassType.CMTouchMove.apply($.ClassType, arguments)}
   ,GetChildrenSortedByYPos$:function($){return $.ClassType.GetChildrenSortedByYPos($)}
   ,GetEnabled$:function($){return $.ClassType.GetEnabled($)}
   ,GetSizeInfo$:function($){return $.ClassType.GetSizeInfo($)}
   ,Invalidate$:function($){return $.ClassType.Invalidate($)}
   ,LayoutChildren$:function($){return $.ClassType.LayoutChildren($)}
   ,MouseDown$1$:function($){return $.ClassType.MouseDown$1.apply($.ClassType, arguments)}
   ,MouseEnter$:function($){return $.ClassType.MouseEnter.apply($.ClassType, arguments)}
   ,MouseExit$:function($){return $.ClassType.MouseExit.apply($.ClassType, arguments)}
   ,MouseMove$:function($){return $.ClassType.MouseMove.apply($.ClassType, arguments)}
   ,MouseUp$1$:function($){return $.ClassType.MouseUp$1.apply($.ClassType, arguments)}
   ,MouseWheel$:function($){return $.ClassType.MouseWheel.apply($.ClassType, arguments)}
   ,SetEnabled$:function($){return $.ClassType.SetEnabled.apply($.ClassType, arguments)}
};
/// TW3DisplayView = class (TW3CustomControl)
var TW3DisplayView = {
   $ClassName:"TW3DisplayView",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FArrange = false;
      $.FArrangeKind = 0;
   }
   /// procedure TW3DisplayView.ApplyArrangement(aKind: TW3DisplayViewArangeType)
   ,ApplyArrangement:function(Self, aKind) {
      if ($Check(Self,"").FObjReady) {
         TW3TagObj.BeginUpdate(Self);
         TW3DisplayView.ArrangeChildren(Self,aKind);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3DisplayView.ArrangeChildren(aKind: TW3DisplayViewArangeType)
   ,ArrangeChildren:function(Self, aKind$1) {
      var x$43 = 0;
      var dx$3 = 0;
      var dy$3 = 0;
      var mObj$5 = null;
      var mCount$2 = 0;
      var mRect = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      var wd$4 = 0;
      var hd$4 = 0;
      mCount$2 = TW3Component.GetChildCount(Self);
      if (mCount$2>0) {
         mRect = TW3MovableControl.getBoundsRect$($Check(Self,""));
         switch (aKind$1) {
            case 0 :
               wd$4 = TRect$Width$1(mRect);
               hd$4 = TRect$Height$1(mRect);
               var $temp79;
               for(x$43 = 0,$temp79 = mCount$2;x$43<$temp79;x$43++) {
                  mObj$5 = TW3Component.GetChildObject(Self,x$43);
                  if ($Is(mObj$5,TW3CustomControl)&&(!$Is(mObj$5,TW3BlockBox))) {
                     TW3MovableControl.SetSize$4$($Check($As(mObj$5,TW3CustomControl),""),wd$4,hd$4);
                  }
               }
               break;
            case 1 :
               dy$3 = mRect.Top$1;
               wd$4 = TRect$Width$1(mRect);
               var $temp80;
               for(x$43 = 0,$temp80 = mCount$2;x$43<$temp80;x$43++) {
                  mObj$5 = TW3Component.GetChildObject(Self,x$43);
                  if ($Is(mObj$5,TW3CustomControl)&&(!$Is(mObj$5,TW3BlockBox))) {
                     hd$4 = TW3MovableControl.GetHeight$1$($Check($As(mObj$5,TW3CustomControl),""));
                     TW3MovableControl.SetBounds$2$($Check($As(mObj$5,TW3CustomControl),""),mRect.Left$1,dy$3,wd$4,hd$4);
                     (dy$3+= hd$4);
                  }
               }
               break;
            case 2 :
               dx$3 = mRect.Left$1;
               hd$4 = TRect$Height$1(mRect);
               var $temp81;
               for(x$43 = 0,$temp81 = mCount$2;x$43<$temp81;x$43++) {
                  mObj$5 = TW3Component.GetChildObject(Self,x$43);
                  if ($Is(mObj$5,TW3CustomControl)&&(!$Is(mObj$5,TW3BlockBox))) {
                     wd$4 = TW3MovableControl.GetWidth$1$($Check($As(mObj$5,TW3CustomControl),""));
                     TW3MovableControl.SetBounds$2$($Check($As(mObj$5,TW3CustomControl),""),dx$3,mRect.Top$1,wd$4,hd$4);
                     (dx$3+= wd$4);
                  }
               }
               break;
         }
      }
   }
   /// procedure TW3DisplayView.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      $Check(Self,"").FArrange = true;
      $Check(Self,"").FArrangeKind = 0;
   }
   /// procedure TW3DisplayView.ReSize()
   ,Resize:function(Self) {
      TW3MovableControl.Resize(Self);
      if ($Check(Self,"").FArrange) {
         TW3DisplayView.ArrangeChildren(Self,$Check(Self,"").FArrangeKind);
      }
   }
   /// procedure TW3DisplayView.SetArrange(aValue: Boolean)
   ,SetArrange:function(Self, aValue$64) {
      if (aValue$64!=$Check(Self,"").FArrange) {
         $Check(Self,"").FArrange = aValue$64;
         if ($Check(Self,"").FArrange) {
            TW3DisplayView.ApplyArrangement(Self,$Check(Self,"").FArrangeKind);
         }
      }
   }
   /// procedure TW3DisplayView.SetArrangeType(aValue: TW3DisplayViewArangeType)
   ,SetArrangeType:function(Self, aValue$65) {
      if (aValue$65!=$Check(Self,"").FArrangeKind) {
         if ($Check(Self,"").FObjReady) {
            if ($Check(Self,"").FArrange) {
               TW3TagObj.BeginUpdate(Self);
               try {
                  $Check(Self,"").FArrangeKind = aValue$65;
                  TW3MovableControl.SetWasSized(Self);
               } finally {
                  TW3TagObj.EndUpdate$($Check(Self,""));
               }
            } else {
               $Check(Self,"").FArrangeKind = aValue$65;
            }
         } else {
            $Check(Self,"").FArrangeKind = aValue$65;
         }
      }
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TW3Display = class (TW3CustomControl)
var TW3Display = {
   $ClassName:"TW3Display",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FFooter = $.FHeader = $.FOnOrient = $.FView = null;
   }
   /// anonymous TSourceMethodSymbol
   ,a$17:function(Self) {
      return TW3CustomBrowserAPI.DevicePixelRatio();
   }
   /// procedure TW3Display.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TObject.Free($Check(Self,"").FView);
      if ($Check(Self,"").FHeader) {
         TObject.Free($Check(Self,"").FHeader);
      }
      if ($Check(Self,"").FFooter) {
         TObject.Free($Check(Self,"").FFooter);
      }
      TW3CustomControl.FinalizeObject(Self);
   }
   /// function TW3Display.GetHeightOfChildren() : Integer
   ,GetHeightOfChildren:function(Self) {
      var Result = 0;
      var x$44 = 0;
      var mObj$6 = null;
      var $temp82;
      for(x$44 = 0,$temp82 = TW3Component.GetChildCount(Self);x$44<$temp82;x$44++) {
         mObj$6 = TW3Component.GetChildObject(Self,x$44);
         if (((mObj$6!==$Check(Self,"").FView)&&$Is(mObj$6,TW3CustomControl))&&(!$Is(mObj$6,TW3BlockBox))) {
            (Result+= TW3MovableControl.GetHeight$1$($Check($As(mObj$6,TW3CustomControl),"")));
         }
      }
      return Result
   }
   /// function TW3Display.GetOrientation() : TDisplayOrientation
   ,GetOrientation:function(Self) {
      var Result = 0;
      {var $temp83 = window.orientation;
         if ($temp83==90) {
            Result = 1;
         }
          else if ($temp83==(-90)) {
            Result = 2;
         }
          else if ($temp83==180) {
            Result = 3;
         }
          else {
            Result = 0;
         }
      }
      return Result
   }
   /// procedure TW3Display.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      $Check(Self,"").FView = TW3Component.Create$38$($New(TW3DisplayView),Self);
      TW3MovableControl.setTop$($Check($Check(Self,"").FView,""),5);
   }
   /// procedure TW3Display.PositionFormInView(aForm: TW3CustomForm)
   ,PositionFormInView:function(Self, aForm) {
      var mApp = null;
      var dx$4 = 0;
      var dy$4 = 0;
      if (aForm) {
         mApp = Application();
         if ((mApp!==null)&&(!$Check(mApp,"").FTerminated)) {
            dx$4 = TW3ScrollInfo.GetScrollLeft(TW3CustomControl.getScrollInfo($Check(Self,"").FView));
            dy$4 = TW3ScrollInfo.GetScrollTop(TW3CustomControl.getScrollInfo($Check(Self,"").FView));
            TW3MovableControl.SetBounds$2$($Check(aForm,""),dx$4,dy$4,TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FView,"")),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FView,"")));
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3Screen),"Method %s in class %s threw exception [%s]",["PositionFormInView", TObject.ClassName($Check(Self,"").ClassType), "Form parameter was NIL error"]);
      }
   }
   /// procedure TW3Display.ReSize()
   ,Resize:function(Self) {
      var mTotal = 0;
      var mList = [];
      var x$45 = 0;
      var dy$5 = 0;
      var mObj$7 = null;
      TW3MovableControl.Resize(Self);
      mTotal = TW3Display.GetHeightOfChildren(Self);
      TW3MovableControl.setHeight$($Check($Check(Self,"").FView,""),TW3MovableControl.GetHeight$1$($Check(Self,""))-mTotal);
      mList = TW3CustomControl.GetChildrenSortedByYPos$($Check(Self,""));
      dy$5 = 0;
      var $temp84;
      for(x$45 = 0,$temp84 = mList.length;x$45<$temp84;x$45++) {
         mObj$7 = $As($DIdxR(mList,x$45,""),TW3CustomControl);
         if ($Is(mObj$7,TW3BlockBox)) {
            TW3MovableControl.SetBounds$2$($Check(mObj$7,""),0,0,TW3MovableControl.GetWidth$1$($Check(Self,"")),TW3MovableControl.GetHeight$1$($Check(Self,"")));
         } else {
            TW3MovableControl.SetBounds$2$($Check(mObj$7,""),0,dy$5,TW3MovableControl.GetWidth$1$($Check(Self,"")),TW3MovableControl.GetHeight$1$($Check(mObj$7,"")));
            (dy$5+= TW3MovableControl.GetHeight$1$($Check(mObj$7,"")));
            if (!x$45) {
               (dy$5+= 2);
            }
         }
      }
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TW3CustomApplication = class (TObject)
var TW3CustomApplication = {
   $ClassName:"TW3CustomApplication",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FBlockBox = $.FBody = $.FCurrentForm = $.FDialog = $.FDialogEvent = $.FDisplay = $.FEnterAnim = $.FLeaveAnim = $.FMainForm = $.FOnBeforeUnload = $.FOnUnload = $.FTransDst = $.FTransSrc = null;
      $.FEntryEffect = 0;
      $.FFormChangeActive = $.FTerminated = false;
      $.FForms = [];
      $.FModalInfoList = [];
   }
   /// procedure TW3CustomApplication.AdjustScreen()
   ,AdjustScreen:function(Self) {
      TW3ScrollInfo.ScrollTo(TW3CustomControl.getScrollInfo($Check(Self,"").FDisplay),0,0);
      TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FDisplay,""),0,0,TDocumentBody.getWidth$4($Check(Self,"").FBody),TDocumentBody.getHeight$3($Check(Self,"").FBody));
   }
   /// procedure TW3CustomApplication.ApplicationClosing()
   ,ApplicationClosing:function(Self) {
      /* null */
   }
   /// procedure TW3CustomApplication.ApplicationStarted()
   ,ApplicationStarted:function(Self) {
      /* null */
   }
   /// procedure TW3CustomApplication.ApplicationStarting()
   ,ApplicationStarting:function(Self) {
      TW3CustomApplication.AdjustScreen(Self);
   }
   /// procedure TW3CustomApplication.CBOnBeforeUnload()
   ,CBOnBeforeUnload:function(Self) {
      if ($Check(Self,"").FOnBeforeUnload) {
         $CheckFunc($Check(Self,"").FOnBeforeUnload,"")(Self);
      }
   }
   /// procedure TW3CustomApplication.CBOnOrientationChange()
   ,CBOnOrientationChange:function(Self) {
      var mOrientation = 0;
      var mTemp$2 = 0;
      var mEntry = null;
      mTemp$2 = parseInt(window.orientation,10);
      switch (mTemp$2) {
         case 0 :
            mOrientation = 0;
            break;
         case 90 :
            mOrientation = 1;
            break;
         case (-90) :
            mOrientation = 2;
            break;
         case 180 :
            mOrientation = 3;
            break;
      }
      try {
         if ($Check(Self,"").FDisplay) {
            mEntry = $Check($Check(Self,"").FDisplay,"").FOnOrient;
            if (mEntry) {
               $CheckFunc(mEntry,"")($Check(Self,"").FDisplay,mOrientation,mTemp$2);
            }
         }
      } finally {
         TW3CustomApplication.AdjustScreen(Self);
      }
   }
   /// procedure TW3CustomApplication.CBOnReSize()
   ,CBOnReSize:function(Self) {
      TW3CustomApplication.AdjustScreen(Self);
   }
   /// procedure TW3CustomApplication.CBOnUnLoad()
   ,CBOnUnLoad:function(Self) {
      try {
         if ($Check(Self,"").FOnUnload) {
            $CheckFunc($Check(Self,"").FOnUnload,"")(Self);
         }
      } finally {
         if (!$Check(Self,"").FTerminated) {
            TW3CustomApplication.Terminate(Self);
         }
      }
   }
   /// procedure TW3CustomApplication.CloseDialog()
   ,CloseDialog:function(Self) {
      if (TW3CustomApplication.GetDialogActive(Self)) {
         TObject.Free($Check(Self,"").FDialog);
         $Check(Self,"").FDialog = null;
         if ($Check(Self,"").FBlockBox!==null) {
            TObject.Free($Check(Self,"").FBlockBox);
            $Check(Self,"").FBlockBox = null;
         }
      }
   }
   /// constructor TW3CustomApplication.Create()
   ,Create$47:function(Self) {
      TObject.Create(Self);
      $Check(Self,"").FBody = TW3Component.Create$38$($New(TDocumentBody),null);
      $Check(Self,"").FDisplay = TW3Component.Create$38$($New(TW3Display),$Check(Self,"").FBody);
      if (!Instance) {
         Instance = Self;
      }
      return Self
   }
   /// procedure TW3CustomApplication.CreateForm(aForm: TW3CustomFormClass; isMainForm: Boolean = False)
   ,CreateForm:function(Self, aForm$1, isMainForm) {
      TW3CustomApplication.RegisterFormInstance(Self,TW3Component.Create$38$($NewDyn(aForm$1,""),$Check($Check(Self,"").FDisplay,"").FView),isMainForm);
   }
   /// function TW3CustomApplication.CreateOpaqueMask(backgroundColor: String = 'black'; opacity: String = '0.6') : Variant
   ,CreateOpaqueMask:function(backgroundColor, opacity) {
      var Result = undefined;
      Result = document.createElement("div");
      Result.setAttribute("style","position:absolute;width:100%;height:100%;text-align:center");
      Result.style.backgroundColor = backgroundColor;
      Result.style.opacity = opacity;
      Result.style.backgroundPosition = "center center";
      if ((Instance!==null)&&($Check(Instance,"").FCurrentForm!==null)) {
         Result.style.zIndex = (TW3CustomControl.GetMaxZIndex($Check(Instance,"").FCurrentForm)+1).toString();
      }
      document.body.appendChild(Result);
      return Result
   }
   /// destructor TW3CustomApplication.Destroy()
   ,Destroy:function(Self) {
      if (!$Check(Self,"").FTerminated) {
         TW3CustomApplication.Terminate(Self);
      }
      TObject.Free($Check(Self,"").FDisplay);
      TObject.Free($Check(Self,"").FBody);
      Instance = null;
      TObject.Destroy(Self);
   }
   /// function TW3CustomApplication.FormByName(formName: String) : TW3CustomForm
   ,FormByName:function(Self, formName) {
      var Result = null;
      var lcName$1 = "";
      var i$45 = 0;
      Result = null;
      lcName$1 = Trim$_String_((formName).toLowerCase());
      var $temp85;
      for(i$45 = 0,$temp85 = TW3CustomApplication.GetFormCount(Self);i$45<$temp85;i$45++) {
         if (($Check(TW3CustomApplication.GetForm(Self,i$45),"").FName$1).toLowerCase()==lcName$1) {
            return TW3CustomApplication.GetForm(Self,i$45);
         }
      }
      return Result
   }
   /// function TW3CustomApplication.GetAppName() : String
   ,GetAppName:function(Self) {
      var Result = "";
      Result = "";
      return Result
   }
   /// function TW3CustomApplication.GetDialogActive() : Boolean
   ,GetDialogActive:function(Self) {
      return $Check(Self,"").FDialog!==null;
   }
   /// function TW3CustomApplication.GetForm(index: Integer) : TW3CustomForm
   ,GetForm:function(Self, index$3) {
      return $DIdxR($Check(Self,"").FForms,index$3,"");
   }
   /// function TW3CustomApplication.GetFormCount() : Integer
   ,GetFormCount:function(Self) {
      return $Check(Self,"").FForms.length;
   }
   /// procedure TW3CustomApplication.GotoForm(aName: String; Effect: TFormEntryEffect = 0)
   ,GotoForm:function(Self, aName, Effect) {
      var a$62 = 0;
      var f$4 = null;
      var a$63 = [];
      if (aName=="") {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.GotoForm", TObject.ClassName($Check(Self,"").ClassType), "Invalid form name error"]);
      }
      a$63 = $Check(Self,"").FForms;
      var $temp86;
      for(a$62 = 0,$temp86 = a$63.length;a$62<$temp86;a$62++) {
         f$4 = $DIdxR(a$63,a$62,"");
         if (SameText(aName,$Check(f$4,"").FName$1)) {
            TW3CustomApplication.GotoFormByRef(Self,f$4,Effect);
            return;
         }
      }
      throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.GotoForm", TObject.ClassName($Check(Self,"").ClassType), ("Form ["+aName.toString()+"] not found error")]);
   }
   /// procedure TW3CustomApplication.GotoFormByRef(aForm: TW3CustomForm; Effect: TFormEntryEffect = 0)
   ,GotoFormByRef:function(Self, aForm$2, Effect$1) {
      var mIndex$3 = 0;
      if ($Check(Self,"").FTerminated) {
         return;
      }
      if ($Check(Self,"").FFormChangeActive) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.GotoFormByRef", TObject.ClassName($Check(Self,"").ClassType), "A form transition is already active error"]);
      }
      if (aForm$2===null) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.GotoFormByRef", TObject.ClassName($Check(Self,"").ClassType), "Form parameter is NIL error"]);
      }
      mIndex$3 = $Check(Self,"").FForms.indexOf(aForm$2);
      if (mIndex$3<0) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.GotoFormByRef", TObject.ClassName($Check(Self,"").ClassType), "Form not registered error"]);
      }
      if (aForm$2===$Check(Self,"").FCurrentForm) {
         return;
      }
      if ($Check(Self,"").FCurrentForm===null) {
         $Check(Self,"").FCurrentForm = aForm$2;
         TW3Display.PositionFormInView($Check(Self,"").FDisplay,aForm$2);
         TW3MovableControl.SetVisible$($Check(aForm$2,""),true);
         TW3CustomForm.FormActivated$($Check(aForm$2,""));
         return;
      }
      if (!Effect$1) {
         TW3CustomForm.FormDeactivated$($Check($Check(Self,"").FCurrentForm,""));
         TW3MovableControl.SetVisible$($Check($Check(Self,"").FCurrentForm,""),false);
         TW3MovableControl.SetVisible$($Check(aForm$2,""),true);
         TW3Display.PositionFormInView($Check(Self,"").FDisplay,aForm$2);
         TW3CustomForm.FormActivated$($Check(aForm$2,""));
         $Check(Self,"").FCurrentForm = aForm$2;
         return;
      }
      $Check(Self,"").FFormChangeActive = true;
      $Check(Self,"").FEntryEffect = Effect$1;
      TW3CustomControl.BringToFront(aForm$2);
      TW3CustomForm.FormDeactivated$($Check($Check(Self,"").FCurrentForm,""));
      $Check(Self,"").FTransSrc = $Check(Self,"").FCurrentForm;
      $Check(Self,"").FTransDst = aForm$2;
      TW3MovableControl.SetVisible$($Check(aForm$2,""),true);
      TW3Display.PositionFormInView($Check(Self,"").FDisplay,aForm$2);
      if (($Check(Self,"").FEnterAnim===null)||($Check(Self,"").FLeaveAnim===null)) {
         $Check(Self,"").FEnterAnim = TW3CustomAnimation.Create$41$($New(TW3NamedAnimation));
         TW3CustomAnimation.SetDuration($Check(Self,"").FEnterAnim,0.3);
         $Check(Self,"").FLeaveAnim = TW3CustomAnimation.Create$41$($New(TW3NamedAnimation));
         TW3CustomAnimation.SetDuration($Check(Self,"").FLeaveAnim,0.3);
      }
      switch (Effect$1) {
         case 1 :
            $Check($Check(Self,"").FEnterAnim,"").FName$2 = "MOVE-LEFT";
            $Check($Check(Self,"").FLeaveAnim,"").FName$2 = "MOVE-OUT-LEFT";
            break;
         case 2 :
            $Check($Check(Self,"").FEnterAnim,"").FName$2 = "MOVE-RIGHT";
            $Check($Check(Self,"").FLeaveAnim,"").FName$2 = "MOVE-OUT-RIGHT";
            break;
      }
      TW3CustomAnimation.ExecuteEx($Check(Self,"").FEnterAnim,aForm$2,null,$Event1(Self,TW3CustomApplication.HandleEnterAnimEnds));
      TW3CustomAnimation.ExecuteEx($Check(Self,"").FLeaveAnim,$Check(Self,"").FCurrentForm,null,$Event1(Self,TW3CustomApplication.HandleLeaveAnimEnds));
   }
   /// procedure TW3CustomApplication.HandleDialogBlockerReSize(Sender: TObject)
   ,HandleDialogBlockerReSize:function(Self, Sender) {
      var dx$5 = 0;
      var dy$6 = 0;
      var modalInfo = null;
      var a$64 = 0;
      var a$65 = [];
      if (($Check(Self,"").FDialog!==null)&&($Check(Self,"").FBlockBox!==null)) {
         dx$5 = $Div(TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FBlockBox,""))-TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FDialog,"")),2);
         dy$6 = $Div(TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FBlockBox,""))-TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FDialog,"")),2);
         TW3MovableControl.MoveTo$1$($Check($Check(Self,"").FDialog,""),dx$5,dy$6);
      }
      a$65 = $Check(Self,"").FModalInfoList;
      var $temp87;
      for(a$64 = 0,$temp87 = a$65.length;a$64<$temp87;a$64++) {
         modalInfo = $DIdxR(a$65,a$64,"");
         dx$5 = $Div(TW3MovableControl.GetWidth$1$($Check($Check(modalInfo,"").OpaqueMask,""))-TW3MovableControl.GetWidth$1$($Check($Check(modalInfo,"").ModalPanel,"")),2);
         dy$6 = $Div(TW3MovableControl.GetHeight$1$($Check($Check(modalInfo,"").OpaqueMask,""))-TW3MovableControl.GetHeight$1$($Check($Check(modalInfo,"").ModalPanel,"")),2);
         TW3MovableControl.MoveTo$1$($Check($Check(modalInfo,"").ModalPanel,""),dx$5,dy$6);
      }
   }
   /// procedure TW3CustomApplication.HandleDialogFeedBack(Sender: TObject; aResult: TW3AlertResult)
   ,HandleDialogFeedBack:function(Self, Sender$1, aResult) {
      try {
         if ($Check(Self,"").FDialogEvent) {
            $CheckFunc($Check(Self,"").FDialogEvent,"")(Self,aResult);
         }
      } finally {
         TW3CustomApplication.CloseDialog(Self);
      }
   }
   /// procedure TW3CustomApplication.HandleEnterAnimEnds(Sender: TObject)
   ,HandleEnterAnimEnds:function(Self, Sender$2) {
      var mAnim = null;
      mAnim = $As(Sender$2,TW3NamedAnimation);
      switch ($Check(Self,"").FEntryEffect) {
         case 1 :
            TW3MovableControl.MoveTo$1$($Check($Check(Self,"").FTransDst,""),0,0);
            $Check(Self,"").FCurrentForm = $Check(Self,"").FTransDst;
            TW3CustomForm.FormActivated$($Check($Check(Self,"").FCurrentForm,""));
            $Check(Self,"").FFormChangeActive = false;
            break;
         case 2 :
            TW3MovableControl.MoveTo$1$($Check($Check(Self,"").FTransDst,""),0,0);
            $Check(Self,"").FCurrentForm = $Check(Self,"").FTransDst;
            TW3CustomForm.FormActivated$($Check($Check(Self,"").FCurrentForm,""));
            TW3MovableControl.SetVisible$($Check($Check(Self,"").FTransSrc,""),false);
            TW3Display.PositionFormInView($Check(Self,"").FDisplay,$Check(Self,"").FTransSrc);
            $Check(Self,"").FFormChangeActive = false;
            break;
      }
      TObject.Free(mAnim);
      mAnim = null;
   }
   /// procedure TW3CustomApplication.HandleLeaveAnimEnds(Sender: TObject)
   ,HandleLeaveAnimEnds:function(Self, Sender$3) {
      var mAnim$1 = null;
      mAnim$1 = $As(Sender$3,TW3NamedAnimation);
      TW3MovableControl.SetVisible$($Check($Check(Self,"").FTransSrc,""),false);
      TObject.Free(mAnim$1);
   }
   /// procedure TW3CustomApplication.HideModal(modalResult: TModalResult)
   ,HideModal:function(Self, modalResult) {
      var modalInfo$1 = null;
      modalInfo$1 = $Pop($Check(Self,"").FModalInfoList,"");
      TObject.Free($Check(modalInfo$1,"").OpaqueMask);
      if ($Check(Self,"").FModalInfoList.length>0) {
         TW3MovableControl.SetVisible$($Check($Check($Peek($Check(Self,"").FModalInfoList,""),"").OpaqueMask,""),true);
      }
      TW3MovableControl.SetVisible$($Check($Check(modalInfo$1,"").ModalPanel,""),false);
      TW3CustomForm.FormDeactivated$($Check($Check(modalInfo$1,"").ModalForm,""));
      switch (modalResult) {
         case 1 :
            if ($Check(modalInfo$1,"").OnOK) {
               $CheckFunc($Check(modalInfo$1,"").OnOK,"")($Check(modalInfo$1,"").ModalForm);
            }
            break;
         case 0 :
            if ($Check(modalInfo$1,"").OnCancel) {
               $CheckFunc($Check(modalInfo$1,"").OnCancel,"")($Check(modalInfo$1,"").ModalForm);
            }
            break;
      }
   }
   /// procedure TW3CustomApplication.HookWindowEvents()
   ,HookWindowEvents:function(Self) {
      w3_bind2(document.body,"onunload",$Event0(Self,TW3CustomApplication.CBOnUnLoad$));
      w3_bind2(document.body,"onbeforeunload",$Event0(Self,TW3CustomApplication.CBOnBeforeUnload$));
      w3_bind2(window,"onresize",$Event0(Self,TW3CustomApplication.CBOnReSize$));
      w3_bind2(window,"onorientationchange",$Event0(Self,TW3CustomApplication.CBOnOrientationChange$));
   }
   /// procedure TW3CustomApplication.RegisterFormInstance(aForm: TW3CustomForm; isMainForm: Boolean = False)
   ,RegisterFormInstance:function(Self, aForm$3, isMainForm$1) {
      if (!$Check(Self,"").FTerminated) {
         if (aForm$3) {
            if ($Check(Self,"").FForms.indexOf(aForm$3)<0) {
               try {
                  $Check(Self,"").FForms.push(aForm$3);
               } catch ($e) {
                  var e$13 = $W($e);
                  throw EW3Exception.CreateFmt($New(EW3Exception),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.RegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), $Check(e$13,"").FMessage]);
               }
               w3_RequestAnimationFrame(function () {
                  TW3MovableControl.AdjustToParentBox$($Check(aForm$3,""));
               });
               if (isMainForm$1) {
                  $Check(Self,"").FMainForm = aForm$3;
               } else {
                  TW3MovableControl.SetVisible$($Check(aForm$3,""),false);
               }
            } else {
               throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.RegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), "Form already registered"]);
            }
         } else {
            throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.RegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), "Form parameter is NIL error"]);
         }
      }
   }
   /// procedure TW3CustomApplication.RunApp()
   ,RunApp:function(Self) {
      var FTemp$1 = null;
      TW3CustomApplication.HookWindowEvents$($Check(Self,""));
      TW3CustomApplication.ApplicationStarting$($Check(Self,""));
      if ($Check(Self,"").FMainForm) {
         FTemp$1 = $Check(Self,"").FMainForm;
         $Check(Self,"").FMainForm = null;
         TW3CustomApplication.GotoFormByRef(Self,FTemp$1,0);
      }
      TW3CustomApplication.ApplicationStarted$($Check(Self,""));
   }
   /// procedure TW3CustomApplication.ShowDialog(aCaption: String; aText: String; aOptions: TW3AlertOptions)
   ,ShowDialog:function(Self, aCaption, aText$4, aOptions) {
      var dx$6 = 0;
      var dy$7 = 0;
      if (TW3CustomApplication.GetDialogActive(Self)) {
         throw Exception.Create($New(EW3Application),"A dialog is already active error");
      } else {
         $Check(Self,"").FBlockBox = TW3Component.Create$38$($New(TW3BlockBox),$Check(Self,"").FDisplay);
         TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FBlockBox,""),0,0,TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FDisplay,"")),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FDisplay,"")));
         TW3CustomControl._setResize($Check(Self,"").FBlockBox,$Event1(Self,TW3CustomApplication.HandleDialogBlockerReSize));
         $Check(Self,"").FDialog = TW3Component.Create$38$($New(TW3AlertDialog),$Check(Self,"").FBlockBox);
         $Check($Check(Self,"").FDialog,"").FOnSelect = $Event2(Self,TW3CustomApplication.HandleDialogFeedBack);
         TW3MovableControl.SetWidth$($Check($Check(Self,"").FDialog,""),280);
         TW3MovableControl.setHeight$($Check($Check(Self,"").FDialog,""),200);
         dx$6 = $Div(TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FBlockBox,""))-TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FDialog,"")),2);
         dy$7 = $Div(TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FBlockBox,""))-TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FDialog,"")),2);
         TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FDialog,""),dx$6,dy$7,TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FDialog,"")),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FDialog,"")));
         $CheckIntf($AsIntf($Check(Self,"").FDialog,"IW3AlertDialog"),"")[0](aCaption,aText$4,aOptions);
      }
   }
   /// procedure TW3CustomApplication.ShowModal(formName: String; panelName: String; focusControlName: String; onInit: TModalDialogProc = nil; onOK: TModalDialogProc = nil; onCancel: TModalDialogProc = nil)
   ,ShowModal$1:function(Self, formName$1, panelName, focusControlName, onInit, onOK, onCancel) {
      var focusControl = null;
      var modalForm = null;
      var modalPanel = null;
      modalForm = TW3CustomApplication.FormByName(Application(),formName$1);
      if (!modalForm) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.ShowModal", TObject.ClassName($Check(Self,"").ClassType), ("Form ["+formName$1.toString()+"] not found")]);
      }
      modalPanel = TW3Component.ChildByName(modalForm,panelName);
      if (!modalPanel) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.ShowModal", TObject.ClassName($Check(Self,"").ClassType), ("Component ["+panelName.toString()+"] not found")]);
      }
      if (!$Is(modalPanel,TW3CustomControl)) {
         throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.ShowModal", TObject.ClassName($Check(Self,"").ClassType), ("Component ["+panelName.toString()+"] is not a TW3CustomControl")]);
      }
      if (focusControlName=="") {
         focusControl = null;
      } else {
         focusControl = TW3Component.ChildByName($As(modalPanel,TW3CustomControl),focusControlName);
         if (!focusControl) {
            throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.ShowModal", TObject.ClassName($Check(Self,"").ClassType), ("Component ["+focusControlName.toString()+"] not found")]);
         }
         if (!$Is(focusControl,TW3CustomControl)) {
            throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.ShowModal", TObject.ClassName($Check(Self,"").ClassType), ("Component ["+focusControlName.toString()+"] is not a TW3CustomControl")]);
         }
      }
      TW3CustomApplication.ShowModal(Self,modalForm,$As(modalPanel,TW3CustomControl),$As(focusControl,TW3CustomControl),onInit,onOK,onCancel);
   }
   /// procedure TW3CustomApplication.ShowModal(form: TW3CustomForm; panel: TW3CustomControl; focusControl: TW3CustomControl; onInit: TModalDialogProc = nil; onOK: TModalDialogProc = nil; onCancel: TModalDialogProc = nil)
   ,ShowModal:function(Self, form, panel, focusControl$1, onInit$1, onOK$1, onCancel$1) {
      var zIndex = 0;
      var opaqueMask = null;
      var modalInfo$2 = null;
      if (!$Check(Self,"").FModalInfoList.length) {
         zIndex = TW3CustomControl.GetMaxZIndex($Check(Self,"").FCurrentForm);
      } else {
         zIndex = TW3CustomControl.GetMaxZIndex($Check($Peek($Check(Self,"").FModalInfoList,""),"").ModalForm);
         TW3MovableControl.SetVisible$($Check($Check($Peek($Check(Self,"").FModalInfoList,""),"").OpaqueMask,""),false);
      }
      opaqueMask = TW3Component.Create$38$($New(TW3BlockBox),$Check(Self,"").FDisplay);
      TW3MovableControl.SetBounds$2$($Check(opaqueMask,""),0,0,TW3MovableControl.GetWidth$1$($Check($Check(Self,"").FDisplay,"")),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FDisplay,"")));
      TW3CustomControl._setResize(opaqueMask,$Event1(Self,TW3CustomApplication.HandleDialogBlockerReSize));
      if (onInit$1) {
         $CheckFunc(onInit$1,"")(form);
      }
      modalInfo$2 = TObject.Create($New(TModalInfo));
      $Check(Self,"").FModalInfoList.push(modalInfo$2);
      $Check(modalInfo$2,"").OpaqueMask = opaqueMask;
      $Check($Check(modalInfo$2,"").OpaqueMask,"").FHandle$3.style.zIndex = (zIndex+1).toString();
      $Check(modalInfo$2,"").ModalForm = form;
      $Check(modalInfo$2,"").ModalPanel = panel;
      $Check(modalInfo$2,"").OnOK = onOK$1;
      $Check(modalInfo$2,"").OnCancel = onCancel$1;
      TW3TagObj.InsertInto($Check(modalInfo$2,"").ModalPanel,$Check($Check(Self,"").FCurrentForm,"").FHandle$3);
      TW3MovableControl.SetVisible$($Check($Check(modalInfo$2,"").ModalPanel,""),true);
      $Check($Check(modalInfo$2,"").ModalPanel,"").FHandle$3.style.zIndex = (zIndex+2).toString();
      TW3MovableControl.MoveTo$1$($Check(panel,""),$Div(TW3MovableControl.ClientWidth($Check(Self,"").FCurrentForm)-TW3MovableControl.GetWidth$1$($Check(panel,"")),2),$Div(TW3MovableControl.ClientHeight($Check(Self,"").FCurrentForm)-TW3MovableControl.GetHeight$1$($Check(panel,"")),2));
      TW3CustomForm.FormActivated$($Check($Check(modalInfo$2,"").ModalForm,""));
      if (focusControl$1) {
         TW3CustomControl.SetFocus(focusControl$1);
      }
   }
   /// procedure TW3CustomApplication.Terminate()
   ,Terminate:function(Self) {
      var x$46 = 0;
      if ($Check(Self,"").FTerminated) {
         return;
      }
      $Check(Self,"").FTerminated = true;
      TW3CustomApplication.ApplicationClosing$($Check(Self,""));
      try {
         var $temp88;
         for(x$46 = 0,$temp88 = $Check(Self,"").FForms.length;x$46<$temp88;x$46++) {
            TObject.Free($DIdxR($Check(Self,"").FForms,x$46,""));
            $DIdxW($Check(Self,"").FForms,x$46,null,"");
         }
         $Check(Self,"").FForms.length=0;
      } finally {
         TObject.Free(Self);
      }
   }
   /// procedure TW3CustomApplication.UnRegisterFormInstance(aForm: TW3CustomForm)
   ,UnRegisterFormInstance:function(Self, aForm$4) {
      var mIndex$4 = 0;
      if (!$Check(Self,"").FTerminated) {
         if (aForm$4) {
            mIndex$4 = $Check(Self,"").FForms.indexOf(aForm$4);
            if (mIndex$4>=0) {
               if ($Check(Self,"").FMainForm!==aForm$4) {
                  if ($Check(Self,"").FCurrentForm===aForm$4) {
                     TW3CustomApplication.GotoFormByRef(Self,$Check(Self,"").FMainForm,0);
                  }
                  $Check(Self,"").FForms.splice(mIndex$4,1)
                  ;
                  try {
                     TObject.Free(aForm$4);
                  } catch ($e) {
                     var e$14 = $W($e);
                     throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.UnRegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), $Check(e$14,"").FMessage]);
                  }
               } else {
                  throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.UnRegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), "Main form cannot be removed error"]);
               }
            } else {
               throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.UnRegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), "Form is not registered"]);
            }
         } else {
            throw EW3Exception.CreateFmt($New(EW3Application),"Method %s in class %s threw exception [%s]",["TW3CustomApplication.UnRegisterFormInstance", TObject.ClassName($Check(Self,"").ClassType), "Form parameter is NIL error"]);
         }
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,ApplicationClosing$:function($){return $.ClassType.ApplicationClosing($)}
   ,ApplicationStarted$:function($){return $.ClassType.ApplicationStarted($)}
   ,ApplicationStarting$:function($){return $.ClassType.ApplicationStarting($)}
   ,CBOnBeforeUnload$:function($){return $.ClassType.CBOnBeforeUnload($)}
   ,CBOnOrientationChange$:function($){return $.ClassType.CBOnOrientationChange($)}
   ,CBOnReSize$:function($){return $.ClassType.CBOnReSize($)}
   ,CBOnUnLoad$:function($){return $.ClassType.CBOnUnLoad($)}
   ,Create$47$:function($){return $.ClassType.Create$47($)}
   ,HookWindowEvents$:function($){return $.ClassType.HookWindowEvents($)}
};
/// TW3BlockBox = class (TW3CustomControl)
var TW3BlockBox = {
   $ClassName:"TW3BlockBox",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject:TW3CustomControl.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TModalResult enumeration
var TModalResult = [ "mrCancel", "mrOK" ];
/// TFormEntryEffect enumeration
var TFormEntryEffect = [ "feNone", "feFromRight", "feToLeft" ];
/// TDisplayOrientation enumeration
var TDisplayOrientation = [ "soPortrait", "soLandscapeLeft", "soLandscapeRight", "soFlipped" ];
/// EW3Screen = class (EW3Exception)
var EW3Screen = {
   $ClassName:"EW3Screen",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
/// EW3Application = class (EW3Exception)
var EW3Application = {
   $ClassName:"EW3Application",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
function Application() {
   return Instance;
};
/// TModalInfo = class (TObject)
var TModalInfo = {
   $ClassName:"TModalInfo",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.OnOK = null;
      $.OnCancel = null;
      $.ModalForm = $.ModalPanel = $.OwnerForm = $.OpaqueMask = null;
   }
   ,Destroy:TObject.Destroy
};
/// TW3CustomForm = class (TW3CustomControl)
var TW3CustomForm = {
   $ClassName:"TW3CustomForm",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FCaption = "";
      $.FInitialized = false;
   }
   /// procedure TW3CustomForm.FormActivated()
   ,FormActivated:function(Self) {
      var x$47 = 0;
      var mObj$8 = null;
      var mControl$2 = null;
      if (!$Check(Self,"").FInitialized) {
         $Check(Self,"").FInitialized = true;
         TW3CustomForm.InitializeForm$($Check(Self,""));
      }
      if ($Check(Self,"").FObjReady) {
         var $temp89;
         for(x$47 = 0,$temp89 = TW3Component.GetChildCount(Self);x$47<$temp89;x$47++) {
            mObj$8 = TW3Component.GetChildObject(Self,x$47);
            if ($Is(mObj$8,TW3CustomControl)) {
               mControl$2 = $As(mObj$8,TW3CustomControl);
               if ($Check(mControl$2,"").FObjReady&&TW3MovableControl.getVisible$($Check(mControl$2,""))) {
                  TW3CustomControl.LayoutChildren$($Check(mControl$2,""));
               }
            }
         }
      }
   }
   /// procedure TW3CustomForm.FormDeactivated()
   ,FormDeactivated:function(Self) {
      /* null */
   }
   /// procedure TW3CustomForm.InitializeForm()
   ,InitializeForm:function(Self) {
      /* null */
   }
   /// procedure TW3CustomForm.setCaption(Value: String)
   ,setCaption:function(Self, Value$22) {
      $Check(Self,"").FCaption = Value$22;
   }
   /// procedure TW3CustomForm.StyleTagObject()
   ,StyleTagObject:function(Self) {
      TW3CustomControl.StyleTagObject(Self);
      w3_setStyle($Check(Self,"").FHandle$3,w3_CSSPrefix("Transform"),"none");
      TW3CustomControl.setStyleClass(Self,"TW3CustomForm");
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject:TW3CustomControl.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject$:function($){return $.ClassType.StyleTagObject($)}
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
   ,FormActivated$:function($){return $.ClassType.FormActivated($)}
   ,FormDeactivated$:function($){return $.ClassType.FormDeactivated($)}
   ,InitializeForm$:function($){return $.ClassType.InitializeForm($)}
};
/// TW3Form = class (TW3CustomForm)
var TW3Form = {
   $ClassName:"TW3Form",
   $Parent:TW3CustomForm
   ,$Init:function ($) {
      TW3CustomForm.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject:TW3CustomControl.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3CustomForm.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
   ,FormActivated:TW3CustomForm.FormActivated
   ,FormDeactivated:TW3CustomForm.FormDeactivated
   ,InitializeForm:TW3CustomForm.InitializeForm
};
/// TW3ScrollInfo = class (TW3OwnedObject)
var TW3ScrollInfo = {
   $ClassName:"TW3ScrollInfo",
   $Parent:TW3OwnedObject
   ,$Init:function ($) {
      TW3OwnedObject.$Init($);
   }
   /// function TW3ScrollInfo.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject$1) {
      return (aObject$1!==null)&&$Is(aObject$1,TW3TagObj);
   }
   /// function TW3ScrollInfo.GetScrollHeight() : Integer
   ,GetScrollHeight:function(Self) {
      var Result = 0;
      var mRef = undefined;
      mRef = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef) {
         Result = TVariant.AsInteger(mRef.scrollHeight);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.GetScrollHeight",Self,"invalid owner handle error");
      }
      return Result
   }
   /// function TW3ScrollInfo.GetScrollLeft() : Integer
   ,GetScrollLeft:function(Self) {
      var Result = 0;
      var mRef$1 = undefined;
      mRef$1 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$1) {
         Result = TVariant.AsInteger(mRef$1.scrollLeft);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.GetScrollLeft",Self,"invalid owner handle error");
      }
      return Result
   }
   /// function TW3ScrollInfo.GetScrollTop() : Integer
   ,GetScrollTop:function(Self) {
      var Result = 0;
      var mRef$2 = undefined;
      mRef$2 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$2) {
         Result = TVariant.AsInteger(mRef$2.scrollTop);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.GetScrollTop",Self,"invalid owner handle error");
      }
      return Result
   }
   /// function TW3ScrollInfo.GetScrollWidth() : Integer
   ,GetScrollWidth:function(Self) {
      var Result = 0;
      var mRef$3 = undefined;
      mRef$3 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$3) {
         Result = TVariant.AsInteger(mRef$3.scrollWidth);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.GetScrollWidth",Self,"invalid owner handle error");
      }
      return Result
   }
   /// procedure TW3ScrollInfo.ScrollTo(aLeft: Integer; aTop: Integer)
   ,ScrollTo:function(Self, aLeft$10, aTop$10) {
      var mRef$4 = undefined;
      mRef$4 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$4) {
         mRef$4.scrollLeft = aLeft$10;
         mRef$4.scrollTop = aTop$10;
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.ScrollTo",Self,"invalid owner handle error");
      }
   }
   /// procedure TW3ScrollInfo.ScrollX(aLeft: Integer)
   ,ScrollX:function(Self, aLeft$11) {
      var mRef$5 = undefined;
      mRef$5 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$5) {
         mRef$5.scrollLeft = TInteger.ToPxStr(aLeft$11);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.ScrollX",Self,"invalid owner handle error");
      }
   }
   /// procedure TW3ScrollInfo.ScrollY(aTop: Integer)
   ,ScrollY:function(Self, aTop$11) {
      var mRef$6 = undefined;
      mRef$6 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$6) {
         mRef$6.scrollTop = TInteger.ToPxStr(aTop$11);
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ScrollInfo.ScrollY",Self,"invalid owner handle error");
      }
   }
   /// function TW3ScrollInfo.ToString() : String
   ,ToString$8:function(Self) {
      return ("OffsetX="+TW3ScrollInfo.GetScrollLeft(Self).toString()+"\rOffsetY="+TW3ScrollInfo.GetScrollTop(Self).toString()+"\rScrollWidth="+TW3ScrollInfo.GetScrollWidth(Self).toString()+"\rScrollHeight="+TW3ScrollInfo.GetScrollHeight(Self).toString()+"\r");
   }
   ,Destroy:TObject.Destroy
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7:TW3OwnedObject.Create$7
   ,ToString$8$:function($){return $.ClassType.ToString$8($)}
};
/// TW3GraphicControl = class (TW3CustomControl)
var TW3GraphicControl = {
   $ClassName:"TW3GraphicControl",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FCanvas = $.FContext$2 = $.FOnPaint = null;
      $.FDirty = false;
   }
   /// procedure TW3GraphicControl.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TObject.Free($Check(Self,"").FCanvas);
      TObject.Free($Check(Self,"").FContext$2);
      TW3CustomControl.FinalizeObject(Self);
   }
   /// function TW3GraphicControl.GetDC() : THandle
   ,GetDC$1:function(Self) {
      var Result = undefined;
      if ($Check(Self,"").FHandle$3) {
         Result = $Check(Self,"").FHandle$3.getContext("2d");
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3GraphicControl.GetDC",Self,"invalid control handle error");
      }
      return Result
   }
   /// procedure TW3GraphicControl.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      $Check(Self,"").FContext$2 = TW3ControlGraphicContext.Create$28$($New(TW3ControlGraphicContext),$Check(Self,"").FHandle$3);
      $Check(Self,"").FCanvas = TW3Canvas.Create$30$($New(TW3Canvas),$Check(Self,"").FContext$2);
   }
   /// procedure TW3GraphicControl.Invalidate()
   ,Invalidate:function(Self) {
      if (!$Check(Self,"").FDirty) {
         $Check(Self,"").FDirty = true;
         TW3AnimationFrame.ScheduleRefresh(Self);
      }
   }
   /// function TW3GraphicControl.MakeElementTagObj() : THandle
   ,MakeElementTagObj:function(Self) {
      return w3_createHtmlElement("canvas");
   }
   /// procedure TW3GraphicControl.Paint()
   ,Paint:function(Self) {
      if ($Check(Self,"").FOnPaint) {
         $CheckFunc($Check(Self,"").FOnPaint,"")(Self,$Check(Self,"").FCanvas);
      }
   }
   /// procedure TW3GraphicControl.Refresh()
   ,Refresh:function(Self) {
      $Check(Self,"").FDirty = false;
      if ((((!TW3TagObj.getUpdating(Self))&&($Check(Self,"").FCanvas!==null))&&($Check(Self,"").FContext$2!==null))&&TW3MovableControl.getVisible$($Check(Self,""))) {
         TW3GraphicControl.Paint$($Check(Self,""));
      }
   }
   /// procedure TW3GraphicControl.Resize()
   ,Resize:function(Self) {
      TW3MovableControl.Resize(Self);
      w3_setAttrib($Check(Self,"").FHandle$3,"width",w3_getStyle($Check(Self,"").FHandle$3,"width"));
      w3_setAttrib($Check(Self,"").FHandle$3,"height",w3_getStyle($Check(Self,"").FHandle$3,"height"));
   }
   /// procedure TW3GraphicControl.SetHeight(aValue: Integer)
   ,setHeight:function(Self, aValue$66) {
      TW3MovableControl.setHeight(Self,aValue$66);
      if ($Check(Self,"").FHandle$3) {
         w3_setAttrib($Check(Self,"").FHandle$3,"height",TInteger.ToPxStr(aValue$66));
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3GraphicControl.SetHeight",Self,"invalid control handle error");
      }
   }
   /// procedure TW3GraphicControl.SetWidth(aValue: Integer)
   ,SetWidth:function(Self, aValue$67) {
      TW3MovableControl.SetWidth(Self,aValue$67);
      if ($Check(Self,"").FHandle$3) {
         w3_setAttrib($Check(Self,"").FHandle$3,"width",TInteger.ToPxStr(aValue$67));
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3GraphicControl.SetWidth",Self,"invalid control handle error");
      }
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj$:function($){return $.ClassType.MakeElementTagObj($)}
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight$:function($){return $.ClassType.setHeight.apply($.ClassType, arguments)}
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth$:function($){return $.ClassType.SetWidth.apply($.ClassType, arguments)}
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate$:function($){return $.ClassType.Invalidate($)}
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
   ,Paint$:function($){return $.ClassType.Paint($)}
};
/// TW3ControlSizeInfo = record
function Copy$TW3ControlSizeInfo(s,d) {
   d.siClientHeight=s.siClientHeight;
   d.siClientWidth=s.siClientWidth;
   d.siHeight=s.siHeight;
   d.siOffsetHeight=s.siOffsetHeight;
   d.siOffsetWidth=s.siOffsetWidth;
   d.siScrollHeight=s.siScrollHeight;
   d.siScrollWidth=s.siScrollWidth;
   d.siWidth=s.siWidth;
   return d;
}
function Clone$TW3ControlSizeInfo($) {
   return {
      siClientHeight:$.siClientHeight,
      siClientWidth:$.siClientWidth,
      siHeight:$.siHeight,
      siOffsetHeight:$.siOffsetHeight,
      siOffsetWidth:$.siOffsetWidth,
      siScrollHeight:$.siScrollHeight,
      siScrollWidth:$.siScrollWidth,
      siWidth:$.siWidth
   }
}
/// function TW3ControlSizeInfo.ToString(var Self: TW3ControlSizeInfo) : String
function TW3ControlSizeInfo$ToString$9(Self$72) {
   return "Width:"+(Self$72.siWidth).toString()+"\r"+"Height:"+(Self$72.siHeight).toString()+"\r"+"ClientWidth:"+(Self$72.siClientWidth).toString()+"\r"+"ClientHeight:"+(Self$72.siClientHeight).toString()+"\r"+"OffsetWidth:"+(Self$72.siOffsetWidth).toString()+"\r"+"OffsetHeight:"+(Self$72.siOffsetHeight).toString()+"\r";
}
/// TW3CustomFont = class (TObject)
var TW3CustomFont = {
   $ClassName:"TW3CustomFont",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FOnChange = null;
   }
   /// function TW3CustomFont.getColor() : TColor
   ,getColor$1:function(Self) {
      var Result = {v:0};
      try {
         var mRef$7 = undefined;
         var mText$2 = "";
         mRef$7 = TW3CustomFont.GetHandle$1$($Check(Self,""));
         if (mRef$7) {
            mText$2 = w3_getStyleAsStr(mRef$7,"color");
            Result.v = StrToColor(mText$2);
         } else {
            throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.getColor", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
         }
      } finally {return Result.v}
   }
   /// function TW3CustomFont.getName() : String
   ,getName:function(Self) {
      var Result = "";
      var mHandle = undefined;
      mHandle = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mHandle) {
         Result = w3_getStyleAsStr(mHandle,"fontFamily");
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.getName", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
      return Result
   }
   /// function TW3CustomFont.getSize() : Integer
   ,getSize:function(Self) {
      var Result = 0;
      var mRef$8 = undefined;
      mRef$8 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mRef$8) {
         Result = w3_getStyleAsInt(mRef$8,"fontSize");
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.getSize", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
      return Result
   }
   /// function TW3CustomFont.getWeight() : String
   ,getWeight:function(Self) {
      var Result = "";
      var mRef$9 = undefined;
      mRef$9 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mRef$9) {
         Result = w3_getStyleAsStr(mRef$9,"fontWeight");
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.getWeight", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
      return Result
   }
   /// procedure TW3CustomFont.setColor(aNewColor: TColor)
   ,setColor$1:function(Self, aNewColor) {
      var mRef$10 = undefined;
      mRef$10 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mRef$10) {
         w3_setStyle(mRef$10,"color",ColorToWebStr(aNewColor,255));
         if ($Check(Self,"").FOnChange) {
            $CheckFunc($Check(Self,"").FOnChange,"")(Self);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.setColor", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
   }
   /// procedure TW3CustomFont.setName(aNewName: String)
   ,setName:function(Self, aNewName) {
      var mHandle$1 = undefined;
      mHandle$1 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mHandle$1) {
         w3_setStyle(mHandle$1,"fontFamily",aNewName);
         if ($Check(Self,"").FOnChange) {
            $CheckFunc($Check(Self,"").FOnChange,"")(Self);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.setName", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
   }
   /// procedure TW3CustomFont.setSize(aNewSize: Integer)
   ,setSize:function(Self, aNewSize) {
      var mRef$11 = undefined;
      mRef$11 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mRef$11) {
         w3_setStyle(mRef$11,"fontSize",TInteger.ToPxStr(aNewSize));
         if ($Check(Self,"").FOnChange) {
            $CheckFunc($Check(Self,"").FOnChange,"")(Self);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.setSize", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
   }
   /// procedure TW3CustomFont.setWeight(aNewWeight: String)
   ,setWeight:function(Self, aNewWeight) {
      var mRef$12 = undefined;
      mRef$12 = TW3CustomFont.GetHandle$1$($Check(Self,""));
      if (mRef$12) {
         w3_setStyle(mRef$12,"fontWeight",aNewWeight);
         if ($Check(Self,"").FOnChange) {
            $CheckFunc($Check(Self,"").FOnChange,"")(Self);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3FontError),"Method %s in class %s threw exception [%s]",["TW3CustomFont.setWeight", TObject.ClassName($Check(Self,"").ClassType), "Invalid tag handle error"]);
      }
   }
   /// function TW3CustomFont.toCssStyle() : String
   ,toCssStyle:function(Self) {
      var Result = "";
      Result = TW3CustomFont.getSize(Self).toString()+"px "+TW3CustomFont.getName(Self);
      if (TW3CustomFont.getName(Self).length<=0) {
         Result = w3_getStyleAsStr(TW3CustomFont.GetHandle$1$($Check(Self,"")),"font");
      }
      return Result
   }
   ,Destroy:TObject.Destroy
   ,GetHandle$1$:function($){return $.ClassType.GetHandle$1($)}
   ,toCssStyle$:function($){return $.ClassType.toCssStyle($)}
};
/// TW3ControlFont = class (TW3CustomFont)
var TW3ControlFont = {
   $ClassName:"TW3ControlFont",
   $Parent:TW3CustomFont
   ,$Init:function ($) {
      TW3CustomFont.$Init($);
      $.FOwner$4 = null;
   }
   /// function TW3ControlFont.getHandle() : THandle
   ,GetHandle$1:function(Self) {
      return $Check($Check(Self,"").FOwner$4,"").FHandle$3;
   }
   /// constructor TW3ControlFont.Create(AOwner: TW3CustomControl)
   ,Create$39:function(Self, AOwner$2) {
      TObject.Create(Self);
      if (AOwner$2) {
         $Check(Self,"").FOwner$4 = AOwner$2;
      } else {
         EW3TagObj.RaiseCntErrMethod("TW3ControlFont.Create",Self,"Owner was nil error");
      }
      return Self
   }
   ,Destroy:TObject.Destroy
   ,GetHandle$1$:function($){return $.ClassType.GetHandle$1($)}
   ,toCssStyle:TW3CustomFont.toCssStyle
   ,Create$39$:function($){return $.ClassType.Create$39.apply($.ClassType, arguments)}
};
/// TW3ControlBackground = class (TW3OwnedObject)
var TW3ControlBackground = {
   $ClassName:"TW3ControlBackground",
   $Parent:TW3OwnedObject
   ,$Init:function ($) {
      TW3OwnedObject.$Init($);
   }
   /// function TW3ControlBackground.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject$2) {
      return (aObject$2!==null)&&$Is(aObject$2,TW3MovableControl);
   }
   /// procedure TW3ControlBackground.FromColor(const aValue: TColor)
   ,FromColor:function(Self, aValue$68) {
      var mRef$13 = undefined;
      mRef$13 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      mRef$13.style["backgroundColor"] = ColorToWebStr(aValue$68,255);
   }
   /// procedure TW3ControlBackground.FromURL(const aURL: String)
   ,FromURL:function(Self, aURL) {
      var mRef$14 = undefined;
      mRef$14 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      mRef$14.style["backgroundImage"] = w3_NameToUrlStr(aURL);
      mRef$14.style["backgroundSize"] = "auto auto";
   }
   /// procedure TW3ControlBackground.FromImageData(const aImgStr: String)
   ,FromImageData$1:function(Self, aImgStr) {
      var mRef$15 = undefined;
      mRef$15 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      mRef$15.style["backgroundImage"] = aImgStr;
      mRef$15.style["backgroundSize"] = "auto auto";
   }
   /// function TW3ControlBackground.ToColor() : TColor
   ,ToColor$1:function(Self) {
      var Result = 0;
      var mRef$16 = undefined;
      mRef$16 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      Result = StrToColor(w3_getStyleAsStr(mRef$16,"backgroundColor"));
      return Result
   }
   /// function TW3ControlBackground.ToURL() : String
   ,ToURL:function(Self) {
      var Result = "";
      var mRef$17 = undefined;
      mRef$17 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      Result = w3_getStyleAsStr(mRef$17,"backgroundImage");
      return Result
   }
   ,Destroy:TObject.Destroy
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7:TW3OwnedObject.Create$7
};
/// TW3Constraints = class (TW3OwnedObject)
var TW3Constraints = {
   $ClassName:"TW3Constraints",
   $Parent:TW3OwnedObject
   ,$Init:function ($) {
      TW3OwnedObject.$Init($);
   }
   /// function TW3Constraints.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject$3) {
      return (aObject$3!==null)&&$Is(aObject$3,TW3TagObj);
   }
   /// function TW3Constraints.GetMaxHeight() : Integer
   ,GetMaxHeight:function(Self) {
      var Result = 0;
      var mRef$18 = undefined;
      mRef$18 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$18) {
         Result = w3_getStyleAsInt(mRef$18,"max-height");
      }
      return Result
   }
   /// function TW3Constraints.GetMaxWidth() : Integer
   ,GetMaxWidth:function(Self) {
      var Result = 0;
      var mRef$19 = undefined;
      mRef$19 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$19) {
         Result = w3_getStyleAsInt(mRef$19,"max-width");
      }
      return Result
   }
   /// function TW3Constraints.GetMinHeight() : Integer
   ,GetMinHeight:function(Self) {
      var Result = 0;
      var mRef$20 = undefined;
      mRef$20 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$20) {
         Result = w3_getStyleAsInt(mRef$20,"min-height");
      }
      return Result
   }
   /// function TW3Constraints.GetMinWidth() : Integer
   ,GetMinWidth:function(Self) {
      var Result = 0;
      var mRef$21 = undefined;
      mRef$21 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$21) {
         Result = w3_getStyleAsInt(mRef$21,"min-width");
      }
      return Result
   }
   /// procedure TW3Constraints.SetMaxHeight(aValue: Integer)
   ,SetMaxHeight:function(Self, aValue$69) {
      var mRef$22 = undefined;
      mRef$22 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$22) {
         mRef$22.style["max-width"] = TInteger.ToPxStr(aValue$69);
      }
   }
   /// procedure TW3Constraints.SetMaxWidth(aValue: Integer)
   ,SetMaxWidth:function(Self, aValue$70) {
      var mRef$23 = undefined;
      mRef$23 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$23) {
         mRef$23.style["max-width"] = TInteger.ToPxStr(aValue$70);
      }
   }
   /// procedure TW3Constraints.SetMinHeight(aValue: Integer)
   ,SetMinHeight:function(Self, aValue$71) {
      var mRef$24 = undefined;
      mRef$24 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$24) {
         mRef$24.style["min-height"] = TInteger.ToPxStr(aValue$71);
      }
   }
   /// procedure TW3Constraints.SetMinWidth(aValue: Integer)
   ,SetMinWidth:function(Self, aValue$72) {
      var mRef$25 = undefined;
      mRef$25 = $Check($As($Check(Self,"").FOwner,TW3MovableControl),"").FHandle$3;
      if (mRef$25) {
         mRef$25.style["min-width"] = TInteger.ToPxStr(aValue$72);
      }
   }
   ,Destroy:TObject.Destroy
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7:TW3OwnedObject.Create$7
};
/// TW3AnimationFrame = class (TObject)
var TW3AnimationFrame = {
   $ClassName:"TW3AnimationFrame",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// procedure TW3AnimationFrame.Perform()
   ,Perform:function() {
      var i$46 = 0;
      var callbacks = [];
      var controls = [];
      if (vScheduledCallbacks.length>0) {
         callbacks = vScheduledCallbacks;
         vScheduledCallbacks = [];
         var $temp90;
         for(i$46 = 0,$temp90 = callbacks.length;i$46<$temp90;i$46++) {
            $CheckFunc($DIdxR(callbacks,i$46,""),"")();
         }
      }
      if (vScheduledControls.length>0) {
         controls = vScheduledControls;
         vScheduledControls = [];
         var $temp91;
         for(i$46 = 0,$temp91 = controls.length;i$46<$temp91;i$46++) {
            TW3GraphicControl.Refresh($DIdxR(controls,i$46,""));
         }
      }
      var $temp92;
      for(i$46 = 0,$temp92 = vOnPerform.length;i$46<$temp92;i$46++) {
         $CheckFunc($DIdxR(vOnPerform,i$46,""),"")();
      }
   }
   /// procedure TW3AnimationFrame.ScheduleCallback(callback: TProcedureRef)
   ,ScheduleCallback:function(callback$2) {
      vScheduledCallbacks.push(callback$2);
      if (!vPending) {
         w3_RequestAnimationFrame(TW3AnimationFrame.Perform);
      }
   }
   /// procedure TW3AnimationFrame.ScheduleRefresh(control: TW3GraphicControl)
   ,ScheduleRefresh:function(control) {
      vScheduledControls.push(control);
      if (!vPending) {
         w3_RequestAnimationFrame(TW3AnimationFrame.Perform);
      }
   }
   ,Destroy:TObject.Destroy
};
/// TShiftStateEnum enumeration
var TShiftStateEnum = [ "ssShift", "ssAlt", "ssCtrl", "ssMeta", "ssLeft", "ssRight", "ssMiddle" ];
/// TShiftState = class (TObject)
var TShiftState = {
   $ClassName:"TShiftState",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FEvent = $.FMouseEvent = null;
      $.FMouseButtons = 0;
   }
   /// function TShiftState.CheckShiftStateEnum(value: TShiftStateEnum) : Boolean
   ,CheckShiftStateEnum:function(Self, value$4) {
      var Result = false;
      if ($Check(Self,"").FEvent===null) {
         Result = false;
      } else {
         switch (value$4) {
            case 0 :
               Result = $Check($Check(Self,"").FEvent,"").shiftKey;
               break;
            case 1 :
               Result = $Check($Check(Self,"").FEvent,"").altKey;
               break;
            case 2 :
               Result = $Check($Check(Self,"").FEvent,"").ctrlKey;
               break;
            case 3 :
               Result = $Check($Check(Self,"").FEvent,"").metaKey;
               break;
            case 4 :
               Result = (($Check(Self,"").FMouseButtons&1)!=0);
               break;
            case 5 :
               Result = (($Check(Self,"").FMouseButtons&4)!=0);
               break;
            case 6 :
               Result = (($Check(Self,"").FMouseButtons&2)!=0);
               break;
         }
      }
      return Result
   }
   /// function TShiftState.Current() : TShiftState
   ,Current:function() {
      var Result = null;
      if (vCurrent===null) {
         vCurrent = TObject.Create($New(TShiftState));
      }
      Result = vCurrent;
      return Result
   }
   /// procedure TShiftState.SetKeyStateEvent(evt: JKeyStateEvent)
   ,SetKeyStateEvent:function(Self, evt$8) {
      $Check(Self,"").FEvent = evt$8;
      $Check(Self,"").FMouseEvent = null;
   }
   /// procedure TShiftState.SetMouseEvent(evt: JMouseEvent)
   ,SetMouseEvent:function(Self, evt$9) {
      $Check(Self,"").FEvent = evt$9;
      $Check(Self,"").FMouseEvent = evt$9;
   }
   ,Destroy:TObject.Destroy
};
/// TMouseButton enumeration
var TMouseButton = [ "mbLeft", "mbMiddle", "mbRight" ];
/// TCustomAppContainer = class (TW3Component)
var TCustomAppContainer = {
   $ClassName:"TCustomAppContainer",
   $Parent:TW3Component
   ,$Init:function ($) {
      TW3Component.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3TagObj.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3Component.FinalizeObject
   ,InitializeObject:TW3Component.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3TagObj.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
};
/// TDocumentBody = class (TCustomAppContainer)
var TDocumentBody = {
   $ClassName:"TDocumentBody",
   $Parent:TCustomAppContainer
   ,$Init:function ($) {
      TCustomAppContainer.$Init($);
      $.FOnReSize = null;
   }
   /// procedure TDocumentBody.CBResize()
   ,CBResize:function(Self) {
      if ($Check(Self,"").FOnReSize) {
         $CheckFunc($Check(Self,"").FOnReSize,"")(Self);
      }
   }
   /// function TDocumentBody.getClientHeight() : Integer
   ,getClientHeight:function(Self) {
      return w3_getStyleAsInt(document.body,"height");
   }
   /// function TDocumentBody.getClientLeft() : Integer
   ,getClientLeft:function(Self) {
      return 0;
   }
   /// function TDocumentBody.getClientRect() : TRect
   ,getClientRect:function(Self) {
      var Result = {Bottom$1:0,Left$1:0,Right$1:0,Top$1:0};
      Result.Left$1 = 0;
      Result.Top$1 = 0;
      Result.Right$1 = w3_getStyleAsInt(document.body,"width")-1;
      Result.Right$1 = w3_getStyleAsInt(document.body,"height")-1;
      return Result
   }
   /// function TDocumentBody.getClientTop() : Integer
   ,getClientTop:function(Self) {
      return 0;
   }
   /// function TDocumentBody.getClientWidth() : Integer
   ,getClientWidth:function(Self) {
      return w3_getStyleAsInt(document.body,"width");
   }
   /// function TDocumentBody.getHeight() : Integer
   ,getHeight$3:function(Self) {
      return parseInt(window.innerHeight,10);
   }
   /// function TDocumentBody.getWidth() : Integer
   ,getWidth$4:function(Self) {
      return parseInt(window.innerWidth,10);
   }
   /// function TDocumentBody.makeElementTagId() : String
   ,MakeElementTagId:function(Self) {
      return "";
   }
   /// function TDocumentBody.makeElementTagObj() : THandle
   ,MakeElementTagObj:function(Self) {
      return document.body;
   }
   /// procedure TDocumentBody.StyleTagObject()
   ,StyleTagObject:function(Self) {
      /* null */
   }
   /// procedure TDocumentBody._setOnResize(aValue: TReSizeEvent)
   ,_setOnResize:function(Self, aValue$73) {
      var mRef$26 = null;
      if (aValue$73) {
         mRef$26 = $Event0(Self,TDocumentBody.CBResize);
      } else {
         mRef$26 = $Event0(Self,TW3Component.CBNoBehavior$);
      }
      w3_bind2($Check(Self,"").FHandle$3,"onresize",mRef$26);
      $Check(Self,"").FOnReSize = aValue$73;
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3TagObj.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3Component.FinalizeObject
   ,InitializeObject:TW3Component.InitializeObject
   ,MakeElementTagId$:function($){return $.ClassType.MakeElementTagId($)}
   ,MakeElementTagObj$:function($){return $.ClassType.MakeElementTagObj($)}
   ,StyleTagObject$:function($){return $.ClassType.StyleTagObject($)}
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
};
/// TDIVAppContainer = class (TCustomAppContainer)
var TDIVAppContainer = {
   $ClassName:"TDIVAppContainer",
   $Parent:TCustomAppContainer
   ,$Init:function ($) {
      TCustomAppContainer.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3TagObj.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3Component.FinalizeObject
   ,InitializeObject:TW3Component.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3TagObj.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
};
function RegisterComponents(Category, ComponentClasses) {
   if (RegisterComponentsProc) {
      $CheckFunc(RegisterComponentsProc,"")(Category,ComponentClasses);
   } else {
      throw Exception.Create($New(Exception),$R[0]);
   }
};
/// EW3TagObj = class (EW3Exception)
var EW3TagObj = {
   $ClassName:"EW3TagObj",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   /// procedure EW3TagObj.RaiseCntErrMethod(methName: String; instance: TObject; msg: String)
   ,RaiseCntErrMethod:function(methName, instance, msg) {
      throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",[methName, (instance!==null)?TObject.ClassName($Check(instance,"").ClassType):"nil", msg]);
   }
   ,Destroy:Exception.Destroy
};
/// EW3CustomControl = class (EW3Exception)
var EW3CustomControl = {
   $ClassName:"EW3CustomControl",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
/// TObjectList = class (TObject)
var TObjectList = {
   $ClassName:"TObjectList",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FData = [];
      $.FOnAdded = null;
      $.FOnClear = null;
      $.FOnDeleted = null;
   }
   /// function TObjectList.Add(Value: TObject) : Integer
   ,Add:function(Self, Value$23) {
      var Result = 0;
      Result = $Check(Self,"").FData.length;
      $Check(Self,"").FData.push(Value$23);
      if ($Check(Self,"").FOnAdded) {
         $CheckFunc($Check(Self,"").FOnAdded,"")(Self);
      }
      return Result
   }
   /// procedure TObjectList.Clear()
   ,Clear$1:function(Self) {
      $Check(Self,"").FData.length=0;
      if ($Check(Self,"").FOnClear) {
         $CheckFunc($Check(Self,"").FOnClear,"")(Self);
      }
   }
   /// constructor TObjectList.Create()
   ,Create$32:function(Self) {
      TObject.Create(Self);
      return Self
   }
   /// destructor TObjectList.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"").FData.length=0;
      TObject.Destroy(Self);
   }
   /// function TObjectList.GetCount() : Integer
   ,GetCount:function(Self) {
      return $Check(Self,"").FData.length;
   }
   /// function TObjectList.GetItem(index: Integer) : TObject
   ,GetItem$4:function(Self, index$4) {
      return $DIdxR($Check(Self,"").FData,index$4,"");
   }
   /// function TObjectList.IndexOf(Value: TObject) : Integer
   ,IndexOf:function(Self, Value$24) {
      return $Check(Self,"").FData.indexOf(Value$24);
   }
   /// procedure TObjectList.Insert(Index: Integer; Value: TObject)
   ,Insert$1:function(Self, Index$11, Value$25) {
      $ArrayInsert($Check(Self,"").FData,Index$11,Value$25,"");
   }
   /// procedure TObjectList.Remove(ondex: Integer)
   ,Remove:function(Self, ondex) {
      $Check(Self,"").FData.splice(ondex,1)
      ;
      if ($Check(Self,"").FOnDeleted) {
         $CheckFunc($Check(Self,"").FOnDeleted,"")(Self);
      }
   }
   /// procedure TObjectList.SetItem(index: Integer; value: TObject)
   ,SetItem:function(Self, index$5, value$5) {
      $DIdxW($Check(Self,"").FData,index$5,value$5,"");
   }
   /// procedure TObjectList.Swap(aFirst: Integer; aSecond: Integer)
   ,Swap$1:function(Self, aFirst, aSecond) {
      $ArraySwapChk($Check(Self,"").FData,aFirst,aSecond,"");
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$32$:function($){return $.ClassType.Create$32($)}
};
/// TStringList = class (TObject)
var TStringList = {
   $ClassName:"TStringList",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FData$1 = [];
      $.FOnAdded$1 = null;
      $.FOnClear$1 = null;
      $.FOnDeleted$1 = null;
   }
   /// function TStringList.Add(value: String) : Integer
   ,Add$1:function(Self, value$6) {
      var Result = 0;
      Result = $Check(Self,"").FData$1.length;
      $Check(Self,"").FData$1.push(value$6);
      if ($Check(Self,"").FOnAdded$1) {
         $CheckFunc($Check(Self,"").FOnAdded$1,"")(Self);
      }
      return Result
   }
   /// procedure TStringList.Clear()
   ,Clear$2:function(Self) {
      $Check(Self,"").FData$1.length=0;
      if ($Check(Self,"").FOnClear$1) {
         $CheckFunc($Check(Self,"").FOnClear$1,"")(Self);
      }
   }
   /// constructor TStringList.Create()
   ,Create$33:function(Self) {
      TObject.Create(Self);
      return Self
   }
   /// destructor TStringList.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"").FData$1.length=0;
      TObject.Destroy(Self);
   }
   /// function TStringList.GetCount() : Integer
   ,GetCount$1:function(Self) {
      return $Check(Self,"").FData$1.length;
   }
   /// function TStringList.GetItem(index: Integer) : String
   ,GetItem$5:function(Self, index$6) {
      return $DIdxR($Check(Self,"").FData$1,index$6,"");
   }
   /// function TStringList.GetText() : String
   ,GetText:function(Self) {
      return ($Check(Self,"").FData$1).join("\r")+"\r";
   }
   /// function TStringList.IndexOf(Value: String) : Integer
   ,IndexOf$1:function(Self, Value$26) {
      return $Check(Self,"").FData$1.indexOf(Value$26);
   }
   /// procedure TStringList.Insert(Index: Integer; Value: String)
   ,Insert$2:function(Self, Index$12, Value$27) {
      $ArrayInsert($Check(Self,"").FData$1,Index$12,Value$27,"");
   }
   /// procedure TStringList.Remove(index: Integer)
   ,Remove$1:function(Self, index$7) {
      $Check(Self,"").FData$1.splice(index$7,1)
      ;
      if ($Check(Self,"").FOnDeleted$1) {
         $CheckFunc($Check(Self,"").FOnDeleted$1,"")(Self);
      }
   }
   /// procedure TStringList.SetItem(index: Integer; Value: String)
   ,SetItem$1:function(Self, index$8, Value$28) {
      $DIdxW($Check(Self,"").FData$1,index$8,Value$28,"");
   }
   /// procedure TStringList.SetText(value: String)
   ,SetText:function(Self, value$7) {
      value$7={v:value$7};
      var xpos$1 = 0;
      var mTemp$3 = "";
      $Check(Self,"").FData$1.length=0;
      xpos$1 = (value$7.v.indexOf("\r")+1);
      if (xpos$1>0) {
         do {
            xpos$1 = (value$7.v.indexOf("\r")+1);
            if (xpos$1>0) {
               mTemp$3 = value$7.v.substr(0,(xpos$1-1));
               Delete(value$7,1,xpos$1);
               if (value$7.v.length>0) {
                  if ($SIdx(value$7.v,1,"")=="\n") {
                     Delete(value$7,1,1);
                  }
               }
               $Check(Self,"").FData$1.push(mTemp$3);
            }
         } while (!(xpos$1<1));
         if (value$7.v.length>0) {
            $Check(Self,"").FData$1.push(value$7.v);
         }
      } else {
         $Check(Self,"").FData$1.push(value$7.v);
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$33$:function($){return $.ClassType.Create$33($)}
};
/// EW3FontError = class (EW3Exception)
var EW3FontError = {
   $ClassName:"EW3FontError",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
/// TW3TextMetrics = record
function Copy$TW3TextMetrics(s,d) {
   d.Width$2=s.Width$2;
   return d;
}
function Clone$TW3TextMetrics($) {
   return {
      Width$2:$.Width$2
   }
}
/// TW3ImageData = class (TObject)
var TW3ImageData = {
   $ClassName:"TW3ImageData",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FHandle = null;
   }
   /// anonymous TSourceMethodSymbol
   ,a$2:function(Self) {
      return $Check($Check(Self,"").FHandle,"").height;
   }
   /// anonymous TSourceMethodSymbol
   ,a$1:function(Self) {
      return $Check($Check(Self,"").FHandle,"").width;
   }
   /// procedure TW3ImageData.FromContextNew(const aContextRef: THandle; const aWidth: Integer; const aHeight: Integer)
   ,FromContextNew:function(Self, aContextRef, aWidth$6, aHeight$6) {
      var mRef$27 = null;
      if (aContextRef) {
         if ((aWidth$6>0)&&(aHeight$6>0)) {
            try {
               mRef$27 = aContextRef.createImageData(aWidth$6,aHeight$6);
            } catch ($e) {
               var e$15 = $W($e);
               throw Exception.Create($New(Exception),"Failed to initialize from graphics-context: createImageData() failed with \""+$Check(e$15,"").FMessage+"\"");
            }
            $Check(Self,"").FHandle = mRef$27;
         } else {
            throw Exception.Create($New(Exception),"Failed to initialize from graphics-context: invalid width or height error");
         }
      } else {
         throw Exception.Create($New(Exception),"Failed to initialize from graphics-context: reference was nil error");
      }
   }
   /// procedure TW3ImageData.FromImageData(aImageDataRef: JImageData)
   ,FromImageData:function(Self, aImageDataRef) {
      $Assert(aImageDataRef!==null,"Failed to initialize from graphics-context: reference was nil error","");
      $Check(Self,"").FHandle = aImageDataRef;
   }
   /// function TW3ImageData.getA(x: Integer; y: Integer) : Integer
   ,getA:function(Self, x$48, y$35) {
      var Result = 0;
      var mIndex$5 = 0;
      mIndex$5 = (($Check($Check(Self,"").FHandle,"").width*y$35)+x$48)*4;
      Result = $Check($Check(Self,"").FHandle,"").data[(mIndex$5+3)];
      return Result
   }
   /// function TW3ImageData.getB(x: Integer; y: Integer) : Integer
   ,getB:function(Self, x$49, y$36) {
      var Result = 0;
      var mIndex$6 = 0;
      mIndex$6 = (($Check($Check(Self,"").FHandle,"").width*y$36)+x$49)*4;
      Result = $Check($Check(Self,"").FHandle,"").data[(mIndex$6+2)];
      return Result
   }
   /// function TW3ImageData.getColor(const x: Integer; const y: Integer) : TColor
   ,getColor:function(Self, x$50, y$37) {
      var Result = 0;
      var mIndex$7 = 0;
      if ((((x$50>=0)&&(x$50<$Check($Check(Self,"").FHandle,"").width))&&(y$37>=0))&&(y$37<$Check($Check(Self,"").FHandle,"").height)) {
         mIndex$7 = (($Check($Check(Self,"").FHandle,"").width*y$37)+x$50)*4;
         Result = RGBToColor($Check($Check(Self,"").FHandle,"").data[mIndex$7],$Check($Check(Self,"").FHandle,"").data[(mIndex$7+1)],$Check($Check(Self,"").FHandle,"").data[(mIndex$7+2)]);
      } else {
         Result = 536870911;
      }
      return Result
   }
   /// function TW3ImageData.getG(x: Integer; y: Integer) : Integer
   ,getG:function(Self, x$51, y$38) {
      var Result = 0;
      var mIndex$8 = 0;
      mIndex$8 = (($Check($Check(Self,"").FHandle,"").width*y$38)+x$51)*4;
      Result = $Check($Check(Self,"").FHandle,"").data[(mIndex$8+1)];
      return Result
   }
   /// procedure TW3ImageData.GetPixel(x: Integer; y: Integer; var Result: TW3RGBA)
   ,GetPixel$1:function(Self, x$52, y$39, Result$1) {
      var mIndex$9 = 0;
      mIndex$9 = (($Check($Check(Self,"").FHandle,"").width*y$39)+x$52)*4;
      Result$1.R = $Check($Check(Self,"").FHandle,"").data[mIndex$9];
      Result$1.G = $Check($Check(Self,"").FHandle,"").data[(mIndex$9+1)];
      Result$1.B = $Check($Check(Self,"").FHandle,"").data[(mIndex$9+2)];
      Result$1.A$1 = $Check($Check(Self,"").FHandle,"").data[(mIndex$9+3)];
   }
   /// function TW3ImageData.GetPixel(x: Integer; y: Integer) : TW3RGBA
   ,GetPixel:function(Self, x$53, y$40) {
      var Result = {A$1:0,B:0,G:0,R:0};
      TW3ImageData.GetPixel$1(Self,x$53,y$40,Result);
      return Result
   }
   /// procedure TW3ImageData.GetPixelEx(x: Integer; y: Integer; var R: Integer; var G: Integer; var B: Integer; var A: Integer)
   ,GetPixelEx:function(Self, x$54, y$41, R$3, G$3, B$3, A$4) {
      var mIndex$10 = 0;
      mIndex$10 = (($Check($Check(Self,"").FHandle,"").width*y$41)+x$54)*4;
      R$3.v = $Check($Check(Self,"").FHandle,"").data[mIndex$10];
      G$3.v = $Check($Check(Self,"").FHandle,"").data[(mIndex$10+1)];
      B$3.v = $Check($Check(Self,"").FHandle,"").data[(mIndex$10+2)];
      A$4.v = $Check($Check(Self,"").FHandle,"").data[(mIndex$10+3)];
   }
   /// function TW3ImageData.getR(x: Integer; y: Integer) : Integer
   ,getR:function(Self, x$55, y$42) {
      var Result = 0;
      var mIndex$11 = 0;
      mIndex$11 = (($Check($Check(Self,"").FHandle,"").width*y$42)+x$55)*4;
      Result = $Check($Check(Self,"").FHandle,"").data[mIndex$11];
      return Result
   }
   /// procedure TW3ImageData.setA(x: Integer; y: Integer; aValue: Integer)
   ,setA:function(Self, x$56, y$43, aValue$74) {
      var mIndex$12 = 0;
      mIndex$12 = (($Check($Check(Self,"").FHandle,"").width*y$43)+x$56)*4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$12+3)]=aValue$74;
   }
   /// procedure TW3ImageData.setB(x: Integer; y: Integer; aValue: Integer)
   ,setB:function(Self, x$57, y$44, aValue$75) {
      var mIndex$13 = 0;
      mIndex$13 = (($Check($Check(Self,"").FHandle,"").width*y$44)+x$57)*4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$13+2)]=aValue$75;
   }
   /// procedure TW3ImageData.setColor(const x: Integer; const y: Integer; const aValue: TColor)
   ,setColor:function(Self, x$58, y$45, aValue$76) {
      var mIndex$14 = 0;
      if ((((x$58>=0)&&(x$58<$Check($Check(Self,"").FHandle,"").width))&&(y$45>=0))&&(y$45<$Check($Check(Self,"").FHandle,"").height)) {
         mIndex$14 = (($Check($Check(Self,"").FHandle,"").width*y$45)+x$58)*4;
         $Check($Check(Self,"").FHandle,"").data[mIndex$14]=((aValue$76>>>16)&255);
         $Check($Check(Self,"").FHandle,"").data[(mIndex$14+1)]=((aValue$76>>>8)&255);
         $Check($Check(Self,"").FHandle,"").data[(mIndex$14+2)]=(aValue$76&255);
         $Check($Check(Self,"").FHandle,"").data[(mIndex$14+3)]=255;
      }
   }
   /// procedure TW3ImageData.setG(x: Integer; y: Integer; aValue: Integer)
   ,setG:function(Self, x$59, y$46, aValue$77) {
      var mIndex$15 = 0;
      mIndex$15 = (($Check($Check(Self,"").FHandle,"").width*y$46)+x$59)*4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$15+1)]=aValue$77;
   }
   /// procedure TW3ImageData.SetPixel(x: Integer; y: Integer; const aValue: TW3RGBA)
   ,SetPixel:function(Self, x$60, y$47, aValue$78) {
      var mIndex$16 = 0;
      mIndex$16 = (($Check($Check(Self,"").FHandle,"").width*y$47)+x$60)*4;
      $Check($Check(Self,"").FHandle,"").data[mIndex$16]=aValue$78.R;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$16+1)]=aValue$78.G;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$16+2)]=aValue$78.B;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$16+3)]=aValue$78.A$1;
   }
   /// procedure TW3ImageData.SetPixelC(x: Integer; y: Integer; aColor: TColor)
   ,SetPixelC:function(Self, x$61, y$48, aColor$3) {
      var mIndex$17 = 0;
      mIndex$17 = (($Check($Check(Self,"").FHandle,"").width*y$48)+x$61)*4;
      $Check($Check(Self,"").FHandle,"").data[mIndex$17]=((aColor$3>>>16)&255);
      $Check($Check(Self,"").FHandle,"").data[(mIndex$17+1)]=((aColor$3>>>8)&255);
      $Check($Check(Self,"").FHandle,"").data[(mIndex$17+2)]=(aColor$3&255);
      $Check($Check(Self,"").FHandle,"").data[(mIndex$17+3)]=255;
   }
   /// procedure TW3ImageData.SetPixelEx(x: Integer; y: Integer; R: Integer; G: Integer; B: Integer; A: Integer)
   ,SetPixelEx:function(Self, x$62, y$49, R$4, G$4, B$4, A$5) {
      var mIndex$18 = 0;
      mIndex$18 = (($Check($Check(Self,"").FHandle,"").width*y$49)+x$62)*4;
      $Check($Check(Self,"").FHandle,"").data[mIndex$18]=R$4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$18+1)]=G$4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$18+2)]=B$4;
      $Check($Check(Self,"").FHandle,"").data[(mIndex$18+3)]=A$5;
   }
   /// procedure TW3ImageData.setR(x: Integer; y: Integer; aValue: Integer)
   ,setR:function(Self, x$63, y$50, aValue$79) {
      var mIndex$19 = 0;
      mIndex$19 = (($Check($Check(Self,"").FHandle,"").width*y$50)+x$63)*4;
      $Check($Check(Self,"").FHandle,"").data[mIndex$19]=aValue$79;
   }
   /// function TW3ImageData.ToDataUrl() : String
   ,ToDataUrl:function(Self) {
      var Result = "";
      var mContext = null;
      var mCanvas = null;
      mContext = TW3GraphicContext.Create$27$($New(TW3GraphicContext),null);
      try {
         TW3CustomGraphicContext.Allocate$($Check(mContext,""),TW3ImageData.a$1(Self),TW3ImageData.a$2(Self));
         mCanvas = TW3Canvas.Create$30$($New(TW3Canvas),mContext);
         try {
            TW3Canvas.PutImageData(mCanvas,Self,0,0);
            Result = TW3Canvas.ToDataURL(mCanvas,"image/png");
            WriteLn(Result);
         } finally {
            TObject.Free(mCanvas);
         }
      } finally {
         TObject.Free(mContext);
      }
      return Result
   }
   ,Destroy:TObject.Destroy
};
/// TW3CustomGraphicContext = class (TObject)
var TW3CustomGraphicContext = {
   $ClassName:"TW3CustomGraphicContext",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// procedure TW3CustomGraphicContext.Allocate(const aWidth: Integer; const aHeight: Integer)
   ,Allocate:function(Self, aWidth$7, aHeight$7) {
      if (TW3CustomGraphicContext.getOwnsReference$($Check(Self,""))) {
         if (VarIsValidRef(TW3CustomGraphicContext.GetDC$($Check(Self,"")))) {
            TW3CustomGraphicContext.Release$($Check(Self,""));
         }
         TW3CustomGraphicContext.SetSize$($Check(Self,""),aWidth$7,aHeight$7);
      } else {
         throw Exception.Create($New(Exception),"Cannot modify current graphics context");
      }
   }
   /// function TW3CustomGraphicContext.BackingStorePixelRatio() : Float
   ,BackingStorePixelRatio:function(Self) {
      var Result = 0;
      var dc = undefined;
      dc = TW3CustomGraphicContext.GetDC$($Check(Self,""));
      
     Result = (dc).webkitBackingStorePixelRatio ||
                (dc).mozBackingStorePixelRatio ||
                (dc).msBackingStorePixelRatio ||
                (dc).oBackingStorePixelRatio ||
                (dc).backingStorePixelRatio || 1
  return Result
   }
   /// procedure TW3CustomGraphicContext.Release()
   ,Release:function(Self) {
      if (TW3CustomGraphicContext.getOwnsReference$($Check(Self,""))) {
         if (VarIsValidRef(TW3CustomGraphicContext.GetDC$($Check(Self,"")))) {
            TW3CustomGraphicContext.ReleaseDC$($Check(Self,""));
         }
      } else {
         throw Exception.Create($New(Exception),"Cannot modify current graphics context");
      }
   }
   ,Destroy:TObject.Destroy
   ,Allocate$:function($){return $.ClassType.Allocate.apply($.ClassType, arguments)}
   ,GetDC$:function($){return $.ClassType.GetDC($)}
   ,GetHandle$:function($){return $.ClassType.GetHandle($)}
   ,GetHeight$:function($){return $.ClassType.GetHeight($)}
   ,getOwnsReference$:function($){return $.ClassType.getOwnsReference($)}
   ,GetWidth$:function($){return $.ClassType.GetWidth($)}
   ,Release$:function($){return $.ClassType.Release($)}
   ,ReleaseDC$:function($){return $.ClassType.ReleaseDC($)}
   ,SetSize$:function($){return $.ClassType.SetSize.apply($.ClassType, arguments)}
};
/// TW3GraphicContext = class (TW3CustomGraphicContext)
var TW3GraphicContext = {
   $ClassName:"TW3GraphicContext",
   $Parent:TW3CustomGraphicContext
   ,$Init:function ($) {
      TW3CustomGraphicContext.$Init($);
      $.FObjId = "";
      $.FObjRef = undefined;
      $.FOwner$1 = undefined;
   }
   /// constructor TW3GraphicContext.Create(const AOwner: THandle)
   ,Create$27:function(Self, AOwner$3) {
      TObject.Create(Self);
      $Check(Self,"").FObjRef = w3_createHtmlElement("canvas");
      $Check(Self,"").FObjId = w3_GetUniqueObjId();
      $Check(Self,"").FObjRef.id = $Check(Self,"").FObjId;
      $Check(Self,"").FOwner$1 = AOwner$3;
      if ($Check(Self,"").FOwner$1) {
         w3_setElementParentByRef($Check(Self,"").FObjRef,$Check(Self,"").FOwner$1);
      }
      return Self
   }
   /// destructor TW3GraphicContext.Destroy()
   ,Destroy:function(Self) {
      if ($Check(Self,"").FOwner$1) {
         w3_RemoveElementByRef($Check(Self,"").FObjRef,$Check(Self,"").FOwner$1);
      }
      $Check(Self,"").FOwner$1 = null;
      $Check(Self,"").FObjRef = null;
      TObject.Destroy(Self);
   }
   /// function TW3GraphicContext.getDC() : THandle
   ,GetDC:function(Self) {
      var Result = undefined;
      if ($Check(Self,"").FObjRef) {
         Result = $Check(Self,"").FObjRef.getContext("2d");
      } else {
         Result = null;
      }
      return Result
   }
   /// function TW3GraphicContext.getHandle() : THandle
   ,GetHandle:function(Self) {
      return $Check(Self,"").FObjRef;
   }
   /// function TW3GraphicContext.getHeight() : Integer
   ,GetHeight:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FObjRef) {
         Result = parseInt($Check(Self,"").FObjRef.height,10);
      }
      return Result
   }
   /// function TW3GraphicContext.getOwnsReference() : Boolean
   ,getOwnsReference:function(Self) {
      return true;
   }
   /// function TW3GraphicContext.getWidth() : Integer
   ,GetWidth:function(Self) {
      var Result = 0;
      if ($Check(Self,"").FObjRef) {
         Result = parseInt($Check(Self,"").FObjRef.width,10);
      }
      return Result
   }
   /// procedure TW3GraphicContext.ReleaseDC()
   ,ReleaseDC:function(Self) {
      if ($Check(Self,"").FObjRef) {
         $Check(Self,"").FObjRef.width = 0;
         $Check(Self,"").FObjRef.height = 0;
      }
   }
   /// procedure TW3GraphicContext.SetSize(aNewWidth: Integer; aNewHeight: Integer)
   ,SetSize:function(Self, aNewWidth, aNewHeight) {
      if ($Check(Self,"").FObjRef) {
         $Check(Self,"").FObjRef.width = aNewWidth;
         $Check(Self,"").FObjRef.height = aNewHeight;
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Allocate:TW3CustomGraphicContext.Allocate
   ,GetDC$:function($){return $.ClassType.GetDC($)}
   ,GetHandle$:function($){return $.ClassType.GetHandle($)}
   ,GetHeight$:function($){return $.ClassType.GetHeight($)}
   ,getOwnsReference$:function($){return $.ClassType.getOwnsReference($)}
   ,GetWidth$:function($){return $.ClassType.GetWidth($)}
   ,Release:TW3CustomGraphicContext.Release
   ,ReleaseDC$:function($){return $.ClassType.ReleaseDC($)}
   ,SetSize$:function($){return $.ClassType.SetSize.apply($.ClassType, arguments)}
   ,Create$27$:function($){return $.ClassType.Create$27.apply($.ClassType, arguments)}
};
/// TW3ControlGraphicContext = class (TW3CustomGraphicContext)
var TW3ControlGraphicContext = {
   $ClassName:"TW3ControlGraphicContext",
   $Parent:TW3CustomGraphicContext
   ,$Init:function ($) {
      TW3CustomGraphicContext.$Init($);
      $.FCtrlTag = undefined;
   }
   /// constructor TW3ControlGraphicContext.Create(const aControlHandle: THandle)
   ,Create$28:function(Self, aControlHandle) {
      TObject.Create(Self);
      if (aControlHandle) {
         $Check(Self,"").FCtrlTag = aControlHandle;
      } else {
         throw Exception.Create($New(Exception),"Control handle is invalid error");
      }
      return Self
   }
   /// function TW3ControlGraphicContext.getDC() : THandle
   ,GetDC:function(Self) {
      return $Check(Self,"").FCtrlTag.getContext("2d");
   }
   /// function TW3ControlGraphicContext.getHandle() : THandle
   ,GetHandle:function(Self) {
      return $Check(Self,"").FCtrlTag;
   }
   /// function TW3ControlGraphicContext.getHeight() : Integer
   ,GetHeight:function(Self) {
      return w3_getPropertyAsInt($Check(Self,"").FCtrlTag,"height");
   }
   /// function TW3ControlGraphicContext.getOwnsReference() : Boolean
   ,getOwnsReference:function(Self) {
      return false;
   }
   /// function TW3ControlGraphicContext.getWidth() : Integer
   ,GetWidth:function(Self) {
      return w3_getPropertyAsInt($Check(Self,"").FCtrlTag,"width");
   }
   /// procedure TW3ControlGraphicContext.ReleaseDC()
   ,ReleaseDC:function(Self) {
      /* null */
   }
   /// procedure TW3ControlGraphicContext.SetSize(aNewWidth: Integer; aNewHeight: Integer)
   ,SetSize:function(Self, aNewWidth$1, aNewHeight$1) {
      /* null */
   }
   ,Destroy:TObject.Destroy
   ,Allocate:TW3CustomGraphicContext.Allocate
   ,GetDC$:function($){return $.ClassType.GetDC($)}
   ,GetHandle$:function($){return $.ClassType.GetHandle($)}
   ,GetHeight$:function($){return $.ClassType.GetHeight($)}
   ,getOwnsReference$:function($){return $.ClassType.getOwnsReference($)}
   ,GetWidth$:function($){return $.ClassType.GetWidth($)}
   ,Release:TW3CustomGraphicContext.Release
   ,ReleaseDC$:function($){return $.ClassType.ReleaseDC($)}
   ,SetSize$:function($){return $.ClassType.SetSize.apply($.ClassType, arguments)}
   ,Create$28$:function($){return $.ClassType.Create$28.apply($.ClassType, arguments)}
};
/// TW3CanvasPattern = class (TObject)
var TW3CanvasPattern = {
   $ClassName:"TW3CanvasPattern",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FHandle$1 = undefined;
   }
   ,Destroy:TObject.Destroy
};
/// TW3CanvasGradient = class (TObject)
var TW3CanvasGradient = {
   $ClassName:"TW3CanvasGradient",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FHandle$2 = undefined;
   }
   /// procedure TW3CanvasGradient.AddColorStop(const offset: Float; const aColor: TColor)
   ,AddColorStop$3:function(Self, offset, aColor$4) {
      $Check(Self,"").FHandle$2.addColorStop(offset,ColorToWebStr(aColor$4,255));
   }
   /// procedure TW3CanvasGradient.AddColorStop(const offset: Float; const R: Integer; const G: Integer; const B: Integer)
   ,AddColorStop$2:function(Self, offset$1, R$5, G$5, B$5) {
      $Check(Self,"").FHandle$2.addColorStop(offset$1,ColorToWebStr$1(R$5,G$5,B$5,255));
   }
   /// procedure TW3CanvasGradient.AddColorStop(const offset: Float; const R: Integer; const G: Integer; const B: Integer; const A: Integer)
   ,AddColorStop$1:function(Self, offset$2, R$6, G$6, B$6, A$6) {
      $Check(Self,"").FHandle$2.addColorStop(offset$2,ColorToWebStr$1(R$6,G$6,B$6,A$6));
   }
   /// procedure TW3CanvasGradient.AddColorStop(const offset: Float; const aColor: String)
   ,AddColorStop:function(Self, offset$3, aColor$5) {
      $Check(Self,"").FHandle$2.addColorStop(offset$3,aColor$5);
   }
   /// constructor TW3CanvasGradient.Create(const aHandle: THandle)
   ,Create$29:function(Self, aHandle$1) {
      TObject.Create(Self);
      $Check(Self,"").FHandle$2 = aHandle$1;
      return Self
   }
   ,Destroy:TObject.Destroy
};
/// TW3Canvas = class (TObject)
var TW3Canvas = {
   $ClassName:"TW3Canvas",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FContext = $.FDC = null;
   }
   /// procedure TW3Canvas.ArcF(x: Float; y: Float; radius: Float; startAngle: Float; endAngle: Float; anticlockwise: Boolean)
   ,ArcF:function(Self, x$64, y$51, radius$2, startAngle, endAngle, anticlockwise) {
      $Check(Self,"").FDC.arc(x$64,y$51,radius$2,startAngle,endAngle,anticlockwise);
   }
   /// procedure TW3Canvas.ArcToF(x1: Float; y1: Float; x2: Float; y2: Float; radius: Float)
   ,ArcToF:function(Self, x1$14, y1$14, x2$9, y2$9, radius$3) {
      $Check(Self,"").FDC.arcTo(x1$14,y1$14,x2$9,y2$9,radius$3);
   }
   /// procedure TW3Canvas.BeginPath()
   ,BeginPath:function(Self) {
      $Check(Self,"").FDC.beginPath();
   }
   /// procedure TW3Canvas.BezierCurveToF(cp1x: Float; cp1y: Float; cp2x: Float; cp2y: Float; x: Float; y: Float)
   ,BezierCurveToF:function(Self, cp1x, cp1y, cp2x, cp2y, x$65, y$52) {
      $Check(Self,"").FDC.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x$65,y$52);
   }
   /// procedure TW3Canvas.Clear()
   ,Clear:function(Self) {
      if ($Check(Self,"").FContext) {
         $Check(Self,"").FDC.clearRect(0,0,TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,"")),TW3CustomGraphicContext.GetHeight$($Check($Check(Self,"").FContext,"")));
      }
   }
   /// procedure TW3Canvas.ClearRect(const aRect: TRect)
   ,ClearRect:function(Self, aRect$7) {
      $Check(Self,"").FDC.clearRect(aRect$7.Left$1,aRect$7.Top$1,TRect$Width$1(aRect$7),TRect$Height$1(aRect$7));
   }
   /// procedure TW3Canvas.ClearRectF(aLeft: Float; aTop: Float; aWidth: Float; aHeight: Float)
   ,ClearRectF:function(Self, aLeft$12, aTop$12, aWidth$8, aHeight$8) {
      $Check(Self,"").FDC.clearRect(aLeft$12,aTop$12,aWidth$8,aHeight$8);
   }
   /// procedure TW3Canvas.ClearShadow()
   ,ClearShadow:function(Self) {
      $Check(Self,"").FDC.clearShadow();
   }
   /// procedure TW3Canvas.Clip()
   ,Clip$2:function(Self) {
      $Check(Self,"").FDC.clip();
   }
   /// procedure TW3Canvas.ClosePath()
   ,ClosePath:function(Self) {
      $Check(Self,"").FDC.closePath();
   }
   /// constructor TW3Canvas.Create(Context: TW3CustomGraphicContext)
   ,Create$30:function(Self, Context$2) {
      TObject.Create(Self);
      $Check(Self,"").FContext = Context$2;
      if ($Check(Self,"").FContext) {
         $Check(Self,"").FDC = TW3CustomGraphicContext.GetDC$($Check($Check(Self,"").FContext,""));
      } else {
         throw Exception.Create($New(Exception),"Invalid canvas context error");
      }
      return Self
   }
   /// function TW3Canvas.CreateHorizontalGradient(x0: Float; x1: Float) : TW3CanvasGradient
   ,CreateHorizontalGradient:function(Self, x0$10, x1$15) {
      return TW3CanvasGradient.Create$29($New(TW3CanvasGradient),$Check(Self,"").FDC.createLinearGradient(x0$10,0,x1$15,0));
   }
   /// function TW3Canvas.CreateImageData(reference: TW3ImageData) : TW3ImageData
   ,CreateImageData$1:function(Self, reference) {
      var Result = null;
      var mTemp$4 = null;
      mTemp$4 = $Check(Self,"").FDC.createImageData($Check(reference,"").FHandle);
      if (mTemp$4) {
         Result = TObject.Create($New(TW3ImageData));
         TW3ImageData.FromImageData(Result,mTemp$4);
      }
      return Result
   }
   /// function TW3Canvas.CreateImageData(sw: Float; sh: Float) : TW3ImageData
   ,CreateImageData:function(Self, sw, sh) {
      var Result = null;
      var mTemp$5 = null;
      mTemp$5 = $Check(Self,"").FDC.createImageData(sw,sh);
      if (mTemp$5) {
         Result = TObject.Create($New(TW3ImageData));
         TW3ImageData.FromImageData(Result,mTemp$5);
      }
      return Result
   }
   /// function TW3Canvas.CreateLinearGradientF(x0: Float; y0: Float; x1: Float; y1: Float) : TW3CanvasGradient
   ,CreateLinearGradientF:function(Self, x0$11, y0$10, x1$16, y1$15) {
      var Result = null;
      var mTemp$6 = undefined;
      mTemp$6 = $Check(Self,"").FDC.createLinearGradient(x0$11,y0$10,x1$16,y1$15);
      if (mTemp$6) {
         Result = TW3CanvasGradient.Create$29($New(TW3CanvasGradient),mTemp$6);
      }
      return Result
   }
   /// function TW3Canvas.CreatePattern(image: THandle; aRepeat: String) : TW3CanvasPattern
   ,CreatePattern:function(Self, image, aRepeat) {
      var Result = null;
      Result = TObject.Create($New(TW3CanvasPattern));
      $Check(Result,"").FHandle$1 = $Check(Self,"").FDC.createPattern(image,aRepeat);
      return Result
   }
   /// function TW3Canvas.CreateRadialGradientF(x0: Float; y0: Float; r0: Float; x1: Float; y1: Float; r1: Float) : TW3CanvasGradient
   ,CreateRadialGradientF:function(Self, x0$12, y0$11, r0$1, x1$17, y1$16, r1) {
      var Result = null;
      var mTemp$7 = undefined;
      try {
         mTemp$7 = $Check(Self,"").FDC.createRadialGradient(x0$12,y0$11,r0$1,x1$17,y1$16,r1);
      } catch ($e) {
         var e$16 = $W($e);
         throw Exception.Create($New(Exception),"Failed to create gradient object:"+$Check(e$16,"").FMessage);
      }
      Result = TW3CanvasGradient.Create$29($New(TW3CanvasGradient),mTemp$7);
      return Result
   }
   /// function TW3Canvas.CreateVerticalGradient(y0: Float; y1: Float) : TW3CanvasGradient
   ,CreateVerticalGradient:function(Self, y0$12, y1$17) {
      return TW3CanvasGradient.Create$29($New(TW3CanvasGradient),$Check(Self,"").FDC.createLinearGradient(0,y0$12,0,y1$17));
   }
   /// procedure TW3Canvas.DrawImage(image: JElement; sx: Float; sy: Float; sw: Float; sh: Float; dx: Float; dy: Float; dw: Float; dh: Float)
   ,DrawImage$2:function(Self, image$1, sx, sy, sw$1, sh$1, dx$7, dy$8, dw, dh) {
      $Check(Self,"").FDC.drawImage(image$1,sx,sy,sw$1,sh$1,dx$7,dy$8,dw,dh);
   }
   /// procedure TW3Canvas.DrawImage(image: JElement; x: Float; y: Float; ow: Float; oh: Float)
   ,DrawImage$1:function(Self, image$2, x$66, y$53, ow, oh) {
      $Check(Self,"").FDC.drawImage(image$2,x$66,y$53,ow,oh);
   }
   /// procedure TW3Canvas.DrawImage(image: JElement; x: Float; y: Float)
   ,DrawImage:function(Self, image$3, x$67, y$54) {
      $Check(Self,"").FDC.drawImage(image$3,x$67,y$54);
   }
   /// procedure TW3Canvas.DrawImageF(imageHandle: THandle; sx: Float; sy: Float; sw: Float; sh: Float; dx: Float; dy: Float; dw: Float; dh: Float)
   ,DrawImageF$2:function(Self, imageHandle, sx$1, sy$1, sw$2, sh$2, dx$8, dy$9, dw$1, dh$1) {
      $Check(Self,"").FDC.drawImage(imageHandle,sx$1,sy$1,sw$2,sh$2,dx$8,dy$9,dw$1,dh$1);
   }
   /// procedure TW3Canvas.DrawImageF(imageHandle: THandle; x: Float; y: Float; ow: Float; oh: Float)
   ,DrawImageF$1:function(Self, imageHandle$1, x$68, y$55, ow$1, oh$1) {
      $Check(Self,"").FDC.drawImage(imageHandle$1,x$68,y$55,ow$1,oh$1);
   }
   /// procedure TW3Canvas.DrawImageF(imageHandle: THandle; x: Float; y: Float)
   ,DrawImageF:function(Self, imageHandle$2, x$69, y$56) {
      $Check(Self,"").FDC.drawImage(imageHandle$2,x$69,y$56);
   }
   /// procedure TW3Canvas.DrawPart(target: TW3Canvas; const srcX: Integer; const srcY: Integer; const srcWidth: Integer; const srcHeight: Integer; const dstX: Integer; const dstY: Integer; const rotation: Integer; const alpha: Integer)
   ,DrawPart$2:function(Self, target$6, srcX, srcY, srcWidth, srcHeight, dstX, dstY, rotation, alpha$3) {
      var mAlpha = 0;
      if (target$6!==null) {
         mAlpha = TW3Canvas.getGlobalAlpha(target$6);
         TW3Canvas.setGlobalAlpha(target$6,0.00392156862745098*alpha$3);
         $Check(target$6,"").FDC.translate(dstX,dstY);
         $Check(target$6,"").FDC.rotate(DegToRad(rotation));
         $Check(target$6,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),srcX,srcY,srcWidth,srcHeight,0,0,srcWidth,srcHeight);
         $Check(target$6,"").FDC.setTransform(1,0,0,1,0,0);
         TW3Canvas.setGlobalAlpha(target$6,mAlpha);
      }
   }
   /// procedure TW3Canvas.DrawPart(target: TW3Canvas; const srcX: Integer; const srcY: Integer; const srcWidth: Integer; const srcHeight: Integer; const dstX: Integer; const dstY: Integer; const rotation: Integer)
   ,DrawPart$1:function(Self, target$7, srcX$1, srcY$1, srcWidth$1, srcHeight$1, dstX$1, dstY$1, rotation$1) {
      if (target$7!==null) {
         $Check(target$7,"").FDC.translate(dstX$1,dstY$1);
         $Check(target$7,"").FDC.rotate(DegToRad(rotation$1));
         $Check(target$7,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),srcX$1,srcY$1,srcWidth$1,srcHeight$1,0,0,srcWidth$1,srcHeight$1);
         $Check(target$7,"").FDC.setTransform(1,0,0,1,0,0);
      }
   }
   /// procedure TW3Canvas.DrawPart(target: TW3Canvas; const srcX: Integer; const srcY: Integer; const srcWidth: Integer; const srcHeight: Integer; const dstX: Integer; const dstY: Integer)
   ,DrawPart:function(Self, target$8, srcX$2, srcY$2, srcWidth$2, srcHeight$2, dstX$2, dstY$2) {
      if (target$8!==null) {
         $Check(target$8,"").FDC.translate(dstX$2,dstY$2);
         $Check(target$8,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),srcX$2,srcY$2,srcWidth$2,srcHeight$2,0,0,srcWidth$2,srcHeight$2);
         $Check(target$8,"").FDC.setTransform(1,0,0,1,0,0);
      }
   }
   /// procedure TW3Canvas.DrawTile(target: TW3Canvas; const TileID: Integer; const TileSize: Integer; const dstX: Integer; const dstY: Integer; const rotation: Integer; const alpha: Integer)
   ,DrawTile$2:function(Self, target$9, TileID, TileSize, dstX$3, dstY$3, rotation$2, alpha$4) {
      var srcX$3 = 0;
      var srcY$3 = 0;
      if (target$9!==null) {
         srcX$3 = (TileID%Math.floor(TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))/TileSize))*TileSize;
         srcY$3 = Math.floor(TileID*(TileSize/TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))))*TileSize;
         TW3Canvas.DrawPart$2(Self,target$9,srcX$3,srcY$3,TileSize,TileSize,dstX$3,dstY$3,rotation$2,alpha$4);
      }
   }
   /// procedure TW3Canvas.DrawTile(target: TW3Canvas; const TileID: Integer; const TileSize: Integer; const dstX: Integer; const dstY: Integer; const rotation: Integer)
   ,DrawTile$1:function(Self, target$10, TileID$1, TileSize$1, dstX$4, dstY$4, rotation$3) {
      var srcX$4 = 0;
      var srcY$4 = 0;
      if (target$10!==null) {
         srcX$4 = (TileID$1%Math.floor(TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))/TileSize$1))*TileSize$1;
         srcY$4 = Math.floor(TileID$1*(TileSize$1/TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))))*TileSize$1;
         TW3Canvas.DrawPart$1(Self,target$10,srcX$4,srcY$4,TileSize$1,TileSize$1,dstX$4,dstY$4,rotation$3);
      }
   }
   /// procedure TW3Canvas.DrawTile(target: TW3Canvas; const TileID: Integer; const TileSize: Integer; const dstX: Integer; const dstY: Integer)
   ,DrawTile:function(Self, target$11, TileID$2, TileSize$2, dstX$5, dstY$5) {
      var srcX$5 = 0;
      var srcY$5 = 0;
      if (target$11!==null) {
         srcX$5 = (TileID$2%Math.floor(TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))/TileSize$2))*TileSize$2;
         srcY$5 = Math.floor(TileID$2*(TileSize$2/TW3CustomGraphicContext.GetWidth$($Check($Check(Self,"").FContext,""))))*TileSize$2;
         TW3Canvas.DrawPart(Self,target$11,srcX$5,srcY$5,TileSize$2,TileSize$2,dstX$5,dstY$5);
      }
   }
   /// procedure TW3Canvas.DrawTo(target: TW3Canvas; const dstX: Integer; const dstY: Integer; const rotation: Integer; const alpha: Integer)
   ,DrawTo$2:function(Self, target$12, dstX$6, dstY$6, rotation$4, alpha$5) {
      var mAlpha$1 = 0;
      if (target$12!==null) {
         mAlpha$1 = $Check($Check(target$12,"").FDC,"").globalAlpha;
         TW3Canvas.setGlobalAlpha(target$12,0.00392156862745098*alpha$5);
         $Check(target$12,"").FDC.translate(dstX$6,dstY$6);
         $Check(target$12,"").FDC.rotate(DegToRad(rotation$4));
         $Check(target$12,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),0,0);
         $Check(target$12,"").FDC.setTransform(1,0,0,1,0,0);
         TW3Canvas.setGlobalAlpha(target$12,mAlpha$1);
      }
   }
   /// procedure TW3Canvas.DrawTo(target: TW3Canvas; const dstX: Integer; const dstY: Integer; const rotation: Integer)
   ,DrawTo$1:function(Self, target$13, dstX$7, dstY$7, rotation$5) {
      if (target$13!==null) {
         $Check(target$13,"").FDC.translate(dstX$7,dstY$7);
         $Check(target$13,"").FDC.rotate(DegToRad(rotation$5));
         $Check(target$13,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),0,0);
         $Check(target$13,"").FDC.setTransform(1,0,0,1,0,0);
      }
   }
   /// procedure TW3Canvas.DrawTo(target: TW3Canvas; const dstX: Integer; const dstY: Integer)
   ,DrawTo:function(Self, target$14, dstX$8, dstY$8) {
      if (target$14!==null) {
         $Check(target$14,"").FDC.drawImage(TW3CustomGraphicContext.GetHandle$($Check($Check(Self,"").FContext,"")),dstX$8,dstY$8);
      }
   }
   /// procedure TW3Canvas.Ellipse(const aRect: TRectF)
   ,Ellipse$1:function(Self, aRect$8) {
      $Check(Self,"").FDC.save();
      $Check(Self,"").FDC.translate((aRect$8.Right+aRect$8.Left)*0.5,(aRect$8.Top+aRect$8.Bottom)*0.5);
      $Check(Self,"").FDC.scale((aRect$8.Right-aRect$8.Left)*0.5,(aRect$8.Top-aRect$8.Bottom)*0.5);
      $Check(Self,"").FDC.moveTo(1,0);
      $Check(Self,"").FDC.arc(0,0,1,0,6.28318530717959,false);
      $Check(Self,"").FDC.restore();
   }
   /// procedure TW3Canvas.Ellipse(x1: Float; y1: Float; x2: Float; y2: Float)
   ,Ellipse:function(Self, x1$18, y1$18, x2$10, y2$10) {
      var r$5 = {Bottom:0,Left:0,Right:0,Top:0};
      r$5 = CreateBounded(x1$18,y1$18,x2$10,y2$10);
      TW3Canvas.Ellipse$1(Self,r$5);
   }
   /// procedure TW3Canvas.Fill()
   ,Fill:function(Self) {
      $Check(Self,"").FDC.fill();
   }
   /// procedure TW3Canvas.FillBounds(aLeft: Float; aTop: Float; aRight: Float; aBottom: Float)
   ,FillBounds:function(Self, aLeft$13, aTop$13, aRight$4, aBottom$4) {
      $Check(Self,"").FDC.fillRect(aLeft$13,aTop$13,aRight$4-aLeft$13,aBottom$4-aTop$13);
   }
   /// procedure TW3Canvas.FillRect(aLeft: Integer; aTop: Integer; aWidth: Integer; aHeight: Integer)
   ,FillRect$1:function(Self, aLeft$14, aTop$14, aWidth$9, aHeight$9) {
      $Check(Self,"").FDC.fillRect(aLeft$14,aTop$14,aWidth$9,aHeight$9);
   }
   /// procedure TW3Canvas.FillRect(const aRect: TRect)
   ,FillRect:function(Self, aRect$9) {
      $Check(Self,"").FDC.fillRect(aRect$9.Left$1,aRect$9.Top$1,TRect$Width$1(aRect$9),TRect$Height$1(aRect$9));
   }
   /// procedure TW3Canvas.FillRectF(aLeft: Float; aTop: Float; aWidth: Float; aHeight: Float)
   ,FillRectF$2:function(Self, aLeft$15, aTop$15, aWidth$10, aHeight$10) {
      $Check(Self,"").FDC.fillRect(aLeft$15,aTop$15,aWidth$10,aHeight$10);
   }
   /// procedure TW3Canvas.FillRectF(const aRect: TRectF)
   ,FillRectF$1:function(Self, aRect$10) {
      $Check(Self,"").FDC.fillRect(aRect$10.Left,aRect$10.Top,TRectF$Width(aRect$10),TRectF$Height(aRect$10));
   }
   /// procedure TW3Canvas.FillRectF(const aRect: TRect)
   ,FillRectF:function(Self, aRect$11) {
      $Check(Self,"").FDC.fillRect(aRect$11.Left$1,aRect$11.Top$1,TRect$Width$1(aRect$11),TRect$Height$1(aRect$11));
   }
   /// procedure TW3Canvas.FillText(text: String; x: Float; y: Float)
   ,FillText$1:function(Self, text, x$70, y$57) {
      $Check(Self,"").FDC.fillText(text,x$70,y$57);
   }
   /// procedure TW3Canvas.FillText(text: String; x: Float; y: Float; maxWidth: Float)
   ,FillText:function(Self, text$1, x$71, y$58, maxWidth) {
      $Check(Self,"").FDC.fillText(text$1,x$71,y$58,maxWidth);
   }
   /// procedure TW3Canvas.FillTextF(text: String; x: Float; y: Float; maxWidth: Float)
   ,FillTextF:function(Self, text$2, x$72, y$59, maxWidth$1) {
      $Check(Self,"").FDC.fillText(text$2,x$72,y$59,maxWidth$1);
   }
   /// function TW3Canvas.getFillStyle() : String
   ,getFillStyle:function(Self) {
      return ""+$Check($Check(Self,"").FDC,"").fillStyle;
   }
   /// function TW3Canvas.getFont() : String
   ,getFont:function(Self) {
      return $Check($Check(Self,"").FDC,"").font;
   }
   /// function TW3Canvas.getGlobalAlpha() : Float
   ,getGlobalAlpha:function(Self) {
      return $Check($Check(Self,"").FDC,"").globalAlpha;
   }
   /// function TW3Canvas.getGlobalCompOp() : String
   ,getGlobalCompOp:function(Self) {
      return $Check($Check(Self,"").FDC,"").globalCompositeOperation;
   }
   /// function TW3Canvas.GetImageData(sx: Float; sy: Float; sw: Float; sh: Float) : TW3ImageData
   ,GetImageData:function(Self, sx$2, sy$2, sw$3, sh$3) {
      var Result = null;
      var mTemp$8 = null;
      mTemp$8 = $Check(Self,"").FDC.getImageData(sx$2,sy$2,sw$3,sh$3);
      if (mTemp$8) {
         Result = TObject.Create($New(TW3ImageData));
         TW3ImageData.FromImageData(Result,mTemp$8);
      }
      return Result
   }
   /// function TW3Canvas.getLineCap() : String
   ,getLineCap:function(Self) {
      return $Check($Check(Self,"").FDC,"").lineCap;
   }
   /// function TW3Canvas.GetLineDash() : TW3DashList
   ,GetLineDash:function(Self) {
      var Result = [];
      
   Result = (Self.FDC).lineDash;
   return Result
   }
   /// function TW3Canvas.GetLineDashOffset() : Float
   ,GetLineDashOffset:function(Self) {
      return $Check($Check(Self,"").FDC,"").lineDashOffset;
   }
   /// function TW3Canvas.getLineJoin() : String
   ,getLineJoin:function(Self) {
      return $Check($Check(Self,"").FDC,"").lineJoin;
   }
   /// function TW3Canvas.getLineWidth() : Float
   ,getLineWidth:function(Self) {
      return $Check($Check(Self,"").FDC,"").lineWidth;
   }
   /// function TW3Canvas.getMiterLimit() : Float
   ,getMiterLimit:function(Self) {
      return $Check($Check(Self,"").FDC,"").miterLimit;
   }
   /// function TW3Canvas.getShadowBlur() : Float
   ,getShadowBlur:function(Self) {
      return $Check($Check(Self,"").FDC,"").shadowBlur;
   }
   /// function TW3Canvas.getShadowColor() : String
   ,getShadowColor:function(Self) {
      return $Check($Check(Self,"").FDC,"").shadowColor;
   }
   /// function TW3Canvas.getshadowX() : Float
   ,getshadowX:function(Self) {
      return $Check($Check(Self,"").FDC,"").shadowOffsetX;
   }
   /// function TW3Canvas.getshadowY() : Float
   ,getshadowY:function(Self) {
      return $Check($Check(Self,"").FDC,"").shadowOffsetY;
   }
   /// function TW3Canvas.getStrokeStyle() : String
   ,getStrokeStyle:function(Self) {
      return ""+$Check($Check(Self,"").FDC,"").strokeStyle;
   }
   /// function TW3Canvas.getTextAlign() : String
   ,getTextAlign:function(Self) {
      return $Check($Check(Self,"").FDC,"").textAlign;
   }
   /// function TW3Canvas.getTextBaseline() : String
   ,getTextBaseline:function(Self) {
      return $Check($Check(Self,"").FDC,"").textBaseline;
   }
   /// procedure TW3Canvas.HorzLine(x1: Float; y: Float; x2: Float)
   ,HorzLine:function(Self, x1$19, y$60, x2$11) {
      $Check(Self,"").FDC.moveTo(x1$19,y$60);
      $Check(Self,"").FDC.lineTo(x2$11,y$60);
   }
   /// function TW3Canvas.IsPointInPathF(const p: TPointF) : Boolean
   ,IsPointInPathF$1:function(Self, p$1) {
      return $Check(Self,"").FDC.isPointInPath(p$1.X,p$1.Y);
   }
   /// function TW3Canvas.IsPointInPathF(x: Float; y: Float) : Boolean
   ,IsPointInPathF:function(Self, x$73, y$61) {
      return $Check(Self,"").FDC.isPointInPath(x$73,y$61);
   }
   /// procedure TW3Canvas.LineF(x1: Float; y1: Float; x2: Float; y2: Float)
   ,LineF:function(Self, x1$20, y1$19, x2$12, y2$11) {
      $Check(Self,"").FDC.moveTo(x1$20,y1$19);
      $Check(Self,"").FDC.lineTo(x2$12,y2$11);
   }
   /// procedure TW3Canvas.LineTo(const aPoint: TPointF)
   ,LineTo:function(Self, aPoint$11) {
      $Check(Self,"").FDC.lineTo(aPoint$11.X,aPoint$11.Y);
   }
   /// procedure TW3Canvas.LineToF(x: Float; y: Float)
   ,LineToF:function(Self, x$74, y$62) {
      $Check(Self,"").FDC.lineTo(x$74,y$62);
   }
   /// function TW3Canvas.MeasureText(aText: String) : TW3TextMetrics
   ,MeasureText:function(Self, aText$5) {
      var Result = {Width$2:0};
      var metrics = undefined;
      metrics = $Check(Self,"").FDC.measureText(aText$5);
      Result.Width$2 = Number(metrics.width);
      return Result
   }
   /// procedure TW3Canvas.MoveTo(const aPoint: TPointF)
   ,MoveTo:function(Self, aPoint$12) {
      $Check(Self,"").FDC.moveTo(aPoint$12.X,aPoint$12.Y);
   }
   /// procedure TW3Canvas.MoveToF(x: Float; y: Float)
   ,MoveToF:function(Self, x$75, y$63) {
      $Check(Self,"").FDC.moveTo(x$75,y$63);
   }
   /// procedure TW3Canvas.PutImageData(imageData: TW3ImageData; x: Float; y: Float; dx: Float; dy: Float; dw: Float; dh: Float)
   ,PutImageData$1:function(Self, imageData, x$76, y$64, dx$9, dy$10, dw$2, dh$2) {
      if (imageData) {
         $Check(Self,"").FDC.putImageData($Check(imageData,"").FHandle,x$76,y$64,dx$9,dy$10,dw$2,dh$2);
      } else {
         throw Exception.Create($New(Exception),"ImageData was nil error");
      }
   }
   /// procedure TW3Canvas.PutImageData(imageData: TW3ImageData; x: Float; y: Float)
   ,PutImageData:function(Self, imageData$1, x$77, y$65) {
      if (imageData$1) {
         $Check(Self,"").FDC.putImageData($Check(imageData$1,"").FHandle,x$77,y$65);
      } else {
         throw Exception.Create($New(Exception),"ImageData was nil error");
      }
   }
   /// procedure TW3Canvas.QuadraticCurveToF(cpx: Float; cpy: Float; x: Float; y: Float)
   ,QuadraticCurveToF:function(Self, cpx, cpy, x$78, y$66) {
      $Check(Self,"").FDC.quadraticCurveTo(cpx,cpy,x$78,y$66);
   }
   /// procedure TW3Canvas.Rectangle(const aRect: TRect)
   ,Rectangle:function(Self, aRect$12) {
      $Check(Self,"").FDC.rect(aRect$12.Left$1,aRect$12.Top$1,TRect$Width$1(aRect$12),TRect$Height$1(aRect$12));
   }
   /// procedure TW3Canvas.RectangleF(aLeft: Float; aTop: Float; aWidth: Float; aHeight: Float)
   ,RectangleF:function(Self, aLeft$16, aTop$16, aWidth$11, aHeight$11) {
      $Check(Self,"").FDC.rect(aLeft$16,aTop$16,aWidth$11,aHeight$11);
   }
   /// procedure TW3Canvas.ResetClip()
   ,ResetClip:function(Self) {
      $Check(Self,"").FDC.resetClip();
   }
   /// procedure TW3Canvas.Restore()
   ,Restore:function(Self) {
      if ($Check(Self,"").FContext) {
         $Check(Self,"").FDC.restore();
      }
   }
   /// procedure TW3Canvas.Rotate(angleRad: Float)
   ,Rotate:function(Self, angleRad) {
      $Check(Self,"").FDC.rotate(angleRad);
   }
   /// procedure TW3Canvas.Save()
   ,Save:function(Self) {
      if ($Check(Self,"").FContext) {
         $Check(Self,"").FDC.save();
      }
   }
   /// procedure TW3Canvas.Scale(sx: Float; sy: Float)
   ,Scale:function(Self, sx$3, sy$3) {
      $Check(Self,"").FDC.scale(sx$3,sy$3);
   }
   /// procedure TW3Canvas.setFillStyle(aValue: String)
   ,setFillStyle:function(Self, aValue$80) {
      $Check($Check(Self,"").FDC,"").fillStyle = aValue$80;
   }
   /// procedure TW3Canvas.setFont(aValue: String)
   ,setFont:function(Self, aValue$81) {
      $Check($Check(Self,"").FDC,"").font = aValue$81;
   }
   /// procedure TW3Canvas.setGlobalAlpha(aValue: Float)
   ,setGlobalAlpha:function(Self, aValue$82) {
      $Check($Check(Self,"").FDC,"").globalAlpha = aValue$82;
   }
   /// procedure TW3Canvas.setGlobalCompOp(aValue: String)
   ,setGlobalCompOp:function(Self, aValue$83) {
      $Check($Check(Self,"").FDC,"").globalCompositeOperation = aValue$83;
   }
   /// procedure TW3Canvas.setLineCap(aValue: String)
   ,setLineCap:function(Self, aValue$84) {
      $Check($Check(Self,"").FDC,"").lineCap = aValue$84;
   }
   /// procedure TW3Canvas.SetLineDash(aValue: TW3DashList)
   ,SetLineDash:function(Self, aValue$85) {
      
   (Self.FDC).lineDash = aValue$85;
      }
   /// procedure TW3Canvas.SetLineDashOffset(aValue: Float)
   ,SetLineDashOffset:function(Self, aValue$86) {
      $Check($Check(Self,"").FDC,"").lineDashOffset = aValue$86;
   }
   /// procedure TW3Canvas.setLineJoin(aValue: String)
   ,setLineJoin:function(Self, aValue$87) {
      $Check($Check(Self,"").FDC,"").lineJoin = aValue$87;
   }
   /// procedure TW3Canvas.setLineWidth(aValue: Float)
   ,setLineWidth:function(Self, aValue$88) {
      $Check($Check(Self,"").FDC,"").lineWidth = aValue$88;
   }
   /// procedure TW3Canvas.setMiterLimit(aValue: Float)
   ,setMiterLimit:function(Self, aValue$89) {
      $Check($Check(Self,"").FDC,"").miterLimit = aValue$89;
   }
   /// procedure TW3Canvas.SetPixel(x: Integer; y: Integer)
   ,SetPixel$1:function(Self, x$79, y$67) {
      $Check(Self,"").FDC.fillRect(x$79,y$67,1,1);
   }
   /// procedure TW3Canvas.setShadowBlur(aValue: Float)
   ,setShadowBlur:function(Self, aValue$90) {
      $Check($Check(Self,"").FDC,"").shadowBlur = aValue$90;
   }
   /// procedure TW3Canvas.setShadowColor(aValue: String)
   ,setShadowColor:function(Self, aValue$91) {
      $Check($Check(Self,"").FDC,"").shadowColor = aValue$91;
   }
   /// procedure TW3Canvas.setShadowX(aValue: Float)
   ,setShadowX:function(Self, aValue$92) {
      $Check($Check(Self,"").FDC,"").shadowOffsetX = aValue$92;
   }
   /// procedure TW3Canvas.setShadowY(aValue: Float)
   ,setShadowY:function(Self, aValue$93) {
      $Check($Check(Self,"").FDC,"").shadowOffsetY = aValue$93;
   }
   /// procedure TW3Canvas.setStrokeStyle(aValue: String)
   ,setStrokeStyle:function(Self, aValue$94) {
      $Check($Check(Self,"").FDC,"").strokeStyle = aValue$94;
   }
   /// procedure TW3Canvas.setTextAlign(aValue: String)
   ,setTextAlign:function(Self, aValue$95) {
      $Check($Check(Self,"").FDC,"").textAlign = aValue$95;
   }
   /// procedure TW3Canvas.setTextbaseLine(aValue: String)
   ,setTextbaseLine:function(Self, aValue$96) {
      $Check($Check(Self,"").FDC,"").textBaseline = aValue$96;
   }
   /// procedure TW3Canvas.Stroke()
   ,Stroke:function(Self) {
      $Check(Self,"").FDC.stroke();
   }
   /// procedure TW3Canvas.StrokeRect(const aRect: TRect)
   ,StrokeRect:function(Self, aRect$13) {
      $Check(Self,"").FDC.strokeRect(aRect$13.Left$1,aRect$13.Top$1,TRect$Width$1(aRect$13),TRect$Height$1(aRect$13));
   }
   /// procedure TW3Canvas.StrokeRectF(aLeft: Float; aTop: Float; aWidth: Float; aHeight: Float)
   ,StrokeRectF$1:function(Self, aLeft$17, aTop$17, aWidth$12, aHeight$12) {
      $Check(Self,"").FDC.strokeRect(aLeft$17,aTop$17,aWidth$12,aHeight$12);
   }
   /// procedure TW3Canvas.StrokeRectF(const aRect: TRectF)
   ,StrokeRectF:function(Self, aRect$14) {
      $Check(Self,"").FDC.strokeRect(aRect$14.Left,aRect$14.Top,TRectF$Width(aRect$14),TRectF$Height(aRect$14));
   }
   /// procedure TW3Canvas.StrokeTextF(text: String; x: Float; y: Float)
   ,StrokeTextF$1:function(Self, text$3, x$80, y$68) {
      $Check(Self,"").FDC.strokeText(text$3,x$80,y$68);
   }
   /// procedure TW3Canvas.StrokeTextF(text: String; x: Float; y: Float; maxWidth: Float)
   ,StrokeTextF:function(Self, text$4, x$81, y$69, maxWidth$2) {
      $Check(Self,"").FDC.strokeText(text$4,x$81,y$69,maxWidth$2);
   }
   /// function TW3Canvas.ToDataURL(aMimeType: String) : String
   ,ToDataURL:function(Self, aMimeType) {
      return $Check($Check(Self,"").FDC,"").canvas.toDataURL(aMimeType);
   }
   /// function TW3Canvas.ToImageData() : TW3ImageData
   ,ToImageData:function(Self) {
      var Result = null;
      var mTemp$9 = null;
      var wd$5 = 0;
      var hd$5 = 0;
      wd$5 = $Check($Check($Check(Self,"").FDC,"").canvas,"").width;
      hd$5 = $Check($Check($Check(Self,"").FDC,"").canvas,"").height;
      try {
         mTemp$9 = $Check(Self,"").FDC.getImageData(0,0,wd$5,hd$5);
      } catch ($e) {
         var e$17 = $W($e);
         throw Exception.Create($New(Exception),"Failed to extract data, browser threw exception: "+$Check(e$17,"").FMessage);
      }
      if (mTemp$9) {
         Result = TObject.Create($New(TW3ImageData));
         TW3ImageData.FromImageData(Result,mTemp$9);
      }
      return Result
   }
   /// procedure TW3Canvas.Transform(m11: Float; m12: Float; m21: Float; m22: Float; dx: Float; dy: Float)
   ,Transform:function(Self, m11, m12, m21, m22, dx$10, dy$11) {
      $Check(Self,"").FDC.transform(m11,m12,m21,m22,dx$10,dy$11);
   }
   /// procedure TW3Canvas.Translate(const pt: TPointF)
   ,Translate$1:function(Self, pt$5) {
      $Check(Self,"").FDC.translate(pt$5.X,pt$5.Y);
   }
   /// procedure TW3Canvas.Translate(tx: Float; ty: Float)
   ,Translate:function(Self, tx, ty) {
      $Check(Self,"").FDC.translate(tx,ty);
   }
   /// procedure TW3Canvas.UseGradient(aGradient: TW3CanvasGradient)
   ,UseGradient:function(Self, aGradient) {
      if (aGradient!==null) {
         $Check($Check(Self,"").FDC,"").fillStyle = $Check(aGradient,"").FHandle$2;
      } else {
         throw Exception.Create($New(Exception),"Failed to use gradient, object was nil error");
      }
   }
   /// procedure TW3Canvas.UsePattern(aPattern: TW3CanvasPattern)
   ,UsePattern:function(Self, aPattern) {
      $Check($Check(Self,"").FDC,"").fillStyle = $Check(aPattern,"").FHandle$1;
   }
   /// procedure TW3Canvas.VertLine(x: Float; y1: Float; y2: Float)
   ,VertLine:function(Self, x$82, y1$20, y2$12) {
      $Check(Self,"").FDC.moveTo(x$82,y1$20);
      $Check(Self,"").FDC.lineTo(x$82,y2$12);
   }
   ,Destroy:TObject.Destroy
   ,Create$30$:function($){return $.ClassType.Create$30.apply($.ClassType, arguments)}
   ,Restore$:function($){return $.ClassType.Restore($)}
   ,Save$:function($){return $.ClassType.Save($)}
};
/// TW3BackgroundGraphicContext = class (TW3CustomGraphicContext)
var TW3BackgroundGraphicContext = {
   $ClassName:"TW3BackgroundGraphicContext",
   $Parent:TW3CustomGraphicContext
   ,$Init:function ($) {
      TW3CustomGraphicContext.$Init($);
      $.FContext$1 = undefined;
      $.FHeight = $.FWidth = 0;
      $.FName = "";
   }
   /// constructor TW3BackgroundGraphicContext.Create(aName: String; aWidth: Integer; aHeight: Integer)
   ,Create$31:function(Self, aName$1, aWidth$13, aHeight$13) {
      TObject.Create(Self);
      aName$1 = Trim$_String_(aName$1);
      if (aName$1.length>0) {
         if ((aWidth$13>0)&&(aHeight$13>0)) {
            $Check(Self,"").FName = aName$1;
            TW3CustomGraphicContext.SetSize$($Check(Self,""),aWidth$13,aHeight$13);
         } else {
            throw Exception.Create($New(EW3Exception),"Background-canvas size must be positive");
         }
      } else {
         throw Exception.Create($New(EW3Exception),"Background-canvas name cannot be empty");
      }
      return Self
   }
   /// function TW3BackgroundGraphicContext.getDC() : THandle
   ,GetDC:function(Self) {
      return $Check(Self,"").FContext$1;
   }
   /// function TW3BackgroundGraphicContext.getHandle() : THandle
   ,GetHandle:function(Self) {
      return null;
   }
   /// function TW3BackgroundGraphicContext.getHeight() : Integer
   ,GetHeight:function(Self) {
      return $Check(Self,"").FHeight;
   }
   /// function TW3BackgroundGraphicContext.getOwnsReference() : Boolean
   ,getOwnsReference:function(Self) {
      return true;
   }
   /// function TW3BackgroundGraphicContext.getWidth() : Integer
   ,GetWidth:function(Self) {
      return $Check(Self,"").FWidth;
   }
   /// function TW3BackgroundGraphicContext.IsSupported() : Boolean
   ,IsSupported:function() {
      return (document.getCSSCanvasContext?true:false);
   }
   /// procedure TW3BackgroundGraphicContext.ReleaseDC()
   ,ReleaseDC:function(Self) {
      $Check(Self,"").FContext$1 = null;
      $Check(Self,"").FWidth = 0;
      $Check(Self,"").FHeight = 0;
   }
   /// procedure TW3BackgroundGraphicContext.SetSize(aNewWidth: Integer; aNewHeight: Integer)
   ,SetSize:function(Self, aNewWidth$2, aNewHeight$2) {
      var mRef$28 = undefined;
      var mName = "";
      if ((aNewWidth$2!=$Check(Self,"").FWidth)||(aNewHeight$2!=$Check(Self,"").FHeight)) {
         if ((aNewWidth$2>0)&&(aNewHeight$2>0)) {
            mName = $Check(Self,"").FName;
            try {
               mRef$28 = document.getCSSCanvasContext("2d",mName,aNewWidth$2,aNewHeight$2);
               if (!mRef$28) {
                  throw Exception.Create($New(Exception),"Failed to hook CSS canvas");
               }
               $Check(Self,"").FContext$1 = mRef$28;
               $Check(Self,"").FWidth = aNewWidth$2;
               $Check(Self,"").FHeight = aNewHeight$2;
            } catch ($e) {
               var e$18 = $W($e);
               throw EW3Exception.CreateFmt($New(EW3Exception),"Background-canvas resize failed: %s",[$Check(e$18,"").FMessage]);
            }
         } else {
            throw Exception.Create($New(EW3Exception),"Background-canvas size must be positive");
         }
      }
   }
   ,Destroy:TObject.Destroy
   ,Allocate:TW3CustomGraphicContext.Allocate
   ,GetDC$:function($){return $.ClassType.GetDC($)}
   ,GetHandle$:function($){return $.ClassType.GetHandle($)}
   ,GetHeight$:function($){return $.ClassType.GetHeight($)}
   ,getOwnsReference$:function($){return $.ClassType.getOwnsReference($)}
   ,GetWidth$:function($){return $.ClassType.GetWidth($)}
   ,Release:TW3CustomGraphicContext.Release
   ,ReleaseDC$:function($){return $.ClassType.ReleaseDC($)}
   ,SetSize$:function($){return $.ClassType.SetSize.apply($.ClassType, arguments)}
   ,Create$31$:function($){return $.ClassType.Create$31.apply($.ClassType, arguments)}
};
function GetStrideAlign(Value$29, ElementSize, AlignSize) {
   var Result = 0;
   Result = Value$29*ElementSize;
   if ((Result%AlignSize)>0) {
      Result = (Result+AlignSize)-(Result%AlignSize);
   }
   return Result
};
/// JMouseWheelDeltaMode enumeration
var JMouseWheelDeltaMode = [ "Pixel", "Line", "Page" ];
/// JMouseButton enumeration
var JMouseButton = [ "Left", "Middle", "Right" ];
/// TW3CSSClassStyleNames = class (TW3OwnedObject)
var TW3CSSClassStyleNames = {
   $ClassName:"TW3CSSClassStyleNames",
   $Parent:TW3OwnedObject
   ,$Init:function ($) {
      TW3OwnedObject.$Init($);
      $.FCache = [];
      $.FCheck = 0;
      $.FToken = "";
   }
   /// function TW3CSSClassStyleNames.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject$4) {
      return (aObject$4!==null)&&$Is(aObject$4,TW3CustomControl);
   }
   /// function TW3CSSClassStyleNames.Add(aCSSClassName: String) : Integer
   ,Add$2:function(Self, aCSSClassName) {
      var Result = 0;
      var mRef$29 = undefined;
      if ($Check(Self,"").FOwner) {
         mRef$29 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$29) {
            w3_AddClass(mRef$29,aCSSClassName);
            $Check(Self,"").FCache.push(aCSSClassName);
            Result = $Check(Self,"").FCache.length-1;
         } else {
            throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Add", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Add", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
      return Result
   }
   /// procedure TW3CSSClassStyleNames.CacheToTag()
   ,CacheToTag:function(Self) {
      var mText$3 = "";
      var mRef$30 = undefined;
      var x$83 = 0;
      if ($Check(Self,"").FOwner) {
         var $temp93;
         for(x$83 = 0,$temp93 = $Check(Self,"").FCache.length;x$83<$temp93;x$83++) {
            if (x$83<($Check(Self,"").FCache.length-1)) {
               mText$3 = mText$3+$DIdxR($Check(Self,"").FCache,x$83,"")+" ";
            } else {
               mText$3+=$DIdxR($Check(Self,"").FCache,x$83,"");
            }
         }
         mRef$30 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$30) {
            mRef$30.setAttribute($Check(Self,"").FToken,mText$3);
         } else {
            throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.CacheToTag", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.CacheToTag", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
   }
   /// procedure TW3CSSClassStyleNames.Clear()
   ,Clear$4:function(Self) {
      var mRef$31 = undefined;
      $Check(Self,"").FCache.length=0;
      $Check(Self,"").FCheck = -1;
      if ($Check(Self,"").FOwner) {
         mRef$31 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$31) {
            mRef$31.setAttribute($Check(Self,"").FToken,"");
         } else {
            throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Clear", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Clear", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
   }
   /// constructor TW3CSSClassStyleNames.Create(AOwner: TObject)
   ,Create$7:function(Self, AOwner$4) {
      TW3OwnedObject.Create$7(Self,AOwner$4);
      $Check(Self,"").FToken = "class";
      $Check(Self,"").FCache = [];
      return Self
   }
   /// destructor TW3CSSClassStyleNames.Destroy()
   ,Destroy:function(Self) {
      $Check(Self,"").FCache.length=0;
      TObject.Destroy(Self);
   }
   /// function TW3CSSClassStyleNames.getCount() : Integer
   ,getCount:function(Self) {
      var Result = 0;
      TW3CSSClassStyleNames.UpdateCache(Self);
      Result = $Check(Self,"").FCache.length;
      return Result
   }
   /// function TW3CSSClassStyleNames.getItem(index: Integer) : String
   ,getItem:function(Self, index$9) {
      var Result = "";
      TW3CSSClassStyleNames.UpdateCache(Self);
      Result = $DIdxR($Check(Self,"").FCache,index$9,"");
      return Result
   }
   /// function TW3CSSClassStyleNames.IndexOf(aCSSClassName: String) : Integer
   ,IndexOf$2:function(Self, aCSSClassName$1) {
      var Result = 0;
      var x$84 = 0;
      Result = -1;
      if ($Check(Self,"").FOwner) {
         aCSSClassName$1 = (Trim$_String_(aCSSClassName$1)).toLowerCase();
         if (aCSSClassName$1.length>0) {
            var $temp94;
            for(x$84 = 0,$temp94 = $Check(Self,"").FCache.length;x$84<$temp94;x$84++) {
               if (($DIdxR($Check(Self,"").FCache,x$84,"")).toLowerCase()==aCSSClassName$1) {
                  Result = x$84;
                  break;
               }
            }
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.IndexOf", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
      return Result
   }
   /// procedure TW3CSSClassStyleNames.ParseToCache(aValue: String)
   ,ParseToCache:function(Self, aValue$97) {
      aValue$97={v:aValue$97};
      var xpos$2 = 0;
      var mTemp$10 = "";
      aValue$97.v = Trim$_String_(aValue$97.v);
      $Check(Self,"").FCheck = aValue$97.v.length;
      if ($Check(Self,"").FCheck>0) {
         $Check(Self,"").FCache.length=0;
         xpos$2 = (aValue$97.v.indexOf(" ")+1);
         if (xpos$2>0) {
            while (xpos$2>0) {
               mTemp$10 = aValue$97.v.substr(0,(xpos$2-1));
               $Check(Self,"").FCache.push(mTemp$10);
               Delete(aValue$97,1,xpos$2);
               xpos$2 = (aValue$97.v.indexOf(" ")+1);
            }
            if (aValue$97.v.length>0) {
               $Check(Self,"").FCache.push(aValue$97.v);
            }
         } else if (aValue$97.v.length>0) {
            $Check(Self,"").FCache.push(aValue$97.v);
         }
      }
   }
   /// function TW3CSSClassStyleNames.Remove(index: Integer) : String
   ,Remove$2:function(Self, index$10) {
      var Result = "";
      var mRef$32 = undefined;
      if ($Check(Self,"").FOwner) {
         mRef$32 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$32) {
            w3_RemoveClass(mRef$32,$DIdxR($Check(Self,"").FCache,index$10,""));
            Result = $DIdxR($Check(Self,"").FCache,index$10,"");
            $Check(Self,"").FCache.splice(index$10,1)
            ;
         } else {
            throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Remove", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.Remove", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
      return Result
   }
   /// function TW3CSSClassStyleNames.RemoveByName(aCSSClassName: String) : String
   ,RemoveByName:function(Self, aCSSClassName$2) {
      var Result = "";
      var mRef$33 = undefined;
      var mIndex$20 = 0;
      if ($Check(Self,"").FOwner) {
         mRef$33 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$33) {
            w3_RemoveClass(mRef$33,aCSSClassName$2);
            mIndex$20 = TW3CSSClassStyleNames.IndexOf$2(Self,aCSSClassName$2);
            if (mIndex$20>=0) {
               $Check(Self,"").FCache.splice(mIndex$20,1)
               ;
            }
            Result = aCSSClassName$2;
         }
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.RemoveByName", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.RemoveByName", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
      return Result
   }
   /// procedure TW3CSSClassStyleNames.setItem(index: Integer; aValue: String)
   ,setItem:function(Self, index$11, aValue$98) {
      TW3CSSClassStyleNames.UpdateCache(Self);
      $DIdxW($Check(Self,"").FCache,index$11,aValue$98,"");
      TW3CSSClassStyleNames.CacheToTag(Self);
   }
   /// function TW3CSSClassStyleNames.toString() : String
   ,toString:function(Self) {
      var Result = "";
      var mText$4 = "";
      var x$85 = 0;
      if ($Check(Self,"").FOwner) {
         TW3CSSClassStyleNames.UpdateCache(Self);
         var $temp95;
         for(x$85 = 0,$temp95 = $Check(Self,"").FCache.length;x$85<$temp95;x$85++) {
            if (x$85<($Check(Self,"").FCache.length-1)) {
               mText$4 = mText$4+$DIdxR($Check(Self,"").FCache,x$85,"")+" ";
            } else {
               mText$4+=$DIdxR($Check(Self,"").FCache,x$85,"");
            }
         }
         Result = mText$4;
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.toString", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
      return Result
   }
   /// procedure TW3CSSClassStyleNames.UpdateCache()
   ,UpdateCache:function(Self) {
      var mRef$34 = undefined;
      var mText$5 = "";
      if ($Check(Self,"").FOwner) {
         mRef$34 = $Check($As($Check(Self,"").FOwner,TW3TagObj),"").FHandle$3;
         if (mRef$34) {
            mText$5 = TVariant.AsString(mRef$34.getAttribute($Check(Self,"").FToken));
            if (mText$5.length!=$Check(Self,"").FCheck) {
               TW3CSSClassStyleNames.ParseToCache(Self,mText$5);
            }
         } else {
            throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.UpdateCache", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
         }
      } else {
         throw EW3Exception.CreateFmt($New(EW3CSSClassStyleNames),"Method %s in class %s threw exception [%s]",["TW3CSSClassStyleNames.UpdateCache", TObject.ClassName($Check(Self,"").ClassType), "Owner tag-object is NIL error"]);
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7$:function($){return $.ClassType.Create$7.apply($.ClassType, arguments)}
};
/// EW3CSSClassStyleNames = class (EW3Exception)
var EW3CSSClassStyleNames = {
   $ClassName:"EW3CSSClassStyleNames",
   $Parent:EW3Exception
   ,$Init:function ($) {
      EW3Exception.$Init($);
   }
   ,Destroy:Exception.Destroy
};
/// TW3TouchList = class (TObject)
var TW3TouchList = {
   $ClassName:"TW3TouchList",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FObjects = [];
   }
   /// anonymous TSourceMethodSymbol
   ,a$4:function(Self, index$12) {
      return $DIdxR($Check(Self,"").FObjects,index$12,"");
   }
   /// anonymous TSourceMethodSymbol
   ,a$3:function(Self) {
      return $Check(Self,"").FObjects.length;
   }
   /// procedure TW3TouchList.Clear()
   ,Clear$3:function(Self) {
      $Check(Self,"").FObjects.length=0;
   }
   /// procedure TW3TouchList.Consume(refObj: JTouchList)
   ,Consume:function(Self, refObj) {
      TW3TouchList.Update$2(Self,refObj);
   }
   /// procedure TW3TouchList.Update(refObj: JTouchList)
   ,Update$2:function(Self, refObj$1) {
      var mCount$3 = 0;
      var x$86 = 0;
      var mObj$9 = null;
      mCount$3 = $Check(refObj$1,"").length;
      if (mCount$3==$Check(Self,"").FObjects.length) {
         var $temp96;
         for(x$86 = 0,$temp96 = mCount$3;x$86<$temp96;x$86++) {
            TW3Touch.Consume$1($DIdxR($Check(Self,"").FObjects,x$86,""),refObj$1[x$86]);
         }
      } else {
         TW3TouchList.Clear$3(Self);
         var $temp97;
         for(x$86 = 0,$temp97 = mCount$3;x$86<$temp97;x$86++) {
            mObj$9 = TObject.Create($New(TW3Touch));
            TW3Touch.Consume$1(mObj$9,refObj$1[x$86]);
            $Check(Self,"").FObjects.push(mObj$9);
         }
      }
   }
   ,Destroy:TObject.Destroy
};
/// TW3TouchData = class (TObject)
var TW3TouchData = {
   $ClassName:"TW3TouchData",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FChanged = $.FTouches = null;
   }
   /// function TW3TouchData.GetChanged() : TW3TouchList
   ,GetChanged:function(Self) {
      var Result = null;
      if (!$Check(Self,"").FChanged) {
         $Check(Self,"").FChanged = TObject.Create($New(TW3TouchList));
         TW3TouchList.Update$2($Check(Self,"").FChanged,$Check(event,"").changedTouches);
      }
      Result = $Check(Self,"").FChanged;
      return Result
   }
   /// function TW3TouchData.GetTouches() : TW3TouchList
   ,GetTouches:function(Self) {
      var Result = null;
      if (!$Check(Self,"").FTouches) {
         $Check(Self,"").FTouches = TObject.Create($New(TW3TouchList));
         TW3TouchList.Update$2($Check(Self,"").FTouches,$Check(event,"").touches);
      }
      Result = $Check(Self,"").FTouches;
      return Result
   }
   /// procedure TW3TouchData.Update(eventObj: JTouchEvent)
   ,Update$3:function(Self, eventObj$17) {
      if ($Check(Self,"").FTouches) {
         TW3TouchList.Update$2($Check(Self,"").FTouches,$Check(eventObj$17,"").touches);
      }
      if ($Check(Self,"").FChanged) {
         TW3TouchList.Update$2($Check(Self,"").FChanged,$Check(eventObj$17,"").changedTouches);
      }
   }
   ,Destroy:TObject.Destroy
};
/// TW3Touch = class (TObject)
var TW3Touch = {
   $ClassName:"TW3Touch",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FClientX = $.FClientY = $.FPageX = $.FPageY = $.FScreenX = $.FScreenY = 0;
      $.FIdent = undefined;
      $.FTarget = null;
   }
   /// procedure TW3Touch.Consume(touch: JTouch)
   ,Consume$1:function(Self, touch) {
      $Check(Self,"").FScreenX = $Check(touch,"").screenX;
      $Check(Self,"").FScreenY = $Check(touch,"").screenY;
      $Check(Self,"").FClientX = $Check(touch,"").clientX;
      $Check(Self,"").FClientY = $Check(touch,"").clientY;
      $Check(Self,"").FPageX = $Check(touch,"").pageX;
      $Check(Self,"").FPageY = $Check(touch,"").pageY;
      $Check(Self,"").FIdent = $Check(touch,"").identifier;
      $Check(Self,"").FTarget = TVariant.AsObject($Check(touch,"").target);
   }
   /// function TW3Touch.ToString() : String
   ,ToString$5:function(Self) {
      return "ScreenX = "+$Check(Self,"").FScreenX.toString()+"\r"+"ScreenY = "+$Check(Self,"").FScreenY.toString()+"\r"+"ClientX = "+$Check(Self,"").FClientX.toString()+"\r"+"ClientY = "+$Check(Self,"").FClientY.toString()+"\r"+"PageX = "+$Check(Self,"").FPageX.toString()+"\r"+"PageY = "+$Check(Self,"").FPageY.toString()+"\r"+"Identifier = "+TVariant.AsString($Check(Self,"").FIdent)+"\r";
   }
   ,Destroy:TObject.Destroy
   ,ToString$5$:function($){return $.ClassType.ToString$5($)}
};
/// TW3GestureData = class (TObject)
var TW3GestureData = {
   $ClassName:"TW3GestureData",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FRotation = $.FScale = 0;
   }
   /// procedure TW3GestureData.Consume(refObj: THandle)
   ,Consume$2:function(Self, refObj$2) {
      $Check(Self,"").FRotation = Number(refObj$2.rotation);
      $Check(Self,"").FScale = Number(refObj$2.scale);
   }
   /// function TW3GestureData.ToString() : String
   ,ToString$6:function(Self) {
      return ("Rotation = "+$Check(Self,"").FRotation.toString()+"\rScale = "+$Check(Self,"").FScale.toString());
   }
   /// procedure TW3GestureData.Update()
   ,Update$4:function(Self) {
      TW3GestureData.Consume$2(Self,event);
   }
   ,Destroy:TObject.Destroy
   ,ToString$6$:function($){return $.ClassType.ToString$6($)}
};
/// TW3Borders = class (TW3OwnedObject)
var TW3Borders = {
   $ClassName:"TW3Borders",
   $Parent:TW3OwnedObject
   ,$Init:function ($) {
      TW3OwnedObject.$Init($);
      $.FBottom = $.FLeft = $.FRight = $.FTop = null;
   }
   /// function TW3Borders.AcceptParent(aObject: TObject) : Boolean
   ,AcceptParent:function(Self, aObject$5) {
      return $Is(aObject$5,TW3TagObj);
   }
   /// constructor TW3Borders.Create(AOwner: TObject)
   ,Create$7:function(Self, AOwner$5) {
      TW3OwnedObject.Create$7(Self,AOwner$5);
      $Check(Self,"").FLeft = TW3Border.Create$36($New(TW3Border),Self,0);
      $Check(Self,"").FTop = TW3Border.Create$36($New(TW3Border),Self,1);
      $Check(Self,"").FRight = TW3Border.Create$36($New(TW3Border),Self,2);
      $Check(Self,"").FBottom = TW3Border.Create$36($New(TW3Border),Self,3);
      return Self
   }
   /// destructor TW3Borders.Destroy()
   ,Destroy:function(Self) {
      TObject.Free($Check(Self,"").FLeft);
      TObject.Free($Check(Self,"").FTop);
      TObject.Free($Check(Self,"").FRight);
      TObject.Free($Check(Self,"").FBottom);
      TObject.Destroy(Self);
   }
   /// function TW3Borders.getEdge(aKind: TW3BorderEdge) : TW3Border
   ,getEdge:function(Self, aKind$2) {
      var Result = null;
      switch (aKind$2) {
         case 0 :
            Result = $Check(Self,"").FLeft;
            break;
         case 1 :
            Result = $Check(Self,"").FTop;
            break;
         case 2 :
            Result = $Check(Self,"").FRight;
            break;
         case 3 :
            Result = $Check(Self,"").FBottom;
            break;
      }
      return Result
   }
   /// function TW3Borders.getHSpace() : Integer
   ,getHSpace:function(Self) {
      return TW3Border.getWidth$3($Check(Self,"").FLeft)+TW3Border.getPadding($Check(Self,"").FLeft)+TW3Border.getWidth$3($Check(Self,"").FRight)+TW3Border.getPadding($Check(Self,"").FRight);
   }
   /// function TW3Borders.getVSpace() : Integer
   ,getVSpace:function(Self) {
      return TW3Border.getWidth$3($Check(Self,"").FTop)+TW3Border.getPadding($Check(Self,"").FTop)+TW3Border.getWidth$3($Check(Self,"").FBottom)+TW3Border.getPadding($Check(Self,"").FBottom);
   }
   /// procedure TW3Borders.setStyle(const aValue: TW3BorderEdgeStyle)
   ,setStyle:function(Self, aValue$99) {
      TW3Border.setStyle$1($Check(Self,"").FLeft,aValue$99);
      TW3Border.setStyle$1($Check(Self,"").FTop,aValue$99);
      TW3Border.setStyle$1($Check(Self,"").FRight,aValue$99);
      TW3Border.setStyle$1($Check(Self,"").FBottom,aValue$99);
   }
   /// function TW3Borders.toString() : String
   ,toString$1:function(Self) {
      var Result = "";
      var mText$6 = "";
      mText$6 = "Borders:|HSpace ="+TW3Borders.getHSpace(Self).toString()+"|"+"VSpace ="+TW3Borders.getVSpace(Self).toString()+"|"+TW3Border.ToString$7($Check(Self,"").FLeft)+"|"+TW3Border.ToString$7($Check(Self,"").FTop)+"|"+TW3Border.ToString$7($Check(Self,"").FRight)+"|"+TW3Border.ToString$7($Check(Self,"").FBottom);
      Result = StrReplace(mText$6,"|","\r\n");
      return Result
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,AcceptParent$:function($){return $.ClassType.AcceptParent.apply($.ClassType, arguments)}
   ,Create$7$:function($){return $.ClassType.Create$7.apply($.ClassType, arguments)}
};
/// TW3BorderEdgeStyle enumeration
var TW3BorderEdgeStyle = [ "besNone", "besSolid", "besDotted", "besDouble", "besGroove", "besInset", "besOutset" ];
/// TW3BorderEdge enumeration
var TW3BorderEdge = [ "beLeft", "beTop", "beRight", "beBottom" ];
/// TW3Border = class (TObject)
var TW3Border = {
   $ClassName:"TW3Border",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FEdge = 0;
      $.FEdgeName = "";
      $.FOwner$2 = null;
   }
   /// constructor TW3Border.Create(AOwner: TW3Borders; AEdge: TW3BorderEdge)
   ,Create$36:function(Self, AOwner$6, AEdge) {
      TObject.Create(Self);
      $Check(Self,"").FOwner$2 = AOwner$6;
      $Check(Self,"").FEdge = $Check(Self,"").FEdge;
      switch (AEdge) {
         case 0 :
            $Check(Self,"").FEdgeName = "Left";
            break;
         case 1 :
            $Check(Self,"").FEdgeName = "Top";
            break;
         case 2 :
            $Check(Self,"").FEdgeName = "Right";
            break;
         case 3 :
            $Check(Self,"").FEdgeName = "Bottom";
            break;
      }
      return Self
   }
   /// function TW3Border.EdgeStyleString(aValue: TW3BorderEdgeStyle) : String
   ,EdgeStyleString:function(Self, aValue$100) {
      var Result = "";
      switch (aValue$100) {
         case 1 :
            Result = "solid";
            break;
         case 2 :
            Result = "dotted";
            break;
         case 3 :
            Result = "double";
            break;
         case 4 :
            Result = "groove";
            break;
         case 5 :
            Result = "inset";
            break;
         case 6 :
            Result = "outset";
            break;
         default :
            Result = "none";
      }
      return Result
   }
   /// function TW3Border.getColor() : TColor
   ,getColor$2:function(Self) {
      var Result = 0;
      var mRef$35 = undefined;
      var mKey = "";
      var mText$7 = "";
      Result = 0;
      mRef$35 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$35) {
         mKey = "border-"+$Check(Self,"").FEdgeName+"-Color";
         mText$7 = w3_getStyleAsStr(mRef$35,mKey);
         Result = StrToColor(mText$7);
      }
      return Result
   }
   /// function TW3Border.getMargin() : Integer
   ,getMargin:function(Self) {
      var Result = 0;
      var mRef$36 = undefined;
      var mKey$1 = "";
      Result = 0;
      mRef$36 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$36) {
         mKey$1 = "margin-"+$Check(Self,"").FEdgeName;
         Result = w3_getStyleAsInt(mRef$36,mKey$1);
      }
      return Result
   }
   /// function TW3Border.getPadding() : Integer
   ,getPadding:function(Self) {
      var Result = 0;
      var mRef$37 = undefined;
      var mKey$2 = "";
      Result = 0;
      mRef$37 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$37) {
         mKey$2 = "padding-"+$Check(Self,"").FEdgeName;
         Result = w3_getStyleAsInt(mRef$37,mKey$2);
      }
      return Result
   }
   /// function TW3Border.getStyle() : TW3BorderEdgeStyle
   ,getStyle:function(Self) {
      var Result = 0;
      var mRef$38 = undefined;
      var mKey$3 = "";
      var mValue$3 = "";
      Result = 0;
      mRef$38 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$38) {
         mKey$3 = "border-"+$Check(Self,"").FEdgeName+"-Style";
         mValue$3 = w3_getStyleAsStr(mRef$38,mKey$3);
         mValue$3 = Trim$_String_((mValue$3).toLowerCase());
         switch (mValue$3) {
            case "solid" :
               Result = 1;
               break;
            case "dotted" :
               Result = 2;
               break;
            case "double" :
               Result = 3;
               break;
            case "groove" :
               Result = 4;
               break;
            case "inset" :
               Result = 5;
               break;
            case "outset" :
               Result = 6;
               break;
         }
      }
      return Result
   }
   /// function TW3Border.getWidth() : Integer
   ,getWidth$3:function(Self) {
      var Result = 0;
      var mRef$39 = undefined;
      var mKey$4 = "";
      Result = 0;
      mRef$39 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$39) {
         mKey$4 = "border-"+$Check(Self,"").FEdgeName+"-Width";
         Result = w3_getStyleAsInt(mRef$39,mKey$4);
      }
      return Result
   }
   /// procedure TW3Border.setColor(aValue: TColor)
   ,setColor$2:function(Self, aValue$101) {
      var mRef$40 = undefined;
      var mKey$5 = "";
      mRef$40 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$40) {
         mKey$5 = "border-"+$Check(Self,"").FEdgeName+"-Color";
         mRef$40.style[mKey$5] = ColorToStr(aValue$101);
      } else {
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3Border.setColor", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      }
   }
   /// procedure TW3Border.setmargin(const aValue: Integer)
   ,setmargin:function(Self, aValue$102) {
      var mRef$41 = undefined;
      var mKey$6 = "";
      mRef$41 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$41) {
         mKey$6 = "margin-"+$Check(Self,"").FEdgeName;
         mRef$41.style[mKey$6] = TInteger.ToPxStr(aValue$102);
      } else {
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3Border.setmargin", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      }
   }
   /// procedure TW3Border.setPadding(aValue: Integer)
   ,setPadding:function(Self, aValue$103) {
      var mRef$42 = undefined;
      var mKey$7 = "";
      mRef$42 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$42) {
         mKey$7 = "padding"+$Check(Self,"").FEdgeName;
         mRef$42.style[mKey$7] = TInteger.ToPxStr(aValue$103);
      } else {
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3Border.setPadding", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      }
   }
   /// procedure TW3Border.setStyle(aValue: TW3BorderEdgeStyle)
   ,setStyle$1:function(Self, aValue$104) {
      var mRef$43 = undefined;
      var mKey$8 = "";
      mRef$43 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$43) {
         mKey$8 = "border-"+$Check(Self,"").FEdgeName+"-Style";
         w3_setStyle(mRef$43,mKey$8,TW3Border.EdgeStyleString(Self,aValue$104));
      } else {
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3Border.setStyle", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      }
   }
   /// procedure TW3Border.setWidth(aValue: Integer)
   ,setWidth:function(Self, aValue$105) {
      var mRef$44 = undefined;
      var mKey$9 = "";
      mRef$44 = $Check($As($Check($Check(Self,"").FOwner$2,"").FOwner,TW3TagObj),"").FHandle$3;
      if (mRef$44) {
         mKey$9 = "border-"+$Check(Self,"").FEdgeName+"-Width";
         w3_setStyle(mRef$44,mKey$9,TInteger.ToPxStr(aValue$105));
      } else {
         throw EW3Exception.CreateFmt($New(EW3TagObj),"Method %s in class %s threw exception [%s]",["TW3Border.setWidth", TObject.ClassName($Check(Self,"").ClassType), "invalid owner handle error"]);
      }
   }
   /// function TW3Border.ToString() : String
   ,ToString$7:function(Self) {
      var Result = "";
      var mText$8 = "";
      mText$8 = $Check(Self,"").FEdgeName+" = {|"+"Width: "+TW3Border.getWidth$3(Self).toString()+"|"+"Style: "+TW3Border.EdgeStyleString(Self,TW3Border.getStyle(Self))+"|"+"Padding:"+TW3Border.getPadding(Self).toString()+"|"+"Color: "+ColorToStr(TW3Border.getColor$2(Self))+"|"+"Margin: "+TW3Border.getMargin(Self).toString()+"|"+"}";
      Result = StrReplace(mText$8,"|","\r\n");
      return Result
   }
   ,Destroy:TObject.Destroy
};
/// TW3CustomAnimation = class (TObject)
var TW3CustomAnimation = {
   $ClassName:"TW3CustomAnimation",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FBusy = false;
      $.FDuration = 0;
      $.FInEvnCB = null;
      $.FOnBegins = null;
      $.FOnEnds = null;
      $.FTarget$1 = null;
   }
   /// procedure TW3CustomAnimation.CBBegins()
   ,CBBegins:function(Self) {
      if ($Check(Self,"").FOnBegins) {
         $CheckFunc($Check(Self,"").FOnBegins,"")(Self);
      }
   }
   /// procedure TW3CustomAnimation.CBEnds()
   ,CBEnds:function(Self) {
      TW3CustomAnimation.FinalizeTransition$($Check(Self,""));
      if ($Check(Self,"").FOnEnds) {
         $CheckFunc($Check(Self,"").FOnEnds,"")(Self);
      }
   }
   /// constructor TW3CustomAnimation.Create()
   ,Create$41:function(Self) {
      TObject.Create(Self);
      $Check(Self,"").FDuration = DefaultDuration;
      return Self
   }
   /// destructor TW3CustomAnimation.Destroy()
   ,Destroy:function(Self) {
      if ($Check(Self,"").FBusy&&($Check(Self,"").FTarget$1!==null)) {
         try {
            TW3CustomAnimation.FinalizeTransition$($Check(Self,""));
         } catch ($e) {
            var e$19 = $W($e);
            /* null */
         }
      }
      TObject.Destroy(Self);
   }
   /// procedure TW3CustomAnimation.Execute(TargetObj: TW3TagObj)
   ,Execute:function(Self, TargetObj) {
      if (TargetObj) {
         if ($Check(Self,"").FBusy) {
            throw Exception.Create($New(Exception),"Transition is already in progress error");
         } else {
            $Check(Self,"").FTarget$1 = TargetObj;
            TW3CustomAnimation.SetupTransition$($Check(Self,""));
         }
      } else {
         throw Exception.Create($New(Exception),"Target-object was NIL error");
      }
   }
   /// procedure TW3CustomAnimation.ExecuteEx(TargetObj: TW3TagObj; BeginHandler: TFxAnimationBeginsEvent; EndHandler: TFxAnimationEndsEvent)
   ,ExecuteEx:function(Self, TargetObj$1, BeginHandler, EndHandler) {
      if (TargetObj$1) {
         if ($Check(Self,"").FBusy) {
            throw Exception.Create($New(Exception),"Transition is already in progress error");
         } else {
            $Check(Self,"").FTarget$1 = TargetObj$1;
            $Check(Self,"").FOnBegins = BeginHandler;
            $Check(Self,"").FOnEnds = EndHandler;
            TW3CustomAnimation.SetupTransition$($Check(Self,""));
         }
      } else {
         throw Exception.Create($New(Exception),"Target-object was NIL error");
      }
   }
   /// procedure TW3CustomAnimation.FinalizeTransition()
   ,FinalizeTransition:function(Self) {
      w3_RemoveEvent($Check($Check(Self,"").FTarget$1,"").FHandle$3,"animationend",$Check(Self,"").FInEvnCB,true);
      w3_RemoveEvent($Check($Check(Self,"").FTarget$1,"").FHandle$3,"webkitAnimationEnd",$Check(Self,"").FInEvnCB,true);
      $Check(Self,"").FBusy = false;
   }
   /// procedure TW3CustomAnimation.SetDuration(Value: Float)
   ,SetDuration:function(Self, Value$30) {
      if ($Check(Self,"").FBusy) {
         throw Exception.Create($New(Exception),"Duration cannot be altered while the transition is active error");
      } else {
         $Check(Self,"").FDuration = Value$30;
      }
   }
   /// procedure TW3CustomAnimation.SetupTransition()
   ,SetupTransition:function(Self) {
      $Check(Self,"").FBusy = true;
      $Check(Self,"").FInEvnCB = $Event0(Self,TW3CustomAnimation.CBEnds);
      w3_AddEvent($Check($Check(Self,"").FTarget$1,"").FHandle$3,"animationend",$Check(Self,"").FInEvnCB,true);
      w3_AddEvent($Check($Check(Self,"").FTarget$1,"").FHandle$3,"webkitAnimationEnd",$Check(Self,"").FInEvnCB,true);
      TW3CustomAnimation.CBBegins(Self);
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$41$:function($){return $.ClassType.Create$41($)}
   ,FinalizeTransition$:function($){return $.ClassType.FinalizeTransition($)}
   ,SetupTransition$:function($){return $.ClassType.SetupTransition($)}
};
/// TW3TransitionAnimation = class (TW3CustomAnimation)
var TW3TransitionAnimation = {
   $ClassName:"TW3TransitionAnimation",
   $Parent:TW3CustomAnimation
   ,$Init:function ($) {
      TW3CustomAnimation.$Init($);
      $.FAnimationCmd = "";
      $.FSticky = $.FStyleSetup = false;
      $.FStyleDOM = undefined;
      $.FTiming = 0;
   }
   /// constructor TW3TransitionAnimation.Create()
   ,Create$41:function(Self) {
      TW3CustomAnimation.Create$41(Self);
      $Check(Self,"").FTiming = DefaultTiming;
      return Self
   }
   /// destructor TW3TransitionAnimation.Destroy()
   ,Destroy:function(Self) {
      TW3TransitionAnimation.InvalidateKeyFrames(Self);
      TW3CustomAnimation.Destroy(Self);
   }
   /// procedure TW3TransitionAnimation.FinalizeTransition()
   ,FinalizeTransition:function(Self) {
      var style;
      if (!$Check(Self,"").FSticky) {
         style = $Check($Check(Self,"").FTarget$1,"").FHandle$3.style;
         style.removeProperty("-webkit-animation");
         style.removeProperty("-webkit-animation-fill-mode");
         style.removeProperty("animation");
         style.removeProperty("animation-fill-mode");
         $Check(Self,"").FAnimationCmd = "";
      }
      TW3CustomAnimation.FinalizeTransition(Self);
   }
   /// procedure TW3TransitionAnimation.InvalidateKeyFrames()
   ,InvalidateKeyFrames:function(Self) {
      if ($Check(Self,"").FStyleSetup) {
         $Check(Self,"").FStyleSetup = false;
         $Check(Self,"").FStyleDOM.parentNode.removeChild($Check(Self,"").FStyleDOM);
         $Check(Self,"").FStyleDOM = null;
      }
   }
   /// function TW3TransitionAnimation.KeyFramesName() : String
   ,KeyFramesName:function(Self) {
      return TObject.ClassName($Check(Self,"").ClassType);
   }
   /// procedure TW3TransitionAnimation.SetSticky(val: Boolean)
   ,SetSticky:function(Self, val) {
      if ($Check(Self,"").FSticky!=val) {
         $Check(Self,"").FSticky = val;
         if ((!val)&&($Check(Self,"").FAnimationCmd!="")) {
            TW3CustomAnimation.FinalizeTransition$($Check(Self,""));
         }
      }
   }
   /// procedure TW3TransitionAnimation.SetupKeyFrames()
   ,SetupKeyFrames:function(Self) {
      var document$1 = undefined;
      var css = "";
      $Check(Self,"").FStyleSetup = true;
      document$1 = document;
      $Check(Self,"").FStyleDOM = document$1.createElement("style");
      $Check(Self,"").FStyleDOM.type = "text/css";
      css = "keyframes "+TW3TransitionAnimation.KeyFramesName$($Check(Self,""))+" {"+TW3TransitionAnimation.KeyFramesCSS$($Check(Self,""))+"}";
      $Check(Self,"").FStyleDOM.appendChild(document$1.createTextNode("@-webkit-"+css));
      $Check(Self,"").FStyleDOM.appendChild(document$1.createTextNode("@"+css));
      document$1.getElementsByTagName("head")[0].appendChild($Check(Self,"").FStyleDOM);
   }
   /// procedure TW3TransitionAnimation.SetupTransition()
   ,SetupTransition:function(Self) {
      var style$1;
      TW3CustomAnimation.SetupTransition(Self);
      if (!$Check(Self,"").FStyleSetup) {
         TW3TransitionAnimation.SetupKeyFrames(Self);
      }
      style$1 = $Check($Check(Self,"").FTarget$1,"").FHandle$3.style;
      $Check(Self,"").FAnimationCmd = TW3TransitionAnimation.KeyFramesName$($Check(Self,""))+" "+FloatToStr$_Float_($Check(Self,"").FDuration)+"s "+cW3AnimationTiming[$Idx($Check(Self,"").FTiming,0,4,"")];
      style$1.webkitAnimation = $Check(Self,"").FAnimationCmd;
      style$1.animation = $Check(Self,"").FAnimationCmd;
      style$1.webkitAnimationFillMode = "both";
      style$1.animationFillMode = "both";
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$41$:function($){return $.ClassType.Create$41($)}
   ,FinalizeTransition$:function($){return $.ClassType.FinalizeTransition($)}
   ,SetupTransition$:function($){return $.ClassType.SetupTransition($)}
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName$:function($){return $.ClassType.KeyFramesName($)}
};
/// TW3ZoomOutTransition = class (TW3TransitionAnimation)
var TW3ZoomOutTransition = {
   $ClassName:"TW3ZoomOutTransition",
   $Parent:TW3TransitionAnimation
   ,$Init:function ($) {
      TW3TransitionAnimation.$Init($);
   }
   /// function TW3ZoomOutTransition.KeyFramesCSS() : String
   ,KeyFramesCSS:function(Self) {
      return "0% {\r\n   -webkit-transform: scale(1.0);\r\n   -webkit-transform-origin: 50% 50%;\r\n   transform: scale(1.0);\r\n   transform-origin: 50% 50%;\r\n}\r\n50% {\r\n   opacity: 0.3;\r\n   -webkit-transform: scale(0.5);\r\n   transform: scale(0.5);\r\n}\r\n100% {\r\n   opacity: 0.0;\r\n   -webkit-transform: scale(0);\r\n   transform: scale(0);\r\n}";
   }
   ,Destroy:TW3TransitionAnimation.Destroy
   ,Create$41:TW3TransitionAnimation.Create$41
   ,FinalizeTransition:TW3TransitionAnimation.FinalizeTransition
   ,SetupTransition:TW3TransitionAnimation.SetupTransition
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName:TW3TransitionAnimation.KeyFramesName
};
/// TW3ZoomInTransition = class (TW3TransitionAnimation)
var TW3ZoomInTransition = {
   $ClassName:"TW3ZoomInTransition",
   $Parent:TW3TransitionAnimation
   ,$Init:function ($) {
      TW3TransitionAnimation.$Init($);
   }
   /// function TW3ZoomInTransition.KeyFramesCSS() : String
   ,KeyFramesCSS:function(Self) {
      return "0% {\r\n   opacity: 0.0;\r\n   -webkit-transform: scale(0);\r\n   transform: scale(0);\r\n}\r\n50% {\r\n   opacity: 0.3;\r\n   -webkit-transform: scale(0.5);\r\n   transform: scale(0.5);\r\n}\r\n100% {\r\n   -webkit-transform: scale(1.0);\r\n   -webkit-transform-origin: 50% 50%;\r\n   transform: scale(1.0);\r\n   transform-origin: 50% 50%;\r\n}";
   }
   ,Destroy:TW3TransitionAnimation.Destroy
   ,Create$41:TW3TransitionAnimation.Create$41
   ,FinalizeTransition:TW3TransitionAnimation.FinalizeTransition
   ,SetupTransition:TW3TransitionAnimation.SetupTransition
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName:TW3TransitionAnimation.KeyFramesName
};
/// TW3WarpOutTransition = class (TW3TransitionAnimation)
var TW3WarpOutTransition = {
   $ClassName:"TW3WarpOutTransition",
   $Parent:TW3TransitionAnimation
   ,$Init:function ($) {
      TW3TransitionAnimation.$Init($);
   }
   /// function TW3WarpOutTransition.KeyFramesCSS() : String
   ,KeyFramesCSS:function(Self) {
      return "0% {\r\n   opacity: 1.0;\r\n   -webkit-transform: scale(1);\r\n   transform: scale(1);\r\n}\r\n100% {\r\n   opacity: 0;\r\n   -webkit-transform: scale(5);\r\n   -webkit-transform-origin: 50% 50%;\r\n   transform: scale(5);\r\n   transform-origin: 50% 50%;\r\n}";
   }
   ,Destroy:TW3TransitionAnimation.Destroy
   ,Create$41:TW3TransitionAnimation.Create$41
   ,FinalizeTransition:TW3TransitionAnimation.FinalizeTransition
   ,SetupTransition:TW3TransitionAnimation.SetupTransition
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName:TW3TransitionAnimation.KeyFramesName
};
/// TW3WarpInTransition = class (TW3TransitionAnimation)
var TW3WarpInTransition = {
   $ClassName:"TW3WarpInTransition",
   $Parent:TW3TransitionAnimation
   ,$Init:function ($) {
      TW3TransitionAnimation.$Init($);
   }
   /// function TW3WarpInTransition.KeyFramesCSS() : String
   ,KeyFramesCSS:function(Self) {
      return "0% {\r\n   opacity: 0;\r\n   -webkit-transform: scale(5);\r\n   -webkit-transform-origin: 50% 50%;\r\n   transform: scale(5);\r\n   transform-origin: 50% 50%;\r\n}\r\n100% {\r\n   opacity: 1.0;\r\n   -webkit-transform: scale(1);\r\n   transform: scale(1);\r\n}";
   }
   ,Destroy:TW3TransitionAnimation.Destroy
   ,Create$41:TW3TransitionAnimation.Create$41
   ,FinalizeTransition:TW3TransitionAnimation.FinalizeTransition
   ,SetupTransition:TW3TransitionAnimation.SetupTransition
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName:TW3TransitionAnimation.KeyFramesName
};
/// TW3RotateTransition = class (TW3CustomAnimation)
var TW3RotateTransition = {
   $ClassName:"TW3RotateTransition",
   $Parent:TW3CustomAnimation
   ,$Init:function ($) {
      TW3CustomAnimation.$Init($);
      $.FDegree = 0;
   }
   /// procedure TW3RotateTransition.setDegree(Value: Float)
   ,setDegree:function(Self, Value$31) {
      if ($Check(Self,"").FBusy) {
         throw Exception.Create($New(Exception),"Degree cannot be altered while the transition is active error");
      } else {
         $Check(Self,"").FDegree = Value$31;
      }
   }
   /// procedure TW3RotateTransition.SetupTransition()
   ,SetupTransition:function(Self) {
      TW3CustomAnimation.SetupTransition(Self);
      w3_setStyle($Check($Check(Self,"").FTarget$1,"").FHandle$3,w3_CSSPrefix("AnimationFillMode"),"both");
      w3_setStyle($Check($Check(Self,"").FTarget$1,"").FHandle$3,w3_CSSPrefix("Animation"),"ROTATE-FOREVER "+FloatToStr$_Float_($Check(Self,"").FDuration)+"s");
   }
   /// procedure TW3RotateTransition.FinalizeTransition()
   ,FinalizeTransition:function(Self) {
      var style$2;
      style$2 = $Check($Check(Self,"").FTarget$1,"").FHandle$3.style;
      style$2[w3_CSSPrefix("Animation")] = "none";
      style$2[w3_CSSPrefix("AnimationFillMode")] = "none";
      TW3CustomAnimation.FinalizeTransition(Self);
   }
   /// constructor TW3RotateTransition.Create()
   ,Create$41:function(Self) {
      TW3CustomAnimation.Create$41(Self);
      $Check(Self,"").FDegree = 30;
      return Self
   }
   ,Destroy:TW3CustomAnimation.Destroy
   ,Create$41$:function($){return $.ClassType.Create$41($)}
   ,FinalizeTransition$:function($){return $.ClassType.FinalizeTransition($)}
   ,SetupTransition$:function($){return $.ClassType.SetupTransition($)}
};
/// TW3ReplacementTransition = class (TObject)
var TW3ReplacementTransition = {
   $ClassName:"TW3ReplacementTransition",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.FHideAnimation = $.FShowAnimation = null;
   }
   /// destructor TW3ReplacementTransition.Destroy()
   ,Destroy:function(Self) {
      TObject.Free($Check(Self,"").FHideAnimation);
      TObject.Free($Check(Self,"").FShowAnimation);
      TObject.Destroy(Self);
   }
   /// procedure TW3ReplacementTransition.Execute(oldControl: TW3MovableControl; newControl: TW3MovableControl)
   ,Execute$1:function(Self, oldControl, newControl) {
      $Check($Check(Self,"").FHideAnimation,"").FOnEnds = function (_implicit_Sender) {
         TW3MovableControl.SetVisible$($Check(oldControl,""),false);
      };
      $Check($Check(Self,"").FShowAnimation,"").FOnBegins = function (_implicit_Sender$1) {
         TW3MovableControl.SetVisible$($Check(newControl,""),true);
      };
      TW3CustomAnimation.Execute($Check(Self,"").FHideAnimation,oldControl);
      TW3CustomAnimation.Execute($Check(Self,"").FShowAnimation,newControl);
   }
   /// procedure TW3ReplacementTransition.SetHideAnimation(v: TW3CustomAnimation)
   ,SetHideAnimation:function(Self, v$7) {
      TObject.Free($Check(Self,"").FHideAnimation);
      $Check(Self,"").FHideAnimation = v$7;
   }
   /// procedure TW3ReplacementTransition.SetShowAnimation(v: TW3CustomAnimation)
   ,SetShowAnimation:function(Self, v$8) {
      TObject.Free($Check(Self,"").FShowAnimation);
      $Check(Self,"").FShowAnimation = v$8;
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
};
/// TW3NamedAnimation = class (TW3CustomAnimation)
var TW3NamedAnimation = {
   $ClassName:"TW3NamedAnimation",
   $Parent:TW3CustomAnimation
   ,$Init:function ($) {
      TW3CustomAnimation.$Init($);
      $.FName$2 = "";
   }
   /// procedure TW3NamedAnimation.SetupTransition()
   ,SetupTransition:function(Self) {
      var mCommand = "";
      TW3CustomAnimation.SetupTransition(Self);
      w3_setStyle($Check($Check(Self,"").FTarget$1,"").FHandle$3,w3_CSSPrefix("AnimationFillMode"),"both");
      mCommand = $Check(Self,"").FName$2+" "+FloatToStr$_Float_($Check(Self,"").FDuration)+"s linear";
      w3_setStyle($Check($Check(Self,"").FTarget$1,"").FHandle$3,w3_CSSPrefix("Animation"),mCommand);
   }
   /// procedure TW3NamedAnimation.FinalizeTransition()
   ,FinalizeTransition:function(Self) {
      TW3CustomAnimation.FinalizeTransition(Self);
      if ($Check(Self,"").FTarget$1!==null) {
         $Check($Check(Self,"").FTarget$1,"").FHandle$3.style[w3_CSSPrefix("Animation")] = "none";
         $Check($Check(Self,"").FTarget$1,"").FHandle$3.style[w3_CSSPrefix("AnimationFillMode")] = "none";
      }
   }
   /// procedure TW3NamedAnimation.ExecuteNamed(TargetObj: TW3TagObj; aAnimName: String)
   ,ExecuteNamed:function(Self, TargetObj$2, aAnimName) {
      $Check(Self,"").FName$2 = aAnimName;
      TW3CustomAnimation.Execute(Self,TargetObj$2);
   }
   ,Destroy:TW3CustomAnimation.Destroy
   ,Create$41:TW3CustomAnimation.Create$41
   ,FinalizeTransition$:function($){return $.ClassType.FinalizeTransition($)}
   ,SetupTransition$:function($){return $.ClassType.SetupTransition($)}
};
/// TW3FadeSlideTransition = class (TW3TransitionAnimation)
var TW3FadeSlideTransition = {
   $ClassName:"TW3FadeSlideTransition",
   $Parent:TW3TransitionAnimation
   ,$Init:function ($) {
      TW3TransitionAnimation.$Init($);
      $.a$12 = $.a$11 = $.a$10 = $.a$9 = $.a$8 = $.a$7 = 0;
      $.FKeyFrameName = "";
   }
   /// constructor TW3FadeSlideTransition.Create()
   ,Create$41:function(Self) {
      TW3TransitionAnimation.Create$41(Self);
      $Check(Self,"").FKeyFrameName = TObject.ClassName($Check(Self,"").ClassType)+"_"+w3_GetUniqueNumber().toString();
      return Self
   }
   /// constructor TW3FadeSlideTransition.CreateFadeIn(dx: Float; dy: Float)
   ,CreateFadeIn:function(Self, dx$11, dy$12) {
      TW3CustomAnimation.Create$41$($Check(Self,""));
      $Check(Self,"").a$7 = dx$11;
      $Check(Self,"").a$8 = dy$12;
      $Check(Self,"").a$12 = 1;
      return Self
   }
   /// constructor TW3FadeSlideTransition.CreateFadeOut(dx: Float; dy: Float)
   ,CreateFadeOut:function(Self, dx$12, dy$13) {
      TW3CustomAnimation.Create$41$($Check(Self,""));
      $Check(Self,"").a$10 = dx$12;
      $Check(Self,"").a$11 = dy$13;
      $Check(Self,"").a$9 = 1;
      return Self
   }
   /// function TW3FadeSlideTransition.KeyFramesCSS() : String
   ,KeyFramesCSS:function(Self) {
      var Result = "";
      var fromTranslate = "";
      var toTranslate = "";
      fromTranslate = Format("transform:translate(%d%%,%d%%)",[Math.round($Check(Self,"").a$7*100), Math.round($Check(Self,"").a$8*100)]);
      toTranslate = Format("transform:translate(%d%%,%d%%)",[Math.round($Check(Self,"").a$10*100), Math.round($Check(Self,"").a$11*100)]);
      Result = "0%{-webkit-"+fromTranslate+";"+fromTranslate+";opacity:"+FloatToStr$_Float_($Check(Self,"").a$9)+"}100%{-webkit-"+toTranslate+";"+toTranslate+";opacity:"+FloatToStr$_Float_($Check(Self,"").a$12)+"}";
      return Result
   }
   /// function TW3FadeSlideTransition.KeyFramesName() : String
   ,KeyFramesName:function(Self) {
      return $Check(Self,"").FKeyFrameName;
   }
   ,Destroy:TW3TransitionAnimation.Destroy
   ,Create$41$:function($){return $.ClassType.Create$41($)}
   ,FinalizeTransition:TW3TransitionAnimation.FinalizeTransition
   ,SetupTransition:TW3TransitionAnimation.SetupTransition
   ,KeyFramesCSS$:function($){return $.ClassType.KeyFramesCSS($)}
   ,KeyFramesName$:function($){return $.ClassType.KeyFramesName($)}
};
/// TW3FadeSlideReplacementTransition = class (TW3ReplacementTransition)
var TW3FadeSlideReplacementTransition = {
   $ClassName:"TW3FadeSlideReplacementTransition",
   $Parent:TW3ReplacementTransition
   ,$Init:function ($) {
      TW3ReplacementTransition.$Init($);
   }
   /// constructor TW3FadeSlideReplacementTransition.Create(dx: Integer; dy: Integer)
   ,Create$45:function(Self, dx$13, dy$14) {
      TW3FadeSlideReplacementTransition.SetDirection(Self,dx$13,dy$14);
      return Self
   }
   /// function TW3FadeSlideReplacementTransition.SetDirection(dx: Integer; dy: Integer) : TW3FadeSlideReplacementTransition
   ,SetDirection:function(Self, dx$14, dy$15) {
      var Result = null;
      TW3ReplacementTransition.SetHideAnimation(Self,TW3FadeSlideTransition.CreateFadeOut($New(TW3FadeSlideTransition),dx$14,dy$15));
      TW3ReplacementTransition.SetShowAnimation(Self,TW3FadeSlideTransition.CreateFadeIn($New(TW3FadeSlideTransition),-dx$14,-dy$15));
      Result = Self;
      return Result
   }
   ,Destroy:TW3ReplacementTransition.Destroy
};
/// TW3AnimationTiming enumeration
var TW3AnimationTiming = [ "atEase", "atLinear", "atEaseIn", "atEaseOut", "atEaseInOut" ];
var cW3AnimationTiming = ["ease","linear","ease-in","ease-out","ease-in-out"];
/// TW3AlertResult enumeration
var TW3AlertResult = [ "roYes", "roNo", "roOK", "roCancel" ];
/// TW3AlertOptions enumeration
var TW3AlertOptions = [ "aoYes", "aoNo", "aoYesNo", "aoOK", "aoCancel", "aoOKCancel" ];
/// TW3AlertDialog = class (TW3CustomControl)
var TW3AlertDialog = {
   $ClassName:"TW3AlertDialog",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FNo = $.FOnSelect = $.FText = $.FTitle = $.FYes = null;
      $.FOptions = 0;
      $.FReady = false;
   }
   /// procedure TW3AlertDialog.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TObject.Free($Check(Self,"").FTitle);
      TObject.Free($Check(Self,"").FText);
      TObject.Free($Check(Self,"").FYes);
      TObject.Free($Check(Self,"").FNo);
      TW3CustomControl.FinalizeObject(Self);
   }
   /// procedure TW3AlertDialog.HandleNoClick(Sender: TObject)
   ,HandleNoClick:function(Self, Sender$4) {
      if ($Check(Self,"").FOnSelect) {
         switch ($Check(Self,"").FOptions) {
            case 0 :
            case 2 :
            case 1 :
               $CheckFunc($Check(Self,"").FOnSelect,"")(Self,1);
               break;
            case 3 :
            case 4 :
            case 5 :
               $CheckFunc($Check(Self,"").FOnSelect,"")(Self,3);
               break;
         }
      }
   }
   /// procedure TW3AlertDialog.HandleYesClick(Sender: TObject)
   ,HandleYesClick:function(Self, Sender$5) {
      if ($Check(Self,"").FOnSelect) {
         switch ($Check(Self,"").FOptions) {
            case 0 :
            case 2 :
            case 1 :
               $CheckFunc($Check(Self,"").FOnSelect,"")(Self,0);
               break;
            case 3 :
            case 4 :
            case 5 :
               $CheckFunc($Check(Self,"").FOnSelect,"")(Self,2);
               break;
         }
      }
   }
   /// procedure TW3AlertDialog.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      $Check(Self,"").FYes = TW3Component.Create$38$($New(TW3AlertButton),Self);
      TW3MovableControl.SetSize$4$($Check($Check(Self,"").FYes,""),120,42);
      TW3Button.SetCaption($Check(Self,"").FYes,"OK");
      TW3CustomControl._setMouseClick($Check(Self,"").FYes,$Event1(Self,TW3AlertDialog.HandleYesClick$));
      TW3MovableControl.SetVisible$($Check($Check(Self,"").FYes,""),false);
      $Check(Self,"").FNo = TW3Component.Create$38$($New(TW3AlertButton),Self);
      TW3MovableControl.SetSize$4$($Check($Check(Self,"").FNo,""),120,42);
      TW3Button.SetCaption($Check(Self,"").FNo,"Cancel");
      TW3CustomControl._setMouseClick($Check(Self,"").FNo,$Event1(Self,TW3AlertDialog.HandleNoClick$));
      TW3MovableControl.SetVisible$($Check($Check(Self,"").FNo,""),false);
      $Check(Self,"").FTitle = TW3Component.Create$38$($New(TW3Label),Self);
      $Check(Self,"").FText = TW3Component.Create$38$($New(TW3Label),Self);
   }
   /// procedure TW3AlertDialog.Resize()
   ,Resize:function(Self) {
      var hd$6 = 0;
      var wd$6 = 0;
      var dx$15 = 0;
      var dy$16 = 0;
      TW3MovableControl.Resize(Self);
      wd$6 = TW3ScrollInfo.GetScrollWidth(TW3CustomControl.getScrollInfo(Self));
      hd$6 = TW3ScrollInfo.GetScrollHeight(TW3CustomControl.getScrollInfo(Self));
      TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FTitle,""),8,8,wd$6-16,32);
      TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FText,""),8,TW3MovableControl.GetTop$($Check($Check(Self,"").FTitle,""))+TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FTitle,""))+2,wd$6-16,92);
      if ($Check(Self,"").FObjReady&&$Check(Self,"").FReady) {
         (wd$6-= 16);
         if ((1<<$Check(Self,"").FOptions&36)!=0) {
            (wd$6-= 8);
         }
         if ((1<<$Check(Self,"").FOptions&27)!=0) {
            if ((1<<$Check(Self,"").FOptions&9)!=0) {
               dy$16 = TW3MovableControl.GetHeight$1$($Check(Self,""))-(TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FYes,""))+20);
               TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FYes,""),10,dy$16,wd$6,TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FYes,"")));
            } else if ((1<<$Check(Self,"").FOptions&18)!=0) {
               dy$16 = TW3MovableControl.GetHeight$1$($Check(Self,""))-(TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FNo,""))+20);
               TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FNo,""),10,dy$16,wd$6,TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FNo,"")));
            }
         } else if ((1<<$Check(Self,"").FOptions&36)!=0) {
            dy$16 = hd$6-(TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FYes,""))+8);
            TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FYes,""),8,dy$16,$Div(wd$6,2),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FYes,"")));
            dx$15 = TW3ScrollInfo.GetScrollWidth(TW3CustomControl.getScrollInfo(Self))-($Div(wd$6,2));
            (dx$15-= 8);
            TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FNo,""),dx$15,dy$16,$Div(wd$6,2),TW3MovableControl.GetHeight$1$($Check($Check(Self,"").FNo,"")));
         }
      }
   }
   /// procedure TW3AlertDialog.SetupDialog(aTitle: String; aText: String; aOptions: TW3AlertOptions)
   ,SetupDialog:function(Self, aTitle, aText$6, aOptions$1) {
      if (!$Check(Self,"").FReady) {
         TW3TagObj.BeginUpdate(Self);
         try {
            $Check(Self,"").FOptions = aOptions$1;
            TW3Label.setCaption$1$($Check($Check(Self,"").FTitle,""),aTitle);
            TW3Label.setCaption$1$($Check($Check(Self,"").FText,""),aText$6);
            switch ($Check(Self,"").FOptions) {
               case 0 :
               case 3 :
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FYes,""),true);
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FNo,""),false);
                  break;
               case 1 :
               case 4 :
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FNo,""),true);
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FYes,""),false);
                  break;
               case 2 :
               case 5 :
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FYes,""),true);
                  TW3MovableControl.SetVisible$($Check($Check(Self,"").FNo,""),true);
                  break;
            }
            switch ($Check(Self,"").FOptions) {
               case 0 :
                  TW3Button.SetCaption($Check(Self,"").FYes,"Yes");
                  break;
               case 1 :
                  TW3Button.SetCaption($Check(Self,"").FNo,"No");
                  break;
               case 3 :
                  TW3Button.SetCaption($Check(Self,"").FYes,"OK");
                  break;
               case 4 :
                  TW3Button.SetCaption($Check(Self,"").FNo,"Cancel");
                  break;
               case 2 :
                  TW3Button.SetCaption($Check(Self,"").FYes,"Yes");
                  TW3Button.SetCaption($Check(Self,"").FNo,"No");
                  break;
               case 5 :
                  TW3Button.SetCaption($Check(Self,"").FYes,"OK");
                  TW3Button.SetCaption($Check(Self,"").FNo,"Cancel");
                  break;
            }
            TW3CustomFont.setName(TW3CustomControl.getFont$1($Check(Self,"").FTitle),"Helvetica, Arial, sans-serif");
            TW3CustomFont.setWeight(TW3CustomControl.getFont$1($Check(Self,"").FTitle),"bold");
            TW3CustomFont.setSize(TW3CustomControl.getFont$1($Check(Self,"").FTitle),24);
            TW3Label.setTextAlign$1$($Check($Check(Self,"").FTitle,""),1);
            TW3CustomFont.setColor$1(TW3CustomControl.getFont$1($Check(Self,"").FTitle),16777215);
            $Check($Check($Check(Self,"").FTitle,"").FContainer,"").FHandle$3.style["text-shadow"] = "0 -1px 0 rgba(0,0,0,.8)";
            TW3CustomFont.setSize(TW3CustomControl.getFont$1($Check(Self,"").FText),16);
            TW3CustomFont.setName(TW3CustomControl.getFont$1($Check(Self,"").FText),"Helvetica, Arial, sans-serif");
            TW3Label.setTextAlign$1$($Check($Check(Self,"").FText,""),1);
            $Check(Self,"").FReady = true;
         } finally {
            TW3MovableControl.SetWasSized(Self);
            TW3MovableControl.SetWasMoved(Self);
            TW3TagObj.EndUpdate$($Check(Self,""));
         }
      }
   }
   /// procedure TW3AlertDialog.StyleTagObject()
   ,StyleTagObject:function(Self) {
      TW3CustomControl.StyleTagObject(Self);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject$:function($){return $.ClassType.StyleTagObject($)}
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
   ,HandleNoClick$:function($){return $.ClassType.HandleNoClick.apply($.ClassType, arguments)}
   ,HandleYesClick$:function($){return $.ClassType.HandleYesClick.apply($.ClassType, arguments)}
};
TW3AlertDialog.$Intf={
   IW3AlertDialog:[TW3AlertDialog.SetupDialog]
}
/// TW3Button = class (TW3CustomControl)
var TW3Button = {
   $ClassName:"TW3Button",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FIgnoreMouse = 0;
      $.FPressed = false;
      $.FTouchEnd = null;
      $.FTouchMove = null;
      $.FTouchX = $.FTouchY = 0;
   }
   /// procedure TW3Button.CBClick(eventObj: JEvent)
   ,CBClick:function(Self, eventObj$18) {
      if ($Check(Self,"").FPressed) {
         TW3Button.ResetClick(Self);
         TW3CustomControl.CBClick(Self,eventObj$18);
      } else {
         TW3Button.ResetClick(Self);
      }
   }
   /// procedure TW3Button.CBKeyDown(eventObj: JKeyboardEvent)
   ,CBKeyDown:function(Self, eventObj$19) {
      TW3CustomControl.CBKeyDown(Self,eventObj$19);
      if (TW3CustomControl.GetEnabled$($Check(Self,""))&&(($Check(eventObj$19,"").keyCode==13)||($Check(eventObj$19,"").keyCode==32))) {
         TW3Button.SetPressed(Self,true);
      }
   }
   /// procedure TW3Button.CBKeyUp(eventObj: JKeyboardEvent)
   ,CBKeyUp:function(Self, eventObj$20) {
      TW3CustomControl.CBKeyDown(Self,eventObj$20);
      switch ($Check(eventObj$20,"").keyCode) {
         case 13 :
         case 32 :
            if (TW3CustomControl.GetEnabled$($Check(Self,""))&&$Check(Self,"").FPressed) {
               TW3CustomControl.CBClick$($Check(Self,""),eventObj$20);
            }
            break;
         case 27 :
            TW3Button.SetPressed(Self,false);
            break;
      }
   }
   /// procedure TW3Button.CBMouseDown(eventObj: JMouseEvent)
   ,CBMouseDown:function(Self, eventObj$21) {
      TW3CustomControl.CBMouseDown(Self,eventObj$21);
      if (PerformanceTimer.Now$1()<$Check(Self,"").FIgnoreMouse) {
         return;
      }
      if (TW3CustomControl.GetEnabled$($Check(Self,""))&&($Check(eventObj$21,"").button==0)) {
         TW3Button.SetPressed(Self,true);
         TW3CustomControl.SetCapture(Self);
      }
   }
   /// procedure TW3Button.CBMouseMove(eventObj: JMouseEvent)
   ,CBMouseMove:function(Self, eventObj$22) {
      TW3CustomControl.CBMouseMove(Self,eventObj$22);
      if (TW3CustomControl.a$6(Self)) {
         TW3Button.SetPressed(Self,TRect$ContainsPos$1(TW3MovableControl.ScreenRect(Self),$Check(eventObj$22,"").clientX,$Check(eventObj$22,"").clientY));
      }
   }
   /// procedure TW3Button.CBMouseUp(eventObj: JMouseEvent)
   ,CBMouseUp:function(Self, eventObj$23) {
      TW3CustomControl.CBMouseUp(Self,eventObj$23);
      if (TW3CustomControl.a$6(Self)&&($Check(eventObj$23,"").button==0)) {
         TW3CustomControl.CBClick$($Check(Self,""),eventObj$23);
      }
   }
   /// function TW3Button.GetCaption() : String
   ,GetCaption:function(Self) {
      var Result = "";
      if ($Check(Self,"").FHandle$3) {
         Result = ""+$Check(Self,"").FHandle$3.innerHTML;
      }
      return Result
   }
   /// procedure TW3Button.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      TW3MovableControl.SetWidth$($Check(Self,""),100);
      TW3MovableControl.setHeight$($Check(Self,""),32);
      $Check(Self,"").FHandle$3.addEventListener("touchstart",function (e$20) {
         var t$4 = null;
         if (!TW3CustomControl.GetEnabled$($Check(Self,""))) {
            return;
         }
         if ($Check(Self,"").FPressed) {
            return;
         }
         TW3Button.SetPressed(Self,true);
         e$20.stopPropagation();
         $Check(Self,"").FHandle$3.addEventListener("touchmove",$Check(Self,"").FTouchMove,false);
         document.body.addEventListener("touchend",$Check(Self,"").FTouchEnd,false);
         t$4 = $Check(e$20,"").touches[0];
         $Check(Self,"").FTouchX = $Check(t$4,"").clientX;
         $Check(Self,"").FTouchY = $Check(t$4,"").clientY;
      },false);
      $Check(Self,"").FTouchMove = function (e$21) {
         var t$5 = null;
         t$5 = $Check(e$21,"").touches[0];
         if ((Math.abs($Check(t$5,"").clientX-$Check(Self,"").FTouchX)>10)||(Math.abs($Check(t$5,"").clientY-$Check(Self,"").FTouchY)>10)) {
            TW3Button.ResetClick(Self);
         }
      };
      $Check(Self,"").FTouchEnd = function (e$22) {
         TW3CustomControl.CBClick$($Check(Self,""),e$22);
         $Check(Self,"").FIgnoreMouse = PerformanceTimer.Now$1()+1000;
      };
      TW3CustomControl._setMouseDown(Self,null);
      TW3CustomControl._setMouseUp(Self,null);
      TW3CustomControl._setMouseMove(Self,null);
      TW3CustomControl._setKeyDown(Self,null);
      TW3CustomControl._setKeyUp(Self,null);
   }
   /// function TW3Button.MakeElementTagObj() : THandle
   ,MakeElementTagObj:function(Self) {
      return w3_createHtmlElement("button");
   }
   /// procedure TW3Button.ResetClick()
   ,ResetClick:function(Self) {
      TW3Button.SetPressed(Self,false);
      if (TW3CustomControl.a$6(Self)) {
         TW3CustomControl.ReleaseCapture(Self);
      } else {
         $Check(Self,"").FHandle$3.removeEventListener("touchmove",$Check(Self,"").FTouchMove,false);
         document.body.removeEventListener("touchend",$Check(Self,"").FTouchEnd,false);
      }
   }
   /// procedure TW3Button.SetCaption(Value: String)
   ,SetCaption:function(Self, Value$32) {
      if ($Check(Self,"").FHandle$3) {
         $Check(Self,"").FHandle$3.innerHTML = Value$32;
      }
   }
   /// procedure TW3Button.SetPressed(value: Boolean)
   ,SetPressed:function(Self, value$8) {
      if ($Check(Self,"").FPressed!=value$8) {
         $Check(Self,"").FPressed = value$8;
         if (value$8) {
            w3_AddClass($Check(Self,"").FHandle$3,PressedCSSClass);
         } else {
            w3_RemoveClass($Check(Self,"").FHandle$3,PressedCSSClass);
         }
      }
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj$:function($){return $.ClassType.MakeElementTagObj($)}
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick$:function($){return $.ClassType.CBClick.apply($.ClassType, arguments)}
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown$:function($){return $.ClassType.CBKeyDown.apply($.ClassType, arguments)}
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp$:function($){return $.ClassType.CBKeyUp.apply($.ClassType, arguments)}
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown$:function($){return $.ClassType.CBMouseDown.apply($.ClassType, arguments)}
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove$:function($){return $.ClassType.CBMouseMove.apply($.ClassType, arguments)}
   ,CBMouseUp$:function($){return $.ClassType.CBMouseUp.apply($.ClassType, arguments)}
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TW3AlertButton = class (TW3Button)
var TW3AlertButton = {
   $ClassName:"TW3AlertButton",
   $Parent:TW3Button
   ,$Init:function ($) {
      TW3Button.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject:TW3Button.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3Button.MakeElementTagObj
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3Button.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3Button.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3Button.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3Button.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3Button.CBMouseMove
   ,CBMouseUp:TW3Button.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TW3LabelText = class (TW3CustomControl)
var TW3LabelText = {
   $ClassName:"TW3LabelText",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject:TW3CustomControl.FinalizeObject
   ,InitializeObject:TW3CustomControl.InitializeObject
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj:TW3TagObj.MakeElementTagObj
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize:TW3MovableControl.Resize
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment:TW3MovableControl.supportAdjustment
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled:TW3CustomControl.SetEnabled
};
/// TW3Label = class (TW3CustomControl)
var TW3Label = {
   $ClassName:"TW3Label",
   $Parent:TW3CustomControl
   ,$Init:function ($) {
      TW3CustomControl.$Init($);
      $.FCaption$1 = "";
      $.FContainer = null;
      $.FTextAlign = 0;
   }
   /// procedure TW3Label.FinalizeObject()
   ,FinalizeObject:function(Self) {
      TObject.Free($Check(Self,"").FContainer);
      TW3CustomControl.FinalizeObject(Self);
   }
   /// procedure TW3Label.InitializeObject()
   ,InitializeObject:function(Self) {
      TW3CustomControl.InitializeObject(Self);
      $Check(Self,"").FContainer = TW3Component.Create$38$($New(TW3LabelText),Self);
      w3_setStyle($Check($Check(Self,"").FContainer,"").FHandle$3,"textOverflow","ellipsis");
      w3_setStyle($Check($Check(Self,"").FContainer,"").FHandle$3,"whiteSpace","nowrap");
      w3_setStyle($Check($Check(Self,"").FContainer,"").FHandle$3,"overflow","hidden");
      w3_setStyle($Check($Check(Self,"").FContainer,"").FHandle$3,w3_CSSPrefixDef("vertical-align"),"middle");
      TW3Label.setCaption$1$($Check(Self,""),"Label");
      TW3MovableControl.setHeight$($Check(Self,""),12);
   }
   /// function TW3Label.makeElementTagObj() : THandle
   ,MakeElementTagObj:function(Self) {
      return w3_createHtmlElement("fieldset");
   }
   /// procedure TW3Label.Resize()
   ,Resize:function(Self) {
      var dx$16 = 0;
      var dy$17 = 0;
      var wd$7 = 0;
      var hd$7 = 0;
      TW3MovableControl.Resize(Self);
      TW3TagObj.BeginUpdate($Check(Self,"").FContainer);
      TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FContainer,""),0,0,2,2);
      wd$7 = ClampInt(TW3ScrollInfo.GetScrollWidth(TW3CustomControl.getScrollInfo($Check(Self,"").FContainer))+2,0,TW3MovableControl.ClientWidth(Self));
      hd$7 = ClampInt(TW3ScrollInfo.GetScrollHeight(TW3CustomControl.getScrollInfo($Check(Self,"").FContainer)),0,TW3MovableControl.ClientHeight(Self));
      switch ($Check(Self,"").FTextAlign) {
         case 0 :
            dy$17 = ($Div(TW3MovableControl.ClientHeight(Self),2))-($Div(hd$7,2));
            TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FContainer,""),0,dy$17,wd$7,hd$7);
            break;
         case 1 :
            dx$16 = ($Div(TW3MovableControl.ClientWidth(Self),2))-($Div(wd$7,2));
            dy$17 = ($Div(TW3MovableControl.ClientHeight(Self),2))-($Div(hd$7,2));
            TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FContainer,""),dx$16,dy$17,wd$7,hd$7);
            break;
         case 2 :
            dx$16 = TW3MovableControl.ClientWidth(Self)-wd$7;
            dy$17 = ($Div(TW3MovableControl.ClientHeight(Self),2))-($Div(hd$7,2));
            TW3MovableControl.SetBounds$2$($Check($Check(Self,"").FContainer,""),dx$16,dy$17,wd$7,hd$7);
            break;
      }
      TW3TagObj.EndUpdate$($Check($Check(Self,"").FContainer,""));
   }
   /// procedure TW3Label.setCaption(const aValue: String)
   ,setCaption$1:function(Self, aValue$106) {
      if (aValue$106!=$Check(Self,"").FCaption$1) {
         TW3TagObj.BeginUpdate(Self);
         $Check(Self,"").FCaption$1 = aValue$106;
         TW3TagObj.SetInnerHTML($Check(Self,"").FContainer,aValue$106);
         TW3MovableControl.SetWasSized(Self);
         TW3MovableControl.SetWasMoved(Self);
         TW3TagObj.EndUpdate$($Check(Self,""));
      }
   }
   /// procedure TW3Label.setEnabled(aValue: Boolean)
   ,SetEnabled:function(Self, aValue$107) {
      TW3CustomControl.SetEnabled(Self,aValue$107);
      TW3CustomControl.SetEnabled$($Check($Check(Self,"").FContainer,""),aValue$107);
   }
   /// procedure TW3Label.setTextAlign(aNewAlignment: TTextAlign)
   ,setTextAlign$1:function(Self, aNewAlignment) {
      var mToWrite = "";
      TW3TagObj.BeginUpdate(Self);
      $Check(Self,"").FTextAlign = aNewAlignment;
      switch (aNewAlignment) {
         case 0 :
            mToWrite = "left";
            break;
         case 1 :
            mToWrite = "center";
            break;
         case 2 :
            mToWrite = "right";
            break;
      }
      w3_setStyle($Check($Check(Self,"").FContainer,"").FHandle$3,"text-align",mToWrite);
      TW3MovableControl.SetWasSized(Self);
      TW3MovableControl.SetWasMoved(Self);
      TW3TagObj.EndUpdate$($Check(Self,""));
   }
   /// function TW3Label.supportAdjustment() : Boolean
   ,supportAdjustment:function(Self) {
      return false;
   }
   ,Destroy:TW3TagObj.Destroy
   ,AfterUpdate:TW3CustomControl.AfterUpdate
   ,Create$37:TW3TagObj.Create$37
   ,EndUpdate:TW3TagObj.EndUpdate
   ,FinalizeObject$:function($){return $.ClassType.FinalizeObject($)}
   ,InitializeObject$:function($){return $.ClassType.InitializeObject($)}
   ,MakeElementTagId:TW3TagObj.MakeElementTagId
   ,MakeElementTagObj$:function($){return $.ClassType.MakeElementTagObj($)}
   ,StyleTagObject:TW3CustomControl.StyleTagObject
   ,UnHookEvents:TW3TagObj.UnHookEvents
   ,CBNoBehavior:TW3Component.CBNoBehavior
   ,ChildAdded:TW3Component.ChildAdded
   ,ChildRemoved:TW3Component.ChildRemoved
   ,Create$38:TW3Component.Create$38
   ,AdjustToParentBox:TW3MovableControl.AdjustToParentBox
   ,DisplayMode:TW3MovableControl.DisplayMode
   ,getBoundsRect:TW3MovableControl.getBoundsRect
   ,GetHeight$1:TW3MovableControl.GetHeight$1
   ,GetLeft:TW3MovableControl.GetLeft
   ,GetTop:TW3MovableControl.GetTop
   ,getVisible:TW3MovableControl.getVisible
   ,GetWidth$1:TW3MovableControl.GetWidth$1
   ,Moved:TW3MovableControl.Moved
   ,MoveTo$1:TW3MovableControl.MoveTo$1
   ,Resize$:function($){return $.ClassType.Resize($)}
   ,SetBounds$3:TW3MovableControl.SetBounds$3
   ,SetBounds$2:TW3MovableControl.SetBounds$2
   ,setHeight:TW3MovableControl.setHeight
   ,setLeft:TW3MovableControl.setLeft
   ,SetSize$4:TW3MovableControl.SetSize$4
   ,setTop:TW3MovableControl.setTop
   ,SetVisible:TW3MovableControl.SetVisible
   ,SetWidth:TW3MovableControl.SetWidth
   ,supportAdjustment$:function($){return $.supportAdjustment($)}
   ,CBAnimationBegins:TW3CustomControl.CBAnimationBegins
   ,CBAnimationEnds:TW3CustomControl.CBAnimationEnds
   ,CBChanged:TW3CustomControl.CBChanged
   ,CBClick:TW3CustomControl.CBClick
   ,CBContextPopup:TW3CustomControl.CBContextPopup
   ,CBDblClick:TW3CustomControl.CBDblClick
   ,CBFocused:TW3CustomControl.CBFocused
   ,CBKeyDown:TW3CustomControl.CBKeyDown
   ,CBKeyPress:TW3CustomControl.CBKeyPress
   ,CBKeyUp:TW3CustomControl.CBKeyUp
   ,CBLostFocus:TW3CustomControl.CBLostFocus
   ,CBMouseDown:TW3CustomControl.CBMouseDown
   ,CBMouseEnter:TW3CustomControl.CBMouseEnter
   ,CBMouseExit:TW3CustomControl.CBMouseExit
   ,CBMouseMove:TW3CustomControl.CBMouseMove
   ,CBMouseUp:TW3CustomControl.CBMouseUp
   ,CBMouseWheel:TW3CustomControl.CBMouseWheel
   ,CMGestureChange:TW3CustomControl.CMGestureChange
   ,CMGestureEnd:TW3CustomControl.CMGestureEnd
   ,CMGestureStart:TW3CustomControl.CMGestureStart
   ,CMTouchBegins:TW3CustomControl.CMTouchBegins
   ,CMTouchEnds:TW3CustomControl.CMTouchEnds
   ,CMTouchMove:TW3CustomControl.CMTouchMove
   ,GetChildrenSortedByYPos:TW3CustomControl.GetChildrenSortedByYPos
   ,GetEnabled:TW3CustomControl.GetEnabled
   ,GetSizeInfo:TW3CustomControl.GetSizeInfo
   ,Invalidate:TW3CustomControl.Invalidate
   ,LayoutChildren:TW3CustomControl.LayoutChildren
   ,MouseDown$1:TW3CustomControl.MouseDown$1
   ,MouseEnter:TW3CustomControl.MouseEnter
   ,MouseExit:TW3CustomControl.MouseExit
   ,MouseMove:TW3CustomControl.MouseMove
   ,MouseUp$1:TW3CustomControl.MouseUp$1
   ,MouseWheel:TW3CustomControl.MouseWheel
   ,SetEnabled$:function($){return $.ClassType.SetEnabled.apply($.ClassType, arguments)}
   ,setCaption$1$:function($){return $.ClassType.setCaption$1.apply($.ClassType, arguments)}
   ,setTextAlign$1$:function($){return $.ClassType.setTextAlign$1.apply($.ClassType, arguments)}
};
/// TTextAlign enumeration
var TTextAlign = [ "taLeft", "taCenter", "taRight" ];
/// TStopWatch = class (TObject)
var TStopWatch = {
   $ClassName:"TStopWatch",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.a$15 = $.a$14 = 0;
      $.FIsRunning = false;
   }
   /// anonymous TSourceMethodSymbol
   ,a$16:function(Self) {
      return ($Check(Self,"").FIsRunning)?PerformanceTimer.Now$1()-$Check(Self,"").a$14:$Check(Self,"").a$15-$Check(Self,"").a$14;
   }
   /// anonymous TSourceMethodSymbol
   ,a$13:function(Self) {
      return vIsHighResolution;
   }
   /// constructor TStopWatch.Create(autoStart: Boolean = False)
   ,Create$46:function(Self, autoStart) {
      if (autoStart) {
         TStopWatch.Start(Self);
      }
      return Self
   }
   /// procedure TStopWatch.Start()
   ,Start:function(Self) {
      $Check(Self,"").FIsRunning = true;
      $Check(Self,"").a$14 = PerformanceTimer.Now$1();
   }
   /// procedure TStopWatch.Stop()
   ,Stop:function(Self) {
      $Check(Self,"").a$15 = PerformanceTimer.Now$1();
      $Check(Self,"").FIsRunning = false;
   }
   ,Destroy:TObject.Destroy
};
/// PerformanceTimer = class (TObject)
var PerformanceTimer = {
   $ClassName:"PerformanceTimer",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// procedure PerformanceTimer.PrepareGetNow()
   ,PrepareGetNow:function() {
      
      if (window.performance && performance.now) {
         vGetNow = performance;
         vIsHighResolution = true;
      } else {
         vIsHighResolution = false;
         if (!Date.now) { Date.now = function (){ return +(new Date) } };
         vGetNow = Date;
      }
      }
   /// function PerformanceTimer.Now() : Float
   ,Now$1:function() {
      var Result = 0;
      if (!vGetNow) {
         PerformanceTimer.PrepareGetNow();
      }
      Result = Number(vGetNow.now());
      return Result
   }
   ,Destroy:TObject.Destroy
};
var G2TextureCubeFaceGL = [34069,34070,34071,34072,34073,34074];
/// TG2QuickSortListVariant = record
function Copy$TG2QuickSortListVariant(s,d) {
   d._ItemCount=s._ItemCount;
   d._Items=s._Items;
   return d;
}
function Clone$TG2QuickSortListVariant($) {
   return {
      _ItemCount:$._ItemCount,
      _Items:$._Items
   }
}
/// function TG2QuickSortListVariant.Add(var Self: TG2QuickSortListVariant; const Item: Variant) : Integer
function TG2QuickSortListVariant$Add$4(Self$73, Item) {
   var Result = 0;
   if (Self$73._Items.length<=Self$73._ItemCount) {
      $ArraySetLenC(Self$73._Items,(Self$73._Items.length+32),function (){return {Data$3:undefined,Order$1:0}});
   }
   $DIdxR(Self$73._Items,Self$73._ItemCount,"").Data$3 = Item;
   $DIdxR(Self$73._Items,Self$73._ItemCount,"").Order$1 = 0;
   Result = Self$73._ItemCount;
   ++Self$73._ItemCount;
   return Result
}
/// function TG2QuickSortListVariant.Add(var Self: TG2QuickSortListVariant; const Item: Variant; const Order: Float) : Integer
function TG2QuickSortListVariant$Add$3(Self$74, Item$1, Order$5) {
   var Result = 0;
   var l$1 = 0;
   var h$7 = 0;
   var m$2 = 0;
   l$1 = 0;
   h$7 = Self$74._ItemCount-1;
   while (l$1<=h$7) {
      m$2 = $Div(l$1+h$7,2);
      if (($DIdxR(Self$74._Items,m$2,"").Order$1-Order$5)<0) {
         l$1 = m$2+1;
      } else {
         h$7 = m$2-1;
      }
   }
   TG2QuickSortListVariant$InsertItem(Self$74,l$1,Item$1,Order$5);
   Result = l$1;
   return Result
}
/// procedure TG2QuickSortListVariant.Clear(var Self: TG2QuickSortListVariant)
function TG2QuickSortListVariant$Clear$5(Self$75) {
   Self$75._ItemCount = 0;
}
/// procedure TG2QuickSortListVariant.Delete(var Self: TG2QuickSortListVariant; const Index: Integer)
function TG2QuickSortListVariant$Delete$1(Self$76, Index$13) {
   var i$47 = 0;
   var $temp98;
   for(i$47 = Index$13,$temp98 = Self$76._ItemCount-2;i$47<=$temp98;i$47++) {
      $DIdxR(Self$76._Items,i$47,"").Data$3 = $DIdxR(Self$76._Items,i$47+1,"").Data$3;
      $DIdxR(Self$76._Items,i$47,"").Order$1 = $DIdxR(Self$76._Items,i$47+1,"").Order$1;
   }
   --Self$76._ItemCount;
}
/// function TG2QuickSortListVariant.GetCapacity(var Self: TG2QuickSortListVariant) : Integer
function TG2QuickSortListVariant$GetCapacity(Self$77) {
   return Self$77._Items.length;
}
/// function TG2QuickSortListVariant.GetFirst(var Self: TG2QuickSortListVariant) : Variant
function TG2QuickSortListVariant$GetFirst(Self$78) {
   var Result = undefined;
   if (Self$78._ItemCount>0) {
      Result = $DIdxR(Self$78._Items,0,"").Data$3;
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickSortListVariant.GetItem(var Self: TG2QuickSortListVariant; const Index: Integer) : Variant
function TG2QuickSortListVariant$GetItem$6(Self$79, Index$14) {
   return $DIdxR(Self$79._Items,Index$14,"").Data$3;
}
/// function TG2QuickSortListVariant.GetLast(var Self: TG2QuickSortListVariant) : Variant
function TG2QuickSortListVariant$GetLast(Self$80) {
   var Result = undefined;
   if (Self$80._ItemCount>0) {
      Result = $DIdxR(Self$80._Items,Self$80._ItemCount-1,"").Data$3;
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickSortListVariant.InsertItem(var Self: TG2QuickSortListVariant; const Pos: Integer; const Item: Variant; const Order: Float)
function TG2QuickSortListVariant$InsertItem(Self$81, Pos$13, Item$2, Order$6) {
   var i$48 = 0;
   if (Self$81._Items.length<=Self$81._ItemCount) {
      $ArraySetLenC(Self$81._Items,(Self$81._Items.length+32),function (){return {Data$3:undefined,Order$1:0}});
   }
   var $temp99;
   for(i$48 = Self$81._ItemCount,$temp99 = Pos$13+1;i$48>=$temp99;i$48--) {
      $DIdxR(Self$81._Items,i$48,"").Data$3 = $DIdxR(Self$81._Items,i$48-1,"").Data$3;
      $DIdxR(Self$81._Items,i$48,"").Order$1 = $DIdxR(Self$81._Items,i$48-1,"").Order$1;
   }
   $DIdxR(Self$81._Items,Pos$13,"").Data$3 = Item$2;
   $DIdxR(Self$81._Items,Pos$13,"").Order$1 = Order$6;
   ++Self$81._ItemCount;
}
/// function TG2QuickSortListVariant.Pop(var Self: TG2QuickSortListVariant) : Variant
function TG2QuickSortListVariant$Pop(Self$82) {
   var Result = undefined;
   if (Self$82._ItemCount>0) {
      Result = $DIdxR(Self$82._Items,Self$82._ItemCount-1,"").Data$3;
      TG2QuickSortListVariant$Delete$1(Self$82,(Self$82._ItemCount-1));
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickSortListVariant.Remove(var Self: TG2QuickSortListVariant; const Item: Variant)
function TG2QuickSortListVariant$Remove$3(Self$83, Item$3) {
   var i$49 = 0;
   var $temp100;
   for(i$49 = 0,$temp100 = Self$83._ItemCount;i$49<$temp100;i$49++) {
      if ($DIdxR(Self$83._Items,i$49,"").Data$3==Item$3) {
         TG2QuickSortListVariant$Delete$1(Self$83,i$49);
         return;
      }
   }
}
/// procedure TG2QuickSortListVariant.SetCapacity(var Self: TG2QuickSortListVariant; const Value: Integer)
function TG2QuickSortListVariant$SetCapacity(Self$84, Value$33) {
   $ArraySetLenC(Self$84._Items,Value$33,function (){return {Data$3:undefined,Order$1:0}});
}
/// procedure TG2QuickSortListVariant.SetItem(var Self: TG2QuickSortListVariant; const Index: Integer; const Value: Variant)
function TG2QuickSortListVariant$SetItem$2(Self$85, Index$15, Value$34) {
   $DIdxR(Self$85._Items,Index$15,"").Data$3 = Value$34;
}
/// TG2QuickSortListItemVariant = record
function Copy$TG2QuickSortListItemVariant(s,d) {
   d.Data$3=s.Data$3;
   d.Order$1=s.Order$1;
   return d;
}
function Clone$TG2QuickSortListItemVariant($) {
   return {
      Data$3:$.Data$3,
      Order$1:$.Order$1
   }
}
/// TG2QuickSortListItemInt = record
function Copy$TG2QuickSortListItemInt(s,d) {
   d.Data$4=s.Data$4;
   d.Order$2=s.Order$2;
   return d;
}
function Clone$TG2QuickSortListItemInt($) {
   return {
      Data$4:$.Data$4,
      Order$2:$.Order$2
   }
}
/// TG2QuickSortListItem = record
function Copy$TG2QuickSortListItem(s,d) {
   d.Data$5=s.Data$5;
   d.Order$3=s.Order$3;
   return d;
}
function Clone$TG2QuickSortListItem($) {
   return {
      Data$5:$.Data$5,
      Order$3:$.Order$3
   }
}
/// TG2QuickSortListInt = record
function Copy$TG2QuickSortListInt(s,d) {
   d._ItemCount$1=s._ItemCount$1;
   d._Items$1=s._Items$1;
   return d;
}
function Clone$TG2QuickSortListInt($) {
   return {
      _ItemCount$1:$._ItemCount$1,
      _Items$1:$._Items$1
   }
}
/// function TG2QuickSortListInt.Add(var Self: TG2QuickSortListInt; const Item: Integer) : Integer
function TG2QuickSortListInt$Add$6(Self$86, Item$4) {
   var Result = 0;
   if (Self$86._Items$1.length<=Self$86._ItemCount$1) {
      $ArraySetLenC(Self$86._Items$1,(Self$86._Items$1.length+32),function (){return {Data$3:undefined,Order$1:0}});
   }
   $DIdxR(Self$86._Items$1,Self$86._ItemCount$1,"").Data$3 = Item$4;
   $DIdxR(Self$86._Items$1,Self$86._ItemCount$1,"").Order$1 = 0;
   Result = Self$86._ItemCount$1;
   ++Self$86._ItemCount$1;
   return Result
}
/// function TG2QuickSortListInt.Add(var Self: TG2QuickSortListInt; const Item: Integer; const Order: Float) : Integer
function TG2QuickSortListInt$Add$5(Self$87, Item$5, Order$7) {
   var Result = 0;
   var l$2 = 0;
   var h$8 = 0;
   var m$3 = 0;
   l$2 = 0;
   h$8 = Self$87._ItemCount$1-1;
   while (l$2<=h$8) {
      m$3 = $Div(l$2+h$8,2);
      if (($DIdxR(Self$87._Items$1,m$3,"").Order$1-Order$7)<0) {
         l$2 = m$3+1;
      } else {
         h$8 = m$3-1;
      }
   }
   TG2QuickSortListInt$InsertItem$1(Self$87,l$2,Item$5,Order$7);
   Result = l$2;
   return Result
}
/// procedure TG2QuickSortListInt.Clear(var Self: TG2QuickSortListInt)
function TG2QuickSortListInt$Clear$6(Self$88) {
   Self$88._ItemCount$1 = 0;
}
/// procedure TG2QuickSortListInt.Delete(var Self: TG2QuickSortListInt; const Index: Integer)
function TG2QuickSortListInt$Delete$2(Self$89, Index$16) {
   var i$50 = 0;
   var $temp101;
   for(i$50 = Index$16,$temp101 = Self$89._ItemCount$1-2;i$50<=$temp101;i$50++) {
      $DIdxR(Self$89._Items$1,i$50,"").Data$3 = $DIdxR(Self$89._Items$1,i$50+1,"").Data$3;
      $DIdxR(Self$89._Items$1,i$50,"").Order$1 = $DIdxR(Self$89._Items$1,i$50+1,"").Order$1;
   }
   --Self$89._ItemCount$1;
}
/// function TG2QuickSortListInt.GetCapacity(var Self: TG2QuickSortListInt) : Integer
function TG2QuickSortListInt$GetCapacity$1(Self$90) {
   return Self$90._Items$1.length;
}
/// function TG2QuickSortListInt.GetFirst(var Self: TG2QuickSortListInt) : Integer
function TG2QuickSortListInt$GetFirst$1(Self$91) {
   var Result = 0;
   if (Self$91._ItemCount$1>0) {
      Result = parseInt($DIdxR(Self$91._Items$1,0,"").Data$3,10);
   } else {
      Result = 0;
   }
   return Result
}
/// function TG2QuickSortListInt.GetItem(var Self: TG2QuickSortListInt; const Index: Integer) : Integer
function TG2QuickSortListInt$GetItem$7(Self$92, Index$17) {
   return parseInt($DIdxR(Self$92._Items$1,Index$17,"").Data$3,10);
}
/// function TG2QuickSortListInt.GetLast(var Self: TG2QuickSortListInt) : Integer
function TG2QuickSortListInt$GetLast$1(Self$93) {
   var Result = 0;
   if (Self$93._ItemCount$1>0) {
      Result = parseInt($DIdxR(Self$93._Items$1,Self$93._ItemCount$1-1,"").Data$3,10);
   } else {
      Result = 0;
   }
   return Result
}
/// procedure TG2QuickSortListInt.InsertItem(var Self: TG2QuickSortListInt; const Pos: Integer; const Item: Integer; const Order: Float)
function TG2QuickSortListInt$InsertItem$1(Self$94, Pos$14, Item$6, Order$8) {
   var i$51 = 0;
   if (Self$94._Items$1.length<=Self$94._ItemCount$1) {
      $ArraySetLenC(Self$94._Items$1,(Self$94._Items$1.length+32),function (){return {Data$3:undefined,Order$1:0}});
   }
   var $temp102;
   for(i$51 = Self$94._ItemCount$1,$temp102 = Pos$14+1;i$51>=$temp102;i$51--) {
      $DIdxR(Self$94._Items$1,i$51,"").Data$3 = $DIdxR(Self$94._Items$1,i$51-1,"").Data$3;
      $DIdxR(Self$94._Items$1,i$51,"").Order$1 = $DIdxR(Self$94._Items$1,i$51-1,"").Order$1;
   }
   $DIdxR(Self$94._Items$1,Pos$14,"").Data$3 = Item$6;
   $DIdxR(Self$94._Items$1,Pos$14,"").Order$1 = Order$8;
   ++Self$94._ItemCount$1;
}
/// function TG2QuickSortListInt.Pop(var Self: TG2QuickSortListInt) : Integer
function TG2QuickSortListInt$Pop$1(Self$95) {
   var Result = 0;
   if (Self$95._ItemCount$1>0) {
      Result = parseInt($DIdxR(Self$95._Items$1,Self$95._ItemCount$1-1,"").Data$3,10);
      TG2QuickSortListInt$Delete$2(Self$95,(Self$95._ItemCount$1-1));
   } else {
      Result = 0;
   }
   return Result
}
/// procedure TG2QuickSortListInt.Remove(var Self: TG2QuickSortListInt; const Item: Variant)
function TG2QuickSortListInt$Remove$4(Self$96, Item$7) {
   var i$52 = 0;
   var $temp103;
   for(i$52 = 0,$temp103 = Self$96._ItemCount$1;i$52<$temp103;i$52++) {
      if ($DIdxR(Self$96._Items$1,i$52,"").Data$3==Item$7) {
         TG2QuickSortListInt$Delete$2(Self$96,i$52);
         return;
      }
   }
}
/// procedure TG2QuickSortListInt.SetCapacity(var Self: TG2QuickSortListInt; const Value: Integer)
function TG2QuickSortListInt$SetCapacity$1(Self$97, Value$35) {
   $ArraySetLenC(Self$97._Items$1,Value$35,function (){return {Data$3:undefined,Order$1:0}});
}
/// procedure TG2QuickSortListInt.SetItem(var Self: TG2QuickSortListInt; const Index: Integer; const Value: Integer)
function TG2QuickSortListInt$SetItem$3(Self$98, Index$18, Value$36) {
   $DIdxR(Self$98._Items$1,Index$18,"").Data$3 = Value$36;
}
/// TG2QuickSortList = record
function Copy$TG2QuickSortList(s,d) {
   d._ItemCount$2=s._ItemCount$2;
   d._Items$2=s._Items$2;
   return d;
}
function Clone$TG2QuickSortList($) {
   return {
      _ItemCount$2:$._ItemCount$2,
      _Items$2:$._Items$2
   }
}
/// function TG2QuickSortList.Add(var Self: TG2QuickSortList; const Item: TObject) : Integer
function TG2QuickSortList$Add$8(Self$99, Item$8) {
   var Result = 0;
   if (Self$99._Items$2.length<=Self$99._ItemCount$2) {
      $ArraySetLenC(Self$99._Items$2,(Self$99._Items$2.length+32),function (){return {Data$5:null,Order$3:0}});
   }
   $DIdxR(Self$99._Items$2,Self$99._ItemCount$2,"").Data$5 = Item$8;
   $DIdxR(Self$99._Items$2,Self$99._ItemCount$2,"").Order$3 = 0;
   Result = Self$99._ItemCount$2;
   ++Self$99._ItemCount$2;
   return Result
}
/// function TG2QuickSortList.Add(var Self: TG2QuickSortList; const Item: TObject; const Order: Float) : Integer
function TG2QuickSortList$Add$7(Self$100, Item$9, Order$9) {
   var Result = 0;
   var l$3 = 0;
   var h$9 = 0;
   var m$4 = 0;
   l$3 = 0;
   h$9 = Self$100._ItemCount$2-1;
   while (l$3<=h$9) {
      m$4 = $Div(l$3+h$9,2);
      if (($DIdxR(Self$100._Items$2,m$4,"").Order$3-Order$9)<0) {
         l$3 = m$4+1;
      } else {
         h$9 = m$4-1;
      }
   }
   TG2QuickSortList$InsertItem$2(Self$100,l$3,Item$9,Order$9);
   Result = l$3;
   return Result
}
/// procedure TG2QuickSortList.Clear(var Self: TG2QuickSortList)
function TG2QuickSortList$Clear$7(Self$101) {
   Self$101._ItemCount$2 = 0;
}
/// procedure TG2QuickSortList.Delete(var Self: TG2QuickSortList; const Index: Integer)
function TG2QuickSortList$Delete$3(Self$102, Index$19) {
   var i$53 = 0;
   var $temp104;
   for(i$53 = Index$19,$temp104 = Self$102._ItemCount$2-2;i$53<=$temp104;i$53++) {
      $DIdxR(Self$102._Items$2,i$53,"").Data$5 = $DIdxR(Self$102._Items$2,i$53+1,"").Data$5;
      $DIdxR(Self$102._Items$2,i$53,"").Order$3 = $DIdxR(Self$102._Items$2,i$53+1,"").Order$3;
   }
   --Self$102._ItemCount$2;
}
/// function TG2QuickSortList.GetCapacity(var Self: TG2QuickSortList) : Integer
function TG2QuickSortList$GetCapacity$2(Self$103) {
   return Self$103._Items$2.length;
}
/// function TG2QuickSortList.GetFirst(var Self: TG2QuickSortList) : TObject
function TG2QuickSortList$GetFirst$2(Self$104) {
   var Result = null;
   if (Self$104._ItemCount$2>0) {
      Result = $DIdxR(Self$104._Items$2,0,"").Data$5;
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickSortList.GetItem(var Self: TG2QuickSortList; const Index: Integer) : TObject
function TG2QuickSortList$GetItem$8(Self$105, Index$20) {
   return $DIdxR(Self$105._Items$2,Index$20,"").Data$5;
}
/// function TG2QuickSortList.GetLast(var Self: TG2QuickSortList) : TObject
function TG2QuickSortList$GetLast$2(Self$106) {
   var Result = null;
   if (Self$106._ItemCount$2>0) {
      Result = $DIdxR(Self$106._Items$2,Self$106._ItemCount$2-1,"").Data$5;
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickSortList.InsertItem(var Self: TG2QuickSortList; const Pos: Integer; const Item: TObject; const Order: Float)
function TG2QuickSortList$InsertItem$2(Self$107, Pos$15, Item$10, Order$10) {
   var i$54 = 0;
   if (Self$107._Items$2.length<=Self$107._ItemCount$2) {
      $ArraySetLenC(Self$107._Items$2,(Self$107._Items$2.length+32),function (){return {Data$5:null,Order$3:0}});
   }
   var $temp105;
   for(i$54 = Self$107._ItemCount$2,$temp105 = Pos$15+1;i$54>=$temp105;i$54--) {
      $DIdxR(Self$107._Items$2,i$54,"").Data$5 = $DIdxR(Self$107._Items$2,i$54-1,"").Data$5;
      $DIdxR(Self$107._Items$2,i$54,"").Order$3 = $DIdxR(Self$107._Items$2,i$54-1,"").Order$3;
   }
   $DIdxR(Self$107._Items$2,Pos$15,"").Data$5 = Item$10;
   $DIdxR(Self$107._Items$2,Pos$15,"").Order$3 = Order$10;
   ++Self$107._ItemCount$2;
}
/// function TG2QuickSortList.Pop(var Self: TG2QuickSortList) : TObject
function TG2QuickSortList$Pop$2(Self$108) {
   var Result = null;
   if (Self$108._ItemCount$2>0) {
      Result = $DIdxR(Self$108._Items$2,Self$108._ItemCount$2-1,"").Data$5;
      TG2QuickSortList$Delete$3(Self$108,(Self$108._ItemCount$2-1));
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickSortList.Remove(var Self: TG2QuickSortList; const Item: TObject)
function TG2QuickSortList$Remove$5(Self$109, Item$11) {
   var i$55 = 0;
   var $temp106;
   for(i$55 = 0,$temp106 = Self$109._ItemCount$2;i$55<$temp106;i$55++) {
      if ($DIdxR(Self$109._Items$2,i$55,"").Data$5===Item$11) {
         TG2QuickSortList$Delete$3(Self$109,i$55);
         return;
      }
   }
}
/// procedure TG2QuickSortList.SetCapacity(var Self: TG2QuickSortList; const Value: Integer)
function TG2QuickSortList$SetCapacity$2(Self$110, Value$37) {
   $ArraySetLenC(Self$110._Items$2,Value$37,function (){return {Data$5:null,Order$3:0}});
}
/// procedure TG2QuickSortList.SetItem(var Self: TG2QuickSortList; const Index: Integer; const Value: TObject)
function TG2QuickSortList$SetItem$4(Self$111, Index$21, Value$38) {
   $DIdxR(Self$111._Items$2,Index$21,"").Data$5 = Value$38;
}
/// TG2QuickListVariant = record
function Copy$TG2QuickListVariant(s,d) {
   d._ItemCount$3=s._ItemCount$3;
   d._Items$3=s._Items$3;
   return d;
}
function Clone$TG2QuickListVariant($) {
   return {
      _ItemCount$3:$._ItemCount$3,
      _Items$3:$._Items$3
   }
}
/// function TG2QuickListVariant.Add(var Self: TG2QuickListVariant; const Item: Variant) : Integer
function TG2QuickListVariant$Add$9(Self$112, Item$12) {
   var Result = 0;
   if (Self$112._Items$3.length<=Self$112._ItemCount$3) {
      $ArraySetLen(Self$112._Items$3,(Self$112._Items$3.length+32),undefined);
   }
   $DIdxW(Self$112._Items$3,Self$112._ItemCount$3,Item$12,"");
   Result = Self$112._ItemCount$3;
   ++Self$112._ItemCount$3;
   return Result
}
/// procedure TG2QuickListVariant.Clear(var Self: TG2QuickListVariant)
function TG2QuickListVariant$Clear$8(Self$113) {
   Self$113._ItemCount$3 = 0;
}
/// procedure TG2QuickListVariant.Delete(var Self: TG2QuickListVariant; const Index: Integer)
function TG2QuickListVariant$Delete$4(Self$114, Index$22) {
   var i$56 = 0;
   var $temp107;
   for(i$56 = Index$22,$temp107 = Self$114._ItemCount$3-2;i$56<=$temp107;i$56++) {
      $DIdxW(Self$114._Items$3,i$56,$DIdxR(Self$114._Items$3,i$56+1,""),"");
   }
   --Self$114._ItemCount$3;
}
/// function TG2QuickListVariant.GetCapacity(var Self: TG2QuickListVariant) : Integer
function TG2QuickListVariant$GetCapacity$3(Self$115) {
   return Self$115._Items$3.length;
}
/// function TG2QuickListVariant.GetFirst(var Self: TG2QuickListVariant) : Variant
function TG2QuickListVariant$GetFirst$3(Self$116) {
   var Result = undefined;
   if (Self$116._ItemCount$3>0) {
      Result = $DIdxR(Self$116._Items$3,0,"");
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickListVariant.GetItem(var Self: TG2QuickListVariant; const Index: Integer) : Variant
function TG2QuickListVariant$GetItem$9(Self$117, Index$23) {
   return $DIdxR(Self$117._Items$3,Index$23,"");
}
/// function TG2QuickListVariant.GetLast(var Self: TG2QuickListVariant) : Variant
function TG2QuickListVariant$GetLast$3(Self$118) {
   var Result = undefined;
   if (Self$118._ItemCount$3>0) {
      Result = $DIdxR(Self$118._Items$3,Self$118._ItemCount$3-1,"");
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickListVariant.Insert(var Self: TG2QuickListVariant; const Index: Integer; const Item: Variant) : Integer
function TG2QuickListVariant$Insert$3(Self$119, Index$24, Item$13) {
   var Result = 0;
   var i$57 = 0;
   if (Self$119._Items$3.length<=Self$119._ItemCount$3) {
      $ArraySetLen(Self$119._Items$3,(Self$119._Items$3.length+32),undefined);
   }
   if (Index$24<Self$119._ItemCount$3) {
      var $temp108;
      for(i$57 = Self$119._ItemCount$3-1,$temp108 = Index$24;i$57>=$temp108;i$57--) {
         $DIdxW(Self$119._Items$3,i$57+1,$DIdxR(Self$119._Items$3,i$57,""),"");
      }
      $DIdxW(Self$119._Items$3,Index$24,Item$13,"");
      Result = Index$24;
   } else {
      $DIdxW(Self$119._Items$3,Self$119._ItemCount$3,Item$13,"");
      Result = Self$119._ItemCount$3;
   }
   ++Self$119._ItemCount$3;
   return Result
}
/// function TG2QuickListVariant.Pop(var Self: TG2QuickListVariant) : Variant
function TG2QuickListVariant$Pop$3(Self$120) {
   var Result = undefined;
   if (Self$120._ItemCount$3>0) {
      Result = $DIdxR(Self$120._Items$3,Self$120._ItemCount$3-1,"");
      TG2QuickListVariant$Delete$4(Self$120,(Self$120._ItemCount$3-1));
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickListVariant.Remove(var Self: TG2QuickListVariant; const Item: Variant)
function TG2QuickListVariant$Remove$6(Self$121, Item$14) {
   var i$58 = 0;
   var $temp109;
   for(i$58 = 0,$temp109 = Self$121._ItemCount$3;i$58<$temp109;i$58++) {
      if ($DIdxR(Self$121._Items$3,i$58,"")==Item$14) {
         TG2QuickListVariant$Delete$4(Self$121,i$58);
         return;
      }
   }
}
/// procedure TG2QuickListVariant.SetCapacity(var Self: TG2QuickListVariant; const Value: Integer)
function TG2QuickListVariant$SetCapacity$3(Self$122, Value$39) {
   $ArraySetLen(Self$122._Items$3,Value$39,undefined);
}
/// procedure TG2QuickListVariant.SetItem(var Self: TG2QuickListVariant; const Index: Integer; const Value: Variant)
function TG2QuickListVariant$SetItem$5(Self$123, Index$25, Value$40) {
   $DIdxW(Self$123._Items$3,Index$25,Value$40,"");
}
/// TG2QuickListInt = record
function Copy$TG2QuickListInt(s,d) {
   d._ItemCount$4=s._ItemCount$4;
   d._Items$4=s._Items$4;
   return d;
}
function Clone$TG2QuickListInt($) {
   return {
      _ItemCount$4:$._ItemCount$4,
      _Items$4:$._Items$4
   }
}
/// function TG2QuickListInt.Add(var Self: TG2QuickListInt; const Item: Integer) : Integer
function TG2QuickListInt$Add$10(Self$124, Item$15) {
   var Result = 0;
   if (Self$124._Items$4.length<=Self$124._ItemCount$4) {
      $ArraySetLen(Self$124._Items$4,(Self$124._Items$4.length+32),0);
   }
   $DIdxW(Self$124._Items$4,Self$124._ItemCount$4,Item$15,"");
   Result = Self$124._ItemCount$4;
   ++Self$124._ItemCount$4;
   return Result
}
/// procedure TG2QuickListInt.Clear(var Self: TG2QuickListInt)
function TG2QuickListInt$Clear$9(Self$125) {
   Self$125._ItemCount$4 = 0;
}
/// procedure TG2QuickListInt.Delete(var Self: TG2QuickListInt; const Index: Integer)
function TG2QuickListInt$Delete$5(Self$126, Index$26) {
   var i$59 = 0;
   var $temp110;
   for(i$59 = Index$26,$temp110 = Self$126._ItemCount$4-2;i$59<=$temp110;i$59++) {
      $DIdxW(Self$126._Items$4,i$59,$DIdxR(Self$126._Items$4,i$59+1,""),"");
   }
   --Self$126._ItemCount$4;
}
/// function TG2QuickListInt.GetCapacity(var Self: TG2QuickListInt) : Integer
function TG2QuickListInt$GetCapacity$4(Self$127) {
   return Self$127._Items$4.length;
}
/// function TG2QuickListInt.GetFirst(var Self: TG2QuickListInt) : Integer
function TG2QuickListInt$GetFirst$4(Self$128) {
   var Result = 0;
   if (Self$128._ItemCount$4>0) {
      Result = $DIdxR(Self$128._Items$4,0,"");
   } else {
      Result = 0;
   }
   return Result
}
/// function TG2QuickListInt.GetItem(var Self: TG2QuickListInt; const Index: Integer) : Integer
function TG2QuickListInt$GetItem$10(Self$129, Index$27) {
   return $DIdxR(Self$129._Items$4,Index$27,"");
}
/// function TG2QuickListInt.GetLast(var Self: TG2QuickListInt) : Integer
function TG2QuickListInt$GetLast$4(Self$130) {
   var Result = 0;
   if (Self$130._ItemCount$4>0) {
      Result = $DIdxR(Self$130._Items$4,Self$130._ItemCount$4-1,"");
   } else {
      Result = 0;
   }
   return Result
}
/// function TG2QuickListInt.Insert(var Self: TG2QuickListInt; const Index: Integer; const Item: Integer) : Integer
function TG2QuickListInt$Insert$4(Self$131, Index$28, Item$16) {
   var Result = 0;
   var i$60 = 0;
   if (Self$131._Items$4.length<=Self$131._ItemCount$4) {
      $ArraySetLen(Self$131._Items$4,(Self$131._Items$4.length+32),0);
   }
   if (Index$28<Self$131._ItemCount$4) {
      var $temp111;
      for(i$60 = Self$131._ItemCount$4-1,$temp111 = Index$28;i$60>=$temp111;i$60--) {
         $DIdxW(Self$131._Items$4,i$60+1,$DIdxR(Self$131._Items$4,i$60,""),"");
      }
      $DIdxW(Self$131._Items$4,Index$28,Item$16,"");
      Result = Index$28;
   } else {
      $DIdxW(Self$131._Items$4,Self$131._ItemCount$4,Item$16,"");
      Result = Self$131._ItemCount$4;
   }
   ++Self$131._ItemCount$4;
   return Result
}
/// function TG2QuickListInt.Pop(var Self: TG2QuickListInt) : Integer
function TG2QuickListInt$Pop$4(Self$132) {
   var Result = 0;
   if (Self$132._ItemCount$4>0) {
      Result = $DIdxR(Self$132._Items$4,Self$132._ItemCount$4-1,"");
      TG2QuickListInt$Delete$5(Self$132,(Self$132._ItemCount$4-1));
   } else {
      Result = 0;
   }
   return Result
}
/// procedure TG2QuickListInt.Remove(var Self: TG2QuickListInt; const Item: Integer)
function TG2QuickListInt$Remove$7(Self$133, Item$17) {
   var i$61 = 0;
   var $temp112;
   for(i$61 = 0,$temp112 = Self$133._ItemCount$4;i$61<$temp112;i$61++) {
      if ($DIdxR(Self$133._Items$4,i$61,"")==Item$17) {
         TG2QuickListInt$Delete$5(Self$133,i$61);
         return;
      }
   }
}
/// procedure TG2QuickListInt.SetCapacity(var Self: TG2QuickListInt; const Value: Integer)
function TG2QuickListInt$SetCapacity$4(Self$134, Value$41) {
   $ArraySetLen(Self$134._Items$4,Value$41,0);
}
/// procedure TG2QuickListInt.SetItem(var Self: TG2QuickListInt; const Index: Integer; const Value: Integer)
function TG2QuickListInt$SetItem$6(Self$135, Index$29, Value$42) {
   $DIdxW(Self$135._Items$4,Index$29,Value$42,"");
}
/// TG2QuickList = record
function Copy$TG2QuickList(s,d) {
   d._ItemCount$5=s._ItemCount$5;
   d._Items$5=s._Items$5;
   return d;
}
function Clone$TG2QuickList($) {
   return {
      _ItemCount$5:$._ItemCount$5,
      _Items$5:$._Items$5
   }
}
/// function TG2QuickList.Add(var Self: TG2QuickList; const Item: TObject) : Integer
function TG2QuickList$Add$11(Self$136, Item$18) {
   var Result = 0;
   if (Self$136._Items$5.length<=Self$136._ItemCount$5) {
      $ArraySetLenC(Self$136._Items$5,(Self$136._Items$5.length+32),function (){return null});
   }
   $DIdxW(Self$136._Items$5,Self$136._ItemCount$5,Item$18,"");
   Result = Self$136._ItemCount$5;
   ++Self$136._ItemCount$5;
   return Result
}
/// procedure TG2QuickList.Clear(var Self: TG2QuickList)
function TG2QuickList$Clear$10(Self$137) {
   Self$137._ItemCount$5 = 0;
}
/// procedure TG2QuickList.Delete(var Self: TG2QuickList; const Index: Integer)
function TG2QuickList$Delete$6(Self$138, Index$30) {
   var i$62 = 0;
   var $temp113;
   for(i$62 = Index$30,$temp113 = Self$138._ItemCount$5-2;i$62<=$temp113;i$62++) {
      $DIdxW(Self$138._Items$5,i$62,$DIdxR(Self$138._Items$5,i$62+1,""),"");
   }
   --Self$138._ItemCount$5;
}
/// function TG2QuickList.GetCapacity(var Self: TG2QuickList) : Integer
function TG2QuickList$GetCapacity$5(Self$139) {
   return Self$139._Items$5.length;
}
/// function TG2QuickList.GetFirst(var Self: TG2QuickList) : TObject
function TG2QuickList$GetFirst$5(Self$140) {
   var Result = null;
   if (Self$140._ItemCount$5>0) {
      Result = $DIdxR(Self$140._Items$5,0,"");
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickList.GetItem(var Self: TG2QuickList; const Index: Integer) : TObject
function TG2QuickList$GetItem$11(Self$141, Index$31) {
   return $DIdxR(Self$141._Items$5,Index$31,"");
}
/// function TG2QuickList.GetLast(var Self: TG2QuickList) : TObject
function TG2QuickList$GetLast$5(Self$142) {
   var Result = null;
   if (Self$142._ItemCount$5>0) {
      Result = $DIdxR(Self$142._Items$5,Self$142._ItemCount$5-1,"");
   } else {
      Result = null;
   }
   return Result
}
/// function TG2QuickList.Insert(var Self: TG2QuickList; const Index: Integer; const Item: TObject) : Integer
function TG2QuickList$Insert$5(Self$143, Index$32, Item$19) {
   var Result = 0;
   var i$63 = 0;
   if (Self$143._Items$5.length<=Self$143._ItemCount$5) {
      $ArraySetLenC(Self$143._Items$5,(Self$143._Items$5.length+32),function (){return null});
   }
   if (Index$32<Self$143._ItemCount$5) {
      var $temp114;
      for(i$63 = Self$143._ItemCount$5-1,$temp114 = Index$32;i$63>=$temp114;i$63--) {
         $DIdxW(Self$143._Items$5,i$63+1,$DIdxR(Self$143._Items$5,i$63,""),"");
      }
      $DIdxW(Self$143._Items$5,Index$32,Item$19,"");
      Result = Index$32;
   } else {
      $DIdxW(Self$143._Items$5,Self$143._ItemCount$5,Item$19,"");
      Result = Self$143._ItemCount$5;
   }
   ++Self$143._ItemCount$5;
   return Result
}
/// function TG2QuickList.Pop(var Self: TG2QuickList) : TObject
function TG2QuickList$Pop$5(Self$144) {
   var Result = null;
   if (Self$144._ItemCount$5>0) {
      Result = $DIdxR(Self$144._Items$5,Self$144._ItemCount$5-1,"");
      TG2QuickList$Delete$6(Self$144,(Self$144._ItemCount$5-1));
   } else {
      Result = null;
   }
   return Result
}
/// procedure TG2QuickList.Remove(var Self: TG2QuickList; const Item: TObject)
function TG2QuickList$Remove$8(Self$145, Item$20) {
   var i$64 = 0;
   var $temp115;
   for(i$64 = 0,$temp115 = Self$145._ItemCount$5;i$64<$temp115;i$64++) {
      if ($DIdxR(Self$145._Items$5,i$64,"")===Item$20) {
         TG2QuickList$Delete$6(Self$145,i$64);
         return;
      }
   }
}
/// procedure TG2QuickList.SetCapacity(var Self: TG2QuickList; const Value: Integer)
function TG2QuickList$SetCapacity$5(Self$146, Value$43) {
   $ArraySetLenC(Self$146._Items$5,Value$43,function (){return null});
}
/// procedure TG2QuickList.SetItem(var Self: TG2QuickList; const Index: Integer; const Value: TObject)
function TG2QuickList$SetItem$7(Self$147, Index$33, Value$44) {
   $DIdxW(Self$147._Items$5,Index$33,Value$44,"");
}
/// TG2AsyncState enumeration
var TG2AsyncState = [ "asIdle", "asLoading", "asLoaded", "asError" ];
function G2TimeInterval(Interval) {
   return (G2Time()%Interval)/Interval;
};
function G2TimeInterval$1(Interval$1, Time$1) {
   return (Time$1%Interval$1)/Interval$1;
};
function G2Time() {
   var Result = 0;
   
    Result = new Date().getTime();
  return Result
};
function G2StrExplode(Str, Separator) {
   var Result = [];
   var Arr = undefined;
   var i = 0;
   var n$2 = 0;
    Arr = (Str).split(Separator); n$2 = (Arr).length; $ArraySetLen(Result,n$2,"");
   var $temp116;
   for(i = 0,$temp116 = n$2;i<$temp116;i++) {
       Result[i] = Arr[i];    }
   return Result
};
function G2RandomSpherePoint() {
   var Result = {Arr$2:[0,0,0]};
   var a1 = 0;
   var a2 = 0;
   var s1 = {};
   s1.v = 0;
   var s2 = {};
   s2.v = 0;
   var c1 = {};
   c1.v = 0;
   var c2 = {};
   c2.v = 0;
   a1 = G2Random2Pi();
   a2 = G2Random2Pi();
   G2SinCos(a1,s1,c1);
   G2SinCos(a2,s2,c2);
   TG2Vec3$SetValue$1(Result,(c1.v*c2.v),s2.v,(s1.v*c2.v));
   return Result
};
function G2RandomPi() {
   return Random()*3.14159265358979;
};
function G2RandomCirclePoint() {
   var Result = {Arr$3:[0,0]};
   var a = 0;
   var s = {};
   s.v = 0;
   var c = {};
   c.v = 0;
   a = G2Random2Pi();
   G2SinCos(a,s,c);
   TG2Vec2$SetX$2(Result,c.v);
   TG2Vec2$SetY$2(Result,s.v);
   return Result
};
function G2Random2Pi() {
   return Random()*6.28318530717959;
};
function G2Random(n$8) {
   return Trunc(Random()*0.99999*n$8);
};
function G2PiTime(Amp) {
   return (G2Time()%Math.round(6.28318530717959*Amp))/Amp;
};
function G2PiTime$1(Amp$1, Time$2) {
   return (Time$2%Math.round(6.28318530717959*Amp$1))/Amp$1;
};
function G2Char(n$9) {
   var Result = "";
   
    (Result) = String.fromCharCode(n$9);
  return Result
};
/// TG2Vec4 = record
function Copy$TG2Vec4(s,d) {
   d.Arr$1=s.Arr$1.slice(0);
   return d;
}
function Clone$TG2Vec4($) {
   return {
      Arr$1:$.Arr$1.slice(0)
   }
}
/// function TG2Vec4.CopyRef(var Self: TG2Vec4) : TG2Vec4
function TG2Vec4$CopyRef(Self$148) {
   var Result = {Arr$1:[0,0,0,0]};
    Result = Self$148; return Result
}
/// function TG2Vec4.GetE(var Self: TG2Vec4; const Index: Integer) : TG2Float
function TG2Vec4$GetE(Self$149, Index$34) {
   return Self$149.Arr$1[$Idx(Index$34,0,3,"")];
}
/// function TG2Vec4.GetW(var Self: TG2Vec4) : TG2Float
function TG2Vec4$GetW(Self$150) {
   return Self$150.Arr$1[3];
}
/// function TG2Vec4.GetX(var Self: TG2Vec4) : TG2Float
function TG2Vec4$GetX(Self$151) {
   return Self$151.Arr$1[0];
}
/// function TG2Vec4.GetY(var Self: TG2Vec4) : TG2Float
function TG2Vec4$GetY(Self$152) {
   return Self$152.Arr$1[1];
}
/// function TG2Vec4.GetZ(var Self: TG2Vec4) : TG2Float
function TG2Vec4$GetZ(Self$153) {
   return Self$153.Arr$1[2];
}
/// function TG2Vec4.Instance() : TG2Vec4
function Instance$1() {
   var Result = {Arr$1:[0,0,0,0]};
   var v$9 = {Arr$1:[0,0,0,0]};
    Result = v$9; return Result
}
/// procedure TG2Vec4.SetE(var Self: TG2Vec4; const Index: Integer; const Value: TG2Float)
function TG2Vec4$SetE(Self$154, Index$35, Value$45) {
   Self$154.Arr$1[$Idx(Index$35,0,3,"")] = Value$45;
}
/// procedure TG2Vec4.SetValue(var Self: TG2Vec4; const _x: TG2Float; const _y: TG2Float; const _z: TG2Float; const _w: TG2Float)
function TG2Vec4$SetValue(Self$155, _x, _y, _z, _w) {
   TG2Vec4$SetX(Self$155,_x);
   TG2Vec4$SetY(Self$155,_y);
   TG2Vec4$SetZ(Self$155,_z);
   TG2Vec4$SetW(Self$155,_w);
}
/// procedure TG2Vec4.SetW(var Self: TG2Vec4; const Value: TG2Float)
function TG2Vec4$SetW(Self$156, Value$46) {
   Self$156.Arr$1[3] = Value$46;
}
/// procedure TG2Vec4.SetX(var Self: TG2Vec4; const Value: TG2Float)
function TG2Vec4$SetX(Self$157, Value$47) {
   Self$157.Arr$1[0] = Value$47;
}
/// procedure TG2Vec4.SetY(var Self: TG2Vec4; const Value: TG2Float)
function TG2Vec4$SetY(Self$158, Value$48) {
   Self$158.Arr$1[1] = Value$48;
}
/// procedure TG2Vec4.SetZ(var Self: TG2Vec4; const Value: TG2Float)
function TG2Vec4$SetZ(Self$159, Value$49) {
   Self$159.Arr$1[2] = Value$49;
}
/// function TG2Vec4.ToFloat32Array(var Self: TG2Vec4) : JFloat32Array
function TG2Vec4$ToFloat32Array(Self$160) {
   var Result = null;
   
    Result = new Float32Array(Self$160.Arr$1);
  return Result
}
/// TG2Vec3 = record
function Copy$TG2Vec3(s,d) {
   d.Arr$2=s.Arr$2.slice(0);
   return d;
}
function Clone$TG2Vec3($) {
   return {
      Arr$2:$.Arr$2.slice(0)
   }
}
/// function TG2Vec3.CopyRef(var Self: TG2Vec3) : TG2Vec3
function TG2Vec3$CopyRef$1(Self$161) {
   var Result = {Arr$2:[0,0,0]};
    Result = Self$161; return Result
}
/// function TG2Vec3.Cross(var Self: TG2Vec3; const v: TG2Vec3) : TG2Vec3
function TG2Vec3$Cross(Self$162, v$10) {
   return G2Vec3Cross(Self$162,v$10);
}
/// function TG2Vec3.Dot(var Self: TG2Vec3; const v: TG2Vec3) : TG2Float
function TG2Vec3$Dot(Self$163, v$11) {
   return G2Vec3Dot(Self$163,v$11);
}
/// function TG2Vec3.GetE(var Self: TG2Vec3; const Index: Integer) : TG2Float
function TG2Vec3$GetE$1(Self$164, Index$36) {
   return Self$164.Arr$2[$Idx(Index$36,0,2,"")];
}
/// function TG2Vec3.GetX(var Self: TG2Vec3) : TG2Float
function TG2Vec3$GetX$1(Self$165) {
   return Self$165.Arr$2[0];
}
/// function TG2Vec3.GetY(var Self: TG2Vec3) : TG2Float
function TG2Vec3$GetY$1(Self$166) {
   return Self$166.Arr$2[1];
}
/// function TG2Vec3.GetZ(var Self: TG2Vec3) : TG2Float
function TG2Vec3$GetZ$1(Self$167) {
   return Self$167.Arr$2[2];
}
/// function TG2Vec3.Instance() : TG2Vec3
function Instance$2() {
   var Result = {Arr$2:[0,0,0]};
   var v$12 = {Arr$2:[0,0,0]};
    Result = v$12; return Result
}
/// function TG2Vec3.Len(var Self: TG2Vec3) : TG2Float
function TG2Vec3$Len(Self$168) {
   return G2Vec3Len(Self$168);
}
/// function TG2Vec3.LenSq(var Self: TG2Vec3) : TG2Float
function TG2Vec3$LenSq(Self$169) {
   return (TG2Vec3$GetX$1(Self$169)*TG2Vec3$GetX$1(Self$169))+(TG2Vec3$GetY$1(Self$169)*TG2Vec3$GetY$1(Self$169));
}
/// function TG2Vec3.Norm(var Self: TG2Vec3) : TG2Vec3
function TG2Vec3$Norm(Self$170) {
   return G2Vec3Norm(Self$170);
}
/// procedure TG2Vec3.SetE(var Self: TG2Vec3; const Index: Integer; const Value: TG2Float)
function TG2Vec3$SetE$1(Self$171, Index$37, Value$50) {
   Self$171.Arr$2[$Idx(Index$37,0,2,"")] = Value$50;
}
/// procedure TG2Vec3.SetValue(var Self: TG2Vec3; const _x: TG2Float; const _y: TG2Float; const _z: TG2Float)
function TG2Vec3$SetValue$1(Self$172, _x$1, _y$1, _z$1) {
   TG2Vec3$SetX$1(Self$172,_x$1);
   TG2Vec3$SetY$1(Self$172,_y$1);
   TG2Vec3$SetZ$1(Self$172,_z$1);
}
/// procedure TG2Vec3.SetX(var Self: TG2Vec3; const Value: TG2Float)
function TG2Vec3$SetX$1(Self$173, Value$51) {
   Self$173.Arr$2[0] = Value$51;
}
/// procedure TG2Vec3.SetY(var Self: TG2Vec3; const Value: TG2Float)
function TG2Vec3$SetY$1(Self$174, Value$52) {
   Self$174.Arr$2[1] = Value$52;
}
/// procedure TG2Vec3.SetZ(var Self: TG2Vec3; const Value: TG2Float)
function TG2Vec3$SetZ$1(Self$175, Value$53) {
   Self$175.Arr$2[2] = Value$53;
}
/// function TG2Vec3.ToFloat32Array(var Self: TG2Vec3) : JFloat32Array
function TG2Vec3$ToFloat32Array$1(Self$176) {
   var Result = null;
   
    Result = new Float32Array(Self$176.Arr$2);
  return Result
}
/// TG2Vec2 = record
function Copy$TG2Vec2(s,d) {
   d.Arr$3=s.Arr$3.slice(0);
   return d;
}
function Clone$TG2Vec2($) {
   return {
      Arr$3:$.Arr$3.slice(0)
   }
}
/// function TG2Vec2.CopyRef(var Self: TG2Vec2) : TG2Vec2
function TG2Vec2$CopyRef$2(Self$177) {
   var Result = {Arr$3:[0,0]};
    Result = Self$177; return Result
}
/// function TG2Vec2.GetE(var Self: TG2Vec2; const Index: Integer) : TG2Float
function TG2Vec2$GetE$2(Self$178, Index$38) {
   return Self$178.Arr$3[$Idx(Index$38,0,1,"")];
}
/// function TG2Vec2.GetX(var Self: TG2Vec2) : TG2Float
function TG2Vec2$GetX$2(Self$179) {
   return Self$179.Arr$3[0];
}
/// function TG2Vec2.GetY(var Self: TG2Vec2) : TG2Float
function TG2Vec2$GetY$2(Self$180) {
   return Self$180.Arr$3[1];
}
/// function TG2Vec2.Instance() : TG2Vec2
function Instance$3() {
   var Result = {Arr$3:[0,0]};
   var v$13 = {Arr$3:[0,0]};
    Result = v$13; return Result
}
/// function TG2Vec2.Len(var Self: TG2Vec2) : TG2Float
function TG2Vec2$Len$1(Self$181) {
   return G2Vec2Len(Self$181);
}
/// function TG2Vec2.LenSq(var Self: TG2Vec2) : TG2Float
function TG2Vec2$LenSq$1(Self$182) {
   return G2Vec2LenSq(Self$182);
}
/// function TG2Vec2.Norm(var Self: TG2Vec2) : TG2Vec2
function TG2Vec2$Norm$1(Self$183) {
   return G2Vec2Norm(Self$183);
}
/// function TG2Vec2.Perp(var Self: TG2Vec2) : TG2Vec2
function TG2Vec2$Perp(Self$184) {
   return G2Vec2Perp(Self$184);
}
/// procedure TG2Vec2.SetE(var Self: TG2Vec2; const Index: Integer; const Value: TG2Float)
function TG2Vec2$SetE$2(Self$185, Index$39, Value$54) {
   Self$185.Arr$3[$Idx(Index$39,0,1,"")] = Value$54;
}
/// procedure TG2Vec2.SetValue(var Self: TG2Vec2; const _x: TG2Float; const _y: TG2Float)
function TG2Vec2$SetValue$2(Self$186, _x$2, _y$2) {
   TG2Vec2$SetX$2(Self$186,_x$2);
   TG2Vec2$SetY$2(Self$186,_y$2);
}
/// procedure TG2Vec2.SetX(var Self: TG2Vec2; const Value: TG2Float)
function TG2Vec2$SetX$2(Self$187, Value$55) {
   Self$187.Arr$3[0] = Value$55;
}
/// procedure TG2Vec2.SetY(var Self: TG2Vec2; const Value: TG2Float)
function TG2Vec2$SetY$2(Self$188, Value$56) {
   Self$188.Arr$3[1] = Value$56;
}
/// function TG2Vec2.ToFloat32Array(var Self: TG2Vec2) : JFloat32Array
function TG2Vec2$ToFloat32Array$2(Self$189) {
   var Result = null;
   
    Result = new Float32Array(Self$189.Arr$3);
  return Result
}
/// TG2Sphere = record
function Copy$TG2Sphere(s,d) {
   Copy$TG2Vec3(s.c$1,d.c$1);
   d.r$1=s.r$1;
   return d;
}
function Clone$TG2Sphere($) {
   return {
      c$1:Clone$TG2Vec3($.c$1),
      r$1:$.r$1
   }
}
/// procedure TG2Sphere.SetValue(var Self: TG2Sphere; const sc: TG2Vec3; const sr: TG2Float)
function TG2Sphere$SetValue$3(Self$190, sc, sr$9) {
   Copy$TG2Vec3(sc,Self$190.c$1);
   Self$190.r$1 = sr$9;
}
/// TG2Rect = record
function Copy$TG2Rect(s,d) {
   d.l=s.l;
   d.t=s.t;
   d.r$2=s.r$2;
   d.b$1=s.b$1;
   return d;
}
function Clone$TG2Rect($) {
   return {
      l:$.l,
      t:$.t,
      r$2:$.r$2,
      b$1:$.b$1
   }
}
/// TG2Ray = record
function Copy$TG2Ray(s,d) {
   Copy$TG2Vec3(s.Origin,d.Origin);
   Copy$TG2Vec3(s.Dir,d.Dir);
   return d;
}
function Clone$TG2Ray($) {
   return {
      Origin:Clone$TG2Vec3($.Origin),
      Dir:Clone$TG2Vec3($.Dir)
   }
}
/// procedure TG2Ray.SetValue(var Self: TG2Ray; const ROrigin: TG2Vec3; const RDir: TG2Vec3)
function TG2Ray$SetValue$4(Self$191, ROrigin, RDir) {
   Copy$TG2Vec3(ROrigin,Self$191.Origin);
   Copy$TG2Vec3(RDir,Self$191.Dir);
}
/// TG2Quat = record
function Copy$TG2Quat(s,d) {
   d.Arr$4=s.Arr$4.slice(0);
   return d;
}
function Clone$TG2Quat($) {
   return {
      Arr$4:$.Arr$4.slice(0)
   }
}
/// function TG2Quat.CopyRef(var Self: TG2Quat) : TG2Quat
function TG2Quat$CopyRef$3(Self$192) {
   var Result = {Arr$4:[0,0,0,0]};
    Result = Self$192; return Result
}
/// function TG2Quat.GetE(var Self: TG2Quat; const Index: Integer) : TG2Float
function TG2Quat$GetE$3(Self$193, Index$40) {
   return Self$193.Arr$4[$Idx(Index$40,0,3,"")];
}
/// function TG2Quat.GetW(var Self: TG2Quat) : TG2Float
function TG2Quat$GetW$1(Self$194) {
   return Self$194.Arr$4[3];
}
/// function TG2Quat.GetX(var Self: TG2Quat) : TG2Float
function TG2Quat$GetX$3(Self$195) {
   return Self$195.Arr$4[0];
}
/// function TG2Quat.GetY(var Self: TG2Quat) : TG2Float
function TG2Quat$GetY$3(Self$196) {
   return Self$196.Arr$4[1];
}
/// function TG2Quat.GetZ(var Self: TG2Quat) : TG2Float
function TG2Quat$GetZ$2(Self$197) {
   return Self$197.Arr$4[2];
}
/// function TG2Quat.Instance() : TG2Quat
function Instance$4() {
   var Result = {Arr$4:[0,0,0,0]};
   var v$14 = {Arr$4:[0,0,0,0]};
    Result = v$14; return Result
}
/// procedure TG2Quat.SetE(var Self: TG2Quat; const Index: Integer; const Value: TG2Float)
function TG2Quat$SetE$3(Self$198, Index$41, Value$57) {
   Self$198.Arr$4[$Idx(Index$41,0,3,"")] = Value$57;
}
/// procedure TG2Quat.SetValue(var Self: TG2Quat; const _x: TG2Float; const _y: TG2Float; const _z: TG2Float; const _w: TG2Float)
function TG2Quat$SetValue$5(Self$199, _x$3, _y$3, _z$2, _w$1) {
   TG2Quat$SetX$3(Self$199,_x$3);
   TG2Quat$SetY$3(Self$199,_y$3);
   TG2Quat$SetZ$2(Self$199,_z$2);
   TG2Quat$SetW$1(Self$199,_w$1);
}
/// procedure TG2Quat.SetW(var Self: TG2Quat; const Value: TG2Float)
function TG2Quat$SetW$1(Self$200, Value$58) {
   Self$200.Arr$4[3] = Value$58;
}
/// procedure TG2Quat.SetX(var Self: TG2Quat; const Value: TG2Float)
function TG2Quat$SetX$3(Self$201, Value$59) {
   Self$201.Arr$4[0] = Value$59;
}
/// procedure TG2Quat.SetY(var Self: TG2Quat; const Value: TG2Float)
function TG2Quat$SetY$3(Self$202, Value$60) {
   Self$202.Arr$4[1] = Value$60;
}
/// procedure TG2Quat.SetZ(var Self: TG2Quat; const Value: TG2Float)
function TG2Quat$SetZ$2(Self$203, Value$61) {
   Self$203.Arr$4[2] = Value$61;
}
/// function TG2Quat.ToFloat32Array(var Self: TG2Quat) : JFloat32Array
function TG2Quat$ToFloat32Array$3(Self$204) {
   var Result = null;
   
    Result = new Float32Array(Self$204.Arr$4);
  return Result
}
/// TG2Point = record
function Copy$TG2Point(s,d) {
   d.x$5=s.x$5;
   d.y$4=s.y$4;
   return d;
}
function Clone$TG2Point($) {
   return {
      x$5:$.x$5,
      y$4:$.y$4
   }
}
/// TG2Plane = record
function Copy$TG2Plane(s,d) {
   d.d=s.d;
   Copy$TG2Vec3(s.n$3,d.n$3);
   return d;
}
function Clone$TG2Plane($) {
   return {
      d:$.d,
      n$3:Clone$TG2Vec3($.n$3)
   }
}
/// function TG2Plane.CopyRef(var Self: TG2Plane) : TG2Plane
function TG2Plane$CopyRef$4(Self$205) {
   var Result = {d:0,n$3:{Arr$2:[0,0,0]}};
    Result = Self$205; return Result
}
/// function TG2Plane.GetA(var Self: TG2Plane) : TG2Float
function TG2Plane$GetA(Self$206) {
   return TG2Vec3$GetX$1(Self$206.n$3);
}
/// function TG2Plane.GetB(var Self: TG2Plane) : TG2Float
function TG2Plane$GetB(Self$207) {
   return TG2Vec3$GetY$1(Self$207.n$3);
}
/// function TG2Plane.GetC(var Self: TG2Plane) : TG2Float
function TG2Plane$GetC(Self$208) {
   return TG2Vec3$GetZ$1(Self$208.n$3);
}
/// function TG2Plane.Instance() : TG2Plane
function Instance$5() {
   var Result = {d:0,n$3:{Arr$2:[0,0,0]}};
   var p$2 = {d:0,n$3:{Arr$2:[0,0,0]}};
    Result = p$2; return Result
}
/// procedure TG2Plane.SetA(var Self: TG2Plane; const Value: TG2Float)
function TG2Plane$SetA(Self$209, Value$62) {
   TG2Vec3$SetX$1(Self$209.n$3,Value$62);
}
/// procedure TG2Plane.SetB(var Self: TG2Plane; const Value: TG2Float)
function TG2Plane$SetB(Self$210, Value$63) {
   TG2Vec3$SetY$1(Self$210.n$3,Value$63);
}
/// procedure TG2Plane.SetC(var Self: TG2Plane; const Value: TG2Float)
function TG2Plane$SetC(Self$211, Value$64) {
   TG2Vec3$SetZ$1(Self$211.n$3,Value$64);
}
/// procedure TG2Plane.SetValue(var Self: TG2Plane; const v0: TG2Vec3; const v1: TG2Vec3; const v2: TG2Vec3)
function TG2Plane$SetValue$8(Self$212, v0, v1, v2) {
   Self$212.n$3 = G2TriangleNormal(v0,v1,v2);
   Self$212.d = TG2Vec3$Dot(Self$212.n$3,v0);
}
/// procedure TG2Plane.SetValue(var Self: TG2Plane; const pn: TG2Vec3; const pd: TG2Float)
function TG2Plane$SetValue$7(Self$213, pn, pd) {
   Copy$TG2Vec3(pn,Self$213.n$3);
   Self$213.d = pd;
}
/// procedure TG2Plane.SetValue(var Self: TG2Plane; const pa: TG2Float; const pb: TG2Float; const pc: TG2Float; const pd: TG2Float)
function TG2Plane$SetValue$6(Self$214, pa, pb, pc$1, pd$1) {
   TG2Vec3$SetX$1(Self$214.n$3,pa);
   TG2Vec3$SetY$1(Self$214.n$3,pb);
   TG2Vec3$SetZ$1(Self$214.n$3,pc$1);
   Self$214.d = pd$1;
}
/// TG2Mat = record
function Copy$TG2Mat(s,d) {
   d.Arr$5=s.Arr$5.slice(0);
   return d;
}
function Clone$TG2Mat($) {
   return {
      Arr$5:$.Arr$5.slice(0)
   }
}
/// function TG2Mat.CopyRef(var Self: TG2Mat) : TG2Mat
function TG2Mat$CopyRef$5(Self$215) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
    Result = Self$215; return Result
}
/// function TG2Mat.GetE(var Self: TG2Mat; const Index: Integer) : TG2Float
function TG2Mat$GetE$4(Self$216, Index$42) {
   return Self$216.Arr$5[$Idx(Index$42,0,15,"")];
}
/// function TG2Mat.GetE00(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE00(Self$217) {
   return Self$217.Arr$5[0];
}
/// function TG2Mat.GetE01(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE01(Self$218) {
   return Self$218.Arr$5[1];
}
/// function TG2Mat.GetE02(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE02(Self$219) {
   return Self$219.Arr$5[2];
}
/// function TG2Mat.GetE03(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE03(Self$220) {
   return Self$220.Arr$5[3];
}
/// function TG2Mat.GetE10(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE10(Self$221) {
   return Self$221.Arr$5[4];
}
/// function TG2Mat.GetE11(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE11(Self$222) {
   return Self$222.Arr$5[5];
}
/// function TG2Mat.GetE12(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE12(Self$223) {
   return Self$223.Arr$5[6];
}
/// function TG2Mat.GetE13(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE13(Self$224) {
   return Self$224.Arr$5[7];
}
/// function TG2Mat.GetE20(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE20(Self$225) {
   return Self$225.Arr$5[8];
}
/// function TG2Mat.GetE21(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE21(Self$226) {
   return Self$226.Arr$5[9];
}
/// function TG2Mat.GetE22(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE22(Self$227) {
   return Self$227.Arr$5[10];
}
/// function TG2Mat.GetE23(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE23(Self$228) {
   return Self$228.Arr$5[11];
}
/// function TG2Mat.GetE30(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE30(Self$229) {
   return Self$229.Arr$5[12];
}
/// function TG2Mat.GetE31(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE31(Self$230) {
   return Self$230.Arr$5[13];
}
/// function TG2Mat.GetE32(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE32(Self$231) {
   return Self$231.Arr$5[14];
}
/// function TG2Mat.GetE33(var Self: TG2Mat) : TG2Float
function TG2Mat$GetE33(Self$232) {
   return Self$232.Arr$5[15];
}
/// function TG2Mat.GetMat(var Self: TG2Mat; const x: Integer; const y: Integer) : TG2Float
function TG2Mat$GetMat(Self$233, x$87, y$70) {
   return Self$233.Arr$5[$Idx((x$87*4)+y$70,0,15,"")];
}
/// function TG2Mat.GetTranslation(var Self: TG2Mat) : TG2Vec3
function TG2Mat$GetTranslation(Self$234) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,TG2Mat$GetE30(Self$234));
   TG2Vec3$SetY$1(Result,TG2Mat$GetE31(Self$234));
   TG2Vec3$SetZ$1(Result,TG2Mat$GetE32(Self$234));
   return Result
}
/// function TG2Mat.Instance() : TG2Mat
function Instance$6() {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var m$5 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
    Result = m$5; return Result
}
/// procedure TG2Mat.SetE(var Self: TG2Mat; const Index: Integer; const Value: TG2Float)
function TG2Mat$SetE$4(Self$235, Index$43, Value$65) {
   Self$235.Arr$5[$Idx(Index$43,0,15,"")] = Value$65;
}
/// procedure TG2Mat.SetE00(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE00(Self$236, Value$66) {
   Self$236.Arr$5[0] = Value$66;
}
/// procedure TG2Mat.SetE01(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE01(Self$237, Value$67) {
   Self$237.Arr$5[1] = Value$67;
}
/// procedure TG2Mat.SetE02(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE02(Self$238, Value$68) {
   Self$238.Arr$5[2] = Value$68;
}
/// procedure TG2Mat.SetE03(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE03(Self$239, Value$69) {
   Self$239.Arr$5[3] = Value$69;
}
/// procedure TG2Mat.SetE10(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE10(Self$240, Value$70) {
   Self$240.Arr$5[4] = Value$70;
}
/// procedure TG2Mat.SetE11(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE11(Self$241, Value$71) {
   Self$241.Arr$5[5] = Value$71;
}
/// procedure TG2Mat.SetE12(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE12(Self$242, Value$72) {
   Self$242.Arr$5[6] = Value$72;
}
/// procedure TG2Mat.SetE13(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE13(Self$243, Value$73) {
   Self$243.Arr$5[7] = Value$73;
}
/// procedure TG2Mat.SetE20(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE20(Self$244, Value$74) {
   Self$244.Arr$5[8] = Value$74;
}
/// procedure TG2Mat.SetE21(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE21(Self$245, Value$75) {
   Self$245.Arr$5[9] = Value$75;
}
/// procedure TG2Mat.SetE22(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE22(Self$246, Value$76) {
   Self$246.Arr$5[10] = Value$76;
}
/// procedure TG2Mat.SetE23(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE23(Self$247, Value$77) {
   Self$247.Arr$5[11] = Value$77;
}
/// procedure TG2Mat.SetE30(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE30(Self$248, Value$78) {
   Self$248.Arr$5[12] = Value$78;
}
/// procedure TG2Mat.SetE31(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE31(Self$249, Value$79) {
   Self$249.Arr$5[13] = Value$79;
}
/// procedure TG2Mat.SetE32(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE32(Self$250, Value$80) {
   Self$250.Arr$5[14] = Value$80;
}
/// procedure TG2Mat.SetE33(var Self: TG2Mat; const Value: TG2Float)
function TG2Mat$SetE33(Self$251, Value$81) {
   Self$251.Arr$5[15] = Value$81;
}
/// procedure TG2Mat.SetMat(var Self: TG2Mat; const x: Integer; const y: Integer; const Value: TG2Float)
function TG2Mat$SetMat(Self$252, x$88, y$71, Value$82) {
   Self$252.Arr$5[$Idx((x$88*4)+y$71,0,15,"")] = Value$82;
}
/// procedure TG2Mat.SetValue(var Self: TG2Mat; const _e00: TG2Float; const _e10: TG2Float; const _e20: TG2Float; const _e30: TG2Float; const _e01: TG2Float; const _e11: TG2Float; const _e21: TG2Float; const _e31: TG2Float; const _e02: TG2Float; const _e12: TG2Float; const _e22: TG2Float; const _e32: TG2Float; const _e03: TG2Float; const _e13: TG2Float; const _e23: TG2Float; const _e33: TG2Float)
function TG2Mat$SetValue$9(Self$253, _e00, _e10, _e20, _e30, _e01, _e11, _e21, _e31, _e02, _e12, _e22, _e32, _e03, _e13, _e23, _e33) {
   TG2Mat$SetE00(Self$253,_e00);
   TG2Mat$SetE10(Self$253,_e10);
   TG2Mat$SetE20(Self$253,_e20);
   TG2Mat$SetE30(Self$253,_e30);
   TG2Mat$SetE01(Self$253,_e01);
   TG2Mat$SetE11(Self$253,_e11);
   TG2Mat$SetE21(Self$253,_e21);
   TG2Mat$SetE31(Self$253,_e31);
   TG2Mat$SetE02(Self$253,_e02);
   TG2Mat$SetE12(Self$253,_e12);
   TG2Mat$SetE22(Self$253,_e22);
   TG2Mat$SetE32(Self$253,_e32);
   TG2Mat$SetE03(Self$253,_e03);
   TG2Mat$SetE13(Self$253,_e13);
   TG2Mat$SetE23(Self$253,_e23);
   TG2Mat$SetE33(Self$253,_e33);
}
/// function TG2Mat.ToFloat32Array(var Self: TG2Mat) : JFloat32Array
function TG2Mat$ToFloat32Array$4(Self$254) {
   var Result = null;
   
    Result = new Float32Array(Self$254.Arr$5);
  return Result
}
/// TG2FrustumCheck enumeration
var TG2FrustumCheck = [ "fcInside", "fcIntersect", "fcOutside" ];
/// TG2Frustum = record
function Copy$TG2Frustum(s,d) {
   d._Planes=s._Planes.map(Clone$TG2Plane);
   Copy$TG2Mat(s._RefP,d._RefP);
   Copy$TG2Mat(s._RefV,d._RefV);
   return d;
}
function Clone$TG2Frustum($) {
   return {
      _Planes:$._Planes.map(Clone$TG2Plane),
      _RefP:Clone$TG2Mat($._RefP),
      _RefV:Clone$TG2Mat($._RefV)
   }
}
/// function TG2Frustum.CheckBox(var Self: TG2Frustum; const Box: TG2AABox) : TG2FrustumCheck
function TG2Frustum$CheckBox$1(Self$255, Box) {
   return TG2Frustum$CheckBox(Self$255,Box.MinV,Box.MaxV);
}
/// function TG2Frustum.CheckBox(var Self: TG2Frustum; const MinV: TG2Vec3; const MaxV: TG2Vec3) : TG2FrustumCheck
function TG2Frustum$CheckBox(Self$256, MinV$4, MaxV$4) {
   var Result = 0;
   var i$65 = 0;
   var MaxPt = {Arr$2:[0,0,0]};
   var MinPt = {Arr$2:[0,0,0]};
   Result = 0;
   for(i$65 = 0;i$65<=5;i$65++) {
      if (TG2Vec3$GetX$1(Self$256._Planes[$Idx(i$65,0,5,"")].n$3)<=0) {
         TG2Vec3$SetX$1(MinPt,TG2Vec3$GetX$1(MinV$4));
         TG2Vec3$SetX$1(MaxPt,TG2Vec3$GetX$1(MaxV$4));
      } else {
         TG2Vec3$SetX$1(MinPt,TG2Vec3$GetX$1(MaxV$4));
         TG2Vec3$SetX$1(MaxPt,TG2Vec3$GetX$1(MinV$4));
      }
      if (TG2Vec3$GetY$1(Self$256._Planes[$Idx(i$65,0,5,"")].n$3)<=0) {
         TG2Vec3$SetY$1(MinPt,TG2Vec3$GetY$1(MinV$4));
         TG2Vec3$SetY$1(MaxPt,TG2Vec3$GetY$1(MaxV$4));
      } else {
         TG2Vec3$SetY$1(MinPt,TG2Vec3$GetY$1(MaxV$4));
         TG2Vec3$SetY$1(MaxPt,TG2Vec3$GetY$1(MinV$4));
      }
      if (TG2Vec3$GetZ$1(Self$256._Planes[$Idx(i$65,0,5,"")].n$3)<=0) {
         TG2Vec3$SetZ$1(MinPt,TG2Vec3$GetZ$1(MinV$4));
         TG2Vec3$SetZ$1(MaxPt,TG2Vec3$GetZ$1(MaxV$4));
      } else {
         TG2Vec3$SetZ$1(MinPt,TG2Vec3$GetZ$1(MaxV$4));
         TG2Vec3$SetZ$1(MaxPt,TG2Vec3$GetZ$1(MinV$4));
      }
      if (TG2Frustum$DistanceToPoint(Self$256,i$65,MinPt)<0) {
         Result = 2;
         return Result;
      }
      if (TG2Frustum$DistanceToPoint(Self$256,i$65,MaxPt)<=0) {
         Result = 1;
      }
   }
   return Result
}
/// function TG2Frustum.CheckSphere(var Self: TG2Frustum; const Sphere: TG2Sphere) : TG2FrustumCheck
function TG2Frustum$CheckSphere$1(Self$257, Sphere) {
   return TG2Frustum$CheckSphere(Self$257,Sphere.c$1,Sphere.r$1);
}
/// function TG2Frustum.CheckSphere(var Self: TG2Frustum; const Center: TG2Vec3; const Radius: TG2Float) : TG2FrustumCheck
function TG2Frustum$CheckSphere(Self$258, Center$2, Radius$4) {
   var Result = 0;
   var i$66 = 0;
   var d$7 = 0;
   Result = 0;
   for(i$66 = 0;i$66<=5;i$66++) {
      d$7 = TG2Frustum$DistanceToPoint(Self$258,i$66,Center$2);
      if (d$7<(-Radius$4)) {
         Result = 2;
         return Result;
      }
      if (d$7<Radius$4) {
         Result = 1;
      }
   }
   return Result
}
/// function TG2Frustum.DistanceToPoint(var Self: TG2Frustum; const PlaneIndex: Integer; const Pt: TG2Vec3) : Single
function TG2Frustum$DistanceToPoint(Self$259, PlaneIndex, Pt) {
   return TG2Vec3$Dot(Self$259._Planes[$Idx(PlaneIndex,0,5,"")].n$3,Pt)+Self$259._Planes[$Idx(PlaneIndex,0,5,"")].d;
}
/// procedure TG2Frustum.ExtractPoints(var Self: TG2Frustum; var OutV: array [0..7] of record TG2Vec3)
function TG2Frustum$ExtractPoints(Self$260, OutV) {
   OutV.v[0] = G2Intersect3Planes(Self$260._Planes[4],Self$260._Planes[0],Self$260._Planes[2]);
   OutV.v[1] = G2Intersect3Planes(Self$260._Planes[5],Self$260._Planes[0],Self$260._Planes[2]);
   OutV.v[2] = G2Intersect3Planes(Self$260._Planes[4],Self$260._Planes[2],Self$260._Planes[1]);
   OutV.v[3] = G2Intersect3Planes(Self$260._Planes[5],Self$260._Planes[2],Self$260._Planes[1]);
   OutV.v[4] = G2Intersect3Planes(Self$260._Planes[4],Self$260._Planes[1],Self$260._Planes[3]);
   OutV.v[5] = G2Intersect3Planes(Self$260._Planes[5],Self$260._Planes[1],Self$260._Planes[3]);
   OutV.v[6] = G2Intersect3Planes(Self$260._Planes[4],Self$260._Planes[3],Self$260._Planes[0]);
   OutV.v[7] = G2Intersect3Planes(Self$260._Planes[5],Self$260._Planes[3],Self$260._Planes[0]);
}
/// function TG2Frustum.GetPlane(var Self: TG2Frustum; const Index: Integer) : TG2Plane
function TG2Frustum$GetPlane(Self$261, Index$44) {
   return TG2Plane$CopyRef$4(Self$261._Planes[$Idx(Index$44,0,5,"")]);
}
/// function TG2Frustum.IntersectFrustum(var Self: TG2Frustum; const Frustum: TG2Frustum) : Boolean
function TG2Frustum$IntersectFrustum(Self$262, Frustum$1) {
   var Result = false;
   function FrustumOutside(f1$1, f2) {
      var Result = false;
      var Points = {v:[{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]}]};
      var i$67 = 0;
      var j$5 = 0;
      var n$10 = 0;
      TG2Frustum$ExtractPoints(f2,Points);
      for(i$67 = 0;i$67<=5;i$67++) {
         n$10 = 0;
         for(j$5 = 0;j$5<=7;j$5++) {
            if (TG2Frustum$DistanceToPoint(f1$1,i$67,Points.v[$Idx(j$5,0,7,"")])<0) {
               ++n$10;
            }
         }
         if (n$10>=8) {
            Result = true;
            return Result;
         }
      }
      Result = false;
      return Result
   };
   Result = (!FrustumOutside(Self$262,Frustum$1))&&(!FrustumOutside(Frustum$1,Self$262));
   return Result
}
/// procedure TG2Frustum.Normalize(var Self: TG2Frustum)
function TG2Frustum$Normalize(Self$263) {
   var i$68 = 0;
   var Rcp = 0;
   for(i$68 = 0;i$68<=5;i$68++) {
      Rcp = 1/G2Vec3Len(Self$263._Planes[$Idx(i$68,0,5,"")].n$3);
      TG2Vec3$SetX$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3,(TG2Vec3$GetX$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3)*Rcp));
      TG2Vec3$SetY$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3,(TG2Vec3$GetY$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3)*Rcp));
      TG2Vec3$SetZ$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3,(TG2Vec3$GetZ$1(Self$263._Planes[$Idx(i$68,0,5,"")].n$3)*Rcp));
      Self$263._Planes[$Idx(i$68,0,5,"")].d*=Rcp;
   }
}
/// procedure TG2Frustum.Update(var Self: TG2Frustum)
function TG2Frustum$Update$8(Self$264) {
   var m$6 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   m$6 = G2MatMul(Self$264._RefV,Self$264._RefP);
   TG2Vec3$SetX$1(Self$264._Planes[0].n$3,(TG2Mat$GetE03(m$6)+TG2Mat$GetE00(m$6)));
   TG2Vec3$SetY$1(Self$264._Planes[0].n$3,(TG2Mat$GetE13(m$6)+TG2Mat$GetE10(m$6)));
   TG2Vec3$SetZ$1(Self$264._Planes[0].n$3,(TG2Mat$GetE23(m$6)+TG2Mat$GetE20(m$6)));
   Self$264._Planes[0].d = TG2Mat$GetE33(m$6)+TG2Mat$GetE30(m$6);
   TG2Vec3$SetX$1(Self$264._Planes[1].n$3,(TG2Mat$GetE03(m$6)-TG2Mat$GetE00(m$6)));
   TG2Vec3$SetY$1(Self$264._Planes[1].n$3,(TG2Mat$GetE13(m$6)-TG2Mat$GetE10(m$6)));
   TG2Vec3$SetZ$1(Self$264._Planes[1].n$3,(TG2Mat$GetE23(m$6)-TG2Mat$GetE20(m$6)));
   Self$264._Planes[1].d = TG2Mat$GetE33(m$6)-TG2Mat$GetE30(m$6);
   TG2Vec3$SetX$1(Self$264._Planes[2].n$3,(TG2Mat$GetE03(m$6)-TG2Mat$GetE01(m$6)));
   TG2Vec3$SetY$1(Self$264._Planes[2].n$3,(TG2Mat$GetE13(m$6)-TG2Mat$GetE11(m$6)));
   TG2Vec3$SetZ$1(Self$264._Planes[2].n$3,(TG2Mat$GetE23(m$6)-TG2Mat$GetE21(m$6)));
   Self$264._Planes[2].d = TG2Mat$GetE33(m$6)-TG2Mat$GetE31(m$6);
   TG2Vec3$SetX$1(Self$264._Planes[3].n$3,(TG2Mat$GetE03(m$6)+TG2Mat$GetE01(m$6)));
   TG2Vec3$SetY$1(Self$264._Planes[3].n$3,(TG2Mat$GetE13(m$6)+TG2Mat$GetE11(m$6)));
   TG2Vec3$SetZ$1(Self$264._Planes[3].n$3,(TG2Mat$GetE23(m$6)+TG2Mat$GetE21(m$6)));
   Self$264._Planes[3].d = TG2Mat$GetE33(m$6)+TG2Mat$GetE31(m$6);
   TG2Vec3$SetX$1(Self$264._Planes[4].n$3,TG2Mat$GetE02(m$6));
   TG2Vec3$SetY$1(Self$264._Planes[4].n$3,TG2Mat$GetE12(m$6));
   TG2Vec3$SetZ$1(Self$264._Planes[4].n$3,TG2Mat$GetE22(m$6));
   Self$264._Planes[4].d = TG2Mat$GetE32(m$6);
   TG2Vec3$SetX$1(Self$264._Planes[5].n$3,(TG2Mat$GetE03(m$6)-TG2Mat$GetE02(m$6)));
   TG2Vec3$SetY$1(Self$264._Planes[5].n$3,(TG2Mat$GetE13(m$6)-TG2Mat$GetE12(m$6)));
   TG2Vec3$SetZ$1(Self$264._Planes[5].n$3,(TG2Mat$GetE23(m$6)-TG2Mat$GetE22(m$6)));
   Self$264._Planes[5].d = TG2Mat$GetE33(m$6)-TG2Mat$GetE32(m$6);
   TG2Frustum$Normalize(Self$264);
}
/// TG2Box = record
function Copy$TG2Box(s,d) {
   Copy$TG2Vec3(s.c$3,d.c$3);
   Copy$TG2Vec3(s.vx,d.vx);
   Copy$TG2Vec3(s.vy,d.vy);
   Copy$TG2Vec3(s.vz,d.vz);
   return d;
}
function Clone$TG2Box($) {
   return {
      c$3:Clone$TG2Vec3($.c$3),
      vx:Clone$TG2Vec3($.vx),
      vy:Clone$TG2Vec3($.vy),
      vz:Clone$TG2Vec3($.vz)
   }
}
/// procedure TG2Box.SetValue(var Self: TG2Box; const bc: TG2Vec3; const bx: TG2Vec3; const by: TG2Vec3; const bz: TG2Vec3)
function TG2Box$SetValue$10(Self$265, bc, bx, by, bz) {
   Copy$TG2Vec3(bc,Self$265.c$3);
   Copy$TG2Vec3(bx,Self$265.vx);
   Copy$TG2Vec3(by,Self$265.vy);
   Copy$TG2Vec3(bz,Self$265.vz);
}
/// function TG2Box.Transform(var Self: TG2Box; const m: TG2Mat) : TG2Box
function TG2Box$Transform$3(Self$266, m$7) {
   var Result = {c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}};
   Result.c$3 = G2Vec3MatMul4x3(Self$266.c$3,m$7);
   Result.vx = G2Vec3MatMul3x3(Self$266.vx,m$7);
   Result.vy = G2Vec3MatMul3x3(Self$266.vy,m$7);
   Result.vz = G2Vec3MatMul3x3(Self$266.vz,m$7);
   return Result
}
/// TG2AABox = record
function Copy$TG2AABox(s,d) {
   Copy$TG2Vec3(s.MaxV,d.MaxV);
   Copy$TG2Vec3(s.MinV,d.MinV);
   return d;
}
function Clone$TG2AABox($) {
   return {
      MaxV:Clone$TG2Vec3($.MaxV),
      MinV:Clone$TG2Vec3($.MinV)
   }
}
/// procedure TG2AABox.Include(var Self: TG2AABox; const v: TG2Vec3)
function TG2AABox$Include(Self$267, v$15) {
   if (TG2Vec3$GetX$1(v$15)<TG2Vec3$GetX$1(Self$267.MinV)) {
      TG2Vec3$SetX$1(Self$267.MinV,TG2Vec3$GetX$1(v$15));
   } else if (TG2Vec3$GetX$1(v$15)>TG2Vec3$GetX$1(Self$267.MaxV)) {
      TG2Vec3$SetX$1(Self$267.MaxV,TG2Vec3$GetX$1(v$15));
   }
   if (TG2Vec3$GetY$1(v$15)<TG2Vec3$GetY$1(Self$267.MinV)) {
      TG2Vec3$SetY$1(Self$267.MinV,TG2Vec3$GetY$1(v$15));
   } else if (TG2Vec3$GetY$1(v$15)>TG2Vec3$GetY$1(Self$267.MaxV)) {
      TG2Vec3$SetY$1(Self$267.MaxV,TG2Vec3$GetY$1(v$15));
   }
   if (TG2Vec3$GetZ$1(v$15)<TG2Vec3$GetZ$1(Self$267.MinV)) {
      TG2Vec3$SetZ$1(Self$267.MinV,TG2Vec3$GetZ$1(v$15));
   } else if (TG2Vec3$GetZ$1(v$15)>TG2Vec3$GetZ$1(Self$267.MaxV)) {
      TG2Vec3$SetZ$1(Self$267.MaxV,TG2Vec3$GetZ$1(v$15));
   }
}
/// function TG2AABox.Intersect(var Self: TG2AABox; const b: TG2AABox) : Boolean
function TG2AABox$Intersect$2(Self$268, b$31) {
   return (((((TG2Vec3$GetX$1(Self$268.MinV)<TG2Vec3$GetX$1(b$31.MaxV))&&(TG2Vec3$GetY$1(Self$268.MinV)<TG2Vec3$GetY$1(b$31.MaxV)))&&(TG2Vec3$GetZ$1(Self$268.MinV)<TG2Vec3$GetZ$1(b$31.MaxV)))&&(TG2Vec3$GetX$1(Self$268.MaxV)>TG2Vec3$GetX$1(b$31.MinV)))&&(TG2Vec3$GetY$1(Self$268.MaxV)>TG2Vec3$GetY$1(b$31.MinV)))&&(TG2Vec3$GetZ$1(Self$268.MaxV)>TG2Vec3$GetZ$1(b$31.MinV));
}
/// procedure TG2AABox.Merge(var Self: TG2AABox; const b: TG2AABox)
function TG2AABox$Merge(Self$269, b$32) {
   if (TG2Vec3$GetX$1(b$32.MinV)<TG2Vec3$GetX$1(Self$269.MinV)) {
      TG2Vec3$SetX$1(Self$269.MinV,TG2Vec3$GetX$1(b$32.MinV));
   } else if (TG2Vec3$GetX$1(b$32.MaxV)>TG2Vec3$GetX$1(Self$269.MaxV)) {
      TG2Vec3$SetX$1(Self$269.MaxV,TG2Vec3$GetX$1(b$32.MaxV));
   }
   if (TG2Vec3$GetY$1(b$32.MinV)<TG2Vec3$GetY$1(Self$269.MinV)) {
      TG2Vec3$SetY$1(Self$269.MinV,TG2Vec3$GetY$1(b$32.MinV));
   } else if (TG2Vec3$GetY$1(b$32.MaxV)>TG2Vec3$GetY$1(Self$269.MaxV)) {
      TG2Vec3$SetY$1(Self$269.MaxV,TG2Vec3$GetY$1(b$32.MaxV));
   }
   if (TG2Vec3$GetZ$1(b$32.MinV)<TG2Vec3$GetZ$1(Self$269.MinV)) {
      TG2Vec3$SetZ$1(Self$269.MinV,TG2Vec3$GetZ$1(b$32.MinV));
   } else if (TG2Vec3$GetZ$1(b$32.MaxV)>TG2Vec3$GetZ$1(Self$269.MaxV)) {
      TG2Vec3$SetZ$1(Self$269.MaxV,TG2Vec3$GetZ$1(b$32.MaxV));
   }
}
/// procedure TG2AABox.SetValue(var Self: TG2AABox; const b: TG2Box)
function TG2AABox$SetValue$13(Self$270, b$33) {
   Copy$TG2AABox(G2BoxToAABox(b$33),Self$270);
}
/// procedure TG2AABox.SetValue(var Self: TG2AABox; const BMinV: TG2Vec3; const BMaxV: TG2Vec3)
function TG2AABox$SetValue$12(Self$271, BMinV, BMaxV) {
   Copy$TG2Vec3(BMinV,Self$271.MinV);
   Copy$TG2Vec3(BMaxV,Self$271.MaxV);
}
/// procedure TG2AABox.SetValue(var Self: TG2AABox; const v: TG2Vec3)
function TG2AABox$SetValue$11(Self$272, v$16) {
   Copy$TG2Vec3(v$16,Self$272.MinV);
   Copy$TG2Vec3(v$16,Self$272.MaxV);
}
function G2Vec4Sub(v0$1, v1$1) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$1)-TG2Vec4$GetX(v1$1)));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$1)-TG2Vec4$GetY(v1$1)));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$1)-TG2Vec4$GetZ(v1$1)));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$1)-TG2Vec4$GetW(v1$1)));
   return Result
};
function G2Vec4Mul(v0$2, v1$2) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$2)*TG2Vec4$GetX(v1$2)));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$2)*TG2Vec4$GetY(v1$2)));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$2)*TG2Vec4$GetZ(v1$2)));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$2)*TG2Vec4$GetW(v1$2)));
   return Result
};
function G2Vec4MatMul(v0$3, m$8) {
   var Result = {Arr$1:[0,0,0,0]};
   var vr = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(vr,((TG2Vec4$GetX(v0$3)*TG2Mat$GetE00(m$8))+(TG2Vec4$GetY(v0$3)*TG2Mat$GetE10(m$8))+(TG2Vec4$GetZ(v0$3)*TG2Mat$GetE20(m$8))+(TG2Vec4$GetW(v0$3)*TG2Mat$GetE30(m$8))));
   TG2Vec4$SetY(vr,((TG2Vec4$GetX(v0$3)*TG2Mat$GetE01(m$8))+(TG2Vec4$GetY(v0$3)*TG2Mat$GetE11(m$8))+(TG2Vec4$GetZ(v0$3)*TG2Mat$GetE21(m$8))+(TG2Vec4$GetW(v0$3)*TG2Mat$GetE31(m$8))));
   TG2Vec4$SetZ(vr,((TG2Vec4$GetX(v0$3)*TG2Mat$GetE02(m$8))+(TG2Vec4$GetY(v0$3)*TG2Mat$GetE12(m$8))+(TG2Vec4$GetZ(v0$3)*TG2Mat$GetE22(m$8))+(TG2Vec4$GetW(v0$3)*TG2Mat$GetE32(m$8))));
   TG2Vec4$SetW(vr,((TG2Vec4$GetX(v0$3)*TG2Mat$GetE03(m$8))+(TG2Vec4$GetY(v0$3)*TG2Mat$GetE13(m$8))+(TG2Vec4$GetZ(v0$3)*TG2Mat$GetE23(m$8))+(TG2Vec4$GetW(v0$3)*TG2Mat$GetE33(m$8))));
   Copy$TG2Vec4(vr,Result);
   return Result
};
function G2Vec4IntSub(v0$4, i$69) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$4)-i$69));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$4)-i$69));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$4)-i$69));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$4)-i$69));
   return Result
};
function G2Vec4IntMul(v0$5, i$70) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$5)*i$70));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$5)*i$70));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$5)*i$70));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$5)*i$70));
   return Result
};
function G2Vec4IntDiv(v0$6, i$71) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$6)/i$71));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$6)/i$71));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$6)/i$71));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$6)/i$71));
   return Result
};
function G2Vec4IntAdd(v0$7, i$72) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$7)+i$72));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$7)+i$72));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$7)+i$72));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$7)+i$72));
   return Result
};
function G2Vec4FloatSub(v0$8, f$5) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$8)-f$5));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$8)-f$5));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$8)-f$5));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$8)-f$5));
   return Result
};
function G2Vec4FloatMul(v0$9, f$6) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$9)*f$6));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$9)*f$6));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$9)*f$6));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$9)*f$6));
   return Result
};
function G2Vec4FloatDiv(v0$10, f$7) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$10)/f$7));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$10)/f$7));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$10)/f$7));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$10)/f$7));
   return Result
};
function G2Vec4FloatAdd(v0$11, f$8) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$11)+f$8));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$11)+f$8));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$11)+f$8));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$11)+f$8));
   return Result
};
function G2Vec4Div(v0$12, v1$3) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$12)/TG2Vec4$GetX(v1$3)));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$12)/TG2Vec4$GetY(v1$3)));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$12)/TG2Vec4$GetZ(v1$3)));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$12)/TG2Vec4$GetW(v1$3)));
   return Result
};
function G2Vec4Add(v0$13, v1$4) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$13)+TG2Vec4$GetX(v1$4)));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$13)+TG2Vec4$GetY(v1$4)));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$13)+TG2Vec4$GetZ(v1$4)));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$13)+TG2Vec4$GetW(v1$4)));
   return Result
};
function G2Vec4(x$89, y$72, z$3, w$10) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetValue(Result,x$89,y$72,z$3,w$10);
   return Result
};
function G2Vec3Vec4Assign(v0$14) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetValue$1(Result,TG2Vec4$GetX(v0$14),TG2Vec4$GetY(v0$14),TG2Vec4$GetZ(v0$14));
   return Result
};
function G2Vec3Sub(v0$15, v1$5) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$15)-TG2Vec3$GetX$1(v1$5)));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$15)-TG2Vec3$GetY$1(v1$5)));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$15)-TG2Vec3$GetZ$1(v1$5)));
   return Result
};
function G2Vec3Reflect(v0$16, n$11) {
   var Result = {Arr$2:[0,0,0]};
   var d$1 = 0;
   d$1 = G2Vec3Dot(v0$16,n$11);
   Result = G2Vec3Sub(v0$16,G2Vec3FloatMul(n$11,(2*d$1)));
   return Result
};
function G2Vec3Norm(v0$17) {
   var Result = {Arr$2:[0,0,0]};
   var d$2 = 0;
   d$2 = Math.sqrt((TG2Vec3$GetX$1(v0$17)*TG2Vec3$GetX$1(v0$17))+(TG2Vec3$GetY$1(v0$17)*TG2Vec3$GetY$1(v0$17))+(TG2Vec3$GetZ$1(v0$17)*TG2Vec3$GetZ$1(v0$17)));
   if (d$2>0) {
      d$2 = 1/d$2;
      TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$17)*d$2));
      TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$17)*d$2));
      TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$17)*d$2));
   } else {
      TG2Vec3$SetX$1(Result,0);
      TG2Vec3$SetY$1(Result,0);
      TG2Vec3$SetZ$1(Result,0);
   }
   return Result
};
function G2Vec3Mul(v0$18, v1$6) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$18)*TG2Vec3$GetX$1(v1$6)));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$18)*TG2Vec3$GetY$1(v1$6)));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$18)*TG2Vec3$GetZ$1(v1$6)));
   return Result
};
function G2Vec3MatMul4x4(v0$19, m$9) {
   var Result = {Arr$2:[0,0,0]};
   var vr$1 = {Arr$2:[0,0,0]};
   var w$2 = 0;
   TG2Vec3$SetX$1(vr$1,((TG2Vec3$GetX$1(v0$19)*TG2Mat$GetE00(m$9))+(TG2Vec3$GetY$1(v0$19)*TG2Mat$GetE10(m$9))+(TG2Vec3$GetZ$1(v0$19)*TG2Mat$GetE20(m$9))+TG2Mat$GetE30(m$9)));
   TG2Vec3$SetY$1(vr$1,((TG2Vec3$GetX$1(v0$19)*TG2Mat$GetE01(m$9))+(TG2Vec3$GetY$1(v0$19)*TG2Mat$GetE11(m$9))+(TG2Vec3$GetZ$1(v0$19)*TG2Mat$GetE21(m$9))+TG2Mat$GetE31(m$9)));
   TG2Vec3$SetZ$1(vr$1,((TG2Vec3$GetX$1(v0$19)*TG2Mat$GetE02(m$9))+(TG2Vec3$GetY$1(v0$19)*TG2Mat$GetE12(m$9))+(TG2Vec3$GetZ$1(v0$19)*TG2Mat$GetE22(m$9))+TG2Mat$GetE32(m$9)));
   w$2 = 1/((TG2Vec3$GetX$1(v0$19)*TG2Mat$GetE03(m$9))+(TG2Vec3$GetY$1(v0$19)*TG2Mat$GetE13(m$9))+(TG2Vec3$GetZ$1(v0$19)*TG2Mat$GetE23(m$9))+TG2Mat$GetE33(m$9));
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(vr$1)*w$2));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(vr$1)*w$2));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(vr$1)*w$2));
   return Result
};
function G2Vec3MatMul4x3(v0$20, m$10) {
   var Result = {Arr$2:[0,0,0]};
   var vr$2 = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(vr$2,((TG2Vec3$GetX$1(v0$20)*TG2Mat$GetE00(m$10))+(TG2Vec3$GetY$1(v0$20)*TG2Mat$GetE10(m$10))+(TG2Vec3$GetZ$1(v0$20)*TG2Mat$GetE20(m$10))+TG2Mat$GetE30(m$10)));
   TG2Vec3$SetY$1(vr$2,((TG2Vec3$GetX$1(v0$20)*TG2Mat$GetE01(m$10))+(TG2Vec3$GetY$1(v0$20)*TG2Mat$GetE11(m$10))+(TG2Vec3$GetZ$1(v0$20)*TG2Mat$GetE21(m$10))+TG2Mat$GetE31(m$10)));
   TG2Vec3$SetZ$1(vr$2,((TG2Vec3$GetX$1(v0$20)*TG2Mat$GetE02(m$10))+(TG2Vec3$GetY$1(v0$20)*TG2Mat$GetE12(m$10))+(TG2Vec3$GetZ$1(v0$20)*TG2Mat$GetE22(m$10))+TG2Mat$GetE32(m$10)));
   Copy$TG2Vec3(vr$2,Result);
   return Result
};
function G2Vec3MatMul3x3(v0$21, m$11) {
   var Result = {Arr$2:[0,0,0]};
   var vr$3 = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(vr$3,((TG2Vec3$GetX$1(v0$21)*TG2Mat$GetE00(m$11))+(TG2Vec3$GetY$1(v0$21)*TG2Mat$GetE10(m$11))+(TG2Vec3$GetZ$1(v0$21)*TG2Mat$GetE20(m$11))));
   TG2Vec3$SetY$1(vr$3,((TG2Vec3$GetX$1(v0$21)*TG2Mat$GetE01(m$11))+(TG2Vec3$GetY$1(v0$21)*TG2Mat$GetE11(m$11))+(TG2Vec3$GetZ$1(v0$21)*TG2Mat$GetE21(m$11))));
   TG2Vec3$SetZ$1(vr$3,((TG2Vec3$GetX$1(v0$21)*TG2Mat$GetE02(m$11))+(TG2Vec3$GetY$1(v0$21)*TG2Mat$GetE12(m$11))+(TG2Vec3$GetZ$1(v0$21)*TG2Mat$GetE22(m$11))));
   Copy$TG2Vec3(vr$3,Result);
   return Result
};
function G2Vec3LenSq(v0$22) {
   return (TG2Vec3$GetX$1(v0$22)*TG2Vec3$GetX$1(v0$22))+(TG2Vec3$GetY$1(v0$22)*TG2Vec3$GetY$1(v0$22))+(TG2Vec3$GetZ$1(v0$22)*TG2Vec3$GetZ$1(v0$22));
};
function G2Vec3Len(v0$23) {
   return Math.sqrt((TG2Vec3$GetX$1(v0$23)*TG2Vec3$GetX$1(v0$23))+(TG2Vec3$GetY$1(v0$23)*TG2Vec3$GetY$1(v0$23))+(TG2Vec3$GetZ$1(v0$23)*TG2Vec3$GetZ$1(v0$23)));
};
function G2Vec3IntSub(v0$24, i$73) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$24)-i$73));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$24)-i$73));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$24)-i$73));
   return Result
};
function G2Vec3IntMul(v0$25, i$74) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$25)*i$74));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$25)*i$74));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$25)*i$74));
   return Result
};
function G2Vec3IntDiv(v0$26, i$75) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$26)/i$75));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$26)/i$75));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$26)/i$75));
   return Result
};
function G2Vec3IntAdd(v0$27, i$76) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$27)+i$76));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$27)+i$76));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$27)+i$76));
   return Result
};
function G2Vec3FloatSub(v0$28, f$9) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$28)-f$9));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$28)-f$9));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$28)-f$9));
   return Result
};
function G2Vec3FloatMul(v0$29, f$10) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$29)*f$10));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$29)*f$10));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$29)*f$10));
   return Result
};
function G2Vec3FloatDiv(v0$30, f$11) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$30)/f$11));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$30)/f$11));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$30)/f$11));
   return Result
};
function G2Vec3FloatAdd(v0$31, f$12) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$31)+f$12));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$31)+f$12));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$31)+f$12));
   return Result
};
function G2Vec3Dot(v0$32, v1$7) {
   return (TG2Vec3$GetX$1(v0$32)*TG2Vec3$GetX$1(v1$7))+(TG2Vec3$GetY$1(v0$32)*TG2Vec3$GetY$1(v1$7))+(TG2Vec3$GetZ$1(v0$32)*TG2Vec3$GetZ$1(v1$7));
};
function G2Vec3Div(v0$33, v1$8) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$33)/TG2Vec3$GetX$1(v1$8)));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$33)/TG2Vec3$GetY$1(v1$8)));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$33)/TG2Vec3$GetZ$1(v1$8)));
   return Result
};
function G2Vec3Cross(v0$34, v1$9) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,((TG2Vec3$GetY$1(v0$34)*TG2Vec3$GetZ$1(v1$9))-(TG2Vec3$GetZ$1(v0$34)*TG2Vec3$GetY$1(v1$9))));
   TG2Vec3$SetY$1(Result,((TG2Vec3$GetZ$1(v0$34)*TG2Vec3$GetX$1(v1$9))-(TG2Vec3$GetX$1(v0$34)*TG2Vec3$GetZ$1(v1$9))));
   TG2Vec3$SetZ$1(Result,((TG2Vec3$GetX$1(v0$34)*TG2Vec3$GetY$1(v1$9))-(TG2Vec3$GetY$1(v0$34)*TG2Vec3$GetX$1(v1$9))));
   return Result
};
function G2Vec3CatmullRom(v0$35, v1$10, v2$1, v3, t$6) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(0.5*((2*TG2Vec3$GetX$1(v1$10))+((TG2Vec3$GetX$1(v2$1)-TG2Vec3$GetX$1(v0$35))*t$6)+(((((2*TG2Vec3$GetX$1(v0$35))-(5*TG2Vec3$GetX$1(v1$10)))+(4*TG2Vec3$GetX$1(v2$1)))-TG2Vec3$GetX$1(v3))*t$6*t$6)+((((TG2Vec3$GetX$1(v3)-(3*TG2Vec3$GetX$1(v2$1)))+(3*TG2Vec3$GetX$1(v1$10)))-TG2Vec3$GetX$1(v0$35))*t$6*t$6*t$6))));
   TG2Vec3$SetY$1(Result,(0.5*((2*TG2Vec3$GetY$1(v1$10))+((TG2Vec3$GetY$1(v2$1)-TG2Vec3$GetY$1(v0$35))*t$6)+(((((2*TG2Vec3$GetY$1(v0$35))-(5*TG2Vec3$GetY$1(v1$10)))+(4*TG2Vec3$GetY$1(v2$1)))-TG2Vec3$GetY$1(v3))*t$6*t$6)+((((TG2Vec3$GetY$1(v3)-(3*TG2Vec3$GetY$1(v2$1)))+(3*TG2Vec3$GetY$1(v1$10)))-TG2Vec3$GetY$1(v0$35))*t$6*t$6*t$6))));
   TG2Vec3$SetZ$1(Result,(0.5*((2*TG2Vec3$GetZ$1(v1$10))+((TG2Vec3$GetZ$1(v2$1)-TG2Vec3$GetZ$1(v0$35))*t$6)+(((((2*TG2Vec3$GetZ$1(v0$35))-(5*TG2Vec3$GetZ$1(v1$10)))+(4*TG2Vec3$GetZ$1(v2$1)))-TG2Vec3$GetZ$1(v3))*t$6*t$6)+((((TG2Vec3$GetZ$1(v3)-(3*TG2Vec3$GetZ$1(v2$1)))+(3*TG2Vec3$GetZ$1(v1$10)))-TG2Vec3$GetZ$1(v0$35))*t$6*t$6*t$6))));
   return Result
};
function G2Vec3Angle(v0$36, v1$11) {
   var Result = 0;
   var VLen = 0;
   VLen = G2Vec3Len(v0$36)*G2Vec3Len(v1$11);
   if (VLen>0) {
      Result = Math.acos(G2Vec3Dot(v0$36,v1$11)/VLen);
   } else {
      Result = 0;
   }
   return Result
};
function G2Vec3Add(v0$37, v1$12) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$37)+TG2Vec3$GetX$1(v1$12)));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$37)+TG2Vec3$GetY$1(v1$12)));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$37)+TG2Vec3$GetZ$1(v1$12)));
   return Result
};
function G2Vec3(x$90, y$73, z$4) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetValue$1(Result,x$90,y$73,z$4);
   return Result
};
function G2Vec2Vec4Assign(v0$38) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetValue$2(Result,TG2Vec4$GetX(v0$38),TG2Vec4$GetY(v0$38));
   return Result
};
function G2Vec2Vec3Assign(v0$39) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetValue$2(Result,TG2Vec3$GetX$1(v0$39),TG2Vec3$GetY$1(v0$39));
   return Result
};
function G2Vec2Sub(v0$40, v1$13) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$40)-TG2Vec2$GetX$2(v1$13)));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$40)-TG2Vec2$GetY$2(v1$13)));
   return Result
};
function G2Vec2Reflect(v0$41, n$12) {
   var Result = {Arr$3:[0,0]};
   var d$3 = 0;
   d$3 = G2Vec2Dot(v0$41,n$12);
   Result = G2Vec2Sub(v0$41,G2Vec2FloatMul(n$12,(2*d$3)));
   return Result
};
function G2Vec2Perp(v0$42) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetValue$2(Result,(-TG2Vec2$GetY$2(v0$42)),TG2Vec2$GetX$2(v0$42));
   return Result
};
function G2Vec2Norm(v0$43) {
   var Result = {Arr$3:[0,0]};
   var d$4 = 0;
   d$4 = Math.sqrt(G2Vec2Dot(v0$43,v0$43));
   if (d$4>0) {
      d$4 = 1/d$4;
      TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$43)*d$4));
      TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$43)*d$4));
   } else {
      TG2Vec2$SetX$2(Result,0);
      TG2Vec2$SetY$2(Result,0);
   }
   return Result
};
function G2Vec2Mul(v0$44, v1$14) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$44)*TG2Vec2$GetX$2(v1$14)));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$44)*TG2Vec2$GetY$2(v1$14)));
   return Result
};
function G2Vec2MatMul4x4(v0$45, m$12) {
   var Result = {Arr$3:[0,0]};
   var vr$4 = {Arr$3:[0,0]};
   var w$3 = 0;
   TG2Vec2$SetX$2(vr$4,((TG2Vec2$GetX$2(v0$45)*TG2Mat$GetE00(m$12))+(TG2Vec2$GetY$2(v0$45)*TG2Mat$GetE10(m$12))+TG2Mat$GetE30(m$12)));
   TG2Vec2$SetY$2(vr$4,((TG2Vec2$GetX$2(v0$45)*TG2Mat$GetE01(m$12))+(TG2Vec2$GetY$2(v0$45)*TG2Mat$GetE11(m$12))+TG2Mat$GetE31(m$12)));
   w$3 = 1/((TG2Vec2$GetX$2(v0$45)*TG2Mat$GetE03(m$12))+(TG2Vec2$GetY$2(v0$45)*TG2Mat$GetE13(m$12))+TG2Mat$GetE33(m$12));
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(vr$4)*w$3));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(vr$4)*w$3));
   return Result
};
function G2Vec2MatMul4x3(v0$46, m$13) {
   var Result = {Arr$3:[0,0]};
   var vr$5 = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(vr$5,((TG2Vec2$GetX$2(v0$46)*TG2Mat$GetE00(m$13))+(TG2Vec2$GetY$2(v0$46)*TG2Mat$GetE10(m$13))+TG2Mat$GetE30(m$13)));
   TG2Vec2$SetY$2(vr$5,((TG2Vec2$GetX$2(v0$46)*TG2Mat$GetE01(m$13))+(TG2Vec2$GetY$2(v0$46)*TG2Mat$GetE11(m$13))+TG2Mat$GetE31(m$13)));
   Copy$TG2Vec2(vr$5,Result);
   return Result
};
function G2Vec2MatMul3x3(v0$47, m$14) {
   var Result = {Arr$3:[0,0]};
   var vr$6 = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(vr$6,((TG2Vec2$GetX$2(v0$47)*TG2Mat$GetE00(m$14))+(TG2Vec2$GetY$2(v0$47)*TG2Mat$GetE10(m$14))));
   TG2Vec2$SetY$2(vr$6,((TG2Vec2$GetX$2(v0$47)*TG2Mat$GetE01(m$14))+(TG2Vec2$GetY$2(v0$47)*TG2Mat$GetE11(m$14))));
   Copy$TG2Vec2(vr$6,Result);
   return Result
};
function G2Vec2LenSq(v0$48) {
   return (TG2Vec2$GetX$2(v0$48)*TG2Vec2$GetX$2(v0$48))+(TG2Vec2$GetY$2(v0$48)*TG2Vec2$GetY$2(v0$48));
};
function G2Vec2Len(v0$49) {
   return Math.sqrt((TG2Vec2$GetX$2(v0$49)*TG2Vec2$GetX$2(v0$49))+(TG2Vec2$GetY$2(v0$49)*TG2Vec2$GetY$2(v0$49)));
};
function G2Vec2IntSub(v0$50, i$77) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$50)-i$77));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$50)-i$77));
   return Result
};
function G2Vec2IntMul(v0$51, i$78) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$51)*i$78));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$51)*i$78));
   return Result
};
function G2Vec2IntDiv(v0$52, i$79) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$52)/i$79));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$52)/i$79));
   return Result
};
function G2Vec2IntAdd(v0$53, i$80) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$53)+i$80));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$53)+i$80));
   return Result
};
function G2Vec2FloatSub(v0$54, f$13) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$54)-f$13));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$54)-f$13));
   return Result
};
function G2Vec2FloatMul(v0$55, f$14) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$55)*f$14));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$55)*f$14));
   return Result
};
function G2Vec2FloatDiv(v0$56, f$15) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$56)/f$15));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$56)/f$15));
   return Result
};
function G2Vec2FloatAdd(v0$57, f$16) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$57)+f$16));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$57)+f$16));
   return Result
};
function G2Vec2Dot(v0$58, v1$15) {
   return (TG2Vec2$GetX$2(v0$58)*TG2Vec2$GetX$2(v1$15))+(TG2Vec2$GetY$2(v0$58)*TG2Vec2$GetY$2(v1$15));
};
function G2Vec2Div(v0$59, v1$16) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$59)/TG2Vec2$GetX$2(v1$16)));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$59)/TG2Vec2$GetY$2(v1$16)));
   return Result
};
function G2Vec2Cross(v0$60, v1$17) {
   return (TG2Vec2$GetX$2(v0$60)*TG2Vec2$GetY$2(v1$17))-(TG2Vec2$GetY$2(v0$60)*TG2Vec2$GetX$2(v1$17));
};
function G2Vec2Angle(v0$61, v1$18) {
   var Result = 0;
   var VLen$1 = 0;
   VLen$1 = G2Vec2Len(v0$61)*G2Vec2Len(v1$18);
   if (VLen$1>0) {
      Result = Math.acos(G2Vec2Dot(v0$61,v1$18)/VLen$1);
   } else {
      Result = 0;
   }
   return Result
};
function G2Vec2Add(v0$62, v1$19) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$62)+TG2Vec2$GetX$2(v1$19)));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$62)+TG2Vec2$GetY$2(v1$19)));
   return Result
};
function G2Vec2(x$91, y$74) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetValue$2(Result,x$91,y$74);
   return Result
};
function G2TriangleNormal(v0$63, v1$20, v2$2) {
   return TG2Vec3$Norm(TG2Vec3$Cross(G2Vec3Sub(v1$20,v0$63),G2Vec3Sub(v2$2,v0$63)));
};
function G2SinCos(a$66, s$10, c$13) {
   s$10.v = Math.sin(a$66);
   c$13.v = Math.cos(a$66);
};
function G2Rect(l$4, t$7, r$6, b$34) {
   var Result = {l:0,t:0,r$2:0,b$1:0};
   Result.l = l$4;
   Result.t = t$7;
   Result.r$2 = r$6;
   Result.b$1 = b$34;
   return Result
};
function G2QuatSub(q0, q1) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0)-TG2Quat$GetX$3(q1)));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0)-TG2Quat$GetY$3(q1)));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0)-TG2Quat$GetZ$2(q1)));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0)-TG2Quat$GetW$1(q1)));
   return Result
};
function G2QuatSlerp(q0$1, q1$1, s$11) {
   var Result = {Arr$4:[0,0,0,0]};
   var SinTh = 0;
   var CosTh = 0;
   var Th = 0;
   var ra = 0;
   var rb = 0;
   var qa = {Arr$4:[0,0,0,0]};
   var qb = {Arr$4:[0,0,0,0]};
   Copy$TG2Quat(q0$1,qa);
   Copy$TG2Quat(q1$1,qb);
   CosTh = (TG2Quat$GetX$3(qa)*TG2Quat$GetX$3(qb))+(TG2Quat$GetY$3(qa)*TG2Quat$GetY$3(qb))+(TG2Quat$GetZ$2(qa)*TG2Quat$GetZ$2(qb))+(TG2Quat$GetW$1(qa)*TG2Quat$GetW$1(qb));
   if (CosTh<0) {
      TG2Quat$SetX$3(qb,(-TG2Quat$GetX$3(qb)));
      TG2Quat$SetY$3(qb,(-TG2Quat$GetY$3(qb)));
      TG2Quat$SetZ$2(qb,(-TG2Quat$GetZ$2(qb)));
      CosTh = -CosTh;
   }
   if (Math.abs(CosTh)>=1) {
      Copy$TG2Quat(qa,Result);
      return Result;
   }
   Th = Math.acos(CosTh);
   SinTh = Math.sin(Th);
   if (Math.abs(SinTh)<0.0001) {
      ra = 1-s$11;
      rb = s$11;
   } else {
      ra = Math.sin((1-s$11)*Th)/SinTh;
      rb = Math.sin(s$11*Th)/SinTh;
   }
   TG2Quat$SetX$3(Result,((TG2Quat$GetX$3(qa)*ra)+(TG2Quat$GetX$3(qb)*rb)));
   TG2Quat$SetY$3(Result,((TG2Quat$GetY$3(qa)*ra)+(TG2Quat$GetY$3(qb)*rb)));
   TG2Quat$SetZ$2(Result,((TG2Quat$GetZ$2(qa)*ra)+(TG2Quat$GetZ$2(qb)*rb)));
   TG2Quat$SetW$1(Result,((TG2Quat$GetW$1(qa)*ra)+(TG2Quat$GetW$1(qb)*rb)));
   return Result
};
function G2QuatNorm(q0$2) {
   var Result = {Arr$4:[0,0,0,0]};
   var d$5 = 0;
   d$5 = Math.sqrt((TG2Quat$GetX$3(q0$2)*TG2Quat$GetX$3(q0$2))+(TG2Quat$GetY$3(q0$2)*TG2Quat$GetY$3(q0$2))+(TG2Quat$GetZ$2(q0$2)*TG2Quat$GetZ$2(q0$2))+(TG2Quat$GetW$1(q0$2)*TG2Quat$GetW$1(q0$2)));
   if (d$5>0) {
      d$5 = 1/d$5;
      TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$2)*d$5));
      TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$2)*d$5));
      TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$2)*d$5));
      TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$2)*d$5));
   } else {
      TG2Quat$SetX$3(Result,0);
      TG2Quat$SetY$3(Result,0);
      TG2Quat$SetZ$2(Result,0);
      TG2Quat$SetW$1(Result,1);
   }
   return Result
};
function G2QuatMul(q0$3, q1$2) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$3)*TG2Quat$GetX$3(q1$2)));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$3)*TG2Quat$GetY$3(q1$2)));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$3)*TG2Quat$GetZ$2(q1$2)));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$3)*TG2Quat$GetW$1(q1$2)));
   return Result
};
function G2QuatFloatSub(q0$4, f$17) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$4)-f$17));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$4)-f$17));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$4)-f$17));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$4)-f$17));
   return Result
};
function G2QuatFloatMul(q0$5, f$18) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$5)*f$18));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$5)*f$18));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$5)*f$18));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$5)*f$18));
   return Result
};
function G2QuatFloatDiv(q0$6, f$19) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$6)/f$19));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$6)/f$19));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$6)/f$19));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$6)/f$19));
   return Result
};
function G2QuatFloatAdd(q0$7, f$20) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$7)+f$20));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$7)+f$20));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$7)+f$20));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$7)+f$20));
   return Result
};
function G2QuatDot(q0$8, q1$3) {
   return (TG2Quat$GetX$3(q0$8)*TG2Quat$GetX$3(q1$3))+(TG2Quat$GetY$3(q0$8)*TG2Quat$GetY$3(q1$3))+(TG2Quat$GetZ$2(q0$8)*TG2Quat$GetZ$2(q1$3))+(TG2Quat$GetW$1(q0$8)*TG2Quat$GetW$1(q1$3));
};
function G2QuatDiv(q0$9, q1$4) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$9)/TG2Quat$GetX$3(q1$4)));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$9)/TG2Quat$GetY$3(q1$4)));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$9)/TG2Quat$GetZ$2(q1$4)));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$9)/TG2Quat$GetW$1(q1$4)));
   return Result
};
function G2QuatAdd(q0$10, q1$5) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetX$3(Result,(TG2Quat$GetX$3(q0$10)+TG2Quat$GetX$3(q1$5)));
   TG2Quat$SetY$3(Result,(TG2Quat$GetY$3(q0$10)+TG2Quat$GetY$3(q1$5)));
   TG2Quat$SetZ$2(Result,(TG2Quat$GetZ$2(q0$10)+TG2Quat$GetZ$2(q1$5)));
   TG2Quat$SetW$1(Result,(TG2Quat$GetW$1(q0$10)+TG2Quat$GetW$1(q1$5)));
   return Result
};
function G2Quat(x$92, y$75, z$5, w$11) {
   var Result = {Arr$4:[0,0,0,0]};
   TG2Quat$SetValue$5(Result,x$92,y$75,z$5,w$11);
   return Result
};
function G2Quat$1(Axis, Angle$2) {
   var Result = {Arr$4:[0,0,0,0]};
   var AxisNorm = {Arr$2:[0,0,0]};
   var s$1 = {};
   s$1.v = 0;
   var c$4 = {};
   c$4.v = 0;
   AxisNorm = G2Vec3Norm(Axis);
   G2SinCos((Angle$2*0.5),s$1,c$4);
   TG2Quat$SetX$3(Result,(s$1.v*TG2Vec3$GetX$1(AxisNorm)));
   TG2Quat$SetY$3(Result,(s$1.v*TG2Vec3$GetY$1(AxisNorm)));
   TG2Quat$SetZ$2(Result,(s$1.v*TG2Vec3$GetZ$1(AxisNorm)));
   TG2Quat$SetW$1(Result,c$4.v);
   return Result
};
function G2Quat$2(m$15) {
   var Result = {Arr$4:[0,0,0,0]};
   var Trace = 0;
   var SqrtTrace = 0;
   var RcpSqrtTrace = 0;
   var MaxDiag = 0;
   var s$2 = 0;
   var MaxI = 0;
   var i$1 = 0;
   Trace = TG2Mat$GetE00(m$15)+TG2Mat$GetE11(m$15)+TG2Mat$GetE22(m$15)+1;
   if (Trace>0) {
      SqrtTrace = Math.sqrt(Trace);
      RcpSqrtTrace = 0.5/SqrtTrace;
      TG2Quat$SetX$3(Result,((TG2Mat$GetE12(m$15)-TG2Mat$GetE21(m$15))*RcpSqrtTrace));
      TG2Quat$SetY$3(Result,((TG2Mat$GetE20(m$15)-TG2Mat$GetE02(m$15))*RcpSqrtTrace));
      TG2Quat$SetZ$2(Result,((TG2Mat$GetE01(m$15)-TG2Mat$GetE10(m$15))*RcpSqrtTrace));
      TG2Quat$SetW$1(Result,(SqrtTrace*0.5));
      return Result;
   }
   MaxI = 0;
   MaxDiag = TG2Mat$GetE00(m$15);
   for(i$1 = 1;i$1<=2;i$1++) {
      if (TG2Mat$GetMat(m$15,i$1,i$1)>MaxDiag) {
         MaxI = i$1;
         MaxDiag = TG2Mat$GetMat(m$15,i$1,i$1);
      }
   }
   switch (MaxI) {
      case 0 :
         s$2 = 2*Math.sqrt((1+TG2Mat$GetE00(m$15))-TG2Mat$GetE11(m$15)-TG2Mat$GetE22(m$15));
         TG2Quat$SetX$3(Result,(0.25*s$2));
         s$2 = 1/s$2;
         TG2Quat$SetY$3(Result,((TG2Mat$GetE01(m$15)+TG2Mat$GetE10(m$15))*s$2));
         TG2Quat$SetZ$2(Result,((TG2Mat$GetE02(m$15)+TG2Mat$GetE20(m$15))*s$2));
         TG2Quat$SetW$1(Result,((TG2Mat$GetE12(m$15)-TG2Mat$GetE21(m$15))*s$2));
         break;
      case 1 :
         s$2 = 2*Math.sqrt((1+TG2Mat$GetE11(m$15))-TG2Mat$GetE00(m$15)-TG2Mat$GetE22(m$15));
         TG2Quat$SetY$3(Result,(0.25*s$2));
         s$2 = 1/s$2;
         TG2Quat$SetX$3(Result,((TG2Mat$GetE01(m$15)+TG2Mat$GetE10(m$15))*s$2));
         TG2Quat$SetZ$2(Result,((TG2Mat$GetE12(m$15)+TG2Mat$GetE21(m$15))*s$2));
         TG2Quat$SetW$1(Result,((TG2Mat$GetE20(m$15)-TG2Mat$GetE02(m$15))*s$2));
         break;
      case 2 :
         s$2 = 2*Math.sqrt((1+TG2Mat$GetE22(m$15))-TG2Mat$GetE00(m$15)-TG2Mat$GetE11(m$15));
         TG2Quat$SetZ$2(Result,(0.25*s$2));
         s$2 = 1/s$2;
         TG2Quat$SetX$3(Result,((TG2Mat$GetE02(m$15)+TG2Mat$GetE20(m$15))*s$2));
         TG2Quat$SetY$3(Result,((TG2Mat$GetE12(m$15)+TG2Mat$GetE21(m$15))*s$2));
         TG2Quat$SetW$1(Result,((TG2Mat$GetE01(m$15)-TG2Mat$GetE10(m$15))*s$2));
         break;
   }
   return Result
};
function G2PtInRect(r$7, p$3) {
   return (((p$3.x$5>=r$7.l)&&(p$3.y$4>=r$7.t))&&(p$3.x$5<=r$7.r$2))&&(p$3.y$4<=r$7.b$1);
};
function G2Point(x$93, y$76) {
   var Result = {x$5:0,y$4:0};
   Result.x$5 = x$93;
   Result.y$4 = y$76;
   return Result
};
function G2MatView(Pos$16, Target$2, Up) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var VecX$1 = {Arr$2:[0,0,0]};
   var VecY$1 = {Arr$2:[0,0,0]};
   var VecZ = {Arr$2:[0,0,0]};
   VecZ = G2Vec3Norm(G2Vec3Sub(Target$2,Pos$16));
   VecX$1 = G2Vec3Norm(G2Vec3Cross(Up,VecZ));
   VecY$1 = G2Vec3Norm(G2Vec3Cross(VecZ,VecX$1));
   TG2Mat$SetValue$9(Result,TG2Vec3$GetX$1(VecX$1),TG2Vec3$GetY$1(VecX$1),TG2Vec3$GetZ$1(VecX$1),(-G2Vec3Dot(VecX$1,Pos$16)),TG2Vec3$GetX$1(VecY$1),TG2Vec3$GetY$1(VecY$1),TG2Vec3$GetZ$1(VecY$1),(-G2Vec3Dot(VecY$1,Pos$16)),TG2Vec3$GetX$1(VecZ),TG2Vec3$GetY$1(VecZ),TG2Vec3$GetZ$1(VecZ),(-G2Vec3Dot(VecZ,Pos$16)),0,0,0,1);
   return Result
};
function G2MatTranspose(m$16) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,TG2Mat$GetE00(m$16),TG2Mat$GetE01(m$16),TG2Mat$GetE02(m$16),TG2Mat$GetE03(m$16),TG2Mat$GetE10(m$16),TG2Mat$GetE11(m$16),TG2Mat$GetE12(m$16),TG2Mat$GetE13(m$16),TG2Mat$GetE20(m$16),TG2Mat$GetE21(m$16),TG2Mat$GetE22(m$16),TG2Mat$GetE23(m$16),TG2Mat$GetE30(m$16),TG2Mat$GetE31(m$16),TG2Mat$GetE32(m$16),TG2Mat$GetE33(m$16));
   return Result
};
function G2MatTranslation(x$94, y$77, z$6) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,1,0,0,x$94,0,1,0,y$77,0,0,1,z$6,0,0,0,1);
   return Result
};
function G2MatTranslation$1(v$17) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,1,0,0,TG2Vec3$GetX$1(v$17),0,1,0,TG2Vec3$GetY$1(v$17),0,0,1,TG2Vec3$GetZ$1(v$17),0,0,0,1);
   return Result
};
function G2MatSub(m0, m1) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$2 = 0;
   for(i$2 = 0;i$2<=15;i$2++) {
      TG2Mat$SetE$4(Result,i$2,(TG2Mat$GetE$4(m0,i$2)-TG2Mat$GetE$4(m1,i$2)));
   }
   return Result
};
function G2MatScaling(x$95, y$78, z$7) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,x$95,0,0,0,0,y$78,0,0,0,0,z$7,0,0,0,0,1);
   return Result
};
function G2MatScaling$1(v$18) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,TG2Vec3$GetX$1(v$18),0,0,0,0,TG2Vec3$GetY$1(v$18),0,0,0,0,TG2Vec3$GetZ$1(v$18),0,0,0,0,1);
   return Result
};
function G2MatScaling$2(s$12) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,s$12,0,0,0,0,s$12,0,0,0,0,s$12,0,0,0,0,1);
   return Result
};
function G2MatRotationZ(a$67) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var s$3 = {};
   s$3.v = 0;
   var c$5 = {};
   c$5.v = 0;
   G2SinCos(a$67,s$3,c$5);
   TG2Mat$SetValue$9(Result,c$5.v,(-s$3.v),0,0,s$3.v,c$5.v,0,0,0,0,1,0,0,0,0,1);
   return Result
};
function G2MatRotationY(a$68) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var s$4 = {};
   s$4.v = 0;
   var c$6 = {};
   c$6.v = 0;
   G2SinCos(a$68,s$4,c$6);
   TG2Mat$SetValue$9(Result,c$6.v,0,s$4.v,0,0,1,0,0,(-s$4.v),0,c$6.v,0,0,0,0,1);
   return Result
};
function G2MatRotationX(a$69) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var s$5 = {};
   s$5.v = 0;
   var c$7 = {};
   c$7.v = 0;
   G2SinCos(a$69,s$5,c$7);
   TG2Mat$SetValue$9(Result,1,0,0,0,0,c$7.v,(-s$5.v),0,0,s$5.v,c$7.v,0,0,0,0,1);
   return Result
};
function G2MatRotation(x$96, y$79, z$8, a$70) {
   return G2MatRotation$1(G2Vec3(x$96,y$79,z$8),a$70);
};
function G2MatRotation$1(v$19, a$71) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var vr$7 = {Arr$2:[0,0,0]};
   var s$6 = {};
   s$6.v = 0;
   var c$8 = {};
   c$8.v = 0;
   var cr = 0;
   var xs = 0;
   var ys = 0;
   var zs = 0;
   var crxy = 0;
   var crxz = 0;
   var cryz = 0;
   vr$7 = G2Vec3Norm(v$19);
   G2SinCos(a$71,s$6,c$8);
   cr = 1-c$8.v;
   xs = TG2Vec3$GetX$1(vr$7)*s$6.v;
   ys = TG2Vec3$GetY$1(vr$7)*s$6.v;
   zs = TG2Vec3$GetZ$1(vr$7)*s$6.v;
   crxy = cr*TG2Vec3$GetX$1(vr$7)*TG2Vec3$GetY$1(vr$7);
   crxz = cr*TG2Vec3$GetX$1(vr$7)*TG2Vec3$GetZ$1(vr$7);
   cryz = cr*TG2Vec3$GetY$1(vr$7)*TG2Vec3$GetZ$1(vr$7);
   TG2Mat$SetValue$9(Result,((cr*TG2Vec3$GetX$1(v$19)*TG2Vec3$GetX$1(v$19))+c$8.v),((-zs)+crxy),(ys+crxz),0,(zs+crxy),((cr*TG2Vec3$GetY$1(v$19)*TG2Vec3$GetY$1(v$19))+c$8.v),((-xs)+cryz),0,((-ys)+crxz),(xs+cryz),((cr*TG2Vec3$GetZ$1(v$19)*TG2Vec3$GetZ$1(v$19))+c$8.v),0,0,0,0,1);
   return Result
};
function G2MatRotation$2(q$1) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var xx = 0;
   var yy = 0;
   var zz = 0;
   var xy = 0;
   var xz = 0;
   var yz = 0;
   var wx = 0;
   var wy = 0;
   var wz = 0;
   xx = 2*TG2Quat$GetX$3(q$1)*TG2Quat$GetX$3(q$1);
   yy = 2*TG2Quat$GetY$3(q$1)*TG2Quat$GetY$3(q$1);
   zz = 2*TG2Quat$GetZ$2(q$1)*TG2Quat$GetZ$2(q$1);
   xy = 2*TG2Quat$GetX$3(q$1)*TG2Quat$GetY$3(q$1);
   xz = 2*TG2Quat$GetX$3(q$1)*TG2Quat$GetZ$2(q$1);
   yz = 2*TG2Quat$GetY$3(q$1)*TG2Quat$GetZ$2(q$1);
   wx = 2*TG2Quat$GetW$1(q$1)*TG2Quat$GetX$3(q$1);
   wy = 2*TG2Quat$GetW$1(q$1)*TG2Quat$GetY$3(q$1);
   wz = 2*TG2Quat$GetW$1(q$1)*TG2Quat$GetZ$2(q$1);
   TG2Mat$SetValue$9(Result,(1-yy-zz),(xy-wz),(xz+wy),0,(xy+wz),(1-xx-zz),(yz-wx),0,(xz-wy),(yz+wx),(1-xx-yy),0,0,0,0,1);
   return Result
};
function G2MatProj(FOV, Aspect, ZNear, ZFar) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var ct = 0;
   var q = 0;
   ct = Cotan(FOV*0.5);
   q = ZFar/(ZFar-ZNear);
   TG2Mat$SetValue$9(Result,(ct/Aspect),0,0,0,0,ct,0,0,0,0,q,((-q)*ZNear),0,0,1,0);
   return Result
};
function G2MatOrth2D(Width$27, Height$24, ZNear$1, ZFar$1, FlipH, FlipV$4) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var RcpD = 0;
   var x$6 = 0;
   var y$5 = 0;
   var w$4 = 0;
   var h = 0;
   if (FlipH) {
      x$6 = 1;
      w$4 = -2/Width$27;
   } else {
      x$6 = -1;
      w$4 = 2/Width$27;
   }
   if (FlipV$4) {
      y$5 = 1;
      h = -2/Height$24;
   } else {
      y$5 = -1;
      h = 2/Height$24;
   }
   RcpD = 1/(ZFar$1-ZNear$1);
   TG2Mat$SetValue$9(Result,w$4,0,0,x$6,0,h,0,y$5,0,0,RcpD,((-ZNear$1)*RcpD),0,0,0,1);
   return Result
};
function G2MatOrth(Width$28, Height$25, ZNear$2, ZFar$2) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var RcpD$1 = 0;
   RcpD$1 = 1/(ZFar$2-ZNear$2);
   TG2Mat$SetValue$9(Result,(2/Width$28),0,0,0,0,(2/Height$25),0,0,0,0,RcpD$1,((-ZNear$2)*RcpD$1),0,0,0,1);
   return Result
};
function G2MatMul(m0$1, m1$1) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var mr = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetE00(mr,((TG2Mat$GetE00(m0$1)*TG2Mat$GetE00(m1$1))+(TG2Mat$GetE01(m0$1)*TG2Mat$GetE10(m1$1))+(TG2Mat$GetE02(m0$1)*TG2Mat$GetE20(m1$1))+(TG2Mat$GetE03(m0$1)*TG2Mat$GetE30(m1$1))));
   TG2Mat$SetE10(mr,((TG2Mat$GetE10(m0$1)*TG2Mat$GetE00(m1$1))+(TG2Mat$GetE11(m0$1)*TG2Mat$GetE10(m1$1))+(TG2Mat$GetE12(m0$1)*TG2Mat$GetE20(m1$1))+(TG2Mat$GetE13(m0$1)*TG2Mat$GetE30(m1$1))));
   TG2Mat$SetE20(mr,((TG2Mat$GetE20(m0$1)*TG2Mat$GetE00(m1$1))+(TG2Mat$GetE21(m0$1)*TG2Mat$GetE10(m1$1))+(TG2Mat$GetE22(m0$1)*TG2Mat$GetE20(m1$1))+(TG2Mat$GetE23(m0$1)*TG2Mat$GetE30(m1$1))));
   TG2Mat$SetE30(mr,((TG2Mat$GetE30(m0$1)*TG2Mat$GetE00(m1$1))+(TG2Mat$GetE31(m0$1)*TG2Mat$GetE10(m1$1))+(TG2Mat$GetE32(m0$1)*TG2Mat$GetE20(m1$1))+(TG2Mat$GetE33(m0$1)*TG2Mat$GetE30(m1$1))));
   TG2Mat$SetE01(mr,((TG2Mat$GetE00(m0$1)*TG2Mat$GetE01(m1$1))+(TG2Mat$GetE01(m0$1)*TG2Mat$GetE11(m1$1))+(TG2Mat$GetE02(m0$1)*TG2Mat$GetE21(m1$1))+(TG2Mat$GetE03(m0$1)*TG2Mat$GetE31(m1$1))));
   TG2Mat$SetE11(mr,((TG2Mat$GetE10(m0$1)*TG2Mat$GetE01(m1$1))+(TG2Mat$GetE11(m0$1)*TG2Mat$GetE11(m1$1))+(TG2Mat$GetE12(m0$1)*TG2Mat$GetE21(m1$1))+(TG2Mat$GetE13(m0$1)*TG2Mat$GetE31(m1$1))));
   TG2Mat$SetE21(mr,((TG2Mat$GetE20(m0$1)*TG2Mat$GetE01(m1$1))+(TG2Mat$GetE21(m0$1)*TG2Mat$GetE11(m1$1))+(TG2Mat$GetE22(m0$1)*TG2Mat$GetE21(m1$1))+(TG2Mat$GetE23(m0$1)*TG2Mat$GetE31(m1$1))));
   TG2Mat$SetE31(mr,((TG2Mat$GetE30(m0$1)*TG2Mat$GetE01(m1$1))+(TG2Mat$GetE31(m0$1)*TG2Mat$GetE11(m1$1))+(TG2Mat$GetE32(m0$1)*TG2Mat$GetE21(m1$1))+(TG2Mat$GetE33(m0$1)*TG2Mat$GetE31(m1$1))));
   TG2Mat$SetE02(mr,((TG2Mat$GetE00(m0$1)*TG2Mat$GetE02(m1$1))+(TG2Mat$GetE01(m0$1)*TG2Mat$GetE12(m1$1))+(TG2Mat$GetE02(m0$1)*TG2Mat$GetE22(m1$1))+(TG2Mat$GetE03(m0$1)*TG2Mat$GetE32(m1$1))));
   TG2Mat$SetE12(mr,((TG2Mat$GetE10(m0$1)*TG2Mat$GetE02(m1$1))+(TG2Mat$GetE11(m0$1)*TG2Mat$GetE12(m1$1))+(TG2Mat$GetE12(m0$1)*TG2Mat$GetE22(m1$1))+(TG2Mat$GetE13(m0$1)*TG2Mat$GetE32(m1$1))));
   TG2Mat$SetE22(mr,((TG2Mat$GetE20(m0$1)*TG2Mat$GetE02(m1$1))+(TG2Mat$GetE21(m0$1)*TG2Mat$GetE12(m1$1))+(TG2Mat$GetE22(m0$1)*TG2Mat$GetE22(m1$1))+(TG2Mat$GetE23(m0$1)*TG2Mat$GetE32(m1$1))));
   TG2Mat$SetE32(mr,((TG2Mat$GetE30(m0$1)*TG2Mat$GetE02(m1$1))+(TG2Mat$GetE31(m0$1)*TG2Mat$GetE12(m1$1))+(TG2Mat$GetE32(m0$1)*TG2Mat$GetE22(m1$1))+(TG2Mat$GetE33(m0$1)*TG2Mat$GetE32(m1$1))));
   TG2Mat$SetE03(mr,((TG2Mat$GetE00(m0$1)*TG2Mat$GetE03(m1$1))+(TG2Mat$GetE01(m0$1)*TG2Mat$GetE13(m1$1))+(TG2Mat$GetE02(m0$1)*TG2Mat$GetE23(m1$1))+(TG2Mat$GetE03(m0$1)*TG2Mat$GetE33(m1$1))));
   TG2Mat$SetE13(mr,((TG2Mat$GetE10(m0$1)*TG2Mat$GetE03(m1$1))+(TG2Mat$GetE11(m0$1)*TG2Mat$GetE13(m1$1))+(TG2Mat$GetE12(m0$1)*TG2Mat$GetE23(m1$1))+(TG2Mat$GetE13(m0$1)*TG2Mat$GetE33(m1$1))));
   TG2Mat$SetE23(mr,((TG2Mat$GetE20(m0$1)*TG2Mat$GetE03(m1$1))+(TG2Mat$GetE21(m0$1)*TG2Mat$GetE13(m1$1))+(TG2Mat$GetE22(m0$1)*TG2Mat$GetE23(m1$1))+(TG2Mat$GetE23(m0$1)*TG2Mat$GetE33(m1$1))));
   TG2Mat$SetE33(mr,((TG2Mat$GetE30(m0$1)*TG2Mat$GetE03(m1$1))+(TG2Mat$GetE31(m0$1)*TG2Mat$GetE13(m1$1))+(TG2Mat$GetE32(m0$1)*TG2Mat$GetE23(m1$1))+(TG2Mat$GetE33(m0$1)*TG2Mat$GetE33(m1$1))));
   Copy$TG2Mat(mr,Result);
   return Result
};
function G2MatInv(m0$2) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var d$6 = 0;
   var di = 0;
   di = TG2Mat$GetE00(m0$2);
   d$6 = 1/di;
   TG2Mat$SetE00(Result,d$6);
   TG2Mat$SetE10(Result,((-TG2Mat$GetE10(m0$2))*d$6));
   TG2Mat$SetE20(Result,((-TG2Mat$GetE20(m0$2))*d$6));
   TG2Mat$SetE30(Result,((-TG2Mat$GetE30(m0$2))*d$6));
   TG2Mat$SetE01(Result,(TG2Mat$GetE01(m0$2)*d$6));
   TG2Mat$SetE02(Result,(TG2Mat$GetE02(m0$2)*d$6));
   TG2Mat$SetE03(Result,(TG2Mat$GetE03(m0$2)*d$6));
   TG2Mat$SetE11(Result,(TG2Mat$GetE11(m0$2)+(TG2Mat$GetE10(Result)*TG2Mat$GetE01(Result)*di)));
   TG2Mat$SetE12(Result,(TG2Mat$GetE12(m0$2)+(TG2Mat$GetE10(Result)*TG2Mat$GetE02(Result)*di)));
   TG2Mat$SetE13(Result,(TG2Mat$GetE13(m0$2)+(TG2Mat$GetE10(Result)*TG2Mat$GetE03(Result)*di)));
   TG2Mat$SetE21(Result,(TG2Mat$GetE21(m0$2)+(TG2Mat$GetE20(Result)*TG2Mat$GetE01(Result)*di)));
   TG2Mat$SetE22(Result,(TG2Mat$GetE22(m0$2)+(TG2Mat$GetE20(Result)*TG2Mat$GetE02(Result)*di)));
   TG2Mat$SetE23(Result,(TG2Mat$GetE23(m0$2)+(TG2Mat$GetE20(Result)*TG2Mat$GetE03(Result)*di)));
   TG2Mat$SetE31(Result,(TG2Mat$GetE31(m0$2)+(TG2Mat$GetE30(Result)*TG2Mat$GetE01(Result)*di)));
   TG2Mat$SetE32(Result,(TG2Mat$GetE32(m0$2)+(TG2Mat$GetE30(Result)*TG2Mat$GetE02(Result)*di)));
   TG2Mat$SetE33(Result,(TG2Mat$GetE33(m0$2)+(TG2Mat$GetE30(Result)*TG2Mat$GetE03(Result)*di)));
   di = TG2Mat$GetE11(Result);
   d$6 = 1/di;
   TG2Mat$SetE11(Result,d$6);
   TG2Mat$SetE01(Result,((-TG2Mat$GetE01(Result))*d$6));
   TG2Mat$SetE21(Result,((-TG2Mat$GetE21(Result))*d$6));
   TG2Mat$SetE31(Result,((-TG2Mat$GetE31(Result))*d$6));
   TG2Mat$SetE10(Result,(TG2Mat$GetE10(Result)*d$6));
   TG2Mat$SetE12(Result,(TG2Mat$GetE12(Result)*d$6));
   TG2Mat$SetE13(Result,(TG2Mat$GetE13(Result)*d$6));
   TG2Mat$SetE00(Result,(TG2Mat$GetE00(Result)+(TG2Mat$GetE01(Result)*TG2Mat$GetE10(Result)*di)));
   TG2Mat$SetE02(Result,(TG2Mat$GetE02(Result)+(TG2Mat$GetE01(Result)*TG2Mat$GetE12(Result)*di)));
   TG2Mat$SetE03(Result,(TG2Mat$GetE03(Result)+(TG2Mat$GetE01(Result)*TG2Mat$GetE13(Result)*di)));
   TG2Mat$SetE20(Result,(TG2Mat$GetE20(Result)+(TG2Mat$GetE21(Result)*TG2Mat$GetE10(Result)*di)));
   TG2Mat$SetE22(Result,(TG2Mat$GetE22(Result)+(TG2Mat$GetE21(Result)*TG2Mat$GetE12(Result)*di)));
   TG2Mat$SetE23(Result,(TG2Mat$GetE23(Result)+(TG2Mat$GetE21(Result)*TG2Mat$GetE13(Result)*di)));
   TG2Mat$SetE30(Result,(TG2Mat$GetE30(Result)+(TG2Mat$GetE31(Result)*TG2Mat$GetE10(Result)*di)));
   TG2Mat$SetE32(Result,(TG2Mat$GetE32(Result)+(TG2Mat$GetE31(Result)*TG2Mat$GetE12(Result)*di)));
   TG2Mat$SetE33(Result,(TG2Mat$GetE33(Result)+(TG2Mat$GetE31(Result)*TG2Mat$GetE13(Result)*di)));
   di = TG2Mat$GetE22(Result);
   d$6 = 1/di;
   TG2Mat$SetE22(Result,d$6);
   TG2Mat$SetE02(Result,((-TG2Mat$GetE02(Result))*d$6));
   TG2Mat$SetE12(Result,((-TG2Mat$GetE12(Result))*d$6));
   TG2Mat$SetE32(Result,((-TG2Mat$GetE32(Result))*d$6));
   TG2Mat$SetE20(Result,(TG2Mat$GetE20(Result)*d$6));
   TG2Mat$SetE21(Result,(TG2Mat$GetE21(Result)*d$6));
   TG2Mat$SetE23(Result,(TG2Mat$GetE23(Result)*d$6));
   TG2Mat$SetE00(Result,(TG2Mat$GetE00(Result)+(TG2Mat$GetE02(Result)*TG2Mat$GetE20(Result)*di)));
   TG2Mat$SetE01(Result,(TG2Mat$GetE01(Result)+(TG2Mat$GetE02(Result)*TG2Mat$GetE21(Result)*di)));
   TG2Mat$SetE03(Result,(TG2Mat$GetE03(Result)+(TG2Mat$GetE02(Result)*TG2Mat$GetE23(Result)*di)));
   TG2Mat$SetE10(Result,(TG2Mat$GetE10(Result)+(TG2Mat$GetE12(Result)*TG2Mat$GetE20(Result)*di)));
   TG2Mat$SetE11(Result,(TG2Mat$GetE11(Result)+(TG2Mat$GetE12(Result)*TG2Mat$GetE21(Result)*di)));
   TG2Mat$SetE13(Result,(TG2Mat$GetE13(Result)+(TG2Mat$GetE12(Result)*TG2Mat$GetE23(Result)*di)));
   TG2Mat$SetE30(Result,(TG2Mat$GetE30(Result)+(TG2Mat$GetE32(Result)*TG2Mat$GetE20(Result)*di)));
   TG2Mat$SetE31(Result,(TG2Mat$GetE31(Result)+(TG2Mat$GetE32(Result)*TG2Mat$GetE21(Result)*di)));
   TG2Mat$SetE33(Result,(TG2Mat$GetE33(Result)+(TG2Mat$GetE32(Result)*TG2Mat$GetE23(Result)*di)));
   di = TG2Mat$GetE33(Result);
   d$6 = 1/di;
   TG2Mat$SetE33(Result,d$6);
   TG2Mat$SetE03(Result,((-TG2Mat$GetE03(Result))*d$6));
   TG2Mat$SetE13(Result,((-TG2Mat$GetE13(Result))*d$6));
   TG2Mat$SetE23(Result,((-TG2Mat$GetE23(Result))*d$6));
   TG2Mat$SetE30(Result,(TG2Mat$GetE30(Result)*d$6));
   TG2Mat$SetE31(Result,(TG2Mat$GetE31(Result)*d$6));
   TG2Mat$SetE32(Result,(TG2Mat$GetE32(Result)*d$6));
   TG2Mat$SetE00(Result,(TG2Mat$GetE00(Result)+(TG2Mat$GetE03(Result)*TG2Mat$GetE30(Result)*di)));
   TG2Mat$SetE01(Result,(TG2Mat$GetE01(Result)+(TG2Mat$GetE03(Result)*TG2Mat$GetE31(Result)*di)));
   TG2Mat$SetE02(Result,(TG2Mat$GetE02(Result)+(TG2Mat$GetE03(Result)*TG2Mat$GetE32(Result)*di)));
   TG2Mat$SetE10(Result,(TG2Mat$GetE10(Result)+(TG2Mat$GetE13(Result)*TG2Mat$GetE30(Result)*di)));
   TG2Mat$SetE11(Result,(TG2Mat$GetE11(Result)+(TG2Mat$GetE13(Result)*TG2Mat$GetE31(Result)*di)));
   TG2Mat$SetE12(Result,(TG2Mat$GetE12(Result)+(TG2Mat$GetE13(Result)*TG2Mat$GetE32(Result)*di)));
   TG2Mat$SetE20(Result,(TG2Mat$GetE20(Result)+(TG2Mat$GetE23(Result)*TG2Mat$GetE30(Result)*di)));
   TG2Mat$SetE21(Result,(TG2Mat$GetE21(Result)+(TG2Mat$GetE23(Result)*TG2Mat$GetE31(Result)*di)));
   TG2Mat$SetE22(Result,(TG2Mat$GetE22(Result)+(TG2Mat$GetE23(Result)*TG2Mat$GetE32(Result)*di)));
   return Result
};
function G2MatIdentity() {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);
   return Result
};
function G2MatFloatSub(m0$3, f$21) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$3 = 0;
   for(i$3 = 0;i$3<=15;i$3++) {
      TG2Mat$SetE$4(Result,i$3,(TG2Mat$GetE$4(m0$3,i$3)-f$21));
   }
   return Result
};
function G2MatFloatMul(m0$4, f$22) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$4 = 0;
   for(i$4 = 0;i$4<=15;i$4++) {
      TG2Mat$SetE$4(Result,i$4,(TG2Mat$GetE$4(m0$4,i$4)*f$22));
   }
   return Result
};
function G2MatFloatDiv(m0$5, f$23) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$5 = 0;
   for(i$5 = 0;i$5<=15;i$5++) {
      TG2Mat$SetE$4(Result,i$5,(TG2Mat$GetE$4(m0$5,i$5)/f$23));
   }
   return Result
};
function G2MatFloatAdd(m0$6, f$24) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$6 = 0;
   for(i$6 = 0;i$6<=15;i$6++) {
      TG2Mat$SetE$4(Result,i$6,(TG2Mat$GetE$4(m0$6,i$6)+f$24));
   }
   return Result
};
function G2MatDecompose(OutScaling, OutRotation, OutTranslation, m$17) {
   var mn = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var v = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(OutScaling,G2Vec3Len(G2Vec3(TG2Mat$GetE00(m$17),TG2Mat$GetE01(m$17),TG2Mat$GetE02(m$17))));
   TG2Vec3$SetY$1(OutScaling,G2Vec3Len(G2Vec3(TG2Mat$GetE10(m$17),TG2Mat$GetE11(m$17),TG2Mat$GetE12(m$17))));
   TG2Vec3$SetZ$1(OutScaling,G2Vec3Len(G2Vec3(TG2Mat$GetE20(m$17),TG2Mat$GetE21(m$17),TG2Mat$GetE22(m$17))));
   Copy$TG2Vec3(G2Vec3(TG2Mat$GetE30(m$17),TG2Mat$GetE31(m$17),TG2Mat$GetE32(m$17)),OutTranslation);
   if (((TG2Vec3$GetX$1(OutScaling)==0)||(TG2Vec3$GetY$1(OutScaling)==0))||(TG2Vec3$GetZ$1(OutScaling)==0)) {
      TG2Quat$SetValue$5(OutRotation,0,0,0,1);
      return;
   }
   TG2Vec3$SetX$1(v,(1/TG2Vec3$GetX$1(OutScaling)));
   TG2Vec3$SetY$1(v,(1/TG2Vec3$GetY$1(OutScaling)));
   TG2Vec3$SetZ$1(v,(1/TG2Vec3$GetZ$1(OutScaling)));
   TG2Mat$SetValue$9(mn,(TG2Mat$GetE00(m$17)*TG2Vec3$GetX$1(v)),(TG2Mat$GetE10(m$17)*TG2Vec3$GetY$1(v)),(TG2Mat$GetE20(m$17)*TG2Vec3$GetZ$1(v)),0,(TG2Mat$GetE01(m$17)*TG2Vec3$GetX$1(v)),(TG2Mat$GetE11(m$17)*TG2Vec3$GetY$1(v)),(TG2Mat$GetE21(m$17)*TG2Vec3$GetZ$1(v)),0,(TG2Mat$GetE02(m$17)*TG2Vec3$GetX$1(v)),(TG2Mat$GetE12(m$17)*TG2Vec3$GetY$1(v)),(TG2Mat$GetE22(m$17)*TG2Vec3$GetZ$1(v)),0,0,0,0,1);
   Copy$TG2Quat(G2Quat$2(mn),OutRotation);
};
function G2MatAdd(m0$7, m1$2) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   var i$7 = 0;
   for(i$7 = 0;i$7<=15;i$7++) {
      TG2Mat$SetE$4(Result,i$7,(TG2Mat$GetE$4(m0$7,i$7)+TG2Mat$GetE$4(m1$2,i$7)));
   }
   return Result
};
function G2Mat(e00$1, e10$1, e20$1, e30$1, e01$1, e11$1, e21$1, e31$1, e02$1, e12$1, e22$1, e32$1, e03$1, e13$1, e23$1, e33$1) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,e00$1,e10$1,e20$1,e30$1,e01$1,e11$1,e21$1,e31$1,e02$1,e12$1,e22$1,e32$1,e03$1,e13$1,e23$1,e33$1);
   return Result
};
function G2Mat$1(AxisX, AxisY, AxisZ, Translation$2) {
   var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
   TG2Mat$SetValue$9(Result,TG2Vec3$GetX$1(AxisX),TG2Vec3$GetX$1(AxisY),TG2Vec3$GetX$1(AxisZ),TG2Vec3$GetX$1(Translation$2),TG2Vec3$GetY$1(AxisX),TG2Vec3$GetY$1(AxisY),TG2Vec3$GetY$1(AxisZ),TG2Vec3$GetY$1(Translation$2),TG2Vec3$GetZ$1(AxisX),TG2Vec3$GetZ$1(AxisY),TG2Vec3$GetZ$1(AxisZ),TG2Vec3$GetZ$1(Translation$2),0,0,0,1);
   return Result
};
function G2LerpVec4(v0$64, v1$21, s$13) {
   var Result = {Arr$1:[0,0,0,0]};
   TG2Vec4$SetX(Result,(TG2Vec4$GetX(v0$64)+((TG2Vec4$GetX(v1$21)-TG2Vec4$GetX(v0$64))*s$13)));
   TG2Vec4$SetY(Result,(TG2Vec4$GetY(v0$64)+((TG2Vec4$GetY(v1$21)-TG2Vec4$GetY(v0$64))*s$13)));
   TG2Vec4$SetZ(Result,(TG2Vec4$GetZ(v0$64)+((TG2Vec4$GetZ(v1$21)-TG2Vec4$GetZ(v0$64))*s$13)));
   TG2Vec4$SetW(Result,(TG2Vec4$GetW(v0$64)+((TG2Vec4$GetW(v1$21)-TG2Vec4$GetW(v0$64))*s$13)));
   return Result
};
function G2LerpVec3(v0$65, v1$22, s$14) {
   var Result = {Arr$2:[0,0,0]};
   TG2Vec3$SetX$1(Result,(TG2Vec3$GetX$1(v0$65)+((TG2Vec3$GetX$1(v1$22)-TG2Vec3$GetX$1(v0$65))*s$14)));
   TG2Vec3$SetY$1(Result,(TG2Vec3$GetY$1(v0$65)+((TG2Vec3$GetY$1(v1$22)-TG2Vec3$GetY$1(v0$65))*s$14)));
   TG2Vec3$SetZ$1(Result,(TG2Vec3$GetZ$1(v0$65)+((TG2Vec3$GetZ$1(v1$22)-TG2Vec3$GetZ$1(v0$65))*s$14)));
   return Result
};
function G2LerpVec2(v0$66, v1$23, s$15) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(TG2Vec2$GetX$2(v0$66)+((TG2Vec2$GetX$2(v1$23)-TG2Vec2$GetX$2(v0$66))*s$15)));
   TG2Vec2$SetY$2(Result,(TG2Vec2$GetY$2(v0$66)+((TG2Vec2$GetY$2(v1$23)-TG2Vec2$GetY$2(v0$66))*s$15)));
   return Result
};
function G2LerpFloat(f0$2, f1$2, s$16) {
   return f0$2+((f1$2-f0$2)*s$16);
};
function G2Intersect3Planes(p1, p2, p3) {
   var Result = {Arr$2:[0,0,0]};
   var iDet = 0;
   iDet = -TG2Vec3$Dot(p1.n$3,TG2Vec3$Cross(p2.n$3,p3.n$3));
   if (Math.abs(iDet)>1E-6) {
      Result = G2Vec3FloatDiv(G2Vec3Add(G2Vec3Add(G2Vec3FloatMul(TG2Vec3$Cross(p2.n$3,p3.n$3),p1.d),G2Vec3FloatMul(TG2Vec3$Cross(p3.n$3,p1.n$3),p2.d)),G2Vec3FloatMul(TG2Vec3$Cross(p1.n$3,p2.n$3),p3.d)),iDet);
   } else {
      TG2Vec3$SetValue$1(Result,0,0,0);
   }
   return Result
};
function G2BoxToAABox(b$35) {
   var Result = {MaxV:{Arr$2:[0,0,0]},MinV:{Arr$2:[0,0,0]}};
   var i$8 = 0;
   var v$1 = [{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]},{Arr$2:[0,0,0]}];
   v$1[0] = G2Vec3Add(G2Vec3Add(G2Vec3Add(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[1] = G2Vec3Sub(G2Vec3Add(G2Vec3Add(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[2] = G2Vec3Sub(G2Vec3Add(G2Vec3Sub(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[3] = G2Vec3Add(G2Vec3Add(G2Vec3Sub(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[4] = G2Vec3Add(G2Vec3Sub(G2Vec3Add(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[5] = G2Vec3Sub(G2Vec3Sub(G2Vec3Add(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[6] = G2Vec3Sub(G2Vec3Sub(G2Vec3Sub(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   v$1[7] = G2Vec3Add(G2Vec3Sub(G2Vec3Sub(b$35.c$3,b$35.vx),b$35.vy),b$35.vz);
   Copy$TG2Vec3(v$1[0],Result.MinV);
   Copy$TG2Vec3(v$1[0],Result.MaxV);
   for(i$8 = 1;i$8<=7;i$8++) {
      if (TG2Vec3$GetX$1(v$1[$Idx(i$8,0,7,"")])<TG2Vec3$GetX$1(Result.MinV)) {
         TG2Vec3$SetX$1(Result.MinV,TG2Vec3$GetX$1(v$1[$Idx(i$8,0,7,"")]));
      }
      if (TG2Vec3$GetY$1(v$1[$Idx(i$8,0,7,"")])<TG2Vec3$GetY$1(Result.MinV)) {
         TG2Vec3$SetY$1(Result.MinV,TG2Vec3$GetY$1(v$1[$Idx(i$8,0,7,"")]));
      }
      if (TG2Vec3$GetZ$1(v$1[$Idx(i$8,0,7,"")])<TG2Vec3$GetZ$1(Result.MinV)) {
         TG2Vec3$SetZ$1(Result.MinV,TG2Vec3$GetZ$1(v$1[$Idx(i$8,0,7,"")]));
      }
      if (TG2Vec3$GetX$1(v$1[$Idx(i$8,0,7,"")])>TG2Vec3$GetX$1(Result.MaxV)) {
         TG2Vec3$SetX$1(Result.MaxV,TG2Vec3$GetX$1(v$1[$Idx(i$8,0,7,"")]));
      }
      if (TG2Vec3$GetY$1(v$1[$Idx(i$8,0,7,"")])>TG2Vec3$GetY$1(Result.MaxV)) {
         TG2Vec3$SetY$1(Result.MaxV,TG2Vec3$GetY$1(v$1[$Idx(i$8,0,7,"")]));
      }
      if (TG2Vec3$GetZ$1(v$1[$Idx(i$8,0,7,"")])>TG2Vec3$GetZ$1(Result.MaxV)) {
         TG2Vec3$SetZ$1(Result.MaxV,TG2Vec3$GetZ$1(v$1[$Idx(i$8,0,7,"")]));
      }
   }
   return Result
};
function G2AABoxToBox(b$36) {
   var Result = {c$3:{Arr$2:[0,0,0]},vx:{Arr$2:[0,0,0]},vy:{Arr$2:[0,0,0]},vz:{Arr$2:[0,0,0]}};
   var v$2 = {Arr$2:[0,0,0]};
   Result.c$3 = G2Vec3FloatMul(G2Vec3Add(b$36.MinV,b$36.MaxV),0.5);
   v$2 = G2Vec3FloatMul(G2Vec3Sub(b$36.MaxV,b$36.MinV),0.5);
   TG2Vec3$SetValue$1(Result.vx,TG2Vec3$GetX$1(v$2),0,0);
   TG2Vec3$SetValue$1(Result.vy,0,TG2Vec3$GetY$1(v$2),0);
   TG2Vec3$SetValue$1(Result.vz,0,0,TG2Vec3$GetZ$1(v$2));
   return Result
};
function G2Vec2Neg(v0$67) {
   var Result = {Arr$3:[0,0]};
   TG2Vec2$SetX$2(Result,(-TG2Vec2$GetX$2(v0$67)));
   TG2Vec2$SetY$2(Result,(-TG2Vec2$GetY$2(v0$67)));
   return Result
};
/// TG2DataManager = class (TG2ResourceAsync)
var TG2DataManager = {
   $ClassName:"TG2DataManager",
   $Parent:TG2ResourceAsync
   ,$Init:function ($) {
      TG2ResourceAsync.$Init($);
      $._Ajax = $._Data$2 = undefined;
      $._OnLoadProc$2 = null;
      $._Position$2 = 0;
   }
   /// constructor TG2DataManager.Create()
   ,Create$48:function(Self) {
      TG2ResourceAsync.Create$48(Self);
      
    Self._Ajax = new XMLHttpRequest();
  $Check(Self,"")._Ajax.onreadystatechange = $Event0(Self,TG2DataManager.OnAjaxStateChange);
      $Check(Self,"")._OnLoadProc$2 = null;
      return Self
   }
   /// destructor TG2DataManager.Destroy()
   ,Destroy:function(Self) {
      TG2Resource.Destroy(Self);
   }
   /// function TG2DataManager.GetSize() : Integer
   ,GetSize:function(Self) {
      return parseInt($Check(Self,"")._Data$2.byteLength,10);
   }
   /// procedure TG2DataManager.Load(const FileName: String)
   ,Load$5:function(Self, FileName$2) {
      $Check(Self,"")._State = 1;
      if (PreventCaching) {
         $Check(Self,"")._Ajax.open("GET",FileName$2+"?c="+G2Time().toString(),true);
      } else {
         $Check(Self,"")._Ajax.open("GET",FileName$2,true);
      }
      $Check(Self,"")._Ajax.responseType = "arraybuffer";
      $Check(Self,"")._Ajax.send();
   }
   /// procedure TG2DataManager.OnAjaxStateChange()
   ,OnAjaxStateChange:function(Self) {
      if (($Check(Self,"")._Ajax.readyState==4)&&($Check(Self,"")._Ajax.status==200)) {
         TG2DataManager.OnLoad$3(Self);
      }
   }
   /// procedure TG2DataManager.OnLoad()
   ,OnLoad$3:function(Self) {
      
    Self._Data$2 = new DataView((Self._Ajax).response);
  $Check(Self,"")._Position$2 = 0;
      $Check(Self,"")._State = 2;
      if ($Check(Self,"")._OnLoadProc$2) {
         $CheckFunc($Check(Self,"")._OnLoadProc$2,"")();
      }
   }
   /// function TG2DataManager.ReadBool() : Boolean
   ,ReadBool:function(Self) {
      var Result = false;
      Result = $Check(Self,"")._Data$2.getInt8($Check(Self,"")._Position$2,true)>0;
      ++$Check(Self,"")._Position$2;
      return Result
   }
   /// function TG2DataManager.ReadFloat32() : TG2Float
   ,ReadFloat32:function(Self) {
      var Result = 0;
      Result = Number($Check(Self,"")._Data$2.getFloat32($Check(Self,"")._Position$2,true));
      ($Check(Self,"")._Position$2+= 4);
      return Result
   }
   /// function TG2DataManager.ReadFloat64() : TG2Float
   ,ReadFloat64:function(Self) {
      var Result = 0;
      Result = Number($Check(Self,"")._Data$2.getFloat64($Check(Self,"")._Position$2,true));
      ($Check(Self,"")._Position$2+= 8);
      return Result
   }
   /// function TG2DataManager.ReadIntS16() : Integer
   ,ReadIntS16:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getInt16($Check(Self,"")._Position$2,true),10);
      ($Check(Self,"")._Position$2+= 2);
      return Result
   }
   /// function TG2DataManager.ReadIntS32() : Integer
   ,ReadIntS32:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getInt32($Check(Self,"")._Position$2,true),10);
      ($Check(Self,"")._Position$2+= 4);
      return Result
   }
   /// function TG2DataManager.ReadIntS8() : Integer
   ,ReadIntS8:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getInt8($Check(Self,"")._Position$2,true),10);
      ++$Check(Self,"")._Position$2;
      return Result
   }
   /// function TG2DataManager.ReadIntU16() : Integer
   ,ReadIntU16:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getUint16($Check(Self,"")._Position$2,true),10);
      ($Check(Self,"")._Position$2+= 2);
      return Result
   }
   /// function TG2DataManager.ReadIntU32() : Integer
   ,ReadIntU32:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getUint32($Check(Self,"")._Position$2,true),10);
      ($Check(Self,"")._Position$2+= 4);
      return Result
   }
   /// function TG2DataManager.ReadIntU8() : Integer
   ,ReadIntU8:function(Self) {
      var Result = 0;
      Result = parseInt($Check(Self,"")._Data$2.getUint8($Check(Self,"")._Position$2,true),10);
      ++$Check(Self,"")._Position$2;
      return Result
   }
   /// function TG2DataManager.ReadMat3x3() : TG2Mat
   ,ReadMat3x3:function(Self) {
      var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Mat$SetE00(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE01(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE02(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE03(Result,0);
      TG2Mat$SetE10(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE11(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE12(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE13(Result,0);
      TG2Mat$SetE20(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE21(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE22(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE23(Result,0);
      TG2Mat$SetE30(Result,0);
      TG2Mat$SetE31(Result,0);
      TG2Mat$SetE32(Result,0);
      TG2Mat$SetE33(Result,1);
      return Result
   }
   /// function TG2DataManager.ReadMat4x3() : TG2Mat
   ,ReadMat4x3:function(Self) {
      var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Mat$SetE00(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE01(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE02(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE03(Result,0);
      TG2Mat$SetE10(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE11(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE12(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE13(Result,0);
      TG2Mat$SetE20(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE21(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE22(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE23(Result,0);
      TG2Mat$SetE30(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE31(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE32(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE33(Result,1);
      return Result
   }
   /// function TG2DataManager.ReadMat4x4() : TG2Mat
   ,ReadMat4x4:function(Self) {
      var Result = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      TG2Mat$SetE00(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE01(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE02(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE03(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE10(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE11(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE12(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE13(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE20(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE21(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE22(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE23(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE30(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE31(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE32(Result,TG2DataManager.ReadFloat32(Self));
      TG2Mat$SetE33(Result,TG2DataManager.ReadFloat32(Self));
      return Result
   }
   /// function TG2DataManager.ReadString(const Size: Integer) : String
   ,ReadString:function(Self, Size$6) {
      var Result = "";
      var i$81 = 0;
      Result = "";
      var $temp117;
      for(i$81 = 0,$temp117 = Size$6;i$81<$temp117;i$81++) {
         Result+=G2Char(TG2DataManager.ReadIntU8(Self));
      }
      return Result
   }
   /// function TG2DataManager.ReadStringNT() : String
   ,ReadStringNT:function(Self) {
      var Result = "";
      var b$37 = 0;
      Result = "";
      b$37 = TG2DataManager.ReadIntU8(Self);
      while ((b$37!=0)) {
         Result+=G2Char(b$37);
         b$37 = TG2DataManager.ReadIntU8(Self);
      }
      return Result
   }
   /// function TG2DataManager.ReadVec2() : TG2Vec2
   ,ReadVec2:function(Self) {
      var Result = {Arr$3:[0,0]};
      TG2Vec2$SetX$2(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec2$SetY$2(Result,TG2DataManager.ReadFloat32(Self));
      return Result
   }
   /// function TG2DataManager.ReadVec3() : TG2Vec3
   ,ReadVec3:function(Self) {
      var Result = {Arr$2:[0,0,0]};
      TG2Vec3$SetX$1(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec3$SetY$1(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec3$SetZ$1(Result,TG2DataManager.ReadFloat32(Self));
      return Result
   }
   /// function TG2DataManager.ReadVec4() : TG2Vec4
   ,ReadVec4:function(Self) {
      var Result = {Arr$1:[0,0,0,0]};
      TG2Vec4$SetX(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec4$SetY(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec4$SetZ(Result,TG2DataManager.ReadFloat32(Self));
      TG2Vec4$SetW(Result,TG2DataManager.ReadFloat32(Self));
      return Result
   }
   /// procedure TG2DataManager.Skip(const Size: Integer)
   ,Skip:function(Self, Size$7) {
      $Check(Self,"")._Position$2+=Size$7;
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,Create$48$:function($){return $.ClassType.Create$48($)}
};
/// TG2RagdollObject = class (TObject)
var TG2RagdollObject = {
   $ClassName:"TG2RagdollObject",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.NodeID$1 = $.DependantCount = 0;
      $.MinV$1 = {Arr$2:[0,0,0]};
      $.MaxV$1 = {Arr$2:[0,0,0]};
      $.Transform$4 = {Arr$5:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};
      $.Dependants = [];
   }
   ,Destroy:TObject.Destroy
};
/// TG2MeshLoader = class (TObject)
var TG2MeshLoader = {
   $ClassName:"TG2MeshLoader",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
   }
   /// function TG2MeshLoader.CheckDataHeader(const DataManager: TG2DataManager; const Header: String) : Boolean
   ,CheckDataHeader:function(Self, DataManager, Header) {
      var Result = false;
      var Pos$17 = 0;
      var DataHeader = "";
      Pos$17 = $Check(DataManager,"")._Position$2;
      DataHeader = TG2DataManager.ReadString(DataManager,Header.length);
      $Check(DataManager,"")._Position$2 = Pos$17;
      Result = Header==DataHeader;
      return Result
   }
   /// constructor TG2MeshLoader.Create()
   ,Create$73:function(Self) {
      TObject.Create(Self);
      return Self
   }
   /// destructor TG2MeshLoader.Destroy()
   ,Destroy:function(Self) {
      TObject.Destroy(Self);
   }
   /// function TG2MeshLoader.CanLoad(const DataManager: TG2DataManager) : Boolean
   ,CanLoad:function(Self, DataManager$1) {
      return false;
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
   ,CanLoad$:function($){return $.CanLoad.apply($.ClassType, arguments)}
   ,Load$4$:function($){return $.ClassType.Load$4.apply($.ClassType, arguments)}
   ,ExportMeshData$:function($){return $.ClassType.ExportMeshData($)}
};
/// TG2MeshData = class (TObject)
var TG2MeshData = {
   $ClassName:"TG2MeshData",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.AnimCount$1 = $.GeomCount$1 = $.MaterialCount$1 = $.NodeCount$3 = $.RagDollCount = $.SkinCount = 0;
      $.Anims$1 = [];
      $.Geoms$1 = [];
      $.Materials$2 = [];
      $.Nodes$3 = [];
      $.RagDolls = [];
      $.Skins$1 = [];
   }
   /// constructor TG2MeshData.Create()
   ,Create$74:function(Self) {
      TObject.Create(Self);
      $Check(Self,"").NodeCount$3 = 0;
      $Check(Self,"").GeomCount$1 = 0;
      $Check(Self,"").SkinCount = 0;
      $Check(Self,"").AnimCount$1 = 0;
      $Check(Self,"").MaterialCount$1 = 0;
      $Check(Self,"").RagDollCount = 0;
      return Self
   }
   /// destructor TG2MeshData.Destroy()
   ,Destroy:function(Self) {
      var i$82 = 0;
      var j$6 = 0;
      var $temp118;
      for(i$82 = 0,$temp118 = $Check(Self,"").RagDollCount;i$82<$temp118;i$82++) {
         TObject.Free($DIdxR($Check(Self,"").RagDolls,i$82,"").Head);
         TObject.Free($DIdxR($Check(Self,"").RagDolls,i$82,"").Neck);
         TObject.Free($DIdxR($Check(Self,"").RagDolls,i$82,"").Pelvis);
         var $temp119;
         for(j$6 = 0,$temp119 = $DIdxR($Check(Self,"").RagDolls,i$82,"").BodyNodeCount;j$6<$temp119;j$6++) {
            TObject.Free($DIdxR($DIdxR($Check(Self,"").RagDolls,i$82,"").BodyNodes,j$6,""));
         }
         var $temp120;
         for(j$6 = 0,$temp120 = $DIdxR($Check(Self,"").RagDolls,i$82,"").ArmLNodeCount;j$6<$temp120;j$6++) {
            TObject.Free($DIdxR($DIdxR($Check(Self,"").RagDolls,i$82,"").ArmLNodes,j$6,""));
         }
         var $temp121;
         for(j$6 = 0,$temp121 = $DIdxR($Check(Self,"").RagDolls,i$82,"").ArmRNodeCount;j$6<$temp121;j$6++) {
            TObject.Free($DIdxR($DIdxR($Check(Self,"").RagDolls,i$82,"").ArmRNodes,j$6,""));
         }
         var $temp122;
         for(j$6 = 0,$temp122 = $DIdxR($Check(Self,"").RagDolls,i$82,"").LegLNodeCount;j$6<$temp122;j$6++) {
            TObject.Free($DIdxR($DIdxR($Check(Self,"").RagDolls,i$82,"").LegLNodes,j$6,""));
         }
         var $temp123;
         for(j$6 = 0,$temp123 = $DIdxR($Check(Self,"").RagDolls,i$82,"").LegRNodeCount;j$6<$temp123;j$6++) {
            TObject.Free($DIdxR($DIdxR($Check(Self,"").RagDolls,i$82,"").LegRNodes,j$6,""));
         }
      }
      TObject.Destroy(Self);
   }
   /// procedure TG2MeshData.LimitSkins(MaxWeights: Integer = 4)
   ,LimitSkins:function(Self, MaxWeights$2) {
      var s$17 = 0;
      var v$20 = 0;
      var w$12 = 0;
      var n$13 = 0;
      var i$83 = 0;
      var j$7 = 0;
      var m$18 = 0;
      var CurWeights = 0;
      var TotalWeight = 0;
      var WeightsRemap = [];
      /// anonymous TRecordSymbol
      function Copy$a$72(s,d) {
         d.Weight$2=s.Weight$2;
         d.Index$45=s.Index$45;
         return d;
      }
      function Clone$a$72($) {
         return {
            Weight$2:$.Weight$2,
            Index$45:$.Index$45
         }
      }
      function Pub$a$72($) {
         return {
            "Weight" : $.Weight$2
            ,"Index" : $.Index$45
         }
      }
      WeightsRemap.length=0;
      var $temp124;
      for(s$17 = 0,$temp124 = $Check(Self,"").SkinCount;s$17<$temp124;s$17++) {
         var $temp125;
         for(v$20 = 0,$temp125 = $DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1.length;v$20<$temp125;v$20++) {
            if ($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount>MaxWeights$2) {
               if ($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount>WeightsRemap.length) {
                  $ArraySetLenC(WeightsRemap,$DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount,function (){return {Weight$2:0,Index$45:0}});
               }
               CurWeights = 0;
               var $temp126;
               for(w$12 = 0,$temp126 = $DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount;w$12<$temp126;w$12++) {
                  n$13 = CurWeights;
                  var $temp127;
                  for(i$83 = 0,$temp127 = CurWeights;i$83<$temp127;i$83++) {
                     if ($DIdxR(WeightsRemap,i$83,"").Weight$2<$DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").Weight$1) {
                        n$13 = i$83;
                        var $temp128;
                        for(m$18 = 0,$temp128 = CurWeights-i$83;m$18<=$temp128;m$18++) {
                           $DIdxW(WeightsRemap,i$83+1,$DIdxR(WeightsRemap,i$83,""),"");
                        }
                        break;
                     }
                  }
                  $DIdxR(WeightsRemap,n$13,"").Weight$2 = $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").Weight$1;
                  $DIdxR(WeightsRemap,n$13,"").Index$45 = $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").BoneID;
                  ++CurWeights;
               }
               TotalWeight = $DIdxR(WeightsRemap,0,"").Weight$2;
               var $temp129;
               for(w$12 = 1,$temp129 = MaxWeights$2;w$12<$temp129;w$12++) {
                  TotalWeight+=$DIdxR(WeightsRemap,w$12,"").Weight$2;
               }
               TotalWeight = 1/TotalWeight;
               $ArraySetLenC($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,MaxWeights$2,function (){return {BoneID:0,Weight$1:0}});
               var $temp130;
               for(w$12 = 0,$temp130 = MaxWeights$2;w$12<$temp130;w$12++) {
                  $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").BoneID = $DIdxR(WeightsRemap,w$12,"").Index$45;
                  $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").Weight$1 = $DIdxR(WeightsRemap,w$12,"").Weight$2*TotalWeight;
               }
               $DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount = MaxWeights$2;
            }
            n$13 = $DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount;
            w$12 = 0;
            while (w$12<n$13) {
               if ($DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,w$12,"").Weight$1<1E-6) {
                  var $temp131;
                  for(j$7 = w$12,$temp131 = n$13-2;j$7<=$temp131;j$7++) {
                     $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,j$7,"").Weight$1 = $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,j$7+1,"").Weight$1;
                     $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,j$7,"").BoneID = $DIdxR($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,j$7+1,"").BoneID;
                  }
                  --n$13;
               } else {
                  ++w$12;
               }
            }
            if (n$13<$DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount) {
               $ArraySetLenC($DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").Weights,n$13,function (){return {BoneID:0,Weight$1:0}});
               $DIdxR($DIdxR($Check(Self,"").Skins$1,s$17,"").Vertices$1,v$20,"").WeightCount = n$13;
            }
         }
         if ($DIdxR($Check(Self,"").Skins$1,s$17,"").MaxWeights$1>MaxWeights$2) {
            $DIdxR($Check(Self,"").Skins$1,s$17,"").MaxWeights$1 = MaxWeights$2;
         }
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
};
function G2AddMeshLoader(MeshLoaderClass) {
   $ArraySetLenC(G2MeshLoaders,(G2MeshLoaders.length+1),function (){return null});
   $DIdxW(G2MeshLoaders,(G2MeshLoaders.length-1),MeshLoaderClass,"");
};
/// anonymous TRecordSymbol
function Copy$a$19(s,d) {
   d.NodeID$2=s.NodeID$2;
   Copy$TG2Mat(s.Offset$4,d.Offset$4);
   return d;
}
function Clone$a$19($) {
   return {
      NodeID$2:$.NodeID$2,
      Offset$4:Clone$TG2Mat($.Offset$4)
   }
}
function Pub$a$19($) {
   return {
      "NodeID" : $.NodeID$2
      ,"Offset" : Pub$TG2Mat($.Offset$4)
   }
}
/// anonymous TRecordSymbol
function Copy$a$20(s,d) {
   d.OwnerID$1=s.OwnerID$1;
   d.Name$9=s.Name$9;
   Copy$TG2Mat(s.Transform$5,d.Transform$5);
   return d;
}
function Clone$a$20($) {
   return {
      OwnerID$1:$.OwnerID$1,
      Name$9:$.Name$9,
      Transform$5:Clone$TG2Mat($.Transform$5)
   }
}
function Pub$a$20($) {
   return {
      "OwnerID" : $.OwnerID$1
      ,"Name" : $.Name$9
      ,"Transform" : Pub$TG2Mat($.Transform$5)
   }
}
/// anonymous TRecordSymbol
function Copy$a$21(s,d) {
   Copy$TG2Vec3(s.Position$3,d.Position$3);
   Copy$TG2Vec3(s.Tangent,d.Tangent);
   Copy$TG2Vec3(s.Binormal,d.Binormal);
   Copy$TG2Vec3(s.Normal,d.Normal);
   d.TexCoords=s.TexCoords;
   Copy$TG2Vec4(s.Color$4,d.Color$4);
   return d;
}
function Clone$a$21($) {
   return {
      Position$3:Clone$TG2Vec3($.Position$3),
      Tangent:Clone$TG2Vec3($.Tangent),
      Binormal:Clone$TG2Vec3($.Binormal),
      Normal:Clone$TG2Vec3($.Normal),
      TexCoords:$.TexCoords,
      Color$4:Clone$TG2Vec4($.Color$4)
   }
}
function Pub$a$21($) {
   return {
      "Position" : Pub$TG2Vec3($.Position$3)
      ,"Tangent" : Pub$TG2Vec3($.Tangent)
      ,"Binormal" : Pub$TG2Vec3($.Binormal)
      ,"Normal" : Pub$TG2Vec3($.Normal)
      ,"TexCoords" : $.TexCoords
      ,"Color" : Pub$TG2Vec4($.Color$4)
   }
}
/// anonymous TRecordSymbol
function Copy$a$22(s,d) {
   d.MaterialID=s.MaterialID;
   d.VertexStart=s.VertexStart;
   d.VertexCount$1=s.VertexCount$1;
   d.FaceStart=s.FaceStart;
   d.FaceCount=s.FaceCount;
   return d;
}
function Clone$a$22($) {
   return {
      MaterialID:$.MaterialID,
      VertexStart:$.VertexStart,
      VertexCount$1:$.VertexCount$1,
      FaceStart:$.FaceStart,
      FaceCount:$.FaceCount
   }
}
function Pub$a$22($) {
   return {
      "MaterialID" : $.MaterialID
      ,"VertexStart" : $.VertexStart
      ,"VertexCount" : $.VertexCount$1
      ,"FaceStart" : $.FaceStart
      ,"FaceCount" : $.FaceCount
   }
}
/// anonymous TRecordSymbol
function Copy$a$23(s,d) {
   d.Faces=s.Faces;
   d.FCount$1=s.FCount$1;
   d.Groups$1=s.Groups$1;
   d.MCount=s.MCount;
   d.NodeID$3=s.NodeID$3;
   d.SkinID=s.SkinID;
   d.TCount$1=s.TCount$1;
   d.VCount$1=s.VCount$1;
   d.Vertices=s.Vertices;
   return d;
}
function Clone$a$23($) {
   return {
      Faces:$.Faces,
      FCount$1:$.FCount$1,
      Groups$1:$.Groups$1,
      MCount:$.MCount,
      NodeID$3:$.NodeID$3,
      SkinID:$.SkinID,
      TCount$1:$.TCount$1,
      VCount$1:$.VCount$1,
      Vertices:$.Vertices
   }
}
function Pub$a$23($) {
   return {
      "Faces" : $.Faces
      ,"FCount" : $.FCount$1
      ,"Groups" : $.Groups$1
      ,"MCount" : $.MCount
      ,"NodeID" : $.NodeID$3
      ,"SkinID" : $.SkinID
      ,"TCount" : $.TCount$1
      ,"VCount" : $.VCount$1
      ,"Vertices" : $.Vertices
   }
}
/// anonymous TRecordSymbol
function Copy$a$24(s,d) {
   d.NodeID$4=s.NodeID$4;
   Copy$TG2Mat(s.Bind$4,d.Bind$4);
   Copy$TG2Box(s.BBox$2,d.BBox$2);
   d.VCount$2=s.VCount$2;
   return d;
}
function Clone$a$24($) {
   return {
      NodeID$4:$.NodeID$4,
      Bind$4:Clone$TG2Mat($.Bind$4),
      BBox$2:Clone$TG2Box($.BBox$2),
      VCount$2:$.VCount$2
   }
}
function Pub$a$24($) {
   return {
      "NodeID" : $.NodeID$4
      ,"Bind" : Pub$TG2Mat($.Bind$4)
      ,"BBox" : Pub$TG2Box($.BBox$2)
      ,"VCount" : $.VCount$2
   }
}
/// anonymous TRecordSymbol
function Copy$a$25(s,d) {
   d.BoneID=s.BoneID;
   d.Weight$1=s.Weight$1;
   return d;
}
function Clone$a$25($) {
   return {
      BoneID:$.BoneID,
      Weight$1:$.Weight$1
   }
}
function Pub$a$25($) {
   return {
      "BoneID" : $.BoneID
      ,"Weight" : $.Weight$1
   }
}
/// anonymous TRecordSymbol
function Copy$a$26(s,d) {
   d.WeightCount=s.WeightCount;
   d.Weights=s.Weights;
   return d;
}
function Clone$a$26($) {
   return {
      WeightCount:$.WeightCount,
      Weights:$.Weights
   }
}
function Pub$a$26($) {
   return {
      "WeightCount" : $.WeightCount
      ,"Weights" : $.Weights
   }
}
/// anonymous TRecordSymbol
function Copy$a$27(s,d) {
   d.GeomID=s.GeomID;
   d.MaxWeights$1=s.MaxWeights$1;
   d.BoneCount$1=s.BoneCount$1;
   d.Bones$1=s.Bones$1;
   d.Vertices$1=s.Vertices$1;
   return d;
}
function Clone$a$27($) {
   return {
      GeomID:$.GeomID,
      MaxWeights$1:$.MaxWeights$1,
      BoneCount$1:$.BoneCount$1,
      Bones$1:$.Bones$1,
      Vertices$1:$.Vertices$1
   }
}
function Pub$a$27($) {
   return {
      "GeomID" : $.GeomID
      ,"MaxWeights" : $.MaxWeights$1
      ,"BoneCount" : $.BoneCount$1
      ,"Bones" : $.Bones$1
      ,"Vertices" : $.Vertices$1
   }
}
/// anonymous TRecordSymbol
function Copy$a$28(s,d) {
   Copy$TG2Vec3(s.Scaling,d.Scaling);
   Copy$TG2Quat(s.Rotation$1,d.Rotation$1);
   Copy$TG2Vec3(s.Translation,d.Translation);
   return d;
}
function Clone$a$28($) {
   return {
      Scaling:Clone$TG2Vec3($.Scaling),
      Rotation$1:Clone$TG2Quat($.Rotation$1),
      Translation:Clone$TG2Vec3($.Translation)
   }
}
function Pub$a$28($) {
   return {
      "Scaling" : Pub$TG2Vec3($.Scaling)
      ,"Rotation" : Pub$TG2Quat($.Rotation$1)
      ,"Translation" : Pub$TG2Vec3($.Translation)
   }
}
/// anonymous TRecordSymbol
function Copy$a$29(s,d) {
   d.NodeID$5=s.NodeID$5;
   d.Frames$2=s.Frames$2;
   return d;
}
function Clone$a$29($) {
   return {
      NodeID$5:$.NodeID$5,
      Frames$2:$.Frames$2
   }
}
function Pub$a$29($) {
   return {
      "NodeID" : $.NodeID$5
      ,"Frames" : $.Frames$2
   }
}
/// anonymous TRecordSymbol
function Copy$a$30(s,d) {
   d.Name$10=s.Name$10;
   d.FrameRate$1=s.FrameRate$1;
   d.FrameCount$2=s.FrameCount$2;
   d.NodeCount$4=s.NodeCount$4;
   d.Nodes$4=s.Nodes$4;
   return d;
}
function Clone$a$30($) {
   return {
      Name$10:$.Name$10,
      FrameRate$1:$.FrameRate$1,
      FrameCount$2:$.FrameCount$2,
      NodeCount$4:$.NodeCount$4,
      Nodes$4:$.Nodes$4
   }
}
function Pub$a$30($) {
   return {
      "Name" : $.Name$10
      ,"FrameRate" : $.FrameRate$1
      ,"FrameCount" : $.FrameCount$2
      ,"NodeCount" : $.NodeCount$4
      ,"Nodes" : $.Nodes$4
   }
}
/// anonymous TRecordSymbol
function Copy$a$31(s,d) {
   Copy$TG2Vec4(s.AmbientColor,d.AmbientColor);
   d.AmbientMap=s.AmbientMap;
   d.AmbientMapAmount=s.AmbientMapAmount;
   d.AmbientMapEnable=s.AmbientMapEnable;
   Copy$TG2Vec4(s.DiffuseColor,d.DiffuseColor);
   d.DiffuseMap=s.DiffuseMap;
   d.DiffuseMapAmount=s.DiffuseMapAmount;
   d.DiffuseMapEnable=s.DiffuseMapEnable;
   Copy$TG2Vec4(s.EmmissiveColor,d.EmmissiveColor);
   d.EmmissiveColorAmount=s.EmmissiveColorAmount;
   d.LightMap=s.LightMap;
   d.LightMapAmount=s.LightMapAmount;
   d.LightMapEnable=s.LightMapEnable;
   d.Name$11=s.Name$11;
   d.NormalMap=s.NormalMap;
   d.NormalMapAmount=s.NormalMapAmount;
   d.NormalMapEnable=s.NormalMapEnable;
   d.OpacityMap=s.OpacityMap;
   d.OpacityMapAmount=s.OpacityMapAmount;
   d.OpacityMapEnable=s.OpacityMapEnable;
   Copy$TG2Vec4(s.SpecularColor,d.SpecularColor);
   d.SpecularColorAmount=s.SpecularColorAmount;
   d.SpecularMap=s.SpecularMap;
   d.SpecularMapAmount=s.SpecularMapAmount;
   d.SpecularMapEnable=s.SpecularMapEnable;
   d.SpecularPower=s.SpecularPower;
   d.TwoSided=s.TwoSided;
   return d;
}
function Clone$a$31($) {
   return {
      AmbientColor:Clone$TG2Vec4($.AmbientColor),
      AmbientMap:$.AmbientMap,
      AmbientMapAmount:$.AmbientMapAmount,
      AmbientMapEnable:$.AmbientMapEnable,
      DiffuseColor:Clone$TG2Vec4($.DiffuseColor),
      DiffuseMap:$.DiffuseMap,
      DiffuseMapAmount:$.DiffuseMapAmount,
      DiffuseMapEnable:$.DiffuseMapEnable,
      EmmissiveColor:Clone$TG2Vec4($.EmmissiveColor),
      EmmissiveColorAmount:$.EmmissiveColorAmount,
      LightMap:$.LightMap,
      LightMapAmount:$.LightMapAmount,
      LightMapEnable:$.LightMapEnable,
      Name$11:$.Name$11,
      NormalMap:$.NormalMap,
      NormalMapAmount:$.NormalMapAmount,
      NormalMapEnable:$.NormalMapEnable,
      OpacityMap:$.OpacityMap,
      OpacityMapAmount:$.OpacityMapAmount,
      OpacityMapEnable:$.OpacityMapEnable,
      SpecularColor:Clone$TG2Vec4($.SpecularColor),
      SpecularColorAmount:$.SpecularColorAmount,
      SpecularMap:$.SpecularMap,
      SpecularMapAmount:$.SpecularMapAmount,
      SpecularMapEnable:$.SpecularMapEnable,
      SpecularPower:$.SpecularPower,
      TwoSided:$.TwoSided
   }
}
function Pub$a$31($) {
   return {
      "AmbientColor" : Pub$TG2Vec4($.AmbientColor)
      ,"AmbientMap" : $.AmbientMap
      ,"AmbientMapAmount" : $.AmbientMapAmount
      ,"AmbientMapEnable" : $.AmbientMapEnable
      ,"DiffuseColor" : Pub$TG2Vec4($.DiffuseColor)
      ,"DiffuseMap" : $.DiffuseMap
      ,"DiffuseMapAmount" : $.DiffuseMapAmount
      ,"DiffuseMapEnable" : $.DiffuseMapEnable
      ,"EmmissiveColor" : Pub$TG2Vec4($.EmmissiveColor)
      ,"EmmissiveColorAmount" : $.EmmissiveColorAmount
      ,"LightMap" : $.LightMap
      ,"LightMapAmount" : $.LightMapAmount
      ,"LightMapEnable" : $.LightMapEnable
      ,"Name" : $.Name$11
      ,"NormalMap" : $.NormalMap
      ,"NormalMapAmount" : $.NormalMapAmount
      ,"NormalMapEnable" : $.NormalMapEnable
      ,"OpacityMap" : $.OpacityMap
      ,"OpacityMapAmount" : $.OpacityMapAmount
      ,"OpacityMapEnable" : $.OpacityMapEnable
      ,"SpecularColor" : Pub$TG2Vec4($.SpecularColor)
      ,"SpecularColorAmount" : $.SpecularColorAmount
      ,"SpecularMap" : $.SpecularMap
      ,"SpecularMapAmount" : $.SpecularMapAmount
      ,"SpecularMapEnable" : $.SpecularMapEnable
      ,"SpecularPower" : $.SpecularPower
      ,"TwoSided" : $.TwoSided
   }
}
/// anonymous TRecordSymbol
function Copy$a$32(s,d) {
   d.ChannelCount$1=s.ChannelCount$1;
   d.Channels$1=s.Channels$1;
   return d;
}
function Clone$a$32($) {
   return {
      ChannelCount$1:$.ChannelCount$1,
      Channels$1:$.Channels$1
   }
}
function Pub$a$32($) {
   return {
      "ChannelCount" : $.ChannelCount$1
      ,"Channels" : $.Channels$1
   }
}
/// anonymous TRecordSymbol
function Copy$a$33(s,d) {
   d.ArmLNodeCount=s.ArmLNodeCount;
   d.ArmLNodes=s.ArmLNodes;
   d.ArmRNodeCount=s.ArmRNodeCount;
   d.ArmRNodes=s.ArmRNodes;
   d.BodyNodeCount=s.BodyNodeCount;
   d.BodyNodes=s.BodyNodes;
   d.Head=s.Head;
   d.LegLNodeCount=s.LegLNodeCount;
   d.LegLNodes=s.LegLNodes;
   d.LegRNodeCount=s.LegRNodeCount;
   d.LegRNodes=s.LegRNodes;
   d.Neck=s.Neck;
   d.NodeID$6=s.NodeID$6;
   d.Pelvis=s.Pelvis;
   return d;
}
function Clone$a$33($) {
   return {
      ArmLNodeCount:$.ArmLNodeCount,
      ArmLNodes:$.ArmLNodes,
      ArmRNodeCount:$.ArmRNodeCount,
      ArmRNodes:$.ArmRNodes,
      BodyNodeCount:$.BodyNodeCount,
      BodyNodes:$.BodyNodes,
      Head:$.Head,
      LegLNodeCount:$.LegLNodeCount,
      LegLNodes:$.LegLNodes,
      LegRNodeCount:$.LegRNodeCount,
      LegRNodes:$.LegRNodes,
      Neck:$.Neck,
      NodeID$6:$.NodeID$6,
      Pelvis:$.Pelvis
   }
}
function Pub$a$33($) {
   return {
      "ArmLNodeCount" : $.ArmLNodeCount
      ,"ArmLNodes" : $.ArmLNodes
      ,"ArmRNodeCount" : $.ArmRNodeCount
      ,"ArmRNodes" : $.ArmRNodes
      ,"BodyNodeCount" : $.BodyNodeCount
      ,"BodyNodes" : $.BodyNodes
      ,"Head" : $.Head
      ,"LegLNodeCount" : $.LegLNodeCount
      ,"LegLNodes" : $.LegLNodes
      ,"LegRNodeCount" : $.LegRNodeCount
      ,"LegRNodes" : $.LegRNodes
      ,"Neck" : $.Neck
      ,"NodeID" : $.NodeID$6
      ,"Pelvis" : $.Pelvis
   }
}
/// TSprite = class (TObject)
var TSprite = {
   $ClassName:"TSprite",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Angle = 0;
      $.AngVel = 0;
      $.Pos$1 = {Arr$3:[0,0]};
      $.Size = 0;
      $.Vel = {Arr$3:[0,0]};
   }
   /// constructor TSprite.Create()
   ,Create$3:function(Self) {
      $Check(Self,"").Size = 20+(Random()*40);
      TG2Vec2$SetX$2($Check(Self,"").Pos$1,((Random()*(TG2Params.GetWidth$2($Check(g2,"")._Params)-($Check(Self,"").Size*2)))+$Check(Self,"").Size));
      TG2Vec2$SetY$2($Check(Self,"").Pos$1,((Random()*(TG2Params.GetHeight$2($Check(g2,"")._Params)-($Check(Self,"").Size*2)))+$Check(Self,"").Size));
      $Check(Self,"").Vel = G2Vec2FloatMul(G2RandomCirclePoint(),((Random()*5)+2));
      $Check(Self,"").Angle = G2Random2Pi();
      $Check(Self,"").AngVel = ((Random()*2)-1)*0.2;
      return Self
   }
   /// procedure TSprite.Render()
   ,Render:function(Self) {
      TG2Core.PicRect$3(g2,(TG2Vec2$GetX$2($Check(Self,"").Pos$1)-$Check(Self,"").Size),(TG2Vec2$GetY$2($Check(Self,"").Pos$1)-$Check(Self,"").Size),($Check(Self,"").Size*2),($Check(Self,"").Size*2),G2Vec4(1,1,1,1),$Check(Game,"").TexSprite,2,1);
   }
   /// procedure TSprite.Update()
   ,Update:function(Self) {
      $Check(Self,"").Pos$1 = G2Vec2Add($Check(Self,"").Pos$1,$Check(Self,"").Vel);
      $Check(Self,"").Angle+=$Check(Self,"").AngVel;
      if ((TG2Vec2$GetX$2($Check(Self,"").Pos$1)-$Check(Self,"").Size)<0) {
         TG2Vec2$SetX$2($Check(Self,"").Pos$1,$Check(Self,"").Size);
         TG2Vec2$SetX$2($Check(Self,"").Vel,(-TG2Vec2$GetX$2($Check(Self,"").Vel)));
      } else if ((TG2Vec2$GetX$2($Check(Self,"").Pos$1)+$Check(Self,"").Size)>TG2Params.GetWidth$2($Check(g2,"")._Params)) {
         TG2Vec2$SetX$2($Check(Self,"").Pos$1,(TG2Params.GetWidth$2($Check(g2,"")._Params)-$Check(Self,"").Size));
         TG2Vec2$SetX$2($Check(Self,"").Vel,(-TG2Vec2$GetX$2($Check(Self,"").Vel)));
      }
      if ((TG2Vec2$GetY$2($Check(Self,"").Pos$1)-$Check(Self,"").Size)<0) {
         TG2Vec2$SetY$2($Check(Self,"").Pos$1,$Check(Self,"").Size);
         TG2Vec2$SetY$2($Check(Self,"").Vel,(-TG2Vec2$GetY$2($Check(Self,"").Vel)));
      } else if ((TG2Vec2$GetY$2($Check(Self,"").Pos$1)+$Check(Self,"").Size)>TG2Params.GetHeight$2($Check(g2,"")._Params)) {
         TG2Vec2$SetY$2($Check(Self,"").Pos$1,(TG2Params.GetHeight$2($Check(g2,"")._Params)-$Check(Self,"").Size));
         TG2Vec2$SetY$2($Check(Self,"").Vel,(-TG2Vec2$GetY$2($Check(Self,"").Vel)));
      }
   }
   ,Destroy:TObject.Destroy
};
/// TGame = class (TObject)
var TGame = {
   $ClassName:"TGame",
   $Parent:TObject
   ,$Init:function ($) {
      TObject.$Init($);
      $.Font0 = $.TexSprite = null;
      $.Initialized = false;
      $.Sprites = function () {
         for (var r=[],i=0; i<10000; i++) r.push(null);
         return r
      }();
   }
   /// constructor TGame.Create()
   ,Create$4:function(Self) {
      TObject.Create(Self);
      TG2Core.CallbackInitializeAdd(g2,$Event0(Self,TGame.Initialize));
      TG2Core.CallbackFinalizeAdd(g2,$Event0(Self,TGame.Finalize));
      TG2Core.CallbackUpdateAdd(g2,$Event0(Self,TGame.Update$1));
      TG2Core.CallbackRenderAdd(g2,$Event0(Self,TGame.Render$1),0);
      TG2Core.CallbackKeyDownAdd(g2,$Event1(Self,TGame.KeyDown));
      TG2Core.CallbackKeyUpAdd(g2,$Event1(Self,TGame.KeyUp));
      TG2Core.CallbackMouseDownAdd(g2,$Event3(Self,TGame.MouseDown));
      TG2Core.CallbackMouseUpAdd(g2,$Event3(Self,TGame.MouseUp));
      TG2Core.CallbackScrollAdd(g2,$Event1(Self,TGame.Scroll));
      TG2Core.CallbackPrintAdd(g2,$Event1(Self,TGame.Print$1));
      $Check(g2,"")._TargetUPS = 45;
      $Check(Self,"").Initialized = false;
      return Self
   }
   /// destructor TGame.Destroy()
   ,Destroy:function(Self) {
      TObject.Destroy(Self);
   }
   /// procedure TGame.Finalize()
   ,Finalize:function(Self) {
      /* null */
   }
   /// procedure TGame.Initialize()
   ,Initialize:function(Self) {
      var i$84 = 0;
      $Check(Self,"").TexSprite = TG2Resource.Create$48$($New(TG2Texture2D));
      TG2Texture2D.Load$1($Check(Self,"").TexSprite,"sprite.png",0);
      $Check(Self,"").Font0 = TG2Resource.Create$48$($New(TG2Font));
      TG2Font.Load$3($Check(Self,"").Font0,"Font0.g2fh","Font0.png");
      $Check(Self,"").Initialized = true;
      for(i$84 = 0;i$84<=9999;i$84++) {
         $Check(Self,"").Sprites[$Idx(i$84,0,9999,"")] = TSprite.Create$3($New(TSprite));
      }
   }
   /// procedure TGame.KeyDown(const Key: Integer)
   ,KeyDown:function(Self, Key$2) {
      /* null */
   }
   /// procedure TGame.KeyUp(const Key: Integer)
   ,KeyUp:function(Self, Key$3) {
      /* null */
   }
   /// procedure TGame.MouseDown(const Button: Integer; const x: Integer; const y: Integer)
   ,MouseDown:function(Self, Button$3, x$97, y$80) {
      /* null */
   }
   /// procedure TGame.MouseUp(const Button: Integer; const x: Integer; const y: Integer)
   ,MouseUp:function(Self, Button$4, x$98, y$81) {
      /* null */
   }
   /// procedure TGame.Print(const c: AnsiChar)
   ,Print$1:function(Self, c$14) {
      /* null */
   }
   /// procedure TGame.Render()
   ,Render$1:function(Self) {
      var i$85 = 0;
      function PrintText(x$99, y$82, Color$8, Str$1) {
         var InvColor = {Arr$1:[0,0,0,0]};
         InvColor = G2Vec4Sub(G2Vec4(1,1,1,1),Color$8);
         TG2Vec4$SetW(InvColor,1);
         TG2Font.Print$3($Check(Self,"").Font0,(x$99-1),(y$82-1),1,1,InvColor,Str$1,2,1);
         TG2Font.Print$3($Check(Self,"").Font0,(x$99+1),(y$82+1),1,1,InvColor,Str$1,2,1);
         TG2Font.Print$3($Check(Self,"").Font0,(x$99),(y$82),1,1,Color$8,Str$1,2,1);
      };
      if ($Check(Self,"").Initialized) {
         if ($Check($Check(Self,"").TexSprite,"")._State==2) {
            for(i$85 = 0;i$85<=9999;i$85++) {
               TSprite.Render($Check(Self,"").Sprites[$Idx(i$85,0,9999,"")]);
            }
         }
         if ($Check($Check(Self,"").Font0,"")._State==2) {
            PrintText(10,10,G2Vec4(1,1,1,1),("FPS: "+$Check(g2,"")._FPS.toString()));
            PrintText(10,40,G2Vec4(1,1,1,1),"Sprites: 10000");
         }
      }
   }
   /// procedure TGame.Scroll(const y: Integer)
   ,Scroll:function(Self, y$83) {
      /* null */
   }
   /// procedure TGame.Update()
   ,Update$1:function(Self) {
      var i$86 = 0;
      if (($Check(Self,"").Initialized&&($Check($Check(Self,"").TexSprite,"")._State==2))&&($Check($Check(Self,"").Font0,"")._State==2)) {
         for(i$86 = 0;i$86<=9999;i$86++) {
            TSprite.Update($Check(Self,"").Sprites[$Idx(i$86,0,9999,"")]);
         }
      }
   }
   ,Destroy$:function($){return $.ClassType.Destroy($)}
};
function ShowMessage$1(Text$8) {
   
    alert(Text$8);
  };
var vCurrent = null;
var vScheduledControls = [];
var vScheduledCallbacks = [];
var vOnPerform = [];
var vPending = false;
var RegisterComponentsProc = null;
var DefaultDuration = 2;
var DefaultTiming = 1;
var vGetNow = undefined;
var vIsHighResolution = false;
var PressedCSSClass = "TW3Button_Pressed";
var Instance = null;
var PreventCaching = false;
var PreventCaching = false;
var G2MeshLoaders = [];
var g2 = null;
var Game = null;
var vCaptureControl = null;
var vCaptureInitialized = false;
var vUniqueNumber = 0;
var vVendor = 0;
var vDriver = null;
var vRequestAnimFrame = null;
var vCancelAnimFrame = null;
var g2 = TG2Resource.Create$48$($New(TG2Core));
var $Application = function() {
   Game = TGame.Create$4($New(TGame));
   TG2Core.Start$1(g2);
   TObject.Free(Game);
}
$Application();

 }
	window.onload = function () { bootstrap(); }
	</script>
</head>

<body></body>

</html>
